!function(e){function t(t){for(var r,s,a=t[0],c=t[1],u=t[2],f=0,d=[];f<a.length;f++)s=a[f],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&d.push(o[s][0]),o[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(l&&l(t);d.length;)d.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,a=1;a<n.length;a++){var c=n[a];0!==o[c]&&(r=!1)}r&&(i.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},o={1:0},i=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var a=window.webpackJsonp=window.webpackJsonp||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var u=0;u<a.length;u++)t(a[u]);var l=c;i.push([280,0]),n()}([,function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function o(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function s(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s}function a(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function c(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}Object.create;function u(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r}Object.create},,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"f",(function(){return h})),n.d(t,"g",(function(){return y})),n.d(t,"a",(function(){return g})),n.d(t,"c",(function(){return b})),n.d(t,"e",(function(){return w})),n.d(t,"d",(function(){return _}));var r=n(33),o=n(25),i=n(119);const s=new i.EventEmitter;let a,c,u,l,f,d,p=!1,h=3,m=3;function y(e){m=e;let t=v();setTimeout(()=>{s.emit("scale-change",t)},100)}function v(){const e=window.innerWidth;let t;return t=e>=2e3?5:e>=1500?4:e>=900?3:2,h=t>m?m:t,t>m?m:t}function g(e){d=e.rendering.getEngine();const t=e.rendering.getScene();a=new r.g(d),c=o.a.CreateFullscreenUI("UI",!0,t,r.j.NEAREST_SAMPLINGMODE),u=o.a.CreateFullscreenUI("UI",!1,a,r.j.NEAREST_SAMPLINGMODE),l=new o.f,l.thickness=0,l.isPointerBlocker=!1,l.zIndex=1e3,c.addControl(l),f=new o.f,f.thickness=0,f.isPointerBlocker=!1,f.zIndex=1e3,u.addControl(f),d.onResizeObservable.add(e=>{c.getContext().imageSmoothingEnabled=!1,u.getContext().imageSmoothingEnabled=!1,s.emit("resize",e),v(),setTimeout(()=>{s.emit("scale-change",h)},50)}),c.getContext().imageSmoothingEnabled=!1,u.getContext().imageSmoothingEnabled=!1,a.autoClear=!1;new r.a("Camera",-Math.PI/2,7*Math.PI/16,10,r.k.Zero(),a);p=!0,e.rendering._multiscenes.push(a),v()}function b(e){if(!p)throw"Scenes aren't initialized yet!";if(0==e)return a;throw"Invalid number"}function w(e){if(!p)throw"UIs aren't initialized yet!";if(0==e)return c;if(1==e)return u;throw"Invalid number"}function _(e){if(!p)throw"UIs aren't initialized yet!";if(0==e)return l;if(1==e)return f;throw"Invalid number"}window.scale=y},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return u})),n.d(t,"k",(function(){return l})),n.d(t,"h",(function(){return f})),n.d(t,"j",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"a",(function(){return h})),n.d(t,"i",(function(){return y})),n.d(t,"f",(function(){return b})),n.d(t,"e",(function(){return _}));var r=n(223),o=n(74),i=n(6);const s="0.2.0-beta.9.2",a=2,c={version:"0.0.0",nickname:"Player"+Math.round(1e5*Math.random()),autostep:o.isMobile,gamepad:!1,singleplayer:!1,allowcustom:!1,mouse:o.isMobile?50:15,viewDistance:o.isMobile?3:o.isFirefox?2:6,hotbarsize:9,scale:3};let u={...c,version:s};function l(e){u={...c,...e},Object(i.g)(u.scale),Object(r.b)(u)}let f={cheats:!1,control:!1,ingame:!1};function d(e){f={...f,...e}}function p(){return{debug:!0,showFPS:!0,inverseY:!1,inverseX:!1,sensitivityX:u.mouse,sensitivityY:u.mouse,chunkSize:32,chunkAddDistance:u.viewDistance,chunkRemoveDistance:u.viewDistance+.5,blockTestDistance:7,tickRate:o.isMobile?65:50,texturePath:"",playerStart:[0,100,0],playerHeight:1.85,playerWidth:.5,playerAutoStep:u.autostep?1:0,clearColor:[.8,.9,1],ambientColor:[1,1,1],lightDiffuse:[1,1,1],lightSpecular:[1,1,1],groundLightColor:[.5,.5,.5],useAO:!0,AOmultipliers:[.93,.8,.5],reverseAOmultiplier:1,preserveDrawingBuffer:!0,adaptToDeviceRatio:!1,gravity:[0,-14,0],bindings:{forward:["W"],left:["A"],backward:["S"],right:["D"],fire:"<mouse 1>","mid-fire":["<mouse 2>"],"alt-fire":["<mouse 3>"],jump:"<space>",inventory:["E"],muteMusic:["O"],thirdprsn:["M"],chatenter:["<enter>"],chat:["T"],cmd:["/"],tab:["`"],menu:["<escape>"],screenshot:["P"]}}}const h=["silkscreen","Lato","Lato-Italic","Lato-Black","Lato-BlackItalic","Lato-Bold","Lato-BoldItalic","Lato-Light","Lato-LightItalic","Lato-Thin","Lato-ThinItalic","PixelOperator-Bold","PixelOperator","PixelOperator8-Bold","PixelOperator8","PixelOperatorHB","PixelOperatorHB8","PixelOperatorHBSC","PixelOperatorMono-Bold","PixelOperatorMono","PixelOperatorMono8-Bold","PixelOperatorMono8","PixelOperatorMonoHB","PixelOperatorMonoHB8","PixelOperatorSC-Bold","PixelOperatorSC"];let m=null;function y(e){m=e}let v="???";const g=window.location.hostname;new URLSearchParams(window.location.search);v="0.0.0.0"==g||"localhost"==g?"Localhost/DEV":"voxelsrv-master.pb4.eu"==g?"Development":"voxelsrv.pb4.eu"==g||"pb4.eu"==g||null!=window.electron?"":"Unofficial/Undefined rehost!";const b=v,w=[[{text:"It's not Minecraft clone... or is it?"}],[{text:"Written in Typescript"}],[{text:"Powered by Noa Engine"}],[{text:"Open Source"}],[{text:"Multiplayer supported!"}],[{text:"You can fork it!"}],[{text:"Available on github"}],[{text:"Bottom text"}],[{text:"Pixelated",font:"PixelOperator-Bold"}],[{text:"In development"}],[{text:"404: File not found"}],[{text:":concern:"}],[{text:"ðŸ¥”"}],[{text:"Works in browser"}],[{text:"youtu.be/dQw4w9WgXcQ"}]];function _(){let e=Math.floor(Math.random()*w.length);return w[e]}null!=window.electron&&w.push([{text:"Now with singleplayer"}])},,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"a",(function(){return h}));var r=n(74),o=n(6),i=n(94),s=n(25);let a,c,u=[],l=0,f=!1;function d(e){f=e}function p(){const e=Object(o.d)(1);a=new s.e,a.width=100,a.horizontalAlignment=0,a.verticalAlignment=1,a.zIndex=10,a.height="36px",a.color="white",a.background="#111111aa",a.focusedBackground="#111111bb",a.thickness=0,a.isVisible=!1,a.shadowColor="",a.fontSize="32",a.promptMessage="Enter chat message",e.addControl(a),c=new s.i,r.isMobile?(c.verticalAlignment=0,c.horizontalAlignment=1,c.width=140*o.f+"px"):(c.verticalAlignment=1,c.horizontalAlignment=0,c.top=-26*o.f+"px",c.width=176*o.f+"px"),c.name="textContainer",c.useBitmapCache=!0,c.zIndex=10,c.background="#11111177",c.height=0,e.addControl(c);const t=e=>{r.isMobile?c.width=140*o.f+"px":(c.top=-26*e+"px",c.width=176*e+"px"),u.forEach(t=>{t.fontSize=8*e,t.paddingLeft=2*e+"px",r.isMobile?t.width=140*e+"px":t.width=176*e+"px",t.height=t.computeExpectedHeight()+"px"}),m()};o.b.on("scale-change",t);const n=setInterval(async()=>{if(f){let e=0;u.forEach(t=>{t.shouldhide&&!t.isVisible&&(t.isVisible=!0,e+=1)}),0!=e&&m()}else{let e=0;u.forEach(t=>{t.shouldhide&&t.isVisible&&(t.isVisible=!1),e+=1}),0!=e&&m()}},100);c.onDisposeObservable.add(()=>{clearInterval(n),u.forEach(e=>e.dispose()),u=[],l=0,o.b.off("scale-change",t)})}async function h(e){const t=Object.values(e);let n="";t.forEach(e=>{n+=e.text});const s=new i.a;for(s.fontSize=8*o.f,s.paddingLeft=2*o.f+"px",s.textVerticalAlignment=1,s.textHorizontalAlignment=0,s.fontFamily="Lato",r.isMobile?s.width=140*o.f+"px":s.width=176*o.f+"px",s.zIndex=11,s.text=t,s.height=s.computeExpectedHeight()+"px",s.useBitmapCache=!0,u.unshift(s),c.addControl(s);u.length>50;)u[u.length-1].dispose(),u.pop();setInterval(async()=>{s.shouldhide=!0,f||(s.isVisible=!1),m()},8e3),m(),console.log("Chat: "+n)}function m(){l=0,u.forEach(e=>{!f&&e.isVisible&&l>200*o.f?(e.shouldhide=!0,e.isVisible=!1):e.isVisible&&(l+=e.heightInPixels)}),0!=l?(c.height=l+5+"px",c.isVisible=!0):c.isVisible&&(c.isVisible=!1)}},,,function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}));var r=n(6),o=n(94),i=n(25);function s(){const e=new i.f;e.width=100*r.f+"px",e.height=18*r.f+"px",e.isPointerBlocker=!0,e.horizontalAlignment=2,e.thickness=0,e.paddingBottom="10px",e.zIndex=10;const t=new o.a;return t.text=[{text:"MenuItemText",color:"white",font:"Lato"}],t.fontSize=10*r.f,t.textHorizontalAlignment=2,e.addControl(t),e.onPointerEnterObservable.add(e=>{t.text.forEach(e=>e.underline=!0),t._markAsDirty()}),e.onPointerOutObservable.add(e=>{t.text.forEach(e=>e.underline=!1),t._markAsDirty()}),{item:e,text:t}}function a(){const e=new i.f;e.height=28*r.f+"px",e.adaptWidthToChildren=!0,e.thickness=0;const t=new i.j;t.fontFamily="Lato",t.fontSize=9*r.f,t.textVerticalAlignment=0,t.color="white",t.text="Input",t.top=r.f,t.verticalAlignment=0,e.addControl(t);const n=new i.e;n.thickness=0,n.background="#ffffffaa",n.focusedBackground="#ffffffff",n.placeholderText="Placeholder",n.color="#666666",n.verticalAlignment=0,n.height=15*r.f+"px",n.width=100*r.f+"px",n.top=14*r.f+"px",e.addControl(n);const o=o=>{e.height=28*r.f+"px",t.fontSize=9*r.f,n.height=15*r.f+"px",n.width=100*r.f+"px",n.top=14*r.f+"px"};return r.b.on("scale-change",o),e.onDisposeObservable.add(()=>{r.b.off("scale-change",o)}),{main:e,name:t,input:n}}function c(){const e=new i.f;e.height=28*r.f+"px",e.adaptWidthToChildren=!0,e.thickness=0;const t=new i.j;t.fontFamily="Lato",t.fontSize=9*r.f,t.textVerticalAlignment=0,t.color="white",t.text="Slider",t.top=r.f,t.verticalAlignment=0,e.addControl(t);const n=new i.h;n.minimum=0,n.maximum=100,n.value=0,n.height=13*r.f+"px",n.width=100*r.f+"px",n.top=14*r.f+"px",n.verticalAlignment=0,n.color="#666666",n.thumbColor="#888888",n.background="#ffffffaa",n.borderColor="#00000000",n.barOffset=6,e.addControl(n);const o=o=>{e.height=28*r.f+"px",t.fontSize=9*r.f,n.height=10*r.f+"px",n.width=100*r.f+"px",n.top=14*r.f+"px"};return r.b.on("scale-change",o),e.onDisposeObservable.add(()=>{r.b.off("scale-change",o)}),{main:e,name:t,slider:n}}function u(){const e=new i.f;e.height=12*r.f+"px",e.adaptWidthToChildren=!0,e.isPointerBlocker=!0,e.thickness=0;const t=new i.j;t.fontFamily="Lato",t.fontSize=9*r.f,t.textVerticalAlignment=0,t.color="white",t.text="Checkbox",t.top=r.f,t.verticalAlignment=0,t.width=100*r.f+"px",e.addControl(t);const n=n=>{e.height=28*r.f+"px",t.fontSize=9*r.f,t.width=100*r.f+"px"};return r.b.on("scale-change",n),e.onDisposeObservable.add(()=>{r.b.off("scale-change",n)}),{main:e,name:t,isChecked:!1}}function l(){const e=new i.f;e.height=17*r.f+"px",e.width=64*r.f+"px",e.verticalAlignment=0,e.horizontalAlignment=0,e.thickness=0,e.background="#4d4d4daa",e.color="#666666";const t=new o.a;t.text=[{text:"Text",color:"white",font:"Lato"}],t.textHorizontalAlignment=2,t.fontSize=6*r.f,t.onPointerEnterObservable.add(e=>{t.text.forEach(e=>e.underline=!0),t._markAsDirty()}),t.onPointerOutObservable.add(e=>{t.text.forEach(e=>e.underline=!1),t._markAsDirty()}),e.addControl(t);const n=n=>{e.height=17*r.f+"px",e.width=64*r.f+"px",t.fontSize=6*r.f};return r.b.on("scale-change",n),e.onDisposeObservable.add(()=>{r.b.off("scale-change",n)}),{button:e,buttonText:t}}},,,,,,,,,function(e,t,n){"use strict";n.d(t,"c",(function(){return j})),n.d(t,"b",(function(){return M})),n.d(t,"a",(function(){return D}));var r=n(35),o=n(74),i=n(137),s=n(6),a=n(25);let c,u;var l=n(82),f=n(49),d=n(107),p=n(128);function h(e,t,n,o){Object(l.a)(e,t),function(){Object(s.c)(0);const e=Object(s.e)(0);u=new a.c,u.background="#eeeeee88",u.height=2*s.f+"px",u.width=2*s.f+"px",u.thickness=0;const t=()=>{u.height=2*s.f+"px",u.width=2*s.f+"px"};s.b.on("scale-change",t),u.onDisposeObservable.add(()=>{s.b.off("scale-change",t)}),e.addControl(u)}(),function(e,t){const n=Object(s.e)(0),o=e.playerEntity,i=e.entities.getPositionData(o);let u;c=new a.j,n.addControl(c),c.text="",c.color="#f0f0f0",c.fontSize=8*s.f+"px",c.left="5px",c.top="5px",c.shadowColor="#111111",c.shadowOffsetX=1,c.shadowOffsetY=1,c.textHorizontalAlignment=a.b.HORIZONTAL_ALIGNMENT_LEFT,c.textVerticalAlignment=a.b.VERTICAL_ALIGNMENT_TOP,u=null!=t?`Server: ${t}\n`:"Singleplayer world\n";let l=s.f;const f=async()=>{const t=`${i.position[0].toFixed(1)}, ${i.position[1].toFixed(1)}, ${i.position[2].toFixed(1)}`,n=`VoxelSrv ${r.d}\nNoa: ${e.version}\nXYZ: ${t}\n${u}`;c.text=n,l!=s.f&&(l=s.f,c.fontSize=8*s.f+"px")};e.on("tick",f),c.onDisposeObservable.add(()=>{e.off("tick",f)})}(e,t.server),Object(l.b)(e,t),Object(f.e)(),Object(d.a)(e),Object(p.b)()}function m(){null!=l.d&&l.d.dispose(),null!=l.c&&l.c.dispose(),null!=f.c&&f.c.dispose(),null!=f.d&&f.d.dispose(),null!=p.c&&p.c.dispose(),null!=c&&c.dispose(),null!=u&&u.dispose()}var y=n(115),v=n(52);var g=n(220),b=n(222),w=n(84),_=n(131),x=n(33);const k={};var O=n(173),P=n(78);let C,S=null,T=null,E=null;function j(e,t){null!=S&&S.send(e,t)}function M(){S.close(),A(C),m(),Object(r.j)({ingame:!1}),Object(i.a)(C)}function D(e,t){document.title="VoxelSrv - Connecting to server...",C=e,C.worldName="World"+Math.round(1e3*Math.random()),S=t,console.log("Username: "+r.c.nickname,"Server: "+S.server);let n=!0;null!=i.b&&i.b.dispose();const c={};S.on("PlayerKick",(function(e){S.close(),C.ents.getPhysics(C.playerEntity).body.airDrag=9999,Object.values(c).forEach(e=>{C.ents.deleteEntity(e,!0)}),console.log("You has been kicked from server \nReason: "+e.reason),A(C),m(),function(e,t,n,r){document.title="VoxelSrv - Disconnected!";const o=new a.f;o.thickness=0,o.horizontalAlignment=2,o.zIndex=10,o.height=120*s.f+"px",o.width=180*s.f+"px",o.background="#11111166",Object(s.d)(1).addControl(o);const c=new a.j;c.fontFamily="Lato",c.fontSize=11*s.f,c.textVerticalAlignment=0,c.color="white",c.text="Disconnected!",c.top=s.f,o.addControl(c);const u=new a.j;u.fontFamily="Lato",u.fontSize=9*s.f,u.textVerticalAlignment=2,u.color="white",u.text=e,u.textWrapping=a.k.WordWrap,o.addControl(u);const l=Object(v.d)();l.item.verticalAlignment=1,l.text.text=[{text:"Reconnect",color:"white",font:"Lato"}],l.item.top=`-${16*s.f}px`,l.item.onPointerClickObservable.add(()=>{o.dispose(),n(r,new y.a(t))}),o.addControl(l.item);const f=Object(v.d)();f.item.verticalAlignment=1,f.text.text=[{text:"Main menu",color:"white",font:"Lato"}],f.item.onPointerClickObservable.add(()=>{o.dispose(),Object(i.a)(r)}),o.addControl(f.item);const d=e=>{o.height=120*s.f+"px",o.width=180*s.f+"px",c.fontSize=11*s.f,f.item.width=100*s.f+"px",f.item.height=18*s.f+"px",f.text.fontSize=10*s.f,l.item.width=100*s.f+"px",l.item.height=18*s.f+"px",l.text.fontSize=10*s.f,l.item.top=`-${16*s.f}px`};s.b.on("scale-change",d),o.onDisposeObservable.add(()=>{s.b.off("scale-change",d)})}(e.reason,S.server,D,C),Object(r.j)({ingame:!1})})),S.on("LoginRequest",(function(e){C.worldName="World-"+1e4*Math.random(),C.camera.heading=0,C.camera.pitch=0;e.auth,S.send("LoginResponse",{username:r.c.nickname,protocol:r.b,mobile:o.isMobile,client:"VoxelSrv "+r.d,uuid:r.c.nickname.toLocaleLowerCase(),secret:""});let t="";S.on("PlayerEntity",(function(e){console.log("Ignoring player-entity: "+e.uuid),t=e.uuid,null!=c[e.uuid]&&null!=C&&C.ents.deleteEntity(c[e.uuid]),delete c[e.uuid]})),n&&S.on("LoginSuccess",(function(e){if(Object(r.j)({ingame:!0}),m(),Object(_.b)(),document.title="VoxelSrv - Playing on "+S.server,Object(w.d)(C,JSON.parse(e.blocksDef)),Object(w.e)(C,JSON.parse(e.itemsDef)),Object(g.b)(C,JSON.parse(e.inventory),JSON.parse(e.armor),JSON.parse(e.movement)),O.a.dispose(),Object(O.b)(C),h(C,S),C.ents.setPosition(C.playerEntity,e.xPos,e.yPos,e.zPos),!n)return;n=!1,S.on("WorldChunkLoad",(function(e){Object(_.f)(e)})),S.on("WorldChunkUnload",(function(e){if(e.type)for(let t=0;t<=8;t++)Object(_.e)(`${e.x}|${t}|${e.z}`);else Object(_.e)(`${e.x}|${e.y}|${e.z}`)})),S.on("WorldBlockUpdate",(function(e){C.setBlock(e.id,e.x,e.y,e.z),Object(_.a)(e.id,e.x,e.y,e.z)})),S.on("UpdateGameplaySetting",(function(e){const t={};t[e.key]=e.value,Object(r.j)(t)})),S.on("PlayerInventory",(function(e){const t=JSON.parse(e.inventory);"armor"==e.type?C.ents.getState(C.playerEntity,"inventory").armor=t:"hook"==e.type?C.ents.getState(C.playerEntity,"inventory").hook=t:(C.ents.getState(C.playerEntity,"inventory").items=t.items,C.ents.getState(C.playerEntity,"inventory").tempslot=t.tempslot)})),S.on("PlayerSlotUpdate",(function(e){const t=JSON.parse(e.data),n=C.ents.getState(C.playerEntity,"inventory");"temp"==e.type?n.tempslot=t:"main"==e.type?n.items[e.slot]=t:"armor"==e.type?n.armor.items[e.slot]=t:"crafting"==e.type?n.crafting[e.slot]=t:"hook"==e.type&&(n.hook.items[e.slot]=t)})),S.on("ChatMessage",(function(e){Object(f.a)(e.message)})),S.on("TabUpdate",(function(e){Object(p.a)(e.message)})),S.on("PlayerTeleport",(function(e){C.ents.setPosition(C.playerEntity,e.x,e.y,e.z)})),S.on("PlayerUpdateMovement",(function(e){C.ents.getMovement(C.playerEntity)[e.key]=e.value})),S.on("PlayerUpdatePhysics",(function(e){C.ents.getPhysicsBody(C.playerEntity)[e.key]=e.value})),S.on("PlayerApplyImpulse",(function(e){C.ents.getPhysicsBody(C.playerEntity).applyImpulse([e.x,e.y,e.z])})),S.on("EntityCreate",(async function(e){if(t!=e.uuid){const t=JSON.parse(e.data);c[e.uuid]=C.ents.add(Object.values(t.position),1,2,null,null,!1,!0),Object(b.a)(c[e.uuid],e.uuid,t.model,t.texture,t.offset,t.nametag,t.name,t.hitbox)}})),S.on("EntityRemove",(function(e){null!=c[e.uuid]&&C.ents.deleteEntity(c[e.uuid]),delete c[e.uuid]})),S.on("EntityMove",(function(e){if(null!=c[e.uuid]){var t=[e.x,e.y,e.z];C.ents.getState(c[e.uuid],"position").newPosition=t,C.ents.getState(c[e.uuid],"position").rotation=2*e.rotation,C.ents.getState(c[e.uuid],"position").pitch=2*e.pitch}})),S.on("SoundPlay",(function(e){!function(e,t,n,o){const i=Object.keys(k)[Object.keys(k).length-1]+1;let s,a=t/10;function c(){k[i].play()}0>t?a=0:1<t&&(a=.1),console.log("Playing: "+e,"Volume: "+t,"Position: "+n),s=e.startsWith("http://")||e.startsWith("https://")&&1==r.c.allowcustom?e:"audio/"+e,null!=n?(k[i]=new x.h("Sound",s,o.rendering.getScene(),c,{volume:a,spatialSound:!0,maxDistance:100}),k[i].setPosition(new x.k(n[0],n[1],n[2]))):k[i]=new x.h("Sound",s,o.rendering.getScene(),c,{volume:a}),k[i].onended=function(){delete k[i]}}(e.sound,e.volume,null!=e.x?[e.x,e.y,e.z]:null,C)}));const o=C.ents.getState(C.playerEntity,"position");let i=[],s=0;E=()=>{const e=C.camera.heading,t=C.camera.pitch;JSON.stringify(i)==JSON.stringify(o.position)&&s==e&&0==t||(i=[...o.position],s=e,S.send("ActionMove",{x:o.position[0],y:o.position[1],z:o.position[2],rotation:e,pitch:t}))},C.on("tick",E),T=async function(){Object.values(c).forEach((async function(e){const t=C.ents.getState(e,"position").position,n=C.ents.getState(e,"position").newPosition,r=C.ents.getState(e,C.entities.names.mesh),o=C.ents.getState(e,"model");if(null!=r&&null!=n&&null!=t){let i=P.create();P.lerp(i,t,n,.1);const s=C.ents.getState(e,"position").rotation,a=C.ents.getState(e,"position").pitch;C.ents.setPosition(e,i[0],i[1],i[2]);const c=[n[0],0,n[2]],u=[t[0],0,t[2]];null==o.x&&(o.x=0,o.y=0,o.z=!1);let l=Math.sin(o.x);if(P.dist(c,u)>.05)o.y=P.dist(c,u)/5,o.x=o.x+o.y,Math.abs(l)>.95?o.z=!0:Math.abs(l)<.05&&(o.z=!1);else{const e=parseFloat(l.toFixed(1));0==e||o.z||(o.x=o.x-.05),0!=e&&o.z&&(o.x=o.x+.05)}o.models.left_arm.rotation.x=-l,o.models.right_arm.rotation.x=l,o.models.right_leg.rotation.x=-l,o.models.left_leg.rotation.x=l;const f=r.mesh.rotation.y;r.mesh.rotation.y=s/2-f>5?s/2:(s/2+f)/2,o.models.head.rotation.x=a/2,null!=o.nametag&&(o.nametag.rotation.y=C.camera.heading-r.mesh.rotation.y,o.nametag.rotation.x=C.camera.pitch)}}))},C.on("beforeRender",T);let a=setInterval(()=>{C.world.playerChunkLoaded&&(C.ents.getPhysics(C.playerEntity).body.airDrag=-1,clearInterval(a))},1)}))}))}function A(e){null!=E&&e.off("tick",E),null!=E&&e.off("beforeRender",T)}},,,,,,,,,,,,,function(e,t){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";var r={MOBILE:"mobile",TABLET:"tablet",SMART_TV:"smarttv",CONSOLE:"console",WEARABLE:"wearable",BROWSER:void 0};e.exports={BROWSER_TYPES:{CHROME:"Chrome",FIREFOX:"Firefox",OPERA:"Opera",YANDEX:"Yandex",SAFARI:"Safari",INTERNET_EXPLORER:"Internet Explorer",EDGE:"Edge",CHROMIUM:"Chromium",IE:"IE",MOBILE_SAFARI:"Mobile Safari",EDGE_CHROMIUM:"Edge Chromium"},DEVICE_TYPES:r,OS_TYPES:{IOS:"iOS",ANDROID:"Android",WINDOWS_PHONE:"Windows Phone",WINDOWS:"Windows",MAC_OS:"Mac OS"},defaultData:{isMobile:!1,isTablet:!1,isBrowser:!1,isSmartTV:!1,isConsole:!1,isWearable:!1}}},function(e,t,n){"use strict";var r,o=n(2),i=n(0),s=i.BROWSER_TYPES,a=i.OS_TYPES,c=i.DEVICE_TYPES,u=n(4),l=u.checkType,f=u.broPayload,d=u.mobilePayload,p=u.wearPayload,h=u.consolePayload,m=u.stvPayload,y=u.getNavigatorInstance,v=u.isIOS13Check,g=new o,b=g.getBrowser(),w=g.getDevice(),_=g.getEngine(),x=g.getOS(),k=g.getUA(),O=s.CHROME,P=s.CHROMIUM,C=s.IE,S=s.INTERNET_EXPLORER,T=s.OPERA,E=s.FIREFOX,j=s.SAFARI,M=s.EDGE,D=s.YANDEX,A=s.MOBILE_SAFARI,I=c.MOBILE,R=c.TABLET,B=c.SMART_TV,L=c.BROWSER,z=c.WEARABLE,F=c.CONSOLE,N=a.ANDROID,U=a.WINDOWS_PHONE,V=a.IOS,W=a.WINDOWS,G=a.MAC_OS,q=function(){return x.name===a.WINDOWS&&"10"===x.version&&("string"==typeof k&&-1!==k.indexOf("Edg/"))},K=function(){return b.name===M},Y=function(){return v("iPad")},J=w.type===B,H=w.type===F,X=w.type===z,$=b.name===A||Y(),Z=b.name===P,Q=function(){switch(w.type){case I:case R:return!0;default:return!1}}()||Y(),ee=w.type===I,te=w.type===R||Y(),ne=w.type===L,re=x.name===N,oe=x.name===U,ie=x.name===V||Y(),se=b.name===O,ae=b.name===E,ce=b.name===j||b.name===A,ue=b.name===T,le=b.name===S||b.name===C,fe=x.version?x.version:"none",de=x.name?x.name:"none",pe=b.major,he=b.version,me=b.name,ye=w.vendor?w.vendor:"none",ve=w.model?w.model:"none",ge=_.name,be=_.version,we=k,_e=K()||q(),xe=b.name===D,ke=w.type,Oe=(r=y())&&(/iPad|iPhone|iPod/.test(r.platform)||"MacIntel"===r.platform&&r.maxTouchPoints>1)&&!window.MSStream,Pe=Y(),Ce=v("iPhone"),Se=v("iPod"),Te=function(){var e=y(),t=e&&e.userAgent.toLowerCase();return"string"==typeof t&&/electron/.test(t)}(),Ee=q(),je=K(),Me=x.name===W,De=x.name===G,Ae=l(w.type);e.exports={deviceDetect:function(){var e=Ae.isBrowser,t=Ae.isMobile,n=Ae.isTablet,r=Ae.isSmartTV,o=Ae.isConsole,i=Ae.isWearable;return e?f(e,b,_,x,k):r?m(r,_,x,k):o?h(o,_,x,k):t||n?d(Ae,w,x,k):i?p(i,_,x,k):void 0},isSmartTV:J,isConsole:H,isWearable:X,isMobileSafari:$,isChromium:Z,isMobile:Q,isMobileOnly:ee,isTablet:te,isBrowser:ne,isAndroid:re,isWinPhone:oe,isIOS:ie,isChrome:se,isFirefox:ae,isSafari:ce,isOpera:ue,isIE:le,osVersion:fe,osName:de,fullBrowserVersion:pe,browserVersion:he,browserName:me,mobileVendor:ye,mobileModel:ve,engineName:ge,engineVersion:be,getUA:we,isEdge:_e,isYandex:xe,deviceType:ke,isIOS13:Oe,isIPad13:Pe,isIPhone13:Ce,isIPod13:Se,isElectron:Te,isEdgeChromium:Ee,isLegacyEdge:je,isWindows:Me,isMacOs:De}},function(e,t,n){var r;
/*!
 * UAParser.js v0.7.18
 * Lightweight JavaScript-based User-Agent string parser
 * https://github.com/faisalman/ua-parser-js
 *
 * Copyright Â© 2012-2016 Faisal Salman <fyzlman@gmail.com>
 * Dual licensed under GPLv2 or MIT
 */!function(o,i){"use strict";var s="model",a="name",c="type",u="vendor",l="version",f="mobile",d="tablet",p={extend:function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},h={rgx:function(e,t){for(var n,r,o,i,s,a,c=0;c<t.length&&!s;){var u=t[c],l=t[c+1];for(n=r=0;n<u.length&&!s;)if(s=u[n++].exec(e))for(o=0;o<l.length;o++)a=s[++r],"object"==typeof(i=l[o])&&i.length>0?2==i.length?"function"==typeof i[1]?this[i[0]]=i[1].call(this,a):this[i[0]]=i[1]:3==i.length?"function"!=typeof i[1]||i[1].exec&&i[1].test?this[i[0]]=a?a.replace(i[1],i[2]):void 0:this[i[0]]=a?i[1].call(this,a,i[2]):void 0:4==i.length&&(this[i[0]]=a?i[3].call(this,a.replace(i[1],i[2])):void 0):this[i]=a||void 0;c+=2}},str:function(e,t){for(var n in t)if("object"==typeof t[n]&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(p.has(t[n][r],e))return"?"===n?void 0:n}else if(p.has(t[n],e))return"?"===n?void 0:n;return e}},m={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},y={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[a,l],[/(opios)[\/\s]+([\w\.]+)/i],[[a,"Opera Mini"],l],[/\s(opr)\/([\w\.]+)/i],[[a,"Opera"],l],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark)\/([\w\.-]+)/i],[a,l],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[a,"IE"],l],[/(edge|edgios|edgea)\/((\d+)?[\w\.]+)/i],[[a,"Edge"],l],[/(yabrowser)\/([\w\.]+)/i],[[a,"Yandex"],l],[/(puffin)\/([\w\.]+)/i],[[a,"Puffin"],l],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[a,"UCBrowser"],l],[/(comodo_dragon)\/([\w\.]+)/i],[[a,/_/g," "],l],[/(micromessenger)\/([\w\.]+)/i],[[a,"WeChat"],l],[/(qqbrowserlite)\/([\w\.]+)/i],[a,l],[/(QQ)\/([\d\.]+)/i],[a,l],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[a,l],[/(BIDUBrowser)[\/\s]?([\w\.]+)/i],[a,l],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[a,l],[/(MetaSr)[\/\s]?([\w\.]+)/i],[a],[/(LBBROWSER)/i],[a],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[l,[a,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[l,[a,"Facebook"]],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[l,[a,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[a,/(.+)/,"$1 WebView"],l],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[a,/(.+(?:g|us))(.+)/,"$1 $2"],l],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[l,[a,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[a,l],[/(dolfin)\/([\w\.]+)/i],[[a,"Dolphin"],l],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[a,"Chrome"],l],[/(coast)\/([\w\.]+)/i],[[a,"Opera Coast"],l],[/fxios\/([\w\.-]+)/i],[l,[a,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[l,[a,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[l,a],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[a,"GSA"],l],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[a,[l,h.str,m.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[a,l],[/(navigator|netscape)\/([\w\.-]+)/i],[[a,"Netscape"],l],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[a,l]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",p.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",p.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",p.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[s,u,[c,d]],[/applecoremedia\/[\w\.]+ \((ipad)/],[s,[u,"Apple"],[c,d]],[/(apple\s{0,1}tv)/i],[[s,"Apple TV"],[u,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[u,s,[c,d]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[s,[u,"Amazon"],[c,d]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[s,h.str,m.device.amazon.model],[u,"Amazon"],[c,f]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[s,u,[c,f]],[/\((ip[honed|\s\w*]+);/i],[s,[u,"Apple"],[c,f]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[u,s,[c,f]],[/\(bb10;\s(\w+)/i],[s,[u,"BlackBerry"],[c,f]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[s,[u,"Asus"],[c,d]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[u,"Sony"],[s,"Xperia Tablet"],[c,d]],[/android.+\s([c-g]\d{4}|so[-l]\w+)\sbuild\//i],[s,[u,"Sony"],[c,f]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[u,s,[c,"console"]],[/android.+;\s(shield)\sbuild/i],[s,[u,"Nvidia"],[c,"console"]],[/(playstation\s[34portablevi]+)/i],[s,[u,"Sony"],[c,"console"]],[/(sprint\s(\w+))/i],[[u,h.str,m.device.sprint.vendor],[s,h.str,m.device.sprint.model],[c,f]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[u,s,[c,d]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[u,[s,/_/g," "],[c,f]],[/(nexus\s9)/i],[s,[u,"HTC"],[c,d]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[s,[u,"Huawei"],[c,f]],[/(microsoft);\s(lumia[\s\w]+)/i],[u,s,[c,f]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[s,[u,"Microsoft"],[c,"console"]],[/(kin\.[onetw]{3})/i],[[s,/\./g," "],[u,"Microsoft"],[c,f]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[s,[u,"Motorola"],[c,f]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[s,[u,"Motorola"],[c,d]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[u,p.trim],[s,p.trim],[c,"smarttv"]],[/hbbtv.+maple;(\d+)/i],[[s,/^/,"SmartTV"],[u,"Samsung"],[c,"smarttv"]],[/\(dtv[\);].+(aquos)/i],[s,[u,"Sharp"],[c,"smarttv"]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[u,"Samsung"],s,[c,d]],[/smart-tv.+(samsung)/i],[u,[c,"smarttv"],s],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[u,"Samsung"],s,[c,f]],[/sie-(\w*)/i],[s,[u,"Siemens"],[c,f]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[u,"Nokia"],s,[c,f]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[s,[u,"Acer"],[c,d]],[/android.+([vl]k\-?\d{3})\s+build/i],[s,[u,"LG"],[c,d]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[u,"LG"],s,[c,d]],[/(lg) netcast\.tv/i],[u,s,[c,"smarttv"]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[s,[u,"LG"],[c,f]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[s,[u,"Lenovo"],[c,d]],[/linux;.+((jolla));/i],[u,s,[c,f]],[/((pebble))app\/[\d\.]+\s/i],[u,s,[c,"wearable"]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[u,s,[c,f]],[/crkey/i],[[s,"Chromecast"],[u,"Google"]],[/android.+;\s(glass)\s\d/i],[s,[u,"Google"],[c,"wearable"]],[/android.+;\s(pixel c)\s/i],[s,[u,"Google"],[c,d]],[/android.+;\s(pixel xl|pixel)\s/i],[s,[u,"Google"],[c,f]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[s,/_/g," "],[u,"Xiaomi"],[c,f]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[s,/_/g," "],[u,"Xiaomi"],[c,d]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[s,[u,"Meizu"],[c,d]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})\s+build/i],[s,[u,"OnePlus"],[c,f]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[s,[u,"RCA"],[c,d]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[s,[u,"Dell"],[c,d]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[s,[u,"Verizon"],[c,d]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[u,"Barnes & Noble"],s,[c,d]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[s,[u,"NuVision"],[c,d]],[/android.+;\s(k88)\sbuild/i],[s,[u,"ZTE"],[c,d]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[s,[u,"Swiss"],[c,f]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[s,[u,"Swiss"],[c,d]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[s,[u,"Zeki"],[c,d]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[u,"Dragon Touch"],s,[c,d]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[s,[u,"Insignia"],[c,d]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[s,[u,"NextBook"],[c,d]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[u,"Voice"],s,[c,f]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[u,"LvTel"],s,[c,f]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[s,[u,"Envizen"],[c,d]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[u,s,[c,d]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[s,[u,"MachSpeed"],[c,d]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[u,s,[c,d]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[s,[u,"Rotor"],[c,d]],[/android.+(KS(.+))\s+build/i],[s,[u,"Amazon"],[c,d]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[u,s,[c,d]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[c,p.lowerize],u,s],[/(android[\w\.\s\-]{0,9});.+build/i],[s,[u,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[l,[a,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[a,l],[/rv\:([\w\.]{1,9}).+(gecko)/i],[l,a]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[a,l],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[a,[l,h.str,m.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[a,"Windows"],[l,h.str,m.os.windows.version]],[/\((bb)(10);/i],[[a,"BlackBerry"],l],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]*)/i,/linux;.+(sailfish);/i],[a,l],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[a,"Symbian"],l],[/\((series40);/i],[a],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[a,"Firefox OS"],l],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[a,l],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[a,"Chromium OS"],l],[/(sunos)\s?([\w\.\d]*)/i],[[a,"Solaris"],l],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[a,l],[/(haiku)\s(\w+)/i],[a,l],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[l,/_/g,"."],[a,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[a,"Mac OS"],[l,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]*)/i],[a,l]]},v=function(e,t){if("object"==typeof e&&(t=e,e=void 0),!(this instanceof v))return new v(e,t).getResult();var n=e||(o&&o.navigator&&o.navigator.userAgent?o.navigator.userAgent:""),r=t?p.extend(y,t):y;return this.getBrowser=function(){var e={name:void 0,version:void 0};return h.rgx.call(e,n,r.browser),e.major=p.major(e.version),e},this.getCPU=function(){var e={architecture:void 0};return h.rgx.call(e,n,r.cpu),e},this.getDevice=function(){var e={vendor:void 0,model:void 0,type:void 0};return h.rgx.call(e,n,r.device),e},this.getEngine=function(){var e={name:void 0,version:void 0};return h.rgx.call(e,n,r.engine),e},this.getOS=function(){var e={name:void 0,version:void 0};return h.rgx.call(e,n,r.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=e,this},this};v.VERSION="0.7.18",v.BROWSER={NAME:a,MAJOR:"major",VERSION:l},v.CPU={ARCHITECTURE:"architecture"},v.DEVICE={MODEL:s,VENDOR:u,TYPE:c,CONSOLE:"console",MOBILE:f,SMARTTV:"smarttv",TABLET:d,WEARABLE:"wearable",EMBEDDED:"embedded"},v.ENGINE={NAME:a,VERSION:l},v.OS={NAME:a,VERSION:l},void 0!==t?(void 0!==e&&e.exports&&(t=e.exports=v),t.UAParser=v):n(3)?void 0===(r=function(){return v}.call(t,n,t,e))||(e.exports=r):o&&(o.UAParser=v);var g=o&&(o.jQuery||o.Zepto);if(void 0!==g){var b=new v;g.ua=b.getResult(),g.ua.get=function(){return b.getUA()},g.ua.set=function(e){b.setUA(e);var t=b.getResult();for(var n in t)g.ua[n]=t[n]}}}("object"==typeof window?window:this)},function(e,t){(function(t){e.exports=t}).call(t,{})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(0),i=o.DEVICE_TYPES,s=o.defaultData,a=t.getNavigatorInstance=function(){return!("undefined"==typeof window||!window.navigator&&!navigator)&&(window.navigator||navigator)},c=t.isIOS13Check=function(e){var t=a();return t&&t.platform&&(-1!==t.platform.indexOf(e)||"MacIntel"===t.platform&&t.maxTouchPoints>1&&!window.MSStream)};e.exports={checkType:function(e){switch(e){case i.MOBILE:return{isMobile:!0};case i.TABLET:return{isTablet:!0};case i.SMART_TV:return{isSmartTV:!0};case i.CONSOLE:return{isConsole:!0};case i.WEARABLE:return{isWearable:!0};case i.BROWSER:return{isBrowser:!0};default:return s}},broPayload:function(e,t,n,r,o){return{isBrowser:e,browserMajorVersion:t.major,browserFullVersion:t.version,browserName:t.name,engineName:n.name||!1,engineVersion:n.version,osName:r.name,osVersion:r.version,userAgent:o}},mobilePayload:function(e,t,n,o){return r({},e,{vendor:t.vendor,model:t.model,os:n.name,osVersion:n.version,ua:o})},stvPayload:function(e,t,n,r){return{isSmartTV:e,engineName:t.name,engineVersion:t.version,osName:n.name,osVersion:n.version,userAgent:r}},consolePayload:function(e,t,n,r){return{isConsole:e,engineName:t.name,engineVersion:t.version,osName:n.name,osVersion:n.version,userAgent:r}},wearPayload:function(e,t,n,r){return{isWearable:e,engineName:t.name,engineVersion:t.version,osName:n.name,osVersion:n.version,userAgent:r}},getNavigatorInstance:a,isIOS13Check:c}}])},,,,function(e,t,n){e.exports={EPSILON:n(243),create:n(244),clone:n(282),angle:n(283),fromValues:n(245),copy:n(284),set:n(285),equals:n(286),exactEquals:n(287),add:n(288),subtract:n(248),sub:n(289),multiply:n(249),mul:n(290),divide:n(250),div:n(291),min:n(292),max:n(293),floor:n(294),ceil:n(295),round:n(296),scale:n(297),scaleAndAdd:n(298),distance:n(251),dist:n(299),squaredDistance:n(252),sqrDist:n(300),length:n(253),len:n(301),squaredLength:n(254),sqrLen:n(302),negate:n(303),inverse:n(304),normalize:n(246),dot:n(247),cross:n(305),lerp:n(306),random:n(307),transformMat4:n(308),transformMat3:n(309),transformQuat:n(310),rotateX:n(311),rotateY:n(312),rotateZ:n(313),forEach:n(314)}},,,,function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return f}));var r=n(74),o=n(6),i=n(84),s=n(25);let a,c;function u(e,t){const n=Object(o.d)(1);a=new s.f,a.zIndex=5,a.verticalAlignment=1,a.width=184*o.f+"px",a.height=24*o.f+"px",a.thickness=0,n.addControl(a);const i=new s.d("hotbar","./textures/gui/hotbar.png");i.width=184*o.f+"px",i.height=24*o.f+"px",a.addControl(i);const u=new s.d("hotbar","./textures/gui/selected.png");u.zIndex=8,u.width=24*o.f+"px",u.height=24*o.f+"px",u.left=-19*o.f*4+"px",a.addControl(u);const l=new Array(9);for(let n=0;n<9;n++){l[n]=d(o.f);const r=l[n].container;r.zIndex=9,r.isPointerBlocker=!0,r.left=-20*o.f*4+20*o.f*n+"px",r.onPointerClickObservable.add(r=>{e.ents.getState(e.playerEntity,"inventory").selected=n,t.send("ActionInventoryClick",{slot:n,type:"select"})}),a.addControl(r)}const f=new s.d("hotbar","./textures/gui/inventoryopen.png");r.isMobile&&(f.zIndex=8,f.verticalAlignment=1,f.width=24*o.f+"px",f.height=24*o.f+"px",f.left=19*o.f*6+"px",f.onPointerClickObservable.add(()=>{c.isVisible=!0}),n.addControl(f));const h=async()=>{const t=e.ents.getState(e.playerEntity,"inventory");u.left=-20*o.f*4+20*o.f*t.selected+"px";for(let e=0;e<9;e++)p(l[e],t.items[e])};e.on("tick",h);const m=e=>{a.width=184*e+"px",a.height=24*e+"px",i.width=184*e+"px",i.height=24*e+"px",u.width=24*e+"px",u.height=24*e+"px";for(let e=0;e<9;e++)l[e].container.height=16*o.f+"px",l[e].container.width=16*o.f+"px",l[e].container.left=-20*o.f*4+20*o.f*e+"px",l[e].item.width=16*o.f+"px",l[e].item.height=16*o.f+"px",l[e].count.fontSize=8*o.f+"px",l[e].count.left=2*o.f+"px",l[e].count.top=4*o.f+"px",l[e].count.shadowOffsetX=o.f,l[e].count.shadowOffsetY=o.f;r.isMobile&&(f.width=24*o.f+"px",f.height=24*o.f+"px",f.left=19*o.f*6+"px")};o.b.on("scale-change",m),a.onDisposeObservable.add(()=>{o.b.off("scale-change",m),e.off("tick",h),f.dispose()})}let l=0;function f(e,t){function n(){return e.ents.getState(e.playerEntity,"inventory")}const r=Object(o.d)(1);c=new s.f,c.zIndex=15,c.verticalAlignment=2,c.background="#00000077",c.thickness=0,c.isVisible=!1,r.addControl(c);const a=new s.d("inventory","./textures/gui/container/inventory.png");a.width=180*o.f+"px",a.height=176*o.f+"px",a.zIndex=18,c.addControl(a);const u=new s.f;u.zIndex=20,u.verticalAlignment=2,u.top=67*o.f+"px",u.height=20*o.f+"px",u.width=164*o.f+"px",u.thickness=0,c.addControl(u);const f=new Array(9),h=new Array(36),m=[],y=new Array(5);for(let e=1;e<4;e++){const n=new s.f;n.zIndex=30,n.verticalAlignment=2,n.height=20*o.f+"px",n.width=164*o.f+"px",n.top=9*o.f+18*(e-1)*o.f+"px",n.thickness=0,c.addControl(n),m[e]=n;for(let r=9*e;r<9*e+9;r++){h[r]=d(o.f);const e=h[r].container;e.zIndex=50,e.left=-18*o.f*4+18*o.f*(r%9)+"px",e.onPointerClickObservable.add(e=>{let n="left";switch(e.buttonIndex){case 0:n="left";break;case 1:n="middle";break;case 2:n="right"}t.send("ActionInventoryClick",{slot:r+27*l,type:n,inventory:"main"}),console.log("ActionInventoryClick",{slot:r+27*l,type:n,inventory:"main"})}),e.onPointerEnterObservable.add(t=>{e.background="#ffffff22"}),e.onPointerOutObservable.add(t=>{e.background="#00000000"}),e.isPointerBlocker=!0,n.addControl(e)}}const v=d(o.f);v.container.zIndex=50,v.container.verticalAlignment=0,v.container.horizontalAlignment=0,v.container.isPointerBlocker=!1,v.count.isPointerBlocker=!1,v.item.isPointerBlocker=!1,c.addControl(v.container);for(let e=0;e<9;e++){f[e]=d(o.f);const n=f[e].container;n.zIndex=40,n.left=-18*o.f*4+18*o.f*e+"px",n.onPointerClickObservable.add(n=>{let r="left";switch(n.buttonIndex){case 0:r="left";break;case 1:r="middle";break;case 2:r="right"}t.send("ActionInventoryClick",{slot:e,type:r,inventory:"main"})}),n.onPointerEnterObservable.add(e=>{n.background="#ffffff22"}),n.onPointerOutObservable.add(e=>{n.background="#00000000"}),n.isPointerBlocker=!0,u.addControl(n)}const g=new s.f;g.zIndex=40,g.verticalAlignment=2,g.top=-39*o.f+"px",g.left=-72*o.f+"px",g.height=72*o.f+"px",g.width=18*o.f+"px",g.thickness=0,c.addControl(g);const b=new Array(4);for(let e=0;e<4;e++){b[e]=d(o.f);const n=b[e].container;n.zIndex=50,n.verticalAlignment=0,n.top=18*o.f*e+"px",n.onPointerClickObservable.add(n=>{let r="left";switch(n.buttonIndex){case 0:r="left";break;case 1:r="middle";break;case 2:r="right"}t.send("ActionInventoryClick",{slot:e,type:r,inventory:"armor"})}),n.onPointerEnterObservable.add(e=>{n.background="#ffffff22"}),n.onPointerOutObservable.add(e=>{n.background="#00000000"}),n.isPointerBlocker=!0,g.addControl(n)}const w=new s.f;w.zIndex=40,w.verticalAlignment=2,w.top=-29*o.f+"px",w.left=18*o.f+"px",w.height=72*o.f+"px",w.width=118*o.f+"px",w.thickness=0,c.addControl(w);for(let e=0;e<5;e++){y[e]=d(o.f);const n=y[e].container;n.zIndex=50,n.verticalAlignment=0,4==e?(n.left=48*o.f+"px",n.top=10*o.f+"px"):(e%2==1&&(n.left=18*o.f+"px"),e>1&&(n.top=18*o.f+"px")),n.onPointerClickObservable.add(n=>{let r="left";switch(n.buttonIndex){case 0:r="left";break;case 1:r="middle";break;case 2:r="right"}t.send("ActionInventoryClick",{slot:e,type:r,inventory:"crafting"})}),n.onPointerEnterObservable.add(e=>{n.background="#ffffff22"}),n.onPointerOutObservable.add(e=>{n.background="#00000000"}),n.isPointerBlocker=!0,w.addControl(n)}r.onPointerMoveObservable.add(e=>{v.container.left=e.x+10,v.container.top=e.y+10});const _={};if(n().size>36){const e=new s.f;_.box=e,e.height=15*o.f+"px",e.width=22*o.f+"px",e.zIndex=25,e.thickness=0,e.top=-6*o.f+"px",e.left=71*o.f+"px",c.addControl(e);const t=n(),r=new s.d("button1","./textures/gui/button-right.png");_.button1=r,r.zIndex=25,r.horizontalAlignment=1,r.height=15*o.f+"px",r.width=11*o.f+"px",r.onPointerClickObservable.add(e=>{l+=1,9+27*l>t.size&&(l=0)}),r.isPointerBlocker=!0,e.addControl(r);const i=new s.d("button2","./textures/gui/button-left.png");_.button2=i,i.zIndex=25,i.horizontalAlignment=0,i.height=15*o.f+"px",i.width=11*o.f+"px",i.onPointerClickObservable.add(e=>{l-=1,l<0&&(l=Math.round(27/((t.size-9)/27)/3-1))}),i.isPointerBlocker=!0,e.addControl(i)}const x=async()=>{if(0==c.isVisible)return;const e=n();if(null!=e.tempslot&&null!=e.tempslot.id){v.item.alpha=1,v.count.alpha=1;const t=i.c[e.tempslot.id];let n;n=null==t?"./textures/error.png":t.texture.startsWith("https://")&&t.texture.startsWith("http://")?t.texture:"./textures/"+t.texture+".png",v.item.source=n,1==e.tempslot.count?v.count.text="":e.tempslot.count<=10?v.count.text=" "+e.tempslot.count.toString():v.count.text=e.tempslot.count.toString()}else v.item.alpha=0,v.count.alpha=0,v.item.source="",v.count.text="";for(let t=0;t<9;t++)p(f[t],e.items[t]);for(let t=9;t<36;t++)p(h[t],e.items[27*l+t]);for(let t=0;t<4;t++){if(0==p(b[t],e.armor.items[t])){let e;switch(b[t].count.alpha=0,t){case 0:e="./textures/item/empty_armor_slot_helmet.png";break;case 1:e="./textures/item/empty_armor_slot_chestplate.png";break;case 2:e="./textures/item/empty_armor_slot_leggings.png";break;case 3:e="./textures/item/empty_armor_slot_boots.png"}b[t].item.source=e,b[t].count.text=""}}for(let t=0;t<5;t++)p(y[t],e.crafting[t])};e.on("tick",x);const k=e=>{a.width=180*e+"px",a.height=176*e+"px",u.top=67*e+"px",u.height=20*e+"px",u.width=164*e+"px",g.top=-39*e+"px",g.left=-72*e+"px",g.height=72*e+"px",g.width=18*e+"px",null!=_.box&&(_.box.height=15*e+"px",_.box.width=22*e+"px",_.box.top=-6*e+"px",_.box.left=71*e+"px",_.button1.height=15*e+"px",_.button1.width=11*e+"px",_.button2.height=15*e+"px",_.button2.width=11*e+"px"),v.container.height=16*e+"px",v.container.width=16*e+"px",v.item.width=16*e+"px",v.item.height=16*e+"px",v.count.fontSize=8*e+"px",v.count.left=2*e+"px",v.count.top=4*e+"px",v.count.shadowOffsetX=e,v.count.shadowOffsetY=e;for(let t=0;t<f.length;t++)f[t].container.height=16*e+"px",f[t].container.width=16*e+"px",f[t].container.left=-18*e*4+18*e*(t%9)+"px",f[t].item.width=16*e+"px",f[t].item.height=16*e+"px",f[t].count.fontSize=8*e+"px",f[t].count.left=2*e+"px",f[t].count.top=4*e+"px",f[t].count.shadowOffsetX=e,f[t].count.shadowOffsetY=e;for(let t=0;t<b.length;t++)b[t].container.height=16*e+"px",b[t].container.width=16*e+"px",b[t].item.width=16*e+"px",b[t].item.height=16*e+"px",b[t].count.fontSize=8*e+"px",b[t].count.left=2*e+"px",b[t].count.top=4*e+"px",b[t].count.shadowOffsetX=e,b[t].count.shadowOffsetY=e;for(let t=1;t<4;t++){m[t].height=20*e+"px",m[t].width=164*e+"px",m[t].top=9*e+18*(t-1)*e+"px";for(let n=9*t;n<9*t+9;n++)h[n].container.left=-18*e*4+18*e*(n%9)+"px",h[n].container.height=16*e+"px",h[n].container.width=16*e+"px",h[n].item.width=16*e+"px",h[n].item.height=16*e+"px",h[n].count.fontSize=8*e+"px",h[n].count.left=2*e+"px",h[n].count.top=4*e+"px",h[n].count.shadowOffsetX=e,h[n].count.shadowOffsetY=e}w.top=-29*e+"px",w.left=18*e+"px",w.height=72*e+"px",w.width=118*e+"px";for(let t=0;t<5;t++)4==t?(y[t].container.left=48*e+"px",y[t].container.top=10*e+"px"):(t%2==1&&(y[t].container.left=18*e+"px"),t>1&&(y[t].container.top=18*e+"px")),y[t].container.height=16*e+"px",y[t].container.width=16*e+"px",y[t].item.width=16*e+"px",y[t].item.height=16*e+"px",y[t].count.fontSize=8*e+"px",y[t].count.left=2*e+"px",y[t].count.top=4*e+"px",y[t].count.shadowOffsetX=e,y[t].count.shadowOffsetY=e};o.b.on("scale-change",k),c.onDisposeObservable.add(()=>{o.b.off("scake-change",k),e.off("tick",x)})}function d(e){const t={item:new s.d("hotbar",""),container:new s.f,count:new s.j},n=t.container;n.zIndex=20,n.height=16*e+"px",n.width=16*e+"px",n.thickness=0;const r=t.item;r.width=16*e+"px",r.height=16*e+"px",n.addControl(r);const o=t.count;return o.text="",o.fontFamily="silkscreen",o.color="#f0f0f0",o.fontSize=8*e+"px",o.left=2*e+"px",o.top=4*e+"px",o.shadowColor="#111111",o.shadowOffsetX=e,o.shadowOffsetY=e,n.addControl(o),t}function p(e,t){if(null!=t&&null!=t.id){e.item.alpha=1,e.count.alpha=1;const n=i.c[t.id];let r;return r=null==n?"./textures/error.png":n.texture.startsWith("https://")&&n.texture.startsWith("http://")?n.texture:"./textures/"+n.texture+".png",e.item.source=r,1==t.count?e.count.text="":t.count<=10?e.count.text=" "+t.count.toString():e.count.text=t.count.toString(),!0}return e.item.alpha=0,e.count.alpha=0,e.item.source="",e.count.text="",!1}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return l}));var r=n(35),o=n(33);let i={},s={},a={},c={};function u(e,t){const n=e.rendering.getScene();i=t;Object.values(t).forEach(e=>{a[e.id]=e.rawid,c[e.rawid]=e.id}),e.registry.registerMaterial("water",[.5,.5,.8,.7],null,!0),e.registry.registerMaterial("barrier",[0,0,0,0],null,!0),console.log("Blocks: ",a);Object.values(t).forEach((function(t){!function(t,i,s,a,c,u,l,f){if(0==s){let n,o=0==c.opaque,s=null!=c.color?Object.values(c.color):[0,0,0];if(null==a&&(a=[""]),1==a.length&&null==c.material)(a[0].startsWith("http://")||a[0].startsWith("https://"))&&1==r.c.allowcustom?e.registry.registerMaterial(i,s,a[0],o):e.registry.registerMaterial(i,s,""!=a[0]?"textures/"+a[0]+".png":null,o),n=i;else if(null==c.material){n=new Array;for(let t=0;t<a.length;t++)(a[t].startsWith("http://")||a[t].startsWith("https://"))&&1==r.c.allowcustom?e.registry.registerMaterial(i+t,s,a[t],o):e.registry.registerMaterial(i+t,s,""!=a[t]?"textures/"+a[t]+".png":null,o),n.push(i+t)}else n=c.material;const u=c;u.material=n,e.registry.registerBlock(t,u)}else if(1==s){const s=function(e,t,n,i){const s=i||"sprite-mat";let a;a=(n.startsWith("http://")||n.startsWith("https://"))&&1==r.c.allowcustom?new o.j(n,t,!0,!0,o.j.NEAREST_SAMPLINGMODE):new o.j("textures/"+n+".png",t,!0,!0,o.j.NEAREST_SAMPLINGMODE);a.hasAlpha=!0;const c=o.e.CreatePlane("sprite-"+s,1,t),u=e.rendering.makeStandardMaterial(s);u.backFaceCulling=!1,u.diffuseTexture=a,u.diffuseTexture.vOffset=.99,c.material=u,c.rotation.y+=.81;const l=o.d.Translation(0,.5,0);c.bakeTransformIntoVertices(l);const f=c.clone();return f.rotation.y+=1.62,o.e.MergeMeshes([c,f],!0)}(e,n,a[0],i),u=c;u.blockMesh=s,e.registry.registerBlock(t,u)}else if(2==s){const s=function(e,t,n,i){const s={},a={};for(let c=0;c<6;c++){let u,l=i+"-"+c||"sprite-mat";switch(s[c]=o.e.CreatePlane("sprite-"+l,1,t),a[c]=e.rendering.makeStandardMaterial(l+c),a[c].backFaceCulling=!1,((c<4?n[1]:n[0]).startsWith("http://")||(c<4?n[1]:n[0]).startsWith("https://"))&&1==r.c.allowcustom?a[c].diffuseTexture=new o.j(c<4?n[1]:n[0],t,!0,!0,o.j.NEAREST_SAMPLINGMODE):a[c].diffuseTexture=new o.j("textures/"+(c<4?n[1]:n[0])+".png",t,!0,!0,o.j.NEAREST_SAMPLINGMODE),a[c].diffuseTexture.hasAlpha=!0,s[c].material=a[c],c){case 0:u=o.d.Translation(0,.5,.435),s[c].rotation.y=1.57;break;case 1:u=o.d.Translation(0,.5,-.435),s[c].rotation.y=1.57;break;case 2:u=o.d.Translation(0,.5,.435);break;case 3:u=o.d.Translation(0,.5,-.435);break;case 4:u=o.d.Translation(0,0,-1),s[c].rotation.x=1.57;break;case 5:u=o.d.Translation(0,0,0),s[c].rotation.x=1.57}s[c].bakeTransformIntoVertices(u)}return o.e.MergeMeshes(Object.values(s),!0,!0,void 0,!1,!1)}(e,n,[a[0],a[1]],i),u=c;u.blockMesh=s,e.registry.registerBlock(t,u)}else if(4==s){const s=e.rendering.makeStandardMaterial(i);let u;u=(a[0].startsWith("http://")||a[0].startsWith("https://"))&&1==r.c.allowcustom?new o.j(a[0],n,!0,!0,o.j.NEAREST_SAMPLINGMODE):new o.j("textures/"+a[0]+".png",n,!0,!0,o.j.NEAREST_SAMPLINGMODE),s.diffuseTexture=u,s.opacityTexture=s.diffuseTexture,s.backFaceCulling=!0;const l=o.f.CreateBox(i,{size:1},e.rendering.getScene());l.material=s,l.bakeTransformIntoVertices(o.d.Scaling(1,1,1).setTranslation(new o.k(0,.5,0))),l.opaque=!1,l.material.needDepthPrePass=!0;const f=c;f.blockMesh=l,e.registry.registerBlock(t,f)}}(t.rawid,t.id,t.type,t.texture,t.options,t.hardness,t.miningtime,t.tool)}))}function l(e,t){s=t,console.log("Items: ",t)}},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(4),o=n(37),i=n(21);class s extends i.a{constructor(e,t=[]){super(e),this.name=e,this._text=[],this._textHorizontalAlignment=i.a.HORIZONTAL_ALIGNMENT_CENTER,this._textVerticalAlignment=i.a.VERTICAL_ALIGNMENT_CENTER,this._resizeToFit=!1,this._lineSpacing=new o.a(0),this._outlineColor="white",this.shouldhide=!1,this.onTextChangedObservable=new r.c,this.onLinesReadyObservable=new r.c,this.text=t}get lines(){return this._lines}get resizeToFit(){return this._resizeToFit}set resizeToFit(e){this._resizeToFit!==e&&(this._resizeToFit=e,this._resizeToFit&&(this._width.ignoreAdaptiveScaling=!0,this._height.ignoreAdaptiveScaling=!0),this._markAsDirty())}get text(){return this._text}set text(e){this._text!==e&&(this._text=e,this._markAsDirty(),this.onTextChangedObservable.notifyObservers(this))}get textHorizontalAlignment(){return this._textHorizontalAlignment}set textHorizontalAlignment(e){this._textHorizontalAlignment!==e&&(this._textHorizontalAlignment=e,this._markAsDirty())}get textVerticalAlignment(){return this._textVerticalAlignment}set textVerticalAlignment(e){this._textVerticalAlignment!==e&&(this._textVerticalAlignment=e,this._markAsDirty())}set lineSpacing(e){this._lineSpacing.fromString(e)&&this._markAsDirty()}get lineSpacing(){return this._lineSpacing.toString(this._host)}_getTypeName(){return"FormTextBlock"}_processMeasures(e,t){this._fontOffset||(this._fontOffset=i.a._GetFontOffset(t.font)),super._processMeasures(e,t),this._lines=this._breakLines(this._currentMeasure.width,t),this.onLinesReadyObservable.notifyObservers(this);let n=0;for(let e=0;e<this._lines.length;e++){const t=this._lines[e];t.width>n&&(n=t.width)}if(this._resizeToFit){let e=this.paddingTopInPixels+this.paddingBottomInPixels+this._fontOffset.height*this._lines.length|0;if(this._lines.length>0&&0!==this._lineSpacing.internalValue){let t=0;t=this._lineSpacing.isPixel?this._lineSpacing.getValue(this._host):this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height),e+=(this._lines.length-1)*t}e!==this._height.internalValue&&(this._height.updateInPlace(e,o.a.UNITMODE_PIXEL),this._rebuildLayout=!0)}}_drawText(e,t,n,r){var o=this._currentMeasure.width,s=0;switch(this._textHorizontalAlignment){case i.a.HORIZONTAL_ALIGNMENT_LEFT:s=0;break;case i.a.HORIZONTAL_ALIGNMENT_RIGHT:s=o-t;break;case i.a.HORIZONTAL_ALIGNMENT_CENTER:s=(o-t)/2}if((this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(r.shadowColor=this.shadowColor,r.shadowBlur=this.shadowBlur,r.shadowOffsetX=this.shadowOffsetX,r.shadowOffsetY=this.shadowOffsetY),null==e)return;const a=r.fillStyle,c=r.font,u=r.strokeStyle,l=r.lineWidth;e.forEach(e=>{if(null==e.text)return;null==e.font&&(e.font=c),r.font=`${this.fontSize} ${e.font}`,r.fillStyle=e.color||a;const t=r.measureText(e.text);r.lineWidth=Math.round(.05*this.fontSizeInPixels),r.lineCap="square",r.strokeStyle=r.fillStyle,e.underline&&(r.beginPath(),r.moveTo(this._currentMeasure.left+s,n+3),r.lineTo(this._currentMeasure.left+s+t.width,n+3),r.stroke(),r.closePath()),r.fillText(e.text,this._currentMeasure.left+s,n),e.linethrough&&(r.beginPath(),r.moveTo(this._currentMeasure.left+s,n-this.fontSizeInPixels/3),r.lineTo(this._currentMeasure.left+s+t.width,n-this.fontSizeInPixels/3),r.stroke(),r.closePath()),r.font=c,r.strokeStyle=u,r.lineWidth=l,s+=t.width}),r.fillStyle=a,r.font=c,r.strokeStyle=u,r.lineWidth=l}_draw(e,t){e.save(),this._applyStates(e),this._renderLines(e),e.restore()}_applyStates(e){super._applyStates(e)}_breakLines(e,t){var n=[];let r=[[]];for(var o of(this.text.forEach(e=>{let t=e.text.split("\n");if(t.length>1){r[r.length-1].push({text:t[0],color:e.color,font:e.font,underline:e.underline,linethrough:e.linethrough});for(let n=1;n<t.length;n++)r.push([{text:t[n],color:e.color,font:e.font,underline:e.underline,linethrough:e.linethrough}])}else r[r.length-1].push(e)}),r))n.push(...this._parseLineWordWrap(o,e,t));return n}_parseLine(e="",t){return{text:e,width:t.measureText(e).width}}_parseLineWordWrap(e=[],t,n){var r=[],o=[],i="";let s=this.fontFamily;e.forEach(e=>{null==e.font&&(e.font=s),e.text.split(" ").forEach(r=>{if(0==r.length)return;n.font=`${this.fontSize} ${e.font}`;let i=n.measureText(r);if(n.font=s,i.width<t)o.push({text:r+" ",font:e.font,color:e.color});else{const a=r.substring(0,Math.ceil(r.length/2)),c=r.substring(Math.floor(r.length/2));n.font=`${this.fontSize} ${e.font}`,i=n.measureText(a);let u=n.measureText(c);n.font=s,i.width<t?o.push({text:a+" ",font:e.font,color:e.color}):o.push({text:" [...] ",font:e.font,color:e.color}),u.width<t?o.push({text:c+" ",font:e.font,color:e.color}):o.push({text:" [...] ",font:e.font,color:e.color,underline:e.underline,linethrough:e.linethrough})}}),i+=e.text});n.font=`${this.fontSize} ${e[0].font}`;let a=n.measureText(i);if(n.font=s,a.width<t)return[{text:e,width:a.width}];let c="",u=0,l=[];for(var f=0;f<o.length;f++){let e=0==f?o[0].text:c+o[f].text;n.font=`${this.fontSize} ${o[f].font}`;let i=n.measureText(e);if(n.font=s,i.width>t){r.push({text:[...l],width:u}),l=[],e="",u=0;for(let e=0;e<f;e++)o.shift();f=-1}else c=e,u=i.width,l.push(o[f])}return r.push({text:[...l],width:u}),r}_renderLines(e){var t=this._currentMeasure.height,n=0;switch(this._textVerticalAlignment){case i.a.VERTICAL_ALIGNMENT_TOP:n=this._fontOffset.ascent;break;case i.a.VERTICAL_ALIGNMENT_BOTTOM:n=t-this._fontOffset.height*(this._lines.length-1)-this._fontOffset.descent;break;case i.a.VERTICAL_ALIGNMENT_CENTER:n=this._fontOffset.ascent+(t-this._fontOffset.height*this._lines.length)/2}n+=this._currentMeasure.top;for(let t=0;t<this._lines.length;t++){const r=this._lines[t];0!==t&&0!==this._lineSpacing.internalValue&&(this._lineSpacing.isPixel?n+=this._lineSpacing.getValue(this._host):n+=this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height)),this._drawText(r.text,r.width,n,e),n+=this._fontOffset.height}}computeExpectedHeight(){if(this.text&&this.widthInPixels){const e=document.createElement("canvas").getContext("2d");if(e){this._applyStates(e),this._fontOffset||(this._fontOffset=i.a._GetFontOffset(e.font));const t=this._lines?this._lines:this._breakLines(this.widthInPixels-this.paddingLeftInPixels-this.paddingRightInPixels,e);let n=this.paddingTopInPixels+this.paddingBottomInPixels+this._fontOffset.height*t.length;if(t.length>0&&0!==this._lineSpacing.internalValue){let e=0;e=this._lineSpacing.isPixel?this._lineSpacing.getValue(this._host):this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height),n+=(t.length-1)*e}return n}}return 0}dispose(){super.dispose(),this.onTextChangedObservable.clear()}}},function(e,t,n){var r=n(255),o=n(315),i="undefined"!=typeof Float64Array;function s(e,t){return e[0]-t[0]}function a(){var e,t=this.stride,n=new Array(t.length);for(e=0;e<n.length;++e)n[e]=[Math.abs(t[e]),e];n.sort(s);var r=new Array(n.length);for(e=0;e<r.length;++e)r[e]=n[e][1];return r}function c(e,t){var n=["View",t,"d",e].join("");t<0&&(n="View_Nil"+e);var o="generic"===e;if(-1===t){var i="function "+n+"(a){this.data=a;};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+n+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+n+"(a){return new "+n+"(a);}";return new Function(i)()}if(0===t){i="function "+n+"(a,d) {this.data = a;this.offset = d};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+n+"_copy() {return new "+n+"(this.data,this.offset)};proto.pick=function "+n+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+n+"_get(){return "+(o?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+n+"_set(v){return "+(o?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}";return new Function("TrivialArray",i)(u[e][0])}i=["'use strict'"];var s=r(t),c=s.map((function(e){return"i"+e})),l="this.offset+"+s.map((function(e){return"this.stride["+e+"]*i"+e})).join("+"),f=s.map((function(e){return"b"+e})).join(","),d=s.map((function(e){return"c"+e})).join(",");i.push("function "+n+"(a,"+f+","+d+",d){this.data=a","this.shape=["+f+"]","this.stride=["+d+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+e+"'","proto.dimension="+t),i.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){return "+s.map((function(e){return"this.shape["+e+"]"})).join("*"),"}})"),1===t?i.push("proto.order=[0]"):(i.push("Object.defineProperty(proto,'order',{get:"),t<4?(i.push("function "+n+"_order(){"),2===t?i.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===t&&i.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):i.push("ORDER})")),i.push("proto.set=function "+n+"_set("+c.join(",")+",v){"),o?i.push("return this.data.set("+l+",v)}"):i.push("return this.data["+l+"]=v}"),i.push("proto.get=function "+n+"_get("+c.join(",")+"){"),o?i.push("return this.data.get("+l+")}"):i.push("return this.data["+l+"]}"),i.push("proto.index=function "+n+"_index(",c.join(),"){return "+l+"}"),i.push("proto.hi=function "+n+"_hi("+c.join(",")+"){return new "+n+"(this.data,"+s.map((function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")})).join(",")+","+s.map((function(e){return"this.stride["+e+"]"})).join(",")+",this.offset)}");var p=s.map((function(e){return"a"+e+"=this.shape["+e+"]"})),h=s.map((function(e){return"c"+e+"=this.stride["+e+"]"}));i.push("proto.lo=function "+n+"_lo("+c.join(",")+"){var b=this.offset,d=0,"+p.join(",")+","+h.join(","));for(var m=0;m<t;++m)i.push("if(typeof i"+m+"==='number'&&i"+m+">=0){d=i"+m+"|0;b+=c"+m+"*d;a"+m+"-=d}");i.push("return new "+n+"(this.data,"+s.map((function(e){return"a"+e})).join(",")+","+s.map((function(e){return"c"+e})).join(",")+",b)}"),i.push("proto.step=function "+n+"_step("+c.join(",")+"){var "+s.map((function(e){return"a"+e+"=this.shape["+e+"]"})).join(",")+","+s.map((function(e){return"b"+e+"=this.stride["+e+"]"})).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(m=0;m<t;++m)i.push("if(typeof i"+m+"==='number'){d=i"+m+"|0;if(d<0){c+=b"+m+"*(a"+m+"-1);a"+m+"=ceil(-a"+m+"/d)}else{a"+m+"=ceil(a"+m+"/d)}b"+m+"*=d}");i.push("return new "+n+"(this.data,"+s.map((function(e){return"a"+e})).join(",")+","+s.map((function(e){return"b"+e})).join(",")+",c)}");var y=new Array(t),v=new Array(t);for(m=0;m<t;++m)y[m]="a[i"+m+"]",v[m]="b[i"+m+"]";i.push("proto.transpose=function "+n+"_transpose("+c+"){"+c.map((function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"})).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+y.join(",")+","+v.join(",")+",this.offset)}"),i.push("proto.pick=function "+n+"_pick("+c+"){var a=[],b=[],c=this.offset");for(m=0;m<t;++m)i.push("if(typeof i"+m+"==='number'&&i"+m+">=0){c=(c+this.stride["+m+"]*i"+m+")|0}else{a.push(this.shape["+m+"]);b.push(this.stride["+m+"])}");return i.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),i.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+s.map((function(e){return"shape["+e+"]"})).join(",")+","+s.map((function(e){return"stride["+e+"]"})).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",i.join("\n"))(u[e],a)}var u={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};e.exports=function(e,t,n,r){if(void 0===e)return(0,u.array[0])([]);"number"==typeof e&&(e=[e]),void 0===t&&(t=[e.length]);var s=t.length;if(void 0===n){n=new Array(s);for(var a=s-1,l=1;a>=0;--a)n[a]=l,l*=t[a]}if(void 0===r){r=0;for(a=0;a<s;++a)n[a]<0&&(r-=(t[a]-1)*n[a])}for(var f=function(e){if(o(e))return"buffer";if(i)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(e)?"array":"generic"}(e),d=u[f];d.length<=s+1;)d.push(c(f,d.length-1));return(0,d[s+1])(e,t,n,r)}},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(6),o=n(25),i=n(61),s=n(52),a=n(221);let c;function u(e){const t=Object(r.d)(1);let n,u;c=new o.f,c.zIndex=20,c.verticalAlignment=2,c.background="#00000077",c.thickness=0,c.isVisible=!1,t.addControl(c);const l=new o.f;l.thickness=0,l.horizontalAlignment=2,l.zIndex=10,l.height=200*r.f+"px",l.width=160*r.f+"px",l.background="#11111166",c.addControl(l);const f=new o.j;function d(t){switch(t){case"settings":n=Object(a.a)(e,d),u="settings",c.addControl(n);break;default:n.dispose(),n=null,l.isVisible=!0,u="main"}}f.fontFamily="Lato",f.fontSize=11*r.f,f.textVerticalAlignment=0,f.color="white",f.text="Pause",f.top=r.f,l.addControl(f);const p=new o.i;l.addControl(p);const h=Object(s.d)();h.item.verticalAlignment=1,h.text.text=[{text:"Back to game",color:"white",font:"Lato"}],h.item.onPointerClickObservable.add(()=>{c.isVisible=!1,e.container.canvas.requestPointerLock()}),p.addControl(h.item);const m=Object(s.d)();m.item.verticalAlignment=1,m.text.text=[{text:"Settings",color:"white",font:"Lato"}],m.item.onPointerClickObservable.add(()=>{l.isVisible=!1,d("settings")}),p.addControl(m.item);const y=Object(s.d)();y.text.text=[{text:"Discord",color:"white",font:"Lato"}],y.item.onPointerClickObservable.add(e=>{window.open("https://discord.com/invite/K9PdsDh","_blank")}),p.addControl(y.item);const v=Object(s.d)();v.item.verticalAlignment=1,v.text.text=[{text:"Disconnect",color:"white",font:"Lato"}],v.item.onPointerClickObservable.add(()=>{c.dispose(),Object(i.b)()}),p.addControl(v.item);const g=e=>{l.height=200*r.f+"px",l.width=160*r.f+"px",f.fontSize=11*r.f,p._children.forEach(e=>{e.width=100*r.f+"px",e.height=18*r.f+"px",e._children[0].fontSize=10*r.f})};return r.b.on("scale-change",g),l.onDisposeObservable.add(()=>{r.b.off("scale-change",g)}),l}},,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return h}));var r=n(237),o=n(238),i=n(239),s=n(240);let a={},c={};function u(e,t){let n,a="";if("server"==e){if(a=s[t[0]],null==a)return null;n=o[a]}else{if(a=i[t[0]],null==a)return null;n=r[a],e="client"}const c=t.slice(1),u=n.decode(c);let l=null;return l=null!=n?n.verify(u):"Invalid packet",l?(console.error("Invalid "+e+" packet! Type: "+a,l),null):{data:n.toObject(u),type:a}}i.forEach((e,t)=>c[e]=t),s.forEach((e,t)=>a[e]=t);var l=n(271),f=n.n(l);class d{constructor(){this.listeners={}}send(e,t){const n=function(e,t,n){let i,s=0;if("server"==e){if(s=a[t],null==s)return null;i=o[t]}else{if(s=c[t],null==s)return null;i=r[t],e="client"}let u=null;if(u=null!=i?i.verify(n):"Invalid packet",u)return console.error("Invalid "+e+" packet! Type: "+t,n,u),null;const l=i.create(n),f=i.encode(l).finish(),d=new Uint8Array(1+f.length);return d.set([s]),d.set(f,1),d.buffer}("client",e,t);null!=n&&this.socket.send(n)}close(){this.listeners={}}emit(e,t){null!=this.listeners[e]&&this.listeners[e].forEach(e=>{e(t)})}on(e,t){null!=this.listeners[e]||(this.listeners[e]=new Array),this.listeners[e].push(t)}}class p extends d{constructor(e){super(),this.server=e,this.socket=new WebSocket(e),this.socket.binaryType="arraybuffer",this.socket.onopen=()=>{setTimeout(()=>this.emit("connection",{}),500)},this.socket.onerror=()=>{setTimeout(()=>this.emit("PlayerKick",{reason:"Can't connect to "+e}),500)},this.socket.onclose=()=>{setTimeout(()=>this.emit("PlayerKick",{reason:"Connection closed!"}),500)},this.socket.onmessage=e=>{const t=u("server",new Uint8Array(e.data));null!=t&&this.emit(t.type,t.data)}}close(){this.listeners={},this.socket.close()}}class h extends d{constructor(e){super(),this.server=e,this.peer=new f.a,this.socket=this.peer.connect(e),console.log("Your peer id: "+this.peer.id),this.socket.on("open",()=>setTimeout(()=>this.emit("connection",{}),500)),this.socket.on("close",()=>setTimeout(()=>this.emit("PlayerKick",{reason:"Connection closed!"}),500)),this.socket.on("error",()=>setTimeout(()=>this.emit("PlayerKick",{reason:"Can't connect to peer"}),500)),this.socket.on("data",e=>{const t=u("server",new Uint8Array(e.data));null!=t&&this.emit(t.type,t.data)})}close(){this.listeners={},this.socket.close()}}},,,,function(e,t,n){"use strict";var r,o="object"==typeof Reflect?Reflect:null,i=o&&"function"==typeof o.apply?o.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=o&&"function"==typeof o.ownKeys?o.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(n,r){function o(){void 0!==i&&e.removeListener("error",i),n([].slice.call(arguments))}var i;"error"!==t&&(i=function(n){e.removeListener(t,o),r(n)},e.once("error",i)),e.once(t,o)}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var c=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function f(e,t,n,r){var o,i,s,a;if(u(n),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),s=i[t]),void 0===s)s=i[t]=n,++e._eventsCount;else if("function"==typeof s?s=i[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(o=l(e))>0&&s.length>o&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,a=c,console&&console.warn&&console.warn(a)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=d.bind(r);return o.listener=n,r.wrapFn=o,o}function h(e,t,n){var r=e._events;if(void 0===r)return[];var o=r[t];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(o):y(o,o.length)}function m(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function y(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)i(c,this,t);else{var u=c.length,l=y(c,u);for(n=0;n<u;++n)i(l[n],this,t)}return!0},a.prototype.addListener=function(e,t){return f(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return f(this,e,t,!0)},a.prototype.once=function(e,t){return u(t),this.on(e,p(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,p(this,e,t)),this},a.prototype.removeListener=function(e,t){var n,r,o,i,s;if(u(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){s=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,o),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var o,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},a.prototype.listeners=function(e){return h(this,e,!0)},a.prototype.rawListeners=function(e){return h(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},a.prototype.listenerCount=m,a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},,,,,,,,,function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}));var r=n(6),o=n(94),i=n(25);let s,a=[],c=0;function u(){const e=Object(r.d)(1);s=new i.i,s.verticalAlignment=2,s.horizontalAlignment=2,s.width=180*r.f+"px",s.name="textContainer",s.useBitmapCache=!0,s.zIndex=100,s.background="#11111155",e.addControl(s);const t=e=>{s.width=180*r.f+"px",a.forEach(t=>{t.fontSize=8*e,t.paddingLeft=2*e+"px",t.width=176*e+"px",t.height=t.computeExpectedHeight()+"px"}),f(),s.isVisible=!1};r.b.on("scale-change",t),s.onDisposeObservable.add(()=>{a.forEach(e=>e.dispose()),a=[],c=0,r.b.off("scale-change",t)}),s.isVisible=!1}async function l(e){a.forEach(e=>e.dispose()),a=[];const t=Object.values(e);let n="";t.forEach(e=>{n+=e.text});const i=new o.a;i.fontSize=8*r.f,i.paddingLeft=2*r.f+"px",i.textVerticalAlignment=1,i.textHorizontalAlignment=2,i.fontFamily="Lato",i.width=176*r.f+"px",i.text=t,i.height=i.computeExpectedHeight()+"px",i.useBitmapCache=!0,a.unshift(i),s.addControl(i),f()}function f(){c=0,a.forEach(e=>{c+=e.heightInPixels}),0!=c&&(s.height=c+5+"px")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return a}));const r=Symbol("thread.errors"),o=Symbol("thread.events"),i=Symbol("thread.terminate"),s=Symbol("thread.transferable"),a=Symbol("thread.worker")},,function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return f}));var r=n(95),o=n(119);const i=new o.EventEmitter;let s={};async function a(e){let t;if(e.compressed){let t=0;t=e.type?262144:35,e.data=await inflate(e.data,t)}if(t=new Uint16Array(e.data.buffer,e.data.byteOffset),e.type){const o=new r(t,[32,256,32]);for(var n=0;n<8;n++){const t=new r(new Uint16Array(32768),[32,32,32]),a=[e.x,n,e.z].join("|");for(let e=0;e<32;e++)for(let r=0;r<32;r++)for(let i=0;i<32;i++){const s=o.get(e,i+32*n,r);t.set(e,i,r,s),s>255&&console.log(s)}i.emit("load-"+a,t),i.emit("loadany",a,t),s[a]=t}}else{const n=[e.x,e.y,e.z].join("|"),o=new r(t,[32,32,32]);i.emit("load-"+n,o),i.emit("loadany",n,o),s[n]=o}}function c(e){delete s[e]}function u(e){return new Promise((t,n)=>{null!=s[e]?t(new r(s[e].data,s[e].shape)):(i.once("load-"+e,e=>t(new r(e.data,e.shape))),setTimeout(()=>{n("Timeout")},1e5))})}function l(e,t,n,r){const o=[Math.floor(t/32),Math.floor(n/32),Math.floor(r/32)].join("|");if(null==s[o])return;let i=t%32,a=n%32,c=r%32;i<0&&(i+=32),a<0&&(a+=32),c<0&&(c+=32),s[o].set(i,a,c,e)}function f(){s={}}},,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return y}));var r=n(6),o=n(25),i=n(52),s=n(35);function a(e,t){const n=new o.f;n.thickness=0,n.horizontalAlignment=2,n.zIndex=10,window.innerHeight>230*r.f?n.height=230*r.f+"px":n.height="100%",n.width=310*r.f+"px",n.background="#11111166";const a=new o.j;a.fontFamily="Lato",a.fontSize=11*r.f,a.textVerticalAlignment=0,a.color="white",a.text="Singleplayer",a.top=r.f,n.addControl(a);const u=Object(i.a)();u.button.top=18*r.f+"px",u.button.left=5*r.f+"px",u.buttonText.text=[{text:"Create World",color:"white",font:"Lato"}],u.button.onPointerClickObservable.add(()=>{!function(){const e=Object(r.d)(1),t=new o.f;t.background="#11111188",window.innerHeight>230*r.f?t.height=230*r.f+"px":t.height="100%";t.width=220*r.f+"px",t.thickness=0,t.zIndex=200;const n=new o.i;n.verticalAlignment=0,n.top=18*r.f+"px",n.width=210*r.f+"px",n.height="80%",n.verticalAlignment=0,n.top=18*r.f+"px",n.width=210*r.f+"px",n.height="80%";const a=Object(i.c)();a.name.text="Worldname",a.input.placeholderText="World",a.input.text="World",n.addControl(a.main);const c=Object(i.d)();c.item.verticalAlignment=1,c.text.text=[{text:"Create",color:"white",font:"Lato"}],c.item.top=`-${16*r.f}px`,c.item.onPointerClickObservable.add(()=>{t.dispose(),window.electron.send("world-create",{data:{name:a.input.text,date:Date.now(),type:"Infinite",voxelsrv:s.d},config:{},world:a.input.text})}),t.addControl(c.item);const u=Object(i.d)();u.item.verticalAlignment=1,u.text.text=[{text:"Back",color:"white",font:"Lato"}],u.item.onPointerClickObservable.add(()=>{t.dispose()}),t.addControl(u.item),t.addControl(n),e.addControl(t)}()}),n.addControl(u.button);const l=Object(i.a)();l.button.top=18*r.f+"px",l.button.left=74*r.f+"px",l.buttonText.text=[{text:"Remove",color:"white",font:"Lato"}],l.button.onPointerClickObservable.add(()=>{});const f=new o.f;f.width=290*r.f+"px",f.height="70%",f.verticalAlignment=0,f.top=40*r.f+"px",f.background="#ffffffbb",f.thickness=0;const d=c();d.main.verticalAlignment=0,d.main.fontFamily="Lato",d.main.background="#88888855",d.main.fontSize=7*r.f;const p=new o.j;p.text="Name",p.color="#222222",d.name.addControl(p);const h=new o.j;h.text="Last played",h.color="#222222",d.date.addControl(h);const m=new o.j;m.text="Type",m.color="#222222",d.type.addControl(m),f.addControl(d.main),n.addControl(f);const y=new o.g;y.height=150*r.f+"px",y.top=13*r.f+"px",y.thickness=0,y.verticalAlignment=0,y.barSize=0,f.addControl(y);const v=new o.i;v.fontFamily="Lato",v.width="100%",v.fontSize=6*r.f,v.verticalAlignment=0,y.addControl(v);let g=[];window.electron.once("world-list",(e,t)=>{t.forEach(e=>{const t=c(),n=new o.j;n.text=e.name,n.color="#222222",t.name.addControl(n);const r=new o.j;r.text=e.date.toString(),r.color="#222222",t.date.addControl(r);const i=new o.j;i.text=e.type,i.color="#222222",t.type.addControl(i);let s=0;t.main.onPointerClickObservable.add(n=>{g.forEach(e=>{e.row.main.background="#ffffff00"}),t.main.background="#ffffffaa",s+=1,s>1&&window.electron.send("world-start",{world:e.rawName}),setTimeout(()=>{s=0},500)}),t.main.onPointerEnterObservable.add(e=>{"#ffffffaa"!=t.main.background&&(t.main.background="#ffffff67")}),t.main.onPointerOutObservable.add(e=>{"#ffffffaa"!=t.main.background&&(t.main.background="#ffffff00")}),v.addControl(t.main),g.push({data:e,row:t})})}),window.electron.send("world-list-request",!0);const b=Object(i.d)();b.item.verticalAlignment=1,b.text.text=[{text:"Go back to menu",color:"white",font:"Lato"}],b.item.onPointerClickObservable.add(()=>{n.dispose(),t("main")}),n.addControl(b.item);const w=e=>{window.innerHeight>230*r.f?n.height=230*r.f+"px":n.height="100%",n.width=310*r.f+"px",a.fontSize=11*r.f,f.width=290*r.f+"px",f.top=40*r.f+"px",y.top=13*r.f+"px",d.main.fontSize=7*r.f,v.fontSize=6*r.f,y.height=150*r.f+"px",u.button.top=18*r.f+"px",u.button.left=5*r.f+"px",l.button.top=18*r.f+"px",l.button.left=74*r.f+"px",b.item.width=100*r.f+"px",b.item.height=18*r.f+"px",b.text.fontSize=10*r.f};return r.b.on("scale-change",w),n.onDisposeObservable.add(()=>{r.b.off("scale-change",w)}),n}function c(){const e=new o.f;e.height=13*r.f+"px",e.thickness=0;const t=()=>{e.height=13*r.f+"px"};r.b.on("scale-change",t),e.onDisposeObservable.add(()=>{r.b.off("scale-change",t)});const n=new o.f;n.width="50%",n.horizontalAlignment=0,n.thickness=0,e.addControl(n);const i=new o.f;i.width="20%",i.horizontalAlignment=0,i.left="50%",i.thickness=0,e.addControl(i);const s=new o.f;return s.width="20%",s.horizontalAlignment=0,s.left="80%",s.thickness=0,e.addControl(s),{main:e,name:n,date:i,type:s}}var u=n(94),l=n(115),f=n(61),d=n(151);function p(){const e=new o.f;e.height=13*r.f+"px",e.thickness=0;const t=()=>{e.height=13*r.f+"px"};r.b.on("scale-change",t),e.onDisposeObservable.add(()=>{r.b.off("scale-change",t)});const n=new o.f;n.width="20%",n.horizontalAlignment=0,n.thickness=0,e.addControl(n);const i=new o.f;i.width="50%",i.horizontalAlignment=0,i.left="20%",i.thickness=0,e.addControl(i);const s=new o.f;s.width="10%",s.horizontalAlignment=0,s.left="70%",s.thickness=0,e.addControl(s);const a=new o.f;return a.width="20%",a.horizontalAlignment=0,a.left="80%",a.thickness=0,e.addControl(a),{main:e,name:n,motd:i,players:s,software:a}}var h=n(221);let m;function y(e){const t=Object(r.d)(1);let n,c;m=new o.f,m.thickness=0,m.isPointerBlocker=!0,m.zIndex=5,t.addControl(m);const y=new o.j;function v(t){switch(n&&n.dispose(),t){case"singleplayer":n=a(0,v),c="singleplayer",document.title="VoxelSrv - Singleplayer Menu";break;case"multiplayer":n=function(e,t){const n=new o.f;n.thickness=0,n.horizontalAlignment=2,n.zIndex=10,window.innerHeight>230*r.f?n.height=230*r.f+"px":n.height="100%",n.width=310*r.f+"px",n.background="#11111166";const s=new o.j;s.fontFamily="Lato",s.fontSize=11*r.f,s.textVerticalAlignment=0,s.color="white",s.text="Multiplayer",s.top=r.f,n.addControl(s);const a=new o.e;a.height=17*r.f+"px",a.width=266*r.f+"px",a.top=18*r.f+"px",a.left=5*r.f+"px",a.fontSize=6*r.f,a.verticalAlignment=0,a.horizontalAlignment=0,a.thickness=0,a.background="#ffffffaa",a.focusedBackground="#ffffffff",a.color="#666666",a.placeholderText="Server address",n.addControl(a);const c=new o.f;c.height=17*r.f+"px",c.width=34*r.f+"px",c.top=18*r.f+"px",c.left=-5*r.f+"px",c.verticalAlignment=0,c.horizontalAlignment=1,c.thickness=0,c.background="#4d4d4daa",c.color="#666666",c.onPointerClickObservable.add(()=>{let t=a.text;t.startsWith("wss://")||t.startsWith("ws://")||(t="ws://"+t),Object(f.a)(e,new l.a(t))});const h=new u.a;h.text=[{text:"Connect",color:"white",font:"Lato"}],h.textHorizontalAlignment=2,h.fontSize=6*r.f,h.onPointerEnterObservable.add(e=>{h.text.forEach(e=>e.underline=!0),h._markAsDirty()}),h.onPointerOutObservable.add(e=>{h.text.forEach(e=>e.underline=!1),h._markAsDirty()}),c.addControl(h),n.addControl(c);const m=new o.f;m.width=290*r.f+"px",m.height="70%",m.verticalAlignment=0,m.top=40*r.f+"px",m.background="#ffffffbb",m.thickness=0;const y=p();y.main.verticalAlignment=0,y.main.fontFamily="Lato",y.main.background="#88888855",y.main.fontSize=7*r.f;const v=new o.j;v.text="Name",v.color="#222222",y.name.addControl(v);const g=new o.j;g.text="Motd",g.color="#222222",y.motd.addControl(g);const b=new o.j;b.text="Players",b.color="#222222",y.players.addControl(b);const w=new o.j;w.text="Software",w.color="#222222",y.software.addControl(w),m.addControl(y.main),n.addControl(m);const _=new o.g;_.height=150*r.f+"px",_.top=13*r.f+"px",_.thickness=0,_.verticalAlignment=0,_.barSize=0,m.addControl(_);const x=new o.i;x.fontFamily="Lato",x.width="100%",x.fontSize=6*r.f,x.verticalAlignment=0,_.addControl(x),fetch("http://pb4.eu:9001").then(e=>e.json()).then(e=>{Object.values(e).forEach(e=>{const t=p(),n=new o.j;n.text=e.name,n.color="#222222",t.name.addControl(n);const r=new o.j;r.text=e.motd,r.color="#222222",t.motd.addControl(r);const i=new o.j;i.text=`${e.numberplayers}/${e.maxplayers}`,i.color="#222222",t.players.addControl(i);const s=new o.j;s.text=e.software,s.color="#222222",t.software.addControl(s),t.main.onPointerEnterObservable.add(e=>{t.main.background="#ffffff67"}),t.main.onPointerOutObservable.add(e=>{t.main.background="#ffffff00"});let u=0;t.main.onPointerClickObservable.add(t=>{a.text=e.ip,u+=1,u>1&&c.onPointerClickObservable.notifyObservers(new o.l(new d.Vector2(0,0),0)),setTimeout(()=>{u=0},1e3)}),x.addControl(t.main)})});const k=Object(i.d)();k.item.verticalAlignment=1,k.text.text=[{text:"Go back to menu",color:"white",font:"Lato"}],k.item.onPointerClickObservable.add(()=>{n.dispose(),t("main")}),n.addControl(k.item);const O=e=>{window.innerHeight>230*r.f?n.height=230*r.f+"px":n.height="100%",n.width=310*r.f+"px",s.fontSize=11*r.f,a.height=17*r.f+"px",a.width=266*r.f+"px",a.top=18*r.f+"px",a.left=5*r.f+"px",a.fontSize=6*r.f,c.height=17*r.f+"px",c.width=34*r.f+"px",c.top=18*r.f+"px",c.left=-5*r.f+"px",h.fontSize=6*r.f,m.width=290*r.f+"px",m.top=40*r.f+"px",_.top=13*r.f+"px",y.main.fontSize=7*r.f,x.fontSize=6*r.f,_.height=150*r.f+"px",k.item.width=100*r.f+"px",k.item.height=18*r.f+"px",k.text.fontSize=10*r.f};return r.b.on("scale-change",O),n.onDisposeObservable.add(()=>{r.b.off("scale-change",O)}),n}(e,v),c="multiplayer",document.title="VoxelSrv - Multiplayer Menu";break;case"settings":n=Object(h.a)(e,v),c="settings",document.title="VoxelSrv - Settings";break;default:n=function(){const e=new o.f;e.thickness=0,e.horizontalAlignment=2,e.zIndex=10,window.innerHeight>230*r.f?e.height=230*r.f+"px":e.height="100%";e.width=220*r.f+"px",e.background="#11111166";const t=new o.d("hotbar","./textures/mainlogo.png");t.width=210*r.f+"px",t.height=64*r.f+"px",t.verticalAlignment=0,t.horizontalAlignment=2,t.top="5px",m.zIndex=15,e.addControl(t);const n=new u.a;n.text=Object(s.e)(),n.fontFamily="Lato",n.fontSize=9*r.f+"px",n.color="yellow",n.zIndex=20,n.width=200*r.f+"px",n.height=10*r.f+"px",n.textHorizontalAlignment=2,n.textVerticalAlignment=2,n.left=65*r.f+"px",window.innerHeight>230*r.f?n.top=`-${60*r.f}px`:n.top=`-${window.innerHeight/4}px`;n.rotation=-.22,n.shadowColor="#111111",n.shadowOffsetX=1,n.shadowOffsetY=1;let a=.005;window.changeSplash=()=>{n.text=Object(s.e)()};const c=setInterval(()=>{n.scaleX=n.scaleX+a,n.scaleY=n.scaleY+a,n.scaleX>1.1?a=-.005:n.scaleX<1&&(a=.005)},20);m.addControl(n);const l=new o.i;if(l.zIndex=20,e.addControl(l),null!=window.electron){const e=Object(i.d)();e.text.text=[{text:"Singleplayer",color:"white",font:"Lato"}],e.item.onPointerClickObservable.add(e=>{v("singleplayer")}),l.addControl(e.item)}const f=Object(i.d)();f.text.text=[{text:"Multiplayer",color:"white",font:"Lato"}],f.item.onPointerClickObservable.add(e=>{v("multiplayer")}),l.addControl(f.item);const d=Object(i.d)();d.text.text=[{text:"Settings",color:"white",font:"Lato"}],d.item.onPointerClickObservable.add(e=>{v("settings")}),l.addControl(d.item);const p=Object(i.d)();p.text.text=[{text:"Discord",color:"white",font:"Lato"}],p.item.onPointerClickObservable.add(e=>{window.open("https://discord.com/invite/K9PdsDh","_blank")}),l.addControl(p.item);const h=Object(i.d)();h.text.text=[{text:"Github",color:"white",font:"Lato"}],h.item.onPointerClickObservable.add(e=>{window.open("https://github.com/VoxelSrv/voxelsrv","_blank")}),l.addControl(h.item);const y=o=>{window.innerHeight>230*r.f?e.height=230*r.f+"px":e.height="100%",e.width=220*r.f+"px",t.width=210*r.f+"px",t.height=64*r.f+"px",n.left=65*r.f+"px",window.innerHeight>230*r.f?n.top=`-${60*r.f}px`:n.top=`-${window.innerHeight/4}px`,n.fontSize=9*r.f+"px",n.width=200*r.f+"px",n.height=10*r.f+"px",l._children.forEach(e=>{e.width=100*r.f+"px",e.height=18*r.f+"px",e._children[0].fontSize=10*r.f})};return r.b.on("scale-change",y),e.onDisposeObservable.add(()=>{clearInterval(c),n.dispose(),r.b.off("scale-change",y)}),e}(),c="main",document.title="VoxelSrv - Main Menu"}m.addControl(n)}y.text=s.f?`VoxelSRV ${s.d}/${s.f}`:"VoxelSRV "+s.d,y.fontFamily="Lato",y.fontSize="26px",y.color="white",y.textHorizontalAlignment=0,y.textVerticalAlignment=1,y.left="5px",y.top="-5px",y.shadowColor="#111111",y.shadowOffsetX=1,y.shadowOffsetY=1,m.addControl(y),v("main")}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s}));const r={deserialize:e=>Object.assign(Error(e.message),{name:e.name,stack:e.stack}),serialize:e=>({__error_marker:"$$error",message:e.message,name:e.name,stack:e.stack})};let o={deserialize(e){return(t=e)&&"object"==typeof t&&"__error_marker"in t&&"$$error"===t.__error_marker?r.deserialize(e):e;var t},serialize:e=>e instanceof Error?r.serialize(e):e};function i(e){return o.deserialize(e)}function s(e){return o.serialize(e)}},,,,,,,function(e,t,n){"use strict";(function(e){var r=t;function o(e,t,n){for(var r=Object.keys(t),o=0;o<r.length;++o)void 0!==e[r[o]]&&n||(e[r[o]]=t[r[o]]);return e}function i(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&o(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}r.asPromise=n(358),r.base64=n(359),r.EventEmitter=n(360),r.float=n(361),r.inquire=n(362),r.utf8=n(363),r.pool=n(364),r.LongBits=n(365),r.isNode=Boolean(void 0!==e&&e&&e.process&&e.process.versions&&e.process.versions.node),r.global=r.isNode&&e||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"==typeof e||e instanceof String},r.isObject=function(e){return e&&"object"==typeof e},r.isset=r.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"==typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var n=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},r.merge=o,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=i,r.ProtocolError=i("ProtocolError"),r.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},r.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}}).call(this,n(168))},,,,,,,,,,,,,,,,,function(e,t,n){(function(r){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(r++,"%c"===e&&(o=r))}),t.splice(o,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(374)(t);const{formatters:o}=e.exports;o.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,n(224))},function(e,t,n){"use strict";var r,o;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e.cancel="cancel",e.run="run"}(r||(r={})),function(e){e.error="error",e.init="init",e.result="result",e.running="running",e.uncaughtError="uncaughtError"}(o||(o={}))},,,,function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(33);let o;function i(e){const t=e.rendering.getScene();o=r.f.CreatePlane("cloudMesh",{height:1500,width:1500},t);const n=new r.i("cloud",t),i=new r.j("./textures/environment/clouds.png",t,!0,!0,r.j.NEAREST_SAMPLINGMODE);i.hasAlpha=!0,i.vScale=.75,i.uScale=.75,n.diffuseTexture=i,n.opacityTexture=i,n.backFaceCulling=!1,n.emissiveColor=new r.b(1,1,1),o.rotation.x=-Math.PI/2,o.material=n,e.rendering.addMeshToScene(o,!1),o.setPositionWithLocalVector(new r.k(0,0,200));let s=[...e.camera.getPosition()];const a=()=>{null!=e.ents.getState(e.playerEntity,e.ents.names.mesh)&&o.setParent(e.ents.getState(e.playerEntity,e.ents.names.mesh).mesh),i.vOffset+=1e-5+(s[2]-e.camera.getPosition()[2])/1e4,i.uOffset-=(s[0]-e.camera.getPosition()[0])/1e4,s=[...e.camera.getPosition()],o.setPositionWithLocalVector(new r.k(0,0,200-e.camera.getPosition()[1]))};e.on("beforeRender",a),o.onDisposeObservable.add(()=>{e.off("beforeRender",a)})}},,function(e,t,n){"use strict";const r=()=>"function"==typeof Symbol,o=e=>r()&&Boolean(Symbol[e]),i=e=>o(e)?Symbol[e]:"@@"+e;o("asyncIterator")||(Symbol.asyncIterator=Symbol.asyncIterator||Symbol.for("Symbol.asyncIterator"));const s=i("iterator"),a=i("observable"),c=i("species");function u(e,t){const n=e[t];if(null!=n){if("function"!=typeof n)throw new TypeError(n+" is not a function");return n}}function l(e){let t=e.constructor;return void 0!==t&&(t=t[c],null===t&&(t=void 0)),void 0!==t?t:b}function f(e){f.log?f.log(e):setTimeout(()=>{throw e},0)}function d(e){Promise.resolve().then(()=>{try{e()}catch(e){f(e)}})}function p(e){const t=e._cleanup;if(void 0!==t&&(e._cleanup=void 0,t))try{if("function"==typeof t)t();else{const e=u(t,"unsubscribe");e&&e.call(t)}}catch(e){f(e)}}function h(e){e._observer=void 0,e._queue=void 0,e._state="closed"}function m(e,t,n){e._state="running";const r=e._observer;try{const o=r?u(r,t):void 0;switch(t){case"next":o&&o.call(r,n);break;case"error":if(h(e),!o)throw n;o.call(r,n);break;case"complete":h(e),o&&o.call(r)}}catch(e){f(e)}"closed"===e._state?p(e):"running"===e._state&&(e._state="ready")}function y(e,t,n){if("closed"!==e._state)return"buffering"===e._state?(e._queue=e._queue||[],void e._queue.push({type:t,value:n})):"ready"!==e._state?(e._state="buffering",e._queue=[{type:t,value:n}],void d(()=>function(e){const t=e._queue;if(t){e._queue=void 0,e._state="ready";for(const n of t)if(m(e,n.type,n.value),"closed"===e._state)break}}(e))):void m(e,t,n)}class v{constructor(e,t){this._cleanup=void 0,this._observer=e,this._queue=void 0,this._state="initializing";const n=new g(this);try{this._cleanup=t.call(void 0,n)}catch(e){n.error(e)}"initializing"===this._state&&(this._state="ready")}get closed(){return"closed"===this._state}unsubscribe(){"closed"!==this._state&&(h(this),p(this))}}class g{constructor(e){this._subscription=e}get closed(){return"closed"===this._subscription._state}next(e){y(this._subscription,"next",e)}error(e){y(this._subscription,"error",e)}complete(){y(this._subscription,"complete")}}class b{constructor(e){if(!(this instanceof b))throw new TypeError("Observable cannot be called as a function");if("function"!=typeof e)throw new TypeError("Observable initializer must be a function");this._subscriber=e}subscribe(e,t,n){return"object"==typeof e&&null!==e||(e={next:e,error:t,complete:n}),new v(e,this._subscriber)}pipe(e,...t){let n=this;for(const r of[e,...t])n=r(n);return n}tap(e,t,n){const r="object"!=typeof e||null===e?{next:e,error:t,complete:n}:e;return new b(e=>this.subscribe({next(t){r.next&&r.next(t),e.next(t)},error(t){r.error&&r.error(t),e.error(t)},complete(){r.complete&&r.complete(),e.complete()},start(e){r.start&&r.start(e)}}))}forEach(e){return new Promise((t,n)=>{if("function"!=typeof e)return void n(new TypeError(e+" is not a function"));function r(){o.unsubscribe(),t()}const o=this.subscribe({next(t){try{e(t,r)}catch(e){n(e),o.unsubscribe()}},error:n,complete:t})})}map(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(l(this))(t=>this.subscribe({next(n){let r=n;try{r=e(n)}catch(e){return t.error(e)}t.next(r)},error(e){t.error(e)},complete(){t.complete()}}))}filter(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(l(this))(t=>this.subscribe({next(n){try{if(!e(n))return}catch(e){return t.error(e)}t.next(n)},error(e){t.error(e)},complete(){t.complete()}}))}reduce(e,t){if("function"!=typeof e)throw new TypeError(e+" is not a function");const n=l(this),r=arguments.length>1;let o=!1,i=t;return new n(t=>this.subscribe({next(n){const s=!o;if(o=!0,!s||r)try{i=e(i,n)}catch(e){return t.error(e)}else i=n},error(e){t.error(e)},complete(){if(!o&&!r)return t.error(new TypeError("Cannot reduce an empty sequence"));t.next(i),t.complete()}}))}concat(...e){const t=l(this);return new t(n=>{let r,o=0;return function i(s){r=s.subscribe({next(e){n.next(e)},error(e){n.error(e)},complete(){o===e.length?(r=void 0,n.complete()):i(t.from(e[o++]))}})}(this),()=>{r&&(r.unsubscribe(),r=void 0)}})}flatMap(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");const t=l(this);return new t(n=>{const r=[],o=this.subscribe({next(o){let s;if(e)try{s=e(o)}catch(e){return n.error(e)}else s=o;const a=t.from(s).subscribe({next(e){n.next(e)},error(e){n.error(e)},complete(){const e=r.indexOf(a);e>=0&&r.splice(e,1),i()}});r.push(a)},error(e){n.error(e)},complete(){i()}});function i(){o.closed&&0===r.length&&n.complete()}return()=>{r.forEach(e=>e.unsubscribe()),o.unsubscribe()}})}[a](){return this}static from(e){const t="function"==typeof this?this:b;if(null==e)throw new TypeError(e+" is not an object");const n=u(e,a);if(n){const r=n.call(e);if(Object(r)!==r)throw new TypeError(r+" is not an object");return function(e){return e instanceof b}(r)&&r.constructor===t?r:new t(e=>r.subscribe(e))}if(o("iterator")){const n=u(e,s);if(n)return new t(t=>{d(()=>{if(!t.closed){for(const r of n.call(e))if(t.next(r),t.closed)return;t.complete()}})})}if(Array.isArray(e))return new t(t=>{d(()=>{if(!t.closed){for(const n of e)if(t.next(n),t.closed)return;t.complete()}})});throw new TypeError(e+" is not observable")}static of(...e){return new("function"==typeof this?this:b)(t=>{d(()=>{if(!t.closed){for(const n of e)if(t.next(n),t.closed)return;t.complete()}})})}static get[c](){return this}}r()&&Object.defineProperty(b,Symbol("extensions"),{value:{symbol:a,hostReportError:f},configurable:!0});t.a=b},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.internalError="internalError",e.message="message",e.termination="termination"}(r||(r={}))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return m}));var r=n(33),o=n(74),i=n(35),s=n(84),a=n(82),c=n(49),u=n(61),l=n(6),f=n(107),d=n(128);const p=n(372);function h(e){const t=e.playerEntity,n=e.rendering.getScene(),h=Object(l.e)(1);function m(){let t=n.createPickingRay(window.innerWidth/2,window.innerHeight/2,r.d.Identity(),e.rendering.getScene().activeCameras[0]);const o=n.pickWithRay(t,e=>e.name.startsWith("hitbox-"),!0);return o.pickedMesh?[o.pickedMesh.name.substring(7),o.distance]:null}e.container.canvas.requestPointerLock(),e.container.canvas.addEventListener("click",()=>{i.h.ingame&&(a.d.isVisible||c.d.isVisible||f.b.isVisible||(e.container.canvas.requestPointerLock(),c.d.isVisible=!1,c.d.text=""))}),e.blockTargetIdCheck=function(e){return null!=s.a[e]&&0!=e&&null!=s.b[s.a[e]]&&1!=s.b[s.a[e]].options.fluid},e.inputs.down.on("fire",(async function(){if(!i.h.ingame)return;if(e.targetedBlock){const t=e.targetedBlock.position;return Object(u.c)("ActionClick",{type:"left",x:t[0],y:t[1],z:t[2],onBlock:!0}),void Object(u.c)("ActionBlockBreak",{x:t[0],y:t[1],z:t[2]})}Object(u.c)("ActionClick",{type:"left",x:0,y:0,z:0,onBlock:!1});const t=m();t&&Object(u.c)("ActionClickEntity",{type:"left",uuid:t[0],distance:t[1]})})),e.inputs.up.on("fire",(function(){i.h.ingame})),e.inputs.down.on("alt-fire",(function(){if(!i.h.ingame)return;if(null!=e.targetedBlock){const t=e.targetedBlock.adjacent,n=e.targetedBlock.position;return Object(u.c)("ActionClick",{type:"right",x:n[0],y:n[1],z:n[2],onBlock:!0}),void(0==e.ents.isTerrainBlocked(t[0],t[1],t[2])&&Object(u.c)("ActionBlockPlace",{x:t[0],y:t[1],z:t[2],x2:n[0],y2:n[1],z2:n[2]}))}Object(u.c)("ActionClick",{type:"right",x:0,y:0,z:0,onBlock:!1});const t=m();t&&Object(u.c)("ActionClickEntity",{type:"right",uuid:t[0],distance:t[1]})})),e.inputs.down.on("mid-fire",(function(){if(i.h.ingame&&e.targetedBlock&&0!=e.targetedBlock.blockID){const n=function(n,r){const o=e.ents.getState(t,"inventory"),i=Object.entries(o.items);for(let e=0;e<i.length;e++)if(null!=i[e]&&null!=i[e][1]&&i[e][1].id==n&&i[e][1].count>=r)return parseInt(i[e][0]);return-1}(s.b[s.a[e.targetedBlock.blockID]].id,1),r=e.ents.getState(t,"inventory").selected;-1!=n&&n<9?(Object(u.c)("ActionInventoryClick",{type:"select",slot:n}),e.ents.getState(t,"inventory").selected=n):-1!=n&&Object(u.c)("ActionInventoryClick",{type:"switch",slot:n,slot2:r})}})),e.inputs.down.on("thirdprsn",(function(){i.h.ingame&&(document.pointerLockElement,e.container.canvas)})),e.inputs.down.on("inventory",(function(){i.h.ingame&&(c.d.isVisible||f.b.isVisible||(a.d.isVisible?(a.d.isVisible=!1,e.container.canvas.requestPointerLock(),Object(u.c)("ActionInventoryClose",{inventory:"main"})):(Object(u.c)("ActionInventoryOpen",{inventory:"main"}),a.d.isVisible=!0,document.exitPointerLock())))})),e.inputs.down.on("chat",(function(){i.h.ingame&&(a.d.isVisible||c.d.isVisible||f.b.isVisible||(c.d.isVisible=!0,Object(c.b)(!0),document.exitPointerLock(),h.moveFocusToControl(c.d),c.d.text=""))})),e.inputs.down.on("cmd",(function(){i.h.ingame&&(a.d.isVisible||c.d.isVisible||f.b.isVisible||(c.d.isVisible=!0,Object(c.b)(!0),document.exitPointerLock(),h.moveFocusToControl(c.d),c.d.text="/"))}));e.inputs.down.on("menu",e=>{if(i.h.ingame)return c.d.isVisible?(c.d.isVisible=!1,c.d.text="",void Object(c.b)(!1)):a.d.isVisible?(a.d.isVisible=!1,void Object(u.c)("ActionInventoryClose",{inventory:"main"})):f.b.isVisible?void(f.b.isVisible=!1):(document.exitPointerLock(),void(f.b.isVisible=!0))}),e.inputs.down.on("chatenter",(function(){i.h.ingame&&(c.d.isVisible=!1,Object(u.c)("ActionMessage",{message:c.d.text}),c.d.text="",Object(c.b)(!1))})),e.inputs.down.on("tab",(function(){d.c.isVisible=!0})),e.inputs.up.on("tab",(function(){d.c.isVisible=!1})),e.inputs.up.on("screenshot",(function(){c.d.isVisible||document.pointerLockElement==e.container.canvas&&p(e.container.canvas,{filename:"VoxelSRV-"+Date.now()+".png"})})),e.on("tick",(async function(){if(!i.h.ingame)return;const n=e.inputs.state.scrolly;if(0!==n){let r=e.ents.getState(t,"inventory").selected;r+=n>0?1:-1,r>=i.c.hotbarsize?r=0:r<0&&(r=8),Object(u.c)("ActionInventoryClick",{slot:r,type:"select"}),e.ents.getState(t,"inventory").selected=r}if(e.inputs.state.jump){const n=e.ents.getPosition(t),r=s.b[s.a[e.getBlock(Math.floor(n[0]),Math.floor(n[1]),Math.floor(n[2]))]];null!=r&&1==r.options.fluid&&e.ents.getPhysicsBody(t).applyImpulse([0,1,0])}})),e.inputs.bind("numberkey","1","2","3","4","5","6","7","8","9"),e.inputs.down.on("numberkey",n=>{if(i.h.ingame&&document.pointerLockElement==e.container.canvas){const r=parseInt(n.key);let o=e.ents.getState(t,"inventory").selected;o=r-1,Object(u.c)("ActionInventoryClick",{slot:o,type:"select"}),e.ents.getState(t,"inventory").selected=o}}),setTimeout(()=>{e.on("tick",async()=>{i.h.ingame&&(document.pointerLockElement!=e.container.canvas&&!o.isMobile||c.d.isVisible||f.b.isVisible||a.d.isVisible?e.ents.getState(e.playerEntity,"receivesInputs").ignore=!0:e.ents.getState(e.playerEntity,"receivesInputs").ignore=!1)})},100)}function m(e,t,n,o){const i=e.playerEntity,s=e.entities.getPositionData(i),a=e.rendering.getScene(),c=(s.width,s.height),u=(e.ents.getPositionData(e.playerEntity).height,[0,c/2,0]);e.rendering.getScene().cameras[0].fov=1;const l=e.entities.getMovement(i);o&&Object.entries(o).forEach(e=>{l[e[0]]=e[1]}),null!=t&&e.ents.addComponentAgain(i,"inventory",t),null!=n&&(e.ents.getState(i,"inventory").armor=n),e.ents.getState(i,"inventory").crafting={1:{},2:{},3:{},4:{}},e.entities.addComponentAgain(i,e.entities.names.mesh,{mesh:new r.e("main",a),offset:u})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(6),o=n(25),i=n(52),s=n(35);function a(e,t){const n=new o.f;n.thickness=0,n.horizontalAlignment=2,n.zIndex=10,window.innerHeight>230*r.f?n.height=230*r.f+"px":n.height="100%",n.width=220*r.f+"px",n.background="#11111166";const a=new o.j;a.fontFamily="Lato",a.fontSize=11*r.f,a.textVerticalAlignment=0,a.color="white",a.text="Settings",a.top=r.f,n.addControl(a);const c=new o.i;c.verticalAlignment=0,c.top=18*r.f+"px",c.width=210*r.f+"px",c.height="80%",n.addControl(c);const u=Object(i.c)();u.name.text="Nickname",u.input.placeholderText="Write your nickname",u.input.text=s.c.nickname,u.input.promptMessage="Enter your nickname",c.addControl(u.main);const l=Object(i.e)();l.name.text="Mouse sensitivity: "+s.c.mouse,l.slider.value=s.c.mouse,l.slider.minimum=1,l.slider.maximum=80,l.slider.step=1,l.slider.onValueChangedObservable.add(e=>{l.name.text="Mouse sensitivity: "+e}),c.addControl(l.main);const f=Object(i.e)();f.name.text="GUI scale: "+s.c.scale,f.slider.value=s.c.scale,f.slider.minimum=2,f.slider.maximum=5,f.slider.step=1,f.slider.onValueChangedObservable.add(e=>{f.name.text="GUI scale: "+e}),c.addControl(f.main);const d=Object(i.b)();d.name.text="Enable gamepad: "+s.c.gamepad,d.isChecked=s.c.gamepad,d.main.onPointerClickObservable.add(()=>{d.isChecked=!d.isChecked,d.name.text="Enable gamepad: "+d.isChecked}),c.addControl(d.main);const p=Object(i.e)();p.name.text="View Distance: "+s.c.viewDistance,p.slider.value=s.c.viewDistance,p.slider.minimum=2,p.slider.maximum=16,p.slider.step=1,p.slider.onValueChangedObservable.add(e=>{p.name.text="View Distance: "+e}),c.addControl(p.main);const h=Object(i.d)();h.item.verticalAlignment=1,h.text.text=[{text:"Back",color:"white",font:"Lato"}],h.item.onPointerClickObservable.add(()=>{Object(s.k)({nickname:u.input.text,mouse:l.slider.value,scale:f.slider.value,gamepad:d.isChecked,viewDistance:p.slider.value}),e.camera.sensitivityX=l.slider.value,e.camera.sensitivityY=l.slider.value,e.world.chunkAddDistance=p.slider.value,e.world.chunkRemoveDistance=p.slider.value,n.dispose(),t("main")}),n.addControl(h.item);const m=e=>{window.innerHeight>230*r.f?n.height=230*r.f+"px":n.height="100%",n.width=220*r.f+"px",a.fontSize=11*r.f,c.top=18*r.f+"px",c.width=210*r.f+"px",h.item.width=100*r.f+"px",h.item.height=18*r.f+"px",h.text.fontSize=10*r.f};return r.b.on("scale-change",m),n.onDisposeObservable.add(()=>{r.b.off("scale-change",m)}),n}},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n(33),o=n(35);const i={};let s;function a(e){s=e,s.ents.createComponent({name:"model",state:{models:{}}})}function c(e,t,n,o,a,c,f,d){const p=s.rendering.getScene();if(null==i[n])fetch("./models/"+n+".json").then(e=>e.json()).then((function(h){const m=u(h,o);i[n]=h,c&&(m.nametag=l(m.main,f,s.ents.getPositionData(e).height)),s.ents.addComponent(e,"model",m);const y=r.f.CreateBox("hitbox-"+t,{height:d[1],width:d[0],depth:d[2]},p);y.setParent(m.main),y.setPositionWithLocalVector(new r.k(0,d[1]/2,0)),y.material=s.rendering.makeStandardMaterial(),y.material.wireframe=!0,s.rendering.addMeshToScene(y,!1),s.entities.addComponent(e,s.entities.names.mesh,{mesh:m.main,offset:a})}));else{const t=u(i[n],o);c&&(t.nametag=l(t.main,f,s.ents.getPositionData(e).height)),s.ents.addComponent(e,"model",t),s.entities.addComponent(e,s.entities.names.mesh,{mesh:t.main,offset:a})}}function u(e,t){const n=s.rendering.getScene(),i=[e.geometry.texturewidth,e.geometry.textureheight],a=new r.e("main",n),c=e.geometry.bones,u={};for(var l=0;l<c.length;l++){const e=c[l],d=e.cubes,p=new Array(d.length),h=e.pivot;for(let a=0;a<d.length;a++){let c=0;null!=d[a].inflate&&(c=d[a].inflate);const u=new Array(6),l=d[a].size,h=d[a].origin,m=d[a].uv;u[0]=new r.l((m[0]+l[2])/i[0],(i[1]-l[1]-l[2]-m[1])/i[1],(l[2]+l[0]+m[0])/i[0],(i[1]-l[2]-m[1])/i[1]),u[1]=new r.l((m[0]+2*l[2]+l[0])/i[0],(i[1]-l[1]-l[2]-m[1])/i[1],(2*l[2]+2*l[0]+m[0])/i[0],(i[1]-l[2]-m[1])/i[1]),u[2]=new r.l(m[0]/i[0],(i[1]-l[1]-l[2]-m[1])/i[1],(m[0]+l[2])/i[0],(i[1]-l[2]-m[1])/i[1]),u[3]=new r.l((m[0]+l[2]+l[0])/i[0],(i[1]-l[1]-l[2]-m[1])/i[1],(l[2]+2*l[0]+m[0])/i[0],(i[1]-l[2]-m[1])/i[1]),u[4]=new r.l((l[0]+l[2]+m[0])/i[0],(i[1]-l[2]-m[1])/i[1],(m[0]+l[2])/i[0],(i[1]-m[1])/i[1]),u[5]=new r.l((2*l[0]+l[2]+m[0])/i[0],(i[1]-l[2]-m[1])/i[1],(m[0]+l[2]+l[0])/i[0],(i[1]-m[1])/i[1]),p[a]=r.f.CreateBox("part-"+e.name+"-"+a,{height:.06*(l[1]+c),width:.06*(l[0]+c),depth:.06*(l[2]+c),faceUV:u,wrap:!0},n),p[a].position=new r.k(.06*-(h[0]+(l[0]-c/2)/2),.06*(h[1]+(l[1]-c/2)/2),.06*(h[2]+(l[2]-c/2)/2));var f=s.rendering.makeStandardMaterial("modelmaterial-"+e.name+"-"+a);p[a].material=f,(t.startsWith("http://")||t.startsWith("https://"))&&1==o.c.allowcustom?f.diffuseTexture=new r.j(t,n,!0,!0,r.j.NEAREST_SAMPLINGMODE):f.diffuseTexture=new r.j("textures/"+t+".png",n,!0,!0,r.j.NEAREST_SAMPLINGMODE),p[a].opaque=!1,f.diffuseTexture.hasAlpha=!0}const m=r.e.MergeMeshes(p,!0,!0,void 0,!0,!0);m.setParent(a),m.setPivotMatrix(r.d.Translation(.06*-h[0],.06*-h[1],.06*-h[2])),u[e.name]=m,s.rendering.addMeshToScene(m)}return{main:a,models:u}}function l(e,t,n){const o=s.rendering.getScene(),i="bold 96px 'lato'",a=new r.c("DynamicTexture",64,o,!1).getContext();a.font=i;const c=a.measureText(t).width+8,u=c*(.3/144),l=new r.c("DynamicTexture",{width:c,height:144},o,!1),f=s.rendering.makeStandardMaterial("nametag");f.diffuseTexture=l,f.emissiveTexture=f.diffuseTexture,f.diffuseTexture.hasAlpha=!0,f.opacityTexture=f.diffuseTexture,l.drawText(t,null,null,i,"#eeeeee","#00000066",!0);const d=r.f.CreatePlane("plane",{width:u,height:.3},o);return d.material=f,d.setPositionWithLocalVector(new r.k(0,n+.2,0)),d.opaque=!1,d.setParent(e),s.rendering.addMeshToScene(d),d}},function(e,t,n){"use strict";n.d(t,"a",(function(){return jn})),n.d(t,"b",(function(){return Mn}));var r=function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function o(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r}var i=Object.keys,s=Array.isArray,a="undefined"!=typeof self?self:"undefined"!=typeof window?window:global;function c(e,t){return"object"!=typeof t||i(t).forEach((function(n){e[n]=t[n]})),e}"undefined"==typeof Promise||a.Promise||(a.Promise=Promise);var u=Object.getPrototypeOf,l={}.hasOwnProperty;function f(e,t){return l.call(e,t)}function d(e,t){"function"==typeof t&&(t=t(u(e))),i(t).forEach((function(n){h(e,n,t[n])}))}var p=Object.defineProperty;function h(e,t,n,r){p(e,t,c(n&&f(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function m(e){return{from:function(t){return e.prototype=Object.create(t.prototype),h(e.prototype,"constructor",e),{extend:d.bind(null,e.prototype)}}}}var y=Object.getOwnPropertyDescriptor;var v=[].slice;function g(e,t,n){return v.call(e,t,n)}function b(e,t){return t(e)}function w(e){if(!e)throw new Error("Assertion Failed")}function _(e){a.setImmediate?setImmediate(e):setTimeout(e,0)}function x(e,t){return e.reduce((function(e,n,r){var o=t(n,r);return o&&(e[o[0]]=o[1]),e}),{})}function k(e,t){if(f(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],r=0,o=t.length;r<o;++r){var i=k(e,t[r]);n.push(i)}return n}var s=t.indexOf(".");if(-1!==s){var a=e[t.substr(0,s)];return void 0===a?void 0:k(a,t.substr(s+1))}}function O(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){w("string"!=typeof n&&"length"in n);for(var r=0,o=t.length;r<o;++r)O(e,t[r],n[r])}else{var i=t.indexOf(".");if(-1!==i){var a=t.substr(0,i),c=t.substr(i+1);if(""===c)void 0===n?s(e)&&!isNaN(parseInt(a))?e.splice(a,1):delete e[a]:e[a]=n;else{var u=e[a];u||(u=e[a]={}),O(u,c,n)}}else void 0===n?s(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function P(e){var t={};for(var n in e)f(e,n)&&(t[n]=e[n]);return t}var C=[].concat;function S(e){return C.apply([],e)}var T="Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set".split(",").concat(S([8,16,32,64].map((function(e){return["Int","Uint","Float"].map((function(t){return t+e+"Array"}))})))).filter((function(e){return a[e]})),E=T.map((function(e){return a[e]})),j=x(T,(function(e){return[e,!0]}));function M(e){if(!e||"object"!=typeof e)return e;var t;if(s(e)){t=[];for(var n=0,r=e.length;n<r;++n)t.push(M(e[n]))}else if(E.indexOf(e.constructor)>=0)t=e;else for(var o in t=e.constructor?Object.create(e.constructor.prototype):{},e)f(e,o)&&(t[o]=M(e[o]));return t}var D={}.toString;function A(e){return D.call(e).slice(8,-1)}var I=function(e,t){return"Array"===t?""+e.map((function(e){return I(e,A(e))})):"ArrayBuffer"===t?""+new Uint8Array(e):"Date"===t?e.getTime():ArrayBuffer.isView(e)?""+new Uint8Array(e.buffer):e};function R(e,t,n,r){return n=n||{},r=r||"",i(e).forEach((function(o){if(f(t,o)){var i=e[o],s=t[o];if("object"==typeof i&&"object"==typeof s&&i&&s){var a=A(i),c=A(s);a===c?j[a]?I(i,a)!==I(s,c)&&(n[r+o]=t[o]):R(i,s,n,r+o+"."):n[r+o]=t[o]}else i!==s&&(n[r+o]=t[o])}else n[r+o]=void 0})),i(t).forEach((function(o){f(e,o)||(n[r+o]=t[o])})),n}var B="undefined"!=typeof Symbol&&Symbol.iterator,L=B?function(e){var t;return null!=e&&(t=e[B])&&t.apply(e)}:function(){return null},z={};function F(e){var t,n,r,o;if(1===arguments.length){if(s(e))return e.slice();if(this===z&&"string"==typeof e)return[e];if(o=L(e)){for(n=[];!(r=o.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"==typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var N="undefined"!=typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},U="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function V(e,t){U=e,W=t}var W=function(){return!0},G=!new Error("").stack;function q(){if(G)try{throw new Error}catch(e){return e}return new Error}function K(e,t){var n=e.stack;return n?(t=t||0,0===n.indexOf(e.name)&&(t+=(e.name+e.message).split("\n").length),n.split("\n").slice(t).filter(W).map((function(e){return"\n"+e})).join("")):""}var Y=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],J=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Y),H={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function X(e,t){this._e=q(),this.name=e,this.message=t}function $(e,t){return e+". Errors: "+Object.keys(t).map((function(e){return t[e].toString()})).filter((function(e,t,n){return n.indexOf(e)===t})).join("\n")}function Z(e,t,n,r){this._e=q(),this.failures=t,this.failedKeys=r,this.successCount=n,this.message=$(e,t)}function Q(e,t){this._e=q(),this.name="BulkError",this.failures=t,this.message=$(e,t)}m(X).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+K(this._e,2))}},toString:function(){return this.name+": "+this.message}}),m(Z).from(X),m(Q).from(X);var ee=J.reduce((function(e,t){return e[t]=t+"Error",e}),{}),te=X,ne=J.reduce((function(e,t){var n=t+"Error";function r(e,r){this._e=q(),this.name=n,e?"string"==typeof e?(this.message=e+(r?"\n "+r:""),this.inner=r||null):"object"==typeof e&&(this.message=e.name+" "+e.message,this.inner=e):(this.message=H[t]||n,this.inner=null)}return m(r).from(te),e[t]=r,e}),{});ne.Syntax=SyntaxError,ne.Type=TypeError,ne.Range=RangeError;var re=Y.reduce((function(e,t){return e[t+"Error"]=ne[t],e}),{});var oe=J.reduce((function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=ne[t]),e}),{});function ie(){}function se(e){return e}function ae(e,t){return null==e||e===se?t:function(n){return t(e(n))}}function ce(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function ue(e,t){return e===ie?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var i=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?ce(r,this.onsuccess):r),o&&(this.onerror=this.onerror?ce(o,this.onerror):o),void 0!==i?i:n}}function le(e,t){return e===ie?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?ce(n,this.onsuccess):n),r&&(this.onerror=this.onerror?ce(r,this.onerror):r)}}function fe(e,t){return e===ie?t:function(n){var r=e.apply(this,arguments);c(n,r);var o=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var s=t.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?ce(o,this.onsuccess):o),i&&(this.onerror=this.onerror?ce(i,this.onerror):i),void 0===r?void 0===s?void 0:s:c(r,s)}}function de(e,t){return e===ie?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function pe(e,t){return e===ie?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,o=arguments.length,i=new Array(o);o--;)i[o]=arguments[o];return n.then((function(){return t.apply(r,i)}))}return t.apply(this,arguments)}}oe.ModifyError=Z,oe.DexieError=X,oe.BulkError=Q;var he={},me="undefined"==typeof Promise?[]:function(){var e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,e.__proto__,e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,t.__proto__,e]}(),ye=me[0],ve=me[1],ge=me[2],be=ve&&ve.then,we=ye&&ye.constructor,_e=!!ge,xe=!1,ke=ge?function(){ge.then(qe)}:a.setImmediate?setImmediate.bind(null,qe):a.MutationObserver?function(){var e=document.createElement("div");new MutationObserver((function(){qe(),e=null})).observe(e,{attributes:!0}),e.setAttribute("i","1")}:function(){setTimeout(qe,0)},Oe=function(e,t){Ae.push([e,t]),Ce&&(ke(),Ce=!1)},Pe=!0,Ce=!0,Se=[],Te=[],Ee=null,je=se,Me={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ht,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((function(e){try{ht(e[0],e[1])}catch(e){}}))}},De=Me,Ae=[],Ie=0,Re=[];function Be(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=ie,this._lib=!1;var t=this._PSD=De;if(U&&(this._stackHolder=q(),this._prev=null,this._numPrev=0),"function"!=typeof e){if(e!==he)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Ne(this,this._value))}this._state=null,this._value=null,++t.ref,Fe(this,e)}var Le={get:function(){var e=De,t=tt;function n(n,r){var o=this,i=!e.global&&(e!==De||t!==tt);i&&it();var s=new Be((function(t,s){Ve(o,new ze(dt(n,e,i),dt(r,e,i),t,s,e))}));return U&&Ge(s,this),s}return n.prototype=he,n},set:function(e){h(this,"then",e&&e.prototype===he?Le:{get:function(){return e},set:Le.set})}};function ze(e,t,n,r,o){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r,this.psd=o}function Fe(e,t){try{t((function(t){if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&Ke();t&&"function"==typeof t.then?Fe(e,(function(e,n){t instanceof Be?t._then(e,n):t.then(e,n)})):(e._state=!0,e._value=t,Ue(e)),n&&Ye()}}),Ne.bind(null,e))}catch(t){Ne(e,t)}}function Ne(e,t){if(Te.push(t),null===e._state){var n=e._lib&&Ke();t=je(t),e._state=!1,e._value=t,U&&null!==t&&"object"==typeof t&&!t._promise&&function(e,t,n){try{e.apply(null,n)}catch(e){t&&t(e)}}((function(){var n=function e(t,n){var r;return y(t,n)||(r=u(t))&&e(r,n)}(t,"stack");t._promise=e,h(t,"stack",{get:function(){return xe?n&&(n.get?n.get.apply(t):n.value):e.stack}})})),function(e){Se.some((function(t){return t._value===e._value}))||Se.push(e)}(e),Ue(e),n&&Ye()}}function Ue(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Ve(e,t[n]);var o=e._PSD;--o.ref||o.finalize(),0===Ie&&(++Ie,Oe((function(){0==--Ie&&Je()}),[]))}function Ve(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Ie,Oe(We,[n,e,t])}else e._listeners.push(t)}function We(e,t,n){try{Ee=t;var r,o=t._value;t._state?r=e(o):(Te.length&&(Te=[]),r=e(o),-1===Te.indexOf(o)&&function(e){var t=Se.length;for(;t;)if(Se[--t]._value===e._value)return void Se.splice(t,1)}(t)),n.resolve(r)}catch(e){n.reject(e)}finally{Ee=null,0==--Ie&&Je(),--n.psd.ref||n.psd.finalize()}}function Ge(e,t){var n=t?t._numPrev+1:0;n<100&&(e._prev=t,e._numPrev=n)}function qe(){Ke()&&Ye()}function Ke(){var e=Pe;return Pe=!1,Ce=!1,e}function Ye(){var e,t,n;do{for(;Ae.length>0;)for(e=Ae,Ae=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(Ae.length>0);Pe=!0,Ce=!0}function Je(){var e=Se;Se=[],e.forEach((function(e){e._PSD.onunhandled.call(null,e._value,e)}));for(var t=Re.slice(0),n=t.length;n;)t[--n]()}function He(e){return new Be(he,!1,e)}function Xe(e,t){var n=De;return function(){var r=Ke(),o=De;try{return ut(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{ut(o,!1),r&&Ye()}}}d(Be.prototype,{then:Le,_then:function(e,t){Ve(this,new ze(null,null,e,t,De))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"==typeof t?this.then(null,(function(e){return e instanceof t?n(e):He(e)})):this.then(null,(function(e){return e&&e.name===t?n(e):He(e)}))},finally:function(e){return this.then((function(t){return e(),t}),(function(t){return e(),He(t)}))},stack:{get:function(){if(this._stack)return this._stack;try{xe=!0;var e=function e(t,n,r){if(n.length===r)return n;var o="";if(!1===t._state){var i,s,a=t._value;null!=a?(i=a.name||"Error",s=a.message||a,o=K(a,0)):(i=a,s=""),n.push(i+(s?": "+s:"")+o)}U&&((o=K(t._stackHolder,2))&&-1===n.indexOf(o)&&n.push(o),t._prev&&e(t._prev,n,r));return n}(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=e),e}finally{xe=!1}}},timeout:function(e,t){var n=this;return e<1/0?new Be((function(r,o){var i=setTimeout((function(){return o(new ne.Timeout(t))}),e);n.then(r,o).finally(clearTimeout.bind(null,i))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&h(Be.prototype,Symbol.toStringTag,"Dexie.Promise"),Me.env=lt(),d(Be,{all:function(){var e=F.apply(null,arguments).map(st);return new Be((function(t,n){0===e.length&&t([]);var r=e.length;e.forEach((function(o,i){return Be.resolve(o).then((function(n){e[i]=n,--r||t(e)}),n)}))}))},resolve:function(e){if(e instanceof Be)return e;if(e&&"function"==typeof e.then)return new Be((function(t,n){e.then(t,n)}));var t=new Be(he,!0,e);return Ge(t,Ee),t},reject:He,race:function(){var e=F.apply(null,arguments).map(st);return new Be((function(t,n){e.map((function(e){return Be.resolve(e).then(t,n)}))}))},PSD:{get:function(){return De},set:function(e){return De=e}},newPSD:rt,usePSD:ft,scheduler:{get:function(){return Oe},set:function(e){Oe=e}},rejectionMapper:{get:function(){return je},set:function(e){je=e}},follow:function(e,t){return new Be((function(n,r){return rt((function(t,n){var r=De;r.unhandleds=[],r.onunhandled=n,r.finalize=ce((function(){var e=this;!function(e){Re.push((function t(){e(),Re.splice(Re.indexOf(t),1)})),++Ie,Oe((function(){0==--Ie&&Je()}),[])}((function(){0===e.unhandleds.length?t():n(e.unhandleds[0])}))}),r.finalize),e()}),t,n,r)}))}}),we&&(we.allSettled&&h(Be,"allSettled",(function(){var e=F.apply(null,arguments).map(st);return new Be((function(t){0===e.length&&t([]);var n=e.length,r=new Array(n);e.forEach((function(e,o){return Be.resolve(e).then((function(e){return r[o]={status:"fulfilled",value:e}}),(function(e){return r[o]={status:"rejected",reason:e}})).then((function(){return--n||t(r)}))}))}))})),we.any&&"undefined"!=typeof AggregateError&&h(Be,"any",(function(){var e=F.apply(null,arguments).map(st);return new Be((function(t,n){0===e.length&&n(new AggregateError([]));var r=e.length,o=new Array(r);e.forEach((function(e,i){return Be.resolve(e).then((function(e){return t(e)}),(function(e){o[i]=e,--r||n(new AggregateError(o))}))}))}))})));var $e={awaits:0,echoes:0,id:0},Ze=0,Qe=[],et=0,tt=0,nt=0;function rt(e,t,n,r){var o=De,i=Object.create(o);i.parent=o,i.ref=0,i.global=!1,i.id=++nt;var s=Me.env;i.env=_e?{Promise:Be,PromiseProp:{value:Be,configurable:!0,writable:!0},all:Be.all,race:Be.race,allSettled:Be.allSettled,any:Be.any,resolve:Be.resolve,reject:Be.reject,nthen:pt(s.nthen,i),gthen:pt(s.gthen,i)}:{},t&&c(i,t),++o.ref,i.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=ft(i,e,n,r);return 0===i.ref&&i.finalize(),a}function ot(){return $e.id||($e.id=++Ze),++$e.awaits,$e.echoes+=100,$e.id}function it(e){!$e.awaits||e&&e!==$e.id||(0==--$e.awaits&&($e.id=0),$e.echoes=100*$e.awaits)}function st(e){return $e.echoes&&e&&e.constructor===we?(ot(),e.then((function(e){return it(),e}),(function(e){return it(),mt(e)}))):e}function at(e){++tt,$e.echoes&&0!=--$e.echoes||($e.echoes=$e.id=0),Qe.push(De),ut(e,!0)}function ct(){var e=Qe[Qe.length-1];Qe.pop(),ut(e,!1)}function ut(e,t){var n,r=De;if((t?!$e.echoes||et++&&e===De:!et||--et&&e===De)||(n=t?at.bind(null,e):ct,be.call(ye,n)),e!==De&&(De=e,r===Me&&(Me.env=lt()),_e)){var o=Me.env.Promise,i=e.env;ve.then=i.nthen,o.prototype.then=i.gthen,(r.global||e.global)&&(Object.defineProperty(a,"Promise",i.PromiseProp),o.all=i.all,o.race=i.race,o.resolve=i.resolve,o.reject=i.reject,i.allSettled&&(o.allSettled=i.allSettled),i.any&&(o.any=i.any))}}function lt(){var e=a.Promise;return _e?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(a,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:ve.then,gthen:e.prototype.then}:{}}function ft(e,t,n,r,o){var i=De;try{return ut(e,!0),t(n,r,o)}finally{ut(i,!1)}}function dt(e,t,n){return"function"!=typeof e?e:function(){var r=De;n&&ot(),ut(t,!0);try{return e.apply(this,arguments)}finally{ut(r,!1)}}}function pt(e,t){return function(n,r){return e.call(this,dt(n,t,!1),dt(r,t,!1))}}-1===(""+be).indexOf("[native code]")&&(ot=it=ie);function ht(e,t){var n;try{n=t.onuncatched(e)}catch(e){}if(!1!==n)try{var r,o={promise:t,reason:e};if(a.document&&document.createEvent?((r=document.createEvent("Event")).initEvent("unhandledrejection",!0,!0),c(r,o)):a.CustomEvent&&c(r=new CustomEvent("unhandledrejection",{detail:o}),o),r&&a.dispatchEvent&&(dispatchEvent(r),!a.PromiseRejectionEvent&&a.onunhandledrejection))try{a.onunhandledrejection(r)}catch(e){}U&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(e.stack||e))}catch(e){}}var mt=Be.reject;var yt=String.fromCharCode(65535),vt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",gt=[],bt="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),wt=bt,_t=bt,xt=function(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)};function kt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Ot={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1},Pt=function(){function e(){}return e.prototype._trans=function(e,t,n){var r=this._tx||De.trans,o=this.name;function i(e,n,r){if(!r.schema[o])throw new ne.NotFound("Table "+o+" not part of transaction");return t(r.idbtrans,r)}var s=Ke();try{return r&&r.db===this.db?r===De.trans?r._promise(e,i,n):rt((function(){return r._promise(e,i,n)}),{trans:r,transless:De.transless||De}):function e(t,n,r,o){if(t._state.openComplete||De.letThrough){var i=t._createTransaction(n,r,t._dbSchema);try{i.create()}catch(e){return mt(e)}return i._promise(n,(function(e,t){return rt((function(){return De.trans=i,o(e,t,i)}))})).then((function(e){return i._completion.then((function(){return e}))}))}if(!t._state.isBeingOpened){if(!t._options.autoOpen)return mt(new ne.DatabaseClosed);t.open().catch(ie)}return t._state.dbReadyPromise.then((function(){return e(t,n,r,o)}))}(this.db,e,[this.name],i)}finally{s&&Ye()}},e.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):this._trans("readonly",(function(t){return n.core.get({trans:t,key:e}).then((function(e){return n.hook.reading.fire(e)}))})).then(t)},e.prototype.where=function(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(s(e))return new this.db.WhereClause(this,"["+e.join("+")+"]");var t=i(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter((function(e){return e.compound&&t.every((function(t){return e.keyPath.indexOf(t)>=0}))&&e.keyPath.every((function(e){return t.indexOf(e)>=0}))}))[0];if(n&&this.db._maxKey!==yt)return this.where(n.name).equals(n.keyPath.map((function(t){return e[t]})));!n&&U&&console.warn("The query "+JSON.stringify(e)+" on "+this.name+" would benefit of a compound index ["+t.join("+")+"]");var r=this.schema.idxByName,o=this.db._deps.indexedDB;function a(e,t){try{return 0===o.cmp(e,t)}catch(e){return!1}}var c=t.reduce((function(t,n){var o=t[0],i=t[1],c=r[n],u=e[n];return[o||c,o||!c?kt(i,c&&c.multi?function(e){var t=k(e,n);return s(t)&&t.some((function(e){return a(u,e)}))}:function(e){return a(u,k(e,n))}):i]}),[null,null]),u=c[0],l=c[1];return u?this.where(u.name).equals(e[u.keyPath]).filter(l):n?this.filter(l):this.where(t).equals("")},e.prototype.filter=function(e){return this.toCollection().and(e)},e.prototype.count=function(e){return this.toCollection().count(e)},e.prototype.offset=function(e){return this.toCollection().offset(e)},e.prototype.limit=function(e){return this.toCollection().limit(e)},e.prototype.each=function(e){return this.toCollection().each(e)},e.prototype.toArray=function(e){return this.toCollection().toArray(e)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,s(e)?"["+e.join("+")+"]":e))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(e){this.schema.mappedClass=e;var t=function(t){if(!t)return t;var n=Object.create(e.prototype);for(var r in t)if(f(t,r))try{n[r]=t[r]}catch(e){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=t,this.hook("reading",t),e},e.prototype.defineClass=function(){return this.mapToClass((function(e){c(this,e)}))},e.prototype.add=function(e,t){var n=this;return this._trans("readwrite",(function(r){return n.core.mutate({trans:r,type:"add",keys:null!=t?[t]:null,values:[e]})})).then((function(e){return e.numFailures?Be.reject(e.failures[0]):e.lastResult})).then((function(t){if(!n.core.schema.primaryKey.outbound)try{O(e,n.core.schema.primaryKey.keyPath,t)}catch(e){}return t}))},e.prototype.update=function(e,t){if("object"!=typeof t||s(t))throw new ne.InvalidArgument("Modifications must be an object.");if("object"!=typeof e||s(e))return this.where(":id").equals(e).modify(t);i(t).forEach((function(n){O(e,n,t[n])}));var n=k(e,this.schema.primKey.keyPath);return void 0===n?mt(new ne.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(t)},e.prototype.put=function(e,t){var n=this;return this._trans("readwrite",(function(r){return n.core.mutate({trans:r,type:"put",values:[e],keys:null!=t?[t]:null})})).then((function(e){return e.numFailures?Be.reject(e.failures[0]):e.lastResult})).then((function(t){if(!n.core.schema.primaryKey.outbound)try{O(e,n.core.schema.primaryKey.keyPath,t)}catch(e){}return t}))},e.prototype.delete=function(e){var t=this;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]})})).then((function(e){return e.numFailures?Be.reject(e.failures[0]):void 0}))},e.prototype.clear=function(){var e=this;return this._trans("readwrite",(function(t){return e.core.mutate({trans:t,type:"deleteRange",range:Ot})})).then((function(e){return e.numFailures?Be.reject(e.failures[0]):void 0}))},e.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",(function(n){return t.core.getMany({keys:e,trans:n}).then((function(e){return e.map((function(e){return t.hook.reading.fire(e)}))}))}))},e.prototype.bulkAdd=function(e,t,n){var r=this,o=Array.isArray(t)?t:void 0,i=(n=n||(o?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){if(!r.core.schema.primaryKey.outbound&&o)throw new ne.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new ne.InvalidArgument("Arguments objects and keys must have the same length");var n=e.length;return r.core.mutate({trans:t,type:"add",keys:o,values:e,wantResults:i}).then((function(e){var t=e.numFailures,o=e.results,s=e.lastResult,a=e.failures;if(0===t)return i?o:s;throw new Q(r.name+".bulkAdd(): "+t+" of "+n+" operations failed",Object.keys(a).map((function(e){return a[e]})))}))}))},e.prototype.bulkPut=function(e,t,n){var r=this,o=Array.isArray(t)?t:void 0,i=(n=n||(o?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){if(!r.core.schema.primaryKey.outbound&&o)throw new ne.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new ne.InvalidArgument("Arguments objects and keys must have the same length");var n=e.length;return r.core.mutate({trans:t,type:"put",keys:o,values:e,wantResults:i}).then((function(e){var t=e.numFailures,o=e.results,s=e.lastResult,a=e.failures;if(0===t)return i?o:s;throw new Q(r.name+".bulkPut(): "+t+" of "+n+" operations failed",Object.keys(a).map((function(e){return a[e]})))}))}))},e.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:e})})).then((function(e){var r=e.numFailures,o=e.lastResult,i=e.failures;if(0===r)return o;throw new Q(t.name+".bulkDelete(): "+r+" of "+n+" operations failed",i)}))},e}();function Ct(e){var t={},n=function(n,r){if(r){for(var o=arguments.length,i=new Array(o-1);--o;)i[o-1]=arguments[o];return t[n].subscribe.apply(null,i),e}if("string"==typeof n)return t[n]};n.addEventType=a;for(var r=1,o=arguments.length;r<o;++r)a(arguments[r]);return n;function a(e,r,o){if("object"==typeof e)return c(e);r||(r=de),o||(o=ie);var i={subscribers:[],fire:o,subscribe:function(e){-1===i.subscribers.indexOf(e)&&(i.subscribers.push(e),i.fire=r(i.fire,e))},unsubscribe:function(e){i.subscribers=i.subscribers.filter((function(t){return t!==e})),i.fire=i.subscribers.reduce(r,o)}};return t[e]=n[e]=i,i}function c(e){i(e).forEach((function(t){var n=e[t];if(s(n))a(t,e[t][0],e[t][1]);else{if("asap"!==n)throw new ne.InvalidArgument("Invalid event config");var r=a(t,se,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];r.subscribers.forEach((function(e){_((function(){e.apply(null,t)}))}))}))}}))}}function St(e,t){return m(t).from({prototype:e}),t}function Tt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Et(e,t){e.filter=kt(e.filter,t)}function jt(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return kt(r(),t())}:t,e.justLimit=n&&!r}function Mt(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new ne.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Dt(e,t,n){var r=Mt(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function At(e,t,n,r){var o=e.replayFilter?kt(e.filter,e.replayFilter()):e.filter;if(e.or){var i={},s=function(e,n,r){if(!o||o(n,r,(function(e){return n.stop(e)}),(function(e){return n.fail(e)}))){var s=n.primaryKey,a=""+s;"[object ArrayBuffer]"===a&&(a=""+new Uint8Array(s)),f(i,a)||(i[a]=!0,t(e,n,r))}};return Promise.all([e.or._iterate(s,n),It(Dt(e,r,n),e.algorithm,s,!e.keysOnly&&e.valueMapper)])}return It(Dt(e,r,n),kt(e.algorithm,o),t,!e.keysOnly&&e.valueMapper)}function It(e,t,n,r){var o=Xe(r?function(e,t,o){return n(r(e),t,o)}:n);return e.then((function(e){if(e)return e.start((function(){var n=function(){return e.continue()};t&&!t(e,(function(e){return n=e}),(function(t){e.stop(t),n=ie}),(function(t){e.fail(t),n=ie}))||o(e.value,e,(function(e){return n=e})),n()}))}))}var Rt=function(){function e(){}return e.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,mt.bind(null,n.error)):n.table._trans("readonly",e).then(t)},e.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,mt.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},e.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=kt(t.algorithm,e)},e.prototype._iterate=function(e,t){return At(this._ctx,e,t,this._ctx.table.core)},e.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&c(n,e),t._ctx=n,t},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(e){var t=this._ctx;return this._read((function(n){return At(t,e,n,t.table.core)}))},e.prototype.count=function(e){var t=this;return this._read((function(e){var n=t._ctx,r=n.table.core;if(Tt(n,!0))return r.count({trans:e,query:{index:Mt(n,r.schema),range:n.range}}).then((function(e){return Math.min(e,n.limit)}));var o=0;return At(n,(function(){return++o,!1}),e,r).then((function(){return o}))})).then(e)},e.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],o=n.length-1;function i(e,t){return t?i(e[n[t]],t-1):e[r]}var s="next"===this._ctx.dir?1:-1;function a(e,t){var n=i(e,o),r=i(t,o);return n<r?-s:n>r?s:0}return this.toArray((function(e){return e.sort(a)})).then(t)},e.prototype.toArray=function(e){var t=this;return this._read((function(e){var n=t._ctx;if("next"===n.dir&&Tt(n,!0)&&n.limit>0){var r=n.valueMapper,o=Mt(n,n.table.core.schema);return n.table.core.query({trans:e,limit:n.limit,values:!0,query:{index:o,range:n.range}}).then((function(e){var t=e.result;return r?t.map(r):t}))}var i=[];return At(n,(function(e){return i.push(e)}),e,n.table.core).then((function(){return i}))}),e)},e.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Tt(t)?jt(t,(function(){var t=e;return function(e,n){return 0===t||(1===t?(--t,!1):(n((function(){e.advance(t),t=0})),!1))}})):jt(t,(function(){var t=e;return function(){return--t<0}}))),this},e.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),jt(this._ctx,(function(){var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}}),!0),this},e.prototype.until=function(e,t){return Et(this._ctx,(function(n,r,o){return!e(n.value)||(r(o),t)})),this},e.prototype.first=function(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)},e.prototype.last=function(e){return this.reverse().first(e)},e.prototype.filter=function(e){var t,n;return Et(this._ctx,(function(t){return e(t.value)})),t=this._ctx,n=e,t.isMatch=kt(t.isMatch,n),this},e.prototype.and=function(e){return this.filter(e)},e.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},e.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.key,n)}))},e.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},e.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.primaryKey,n)}))},e.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.key)})).then((function(){return n})).then(e)},e.prototype.primaryKeys=function(e){var t=this._ctx;if("next"===t.dir&&Tt(t,!0)&&t.limit>0)return this._read((function(e){var n=Mt(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})})).then((function(e){return e.result})).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.primaryKey)})).then((function(){return n})).then(e)},e.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},e.prototype.firstKey=function(e){return this.limit(1).keys((function(e){return e[0]})).then(e)},e.prototype.lastKey=function(e){return this.reverse().firstKey(e)},e.prototype.distinct=function(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var n={};return Et(this._ctx,(function(e){var t=e.primaryKey.toString(),r=f(n,t);return n[t]=!0,!r})),this},e.prototype.modify=function(e){var t=this,n=this._ctx;return this._write((function(r){var o;if("function"==typeof e)o=e;else{var s=i(e),a=s.length;o=function(t){for(var n=!1,r=0;r<a;++r){var o=s[r],i=e[o];k(t,o)!==i&&(O(t,o,i),n=!0)}return n}}var c=n.table.core,u=c.schema.primaryKey,l=u.outbound,f=u.extractKey,d="testmode"in Cn?1:2e3,p=t.db.core.cmp,h=[],m=0,y=[],v=function(e,t){var n=t.failures,r=t.numFailures;m+=e-r;for(var o=0,s=i(n);o<s.length;o++){var a=s[o];h.push(n[a])}};return t.clone().primaryKeys().then((function(e){var t=function(n){var i=Math.min(d,e.length-n);return c.getMany({trans:r,keys:e.slice(n,n+i)}).then((function(s){for(var a=[],u=[],h=l?[]:null,m=[],y=0;y<i;++y){var g=s[y],b={value:M(g),primKey:e[n+y]};!1!==o.call(b,b.value,b)&&(null==b.value?m.push(e[n+y]):l||0===p(f(g),f(b.value))?(u.push(b.value),l&&h.push(e[n+y])):(m.push(e[n+y]),a.push(b.value)))}return Promise.resolve(a.length>0&&c.mutate({trans:r,type:"add",values:a}).then((function(e){for(var t in e.failures)m.splice(parseInt(t),1);v(a.length,e)}))).then((function(e){return u.length>0&&c.mutate({trans:r,type:"put",keys:h,values:u}).then((function(e){return v(u.length,e)}))})).then((function(){return m.length>0&&c.mutate({trans:r,type:"delete",keys:m}).then((function(e){return v(m.length,e)}))})).then((function(){return e.length>n+i&&t(n+d)}))}))};return t(0).then((function(){if(h.length>0)throw new Z("Error modifying one or more objects",h,m,y);return e.length}))}))}))},e.prototype.delete=function(){var e=this._ctx,t=e.range;return Tt(e)&&(e.isPrimKey&&!_t||3===t.type)?this._write((function(n){var r=e.table.core.schema.primaryKey,o=t;return e.table.core.count({trans:n,query:{index:r,range:o}}).then((function(t){return e.table.core.mutate({trans:n,type:"deleteRange",range:o}).then((function(e){var n=e.failures,r=(e.lastResult,e.results,e.numFailures);if(r)throw new Z("Could not delete some values",Object.keys(n).map((function(e){return n[e]})),t-r);return t-r}))}))})):this.modify((function(e,t){return t.value=null}))},e}();function Bt(e,t){return e<t?-1:e===t?0:1}function Lt(e,t){return e>t?-1:e===t?0:1}function zt(e,t,n){var r=e instanceof Gt?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function Ft(e){return new e.Collection(e,(function(){return Wt("")})).limit(0)}function Nt(e,t,n,r,o,i){for(var s=Math.min(e.length,r.length),a=-1,c=0;c<s;++c){var u=t[c];if(u!==r[c])return o(e[c],n[c])<0?e.substr(0,c)+n[c]+n.substr(c+1):o(e[c],r[c])<0?e.substr(0,c)+r[c]+n.substr(c+1):a>=0?e.substr(0,a)+t[a]+n.substr(a+1):null;o(e[c],u)<0&&(a=c)}return s<r.length&&"next"===i?e+n.substr(e.length):s<e.length&&"prev"===i?e.substr(0,n.length):a<0?null:e.substr(0,a)+r[a]+n.substr(a+1)}function Ut(e,t,n,r){var o,i,s,a,c,u,l,f=n.length;if(!n.every((function(e){return"string"==typeof e})))return zt(e,"String expected.");function d(e){o=function(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}(e),i=function(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}(e),s="next"===e?Bt:Lt;var t=n.map((function(e){return{lower:i(e),upper:o(e)}})).sort((function(e,t){return s(e.lower,t.lower)}));a=t.map((function(e){return e.upper})),c=t.map((function(e){return e.lower})),u=e,l="next"===e?"":r}d("next");var p=new e.Collection(e,(function(){return Vt(a[0],c[f-1]+r)}));p._ondirectionchange=function(e){d(e)};var h=0;return p._addAlgorithm((function(e,n,r){var o=e.key;if("string"!=typeof o)return!1;var d=i(o);if(t(d,c,h))return!0;for(var p=null,m=h;m<f;++m){var y=Nt(o,d,a[m],c[m],s,u);null===y&&null===p?h=m+1:(null===p||s(p,y)>0)&&(p=y)}return n(null!==p?function(){e.continue(p+l)}:r),!1})),p}function Vt(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function Wt(e){return{type:1,lower:e,upper:e}}var Gt=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!0,configurable:!0}),e.prototype.between=function(e,t,n,r){n=!1!==n,r=!0===r;try{return this._cmp(e,t)>0||0===this._cmp(e,t)&&(n||r)&&(!n||!r)?Ft(this):new this.Collection(this,(function(){return Vt(e,t,!n,!r)}))}catch(e){return zt(this,vt)}},e.prototype.equals=function(e){return new this.Collection(this,(function(){return Wt(e)}))},e.prototype.above=function(e){return null==e?zt(this,vt):new this.Collection(this,(function(){return Vt(e,void 0,!0)}))},e.prototype.aboveOrEqual=function(e){return null==e?zt(this,vt):new this.Collection(this,(function(){return Vt(e,void 0,!1)}))},e.prototype.below=function(e){return null==e?zt(this,vt):new this.Collection(this,(function(){return Vt(void 0,e,!1,!0)}))},e.prototype.belowOrEqual=function(e){return null==e?zt(this,vt):new this.Collection(this,(function(){return Vt(void 0,e)}))},e.prototype.startsWith=function(e){return"string"!=typeof e?zt(this,"String expected."):this.between(e,e+yt,!0,!0)},e.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):Ut(this,(function(e,t){return 0===e.indexOf(t[0])}),[e],yt)},e.prototype.equalsIgnoreCase=function(e){return Ut(this,(function(e,t){return e===t[0]}),[e],"")},e.prototype.anyOfIgnoreCase=function(){var e=F.apply(z,arguments);return 0===e.length?Ft(this):Ut(this,(function(e,t){return-1!==t.indexOf(e)}),e,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var e=F.apply(z,arguments);return 0===e.length?Ft(this):Ut(this,(function(e,t){return t.some((function(t){return 0===e.indexOf(t)}))}),e,yt)},e.prototype.anyOf=function(){var e=this,t=F.apply(z,arguments),n=this._cmp;try{t.sort(n)}catch(e){return zt(this,vt)}if(0===t.length)return Ft(this);var r=new this.Collection(this,(function(){return Vt(t[0],t[t.length-1])}));r._ondirectionchange=function(r){n="next"===r?e._ascending:e._descending,t.sort(n)};var o=0;return r._addAlgorithm((function(e,r,i){for(var s=e.key;n(s,t[o])>0;)if(++o===t.length)return r(i),!1;return 0===n(s,t[o])||(r((function(){e.continue(t[o])})),!1)})),r},e.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var e=F.apply(z,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return zt(this,vt)}var t=e.reduce((function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[-1/0,t]]}),null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(e,t){var n=this,r=this._cmp,o=this._ascending,i=this._descending,s=this._min,a=this._max;if(0===e.length)return Ft(this);if(!e.every((function(e){return void 0!==e[0]&&void 0!==e[1]&&o(e[0],e[1])<=0})))return zt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ne.InvalidArgument);var c=!t||!1!==t.includeLowers,u=t&&!0===t.includeUppers;var l,f=o;function d(e,t){return f(e[0],t[0])}try{(l=e.reduce((function(e,t){for(var n=0,o=e.length;n<o;++n){var i=e[n];if(r(t[0],i[1])<0&&r(t[1],i[0])>0){i[0]=s(i[0],t[0]),i[1]=a(i[1],t[1]);break}}return n===o&&e.push(t),e}),[])).sort(d)}catch(e){return zt(this,vt)}var p=0,h=u?function(e){return o(e,l[p][1])>0}:function(e){return o(e,l[p][1])>=0},m=c?function(e){return i(e,l[p][0])>0}:function(e){return i(e,l[p][0])>=0};var y=h,v=new this.Collection(this,(function(){return Vt(l[0][0],l[l.length-1][1],!c,!u)}));return v._ondirectionchange=function(e){"next"===e?(y=h,f=o):(y=m,f=i),l.sort(d)},v._addAlgorithm((function(e,t,r){for(var i=e.key;y(i);)if(++p===l.length)return t(r),!1;return!!function(e){return!h(e)&&!m(e)}(i)||(0===n._cmp(i,l[p][1])||0===n._cmp(i,l[p][0])||t((function(){f===o?e.continue(l[p][0]):e.continue(l[p][1])})),!1)})),v},e.prototype.startsWithAnyOf=function(){var e=F.apply(z,arguments);return e.every((function(e){return"string"==typeof e}))?0===e.length?Ft(this):this.inAnyRange(e.map((function(e){return[e,e+yt]}))):zt(this,"startsWithAnyOf() only works with strings")},e}();function qt(e){return 1===e.length?e[0]:e}function Kt(e){try{return e.only([[]]),[[]]}catch(e){return yt}}function Yt(e){return Xe((function(t){return Jt(t),e(t.target.error),!1}))}function Jt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Ht=function(){function e(){}return e.prototype._lock=function(){return w(!De.global),++this._reculock,1!==this._reculock||De.global||(De.lockOwnerFor=this),this},e.prototype._unlock=function(){if(w(!De.global),0==--this._reculock)for(De.global||(De.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{ft(e[1],e[0])}catch(e){}}return this},e.prototype._locked=function(){return this._reculock&&De.lockOwnerFor!==this},e.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(w(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new ne.DatabaseClosed(r);case"MissingAPIError":throw new ne.MissingAPI(r.message,r);default:throw new ne.OpenFailed(r)}if(!this.active)throw new ne.TransactionInactive;return w(null===this._completion._state),(e=this.idbtrans=e||n.transaction(qt(this.storeNames),this.mode)).onerror=Xe((function(n){Jt(n),t._reject(e.error)})),e.onabort=Xe((function(n){Jt(n),t.active&&t._reject(new ne.Abort(e.error)),t.active=!1,t.on("abort").fire(n)})),e.oncomplete=Xe((function(){t.active=!1,t._resolve()})),this},e.prototype._promise=function(e,t,n){var r=this;if("readwrite"===e&&"readwrite"!==this.mode)return mt(new ne.ReadOnly("Transaction is readonly"));if(!this.active)return mt(new ne.TransactionInactive);if(this._locked())return new Be((function(o,i){r._blockedFuncs.push([function(){r._promise(e,t,n).then(o,i)},De])}));if(n)return rt((function(){var e=new Be((function(e,n){r._lock();var o=t(e,n,r);o&&o.then&&o.then(e,n)}));return e.finally((function(){return r._unlock()})),e._lib=!0,e}));var o=new Be((function(e,n){var o=t(e,n,r);o&&o.then&&o.then(e,n)}));return o._lib=!0,o},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(e){var t=this._root(),n=Be.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then((function(){return n}));else{t._waitingFor=n,t._waitingQueue=[];var r=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(r.get(-1/0).onsuccess=e)}()}var o=t._waitingFor;return new Be((function(e,r){n.then((function(n){return t._waitingQueue.push(Xe(e.bind(null,n)))}),(function(e){return t._waitingQueue.push(Xe(r.bind(null,e)))})).finally((function(){t._waitingFor===o&&(t._waitingFor=null)}))}))},e.prototype.abort=function(){this.active&&this._reject(new ne.Abort),this.active=!1},e.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(f(t,e))return t[e];var n=this.schema[e];if(!n)throw new ne.NotFound("Table "+e+" not part of transaction");var r=new this.db.Table(e,n,this);return r.core=this.db.core.table(e),t[e]=r,r},e}();function Xt(e,t,n,r,o,i,s){return{name:e,keyPath:t,unique:n,multi:r,auto:o,compound:i,src:(n&&!s?"&":"")+(r?"*":"")+(o?"++":"")+$t(t)}}function $t(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function Zt(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:x(n,(function(e){return[e.name,e]}))}}function Qt(e){return null==e?function(){}:"string"==typeof e?function(e){return 1===e.split(".").length?function(t){return t[e]}:function(t){return k(t,e)}}(e):function(t){return k(t,e)}}function en(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}function tn(e){return[].slice.call(e)}var nn=0;function rn(e){return null==e?":id":"string"==typeof e?e:"["+e.join("+")+"]"}function on(e,t,n,r){var i=t.cmp.bind(t);function a(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var t=e.lower,r=e.upper,o=e.lowerOpen,i=e.upperOpen;return void 0===t?void 0===r?null:n.upperBound(r,!!i):void 0===r?n.lowerBound(t,!!o):n.bound(t,r,!!o,!!i)}var c=function(e,t){var n=tn(e.objectStoreNames);return{schema:{name:e.name,tables:n.map((function(e){return t.objectStore(e)})).map((function(e){var t=e.keyPath,n=e.autoIncrement,r=s(t),o=null==t,i={},a={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:o,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:Qt(t)},indexes:tn(e.indexNames).map((function(t){return e.index(t)})).map((function(e){var t=e.name,n=e.unique,r=e.multiEntry,o=e.keyPath,a={name:t,compound:s(o),keyPath:o,unique:n,multiEntry:r,extractKey:Qt(o)};return i[rn(o)]=a,a})),getIndexByKeyPath:function(e){return i[rn(e)]}};return i[":id"]=a.primaryKey,null!=t&&(i[rn(t)]=a.primaryKey),a}))},hasGetAll:n.length>0&&"getAll"in t.objectStore(n[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,r),u=c.schema,l=c.hasGetAll,f=u.tables.map((function(e){return function(e){var t=e.name;return{name:t,schema:e,mutate:function(n){var r=n.trans,i=n.type,s=n.keys,c=n.values,u=n.range,l=n.wantResults;return new Promise((function(n,f){n=Xe(n);var d=r.objectStore(t),p=null==d.keyPath,h="put"===i||"add"===i;if(!h&&"delete"!==i&&"deleteRange"!==i)throw new Error("Invalid operation type: "+i);var m=(s||c||{length:1}).length;if(s&&c&&s.length!==c.length)throw new Error("Given keys array must have same length as given values array.");if(0===m)return n({numFailures:0,failures:{},results:[],lastResult:void 0});var y,v=l&&o(s||en(e.primaryKey,{type:i,keys:s,values:c})),g=[],b=0,w=function(e){++b,Jt(e),v&&(v[e.target._reqno]=void 0),g[e.target._reqno]=e.target.error},_=function(e){var t=e.target;v[t._reqno]=t.result};if("deleteRange"===i){if(4===u.type)return n({numFailures:b,failures:g,results:v,lastResult:void 0});y=3===u.type?d.clear():d.delete(a(u))}else{var x=h?p?[c,s]:[c,null]:[s,null],k=x[0],O=x[1];if(h)for(var P=0;P<m;++P)(y=O&&void 0!==O[P]?d[i](k[P],O[P]):d[i](k[P]))._reqno=P,v&&void 0===v[P]&&(y.onsuccess=_),y.onerror=w;else for(P=0;P<m;++P)(y=d[i](k[P]))._reqno=P,y.onerror=w}var C=function(e){var t=e.target.result;v&&(v[m-1]=t),n({numFailures:b,failures:g,results:v,lastResult:t})};y.onerror=function(e){w(e),C(e)},y.onsuccess=C}))},getMany:function(e){var n=e.trans,r=e.keys;return new Promise((function(e,o){e=Xe(e);for(var i,s=n.objectStore(t),a=r.length,c=new Array(a),u=0,l=0,f=function(t){var n=t.target;null!=(c[n._pos]=n.result)&&0,++l===u&&e(c)},d=Yt(o),p=0;p<a;++p){null!=r[p]&&((i=s.get(r[p]))._pos=p,i.onsuccess=f,i.onerror=d,++u)}0===u&&e(c)}))},get:function(e){var n=e.trans,r=e.key;return new Promise((function(e,o){e=Xe(e);var i=n.objectStore(t).get(r);i.onsuccess=function(t){return e(t.target.result)},i.onerror=Yt(o)}))},query:function(e){return function(n){return new Promise((function(r,o){r=Xe(r);var i=n.trans,s=n.values,c=n.limit,u=n.query,l=c===1/0?void 0:c,f=u.index,d=u.range,p=i.objectStore(t),h=f.isPrimaryKey?p:p.index(f.name),m=a(d);if(0===c)return r({result:[]});if(e){var y=s?h.getAll(m,l):h.getAllKeys(m,l);y.onsuccess=function(e){return r({result:e.target.result})},y.onerror=Yt(o)}else{var v=0,g=s||!("openKeyCursor"in h)?h.openCursor(m):h.openKeyCursor(m),b=[];g.onsuccess=function(e){var t=g.result;return t?(b.push(s?t.value:t.primaryKey),++v===c?r({result:b}):void t.continue()):r({result:b})},g.onerror=Yt(o)}}))}}(l),openCursor:function(e){var n=e.trans,r=e.values,o=e.query,i=e.reverse,s=e.unique;return new Promise((function(e,c){e=Xe(e);var u=o.index,l=o.range,f=n.objectStore(t),d=u.isPrimaryKey?f:f.index(u.name),p=i?s?"prevunique":"prev":s?"nextunique":"next",h=r||!("openKeyCursor"in d)?d.openCursor(a(l),p):d.openKeyCursor(a(l),p);h.onerror=Yt(c),h.onsuccess=Xe((function(t){var r=h.result;if(r){r.___id=++nn,r.done=!1;var o=r.continue.bind(r),i=r.continuePrimaryKey;i&&(i=i.bind(r));var s=r.advance.bind(r),a=function(){throw new Error("Cursor not stopped")};r.trans=n,r.stop=r.continue=r.continuePrimaryKey=r.advance=function(){throw new Error("Cursor not started")},r.fail=Xe(c),r.next=function(){var e=this,t=1;return this.start((function(){return t--?e.continue():e.stop()})).then((function(){return e}))},r.start=function(e){var t=new Promise((function(e,t){e=Xe(e),h.onerror=Yt(t),r.fail=t,r.stop=function(t){r.stop=r.continue=r.continuePrimaryKey=r.advance=a,e(t)}})),n=function(){if(h.result)try{e()}catch(e){r.fail(e)}else r.done=!0,r.start=function(){throw new Error("Cursor behind last entry")},r.stop()};return h.onsuccess=Xe((function(e){h.onsuccess=n,n()})),r.continue=o,r.continuePrimaryKey=i,r.advance=s,n(),t},e(r)}else e(null)}),c)}))},count:function(e){var n=e.query,r=e.trans,o=n.index,i=n.range;return new Promise((function(e,n){var s=r.objectStore(t),c=o.isPrimaryKey?s:s.index(o.name),u=a(i),l=u?c.count(u):c.count();l.onsuccess=Xe((function(t){return e(t.target.result)})),l.onerror=Yt(n)}))}}}(e)})),d={};return f.forEach((function(e){return d[e.name]=e})),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!d[e])throw new Error("Table '"+e+"' not found");return d[e]},cmp:i,MIN_KEY:-1/0,MAX_KEY:Kt(n),schema:u}}function sn(e,t,n,o){var i=n.IDBKeyRange;return{dbcore:function(e,t){return t.reduce((function(e,t){var n=t.create;return r(r({},e),n(e))}),e)}(on(t,n.indexedDB,i,o),e.dbcore)}}function an(e,t){var n=t.db,r=sn(e._middlewares,n,e._deps,t);e.core=r.dbcore,e.tables.forEach((function(t){var n=t.name;e.core.schema.tables.some((function(e){return e.name===n}))&&(t.core=e.core.table(n),e[n]instanceof e.Table&&(e[n].core=t.core))}))}function cn(e,t,n,r){n.forEach((function(n){var o=r[n];t.forEach((function(t){n in t||(t===e.Transaction.prototype||t instanceof e.Transaction?h(t,n,{get:function(){return this.table(n)},set:function(e){p(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new e.Table(n,o))}))}))}function un(e,t){t.forEach((function(t){for(var n in t)t[n]instanceof e.Table&&delete t[n]}))}function ln(e,t){return e._cfg.version-t._cfg.version}function fn(e,t,n,r){var o=e._dbSchema,s=e._createTransaction("readwrite",e._storeNames,o);s.create(n),s._completion.catch(r);var a=s._reject.bind(s),c=De.transless||De;rt((function(){De.trans=s,De.transless=c,0===t?(i(o).forEach((function(e){dn(n,e,o[e].primKey,o[e].indexes)})),an(e,n),Be.follow((function(){return e.on.populate.fire(s)})).catch(a)):function(e,t,n,r){var o=[],s=e._versions,a=e._dbSchema=hn(e,e.idbdb,r),c=!1;function u(){return o.length?Be.resolve(o.shift()(n.idbtrans)).then(u):Be.resolve()}return s.filter((function(e){return e._cfg.version>=t})).forEach((function(s){o.push((function(){var o=a,u=s._cfg.dbschema;mn(e,o,r),mn(e,u,r),a=e._dbSchema=u;var l=function(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var o=e[n],i=t[n];if(o){var s={name:n,def:i,recreate:!1,del:[],add:[],change:[]};if(o.primKey.src===i.primKey.src||bt){var a=o.idxByName,c=i.idxByName,u=void 0;for(u in a)c[u]||s.del.push(u);for(u in c){var l=a[u],f=c[u];l?l.src!==f.src&&s.change.push(f):s.add.push(f)}(s.del.length>0||s.add.length>0||s.change.length>0)&&r.change.push(s)}else s.recreate=!0,r.change.push(s)}else r.add.push([n,i])}return r}(o,u);l.add.forEach((function(e){dn(r,e[0],e[1].primKey,e[1].indexes)})),l.change.forEach((function(e){if(e.recreate)throw new ne.Upgrade("Not yet support for changing primary key");var t=r.objectStore(e.name);e.add.forEach((function(e){return pn(t,e)})),e.change.forEach((function(e){t.deleteIndex(e.name),pn(t,e)})),e.del.forEach((function(e){return t.deleteIndex(e)}))}));var f=s._cfg.contentUpgrade;if(f&&s._cfg.version>t){an(e,r),c=!0;var d=P(u);l.del.forEach((function(e){d[e]=o[e]})),un(e,[e.Transaction.prototype]),cn(e,[e.Transaction.prototype],i(d),d),n.schema=d;var p,h=N(f);h&&ot();var m=Be.follow((function(){if((p=f(n))&&h){var e=it.bind(null,null);p.then(e,e)}}));return p&&"function"==typeof p.then?Be.resolve(p):m.then((function(){return p}))}})),o.push((function(t){c&&wt||function(e,t){for(var n=0;n<t.db.objectStoreNames.length;++n){var r=t.db.objectStoreNames[n];null==e[r]&&t.db.deleteObjectStore(r)}}(s._cfg.dbschema,t);un(e,[e.Transaction.prototype]),cn(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema}))})),u().then((function(){var e,t;t=r,i(e=a).forEach((function(n){t.db.objectStoreNames.contains(n)||dn(t,n,e[n].primKey,e[n].indexes)}))}))}(e,t,s,n).catch(a)}))}function dn(e,t,n,r){var o=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach((function(e){return pn(o,e)})),o}function pn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function hn(e,t,n){var r={};return g(t.objectStoreNames,0).forEach((function(e){for(var t=n.objectStore(e),o=t.keyPath,i=Xt($t(o),o||"",!1,!1,!!t.autoIncrement,o&&"string"!=typeof o,!0),s=[],a=0;a<t.indexNames.length;++a){var c=t.index(t.indexNames[a]);o=c.keyPath;var u=Xt(c.name,o,!!c.unique,!!c.multiEntry,!1,o&&"string"!=typeof o,!1);s.push(u)}r[e]=Zt(e,i,s)})),r}function mn(e,t,n){for(var r=n.db.objectStoreNames,o=0;o<r.length;++o){var i=r[o],s=n.objectStore(i);e._hasGetAll="getAll"in s;for(var c=0;c<s.indexNames.length;++c){var u=s.indexNames[c],l=s.index(u).keyPath,f="string"==typeof l?l:"["+g(l).join("+")+"]";if(t[i]){var d=t[i].idxByName[f];d&&(d.name=u,delete t[i].idxByName[f],t[i].idxByName[u]=d)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&a.WorkerGlobalScope&&a instanceof a.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}var yn,vn=function(){function e(){}return e.prototype._parseStoresSpec=function(e,t){i(e).forEach((function(n){if(null!==e[n]){var r=e[n].split(",").map((function(e,t){var n=(e=e.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return Xt(n,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),s(r),0===t)})),o=r.shift();if(o.multi)throw new ne.Schema("Primary key cannot be multi-valued");r.forEach((function(e){if(e.auto)throw new ne.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new ne.Schema("Index must have a name and cannot be an empty string")})),t[n]=Zt(n,o,r)}}))},e.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?c(this._cfg.storesSource,e):e;var n=t._versions,r={},o={};return n.forEach((function(e){c(r,e._cfg.storesSource),o=e._cfg.dbschema={},e._parseStoresSpec(r,o)})),t._dbSchema=o,un(t,[t._allTables,t,t.Transaction.prototype]),cn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],i(o),o),t._storeNames=i(o),this},e.prototype.upgrade=function(e){return this._cfg.contentUpgrade=e,this},e}();function gn(e){return rt((function(){return De.letThrough=!0,e()}))}function bn(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then((function(){return t.dbOpenError?mt(t.dbOpenError):e}));U&&(t.openCanceller._stackHolder=q()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.dbReadyResolve,o=null;return Be.race([t.openCanceller,new Be((function(r,s){if(!n)throw new ne.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var a=e.name,c=t.autoSchema?n.open(a):n.open(a,Math.round(10*e.verno));if(!c)throw new ne.MissingAPI("IndexedDB API not available");c.onerror=Yt(s),c.onblocked=Xe(e._fireOnBlocked),c.onupgradeneeded=Xe((function(r){if(o=c.transaction,t.autoSchema&&!e._options.allowEmptyDB){c.onerror=Jt,o.abort(),c.result.close();var i=n.deleteDatabase(a);i.onsuccess=i.onerror=Xe((function(){s(new ne.NoSuchDatabase("Database "+a+" doesnt exist"))}))}else{o.onerror=Yt(s);var u=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;e.idbdb=c.result,fn(e,u/10,o,s)}}),s),c.onsuccess=Xe((function(){o=null;var n=e.idbdb=c.result,s=g(n.objectStoreNames);if(s.length>0)try{var u=n.transaction(qt(s),"readonly");t.autoSchema?function(e,t,n){e.verno=t.version/10;var r=e._dbSchema=hn(0,t,n);e._storeNames=g(t.objectStoreNames,0),cn(e,[e._allTables],i(r),r)}(e,n,u):mn(e,e._dbSchema,u),an(e,u)}catch(e){}gt.push(e),n.onversionchange=Xe((function(n){t.vcFired=!0,e.on("versionchange").fire(n)})),yn.add(a),r()}),s)}))]).then((function(){return t.onReadyBeingFired=[],Be.resolve(gn(e.on.ready.fire)).then((function e(){if(t.onReadyBeingFired.length>0){var n=t.onReadyBeingFired.reduce(pe,ie);return t.onReadyBeingFired=[],Be.resolve(gn(n)).then(e)}}))})).finally((function(){t.onReadyBeingFired=null})).then((function(){return t.isBeingOpened=!1,e})).catch((function(n){try{o&&o.abort()}catch(e){}return t.isBeingOpened=!1,e.close(),t.dbOpenError=n,mt(t.dbOpenError)})).finally((function(){t.openComplete=!0,r()}))}function wn(e){var t=function(t){return e.next(t)},n=o(t),r=o((function(t){return e.throw(t)}));function o(e){return function(t){var o=e(t),i=o.value;return o.done?i:i&&"function"==typeof i.then?i.then(n,r):s(i)?Promise.all(i).then(n,r):n(i)}}return o(t)()}function _n(e,t,n){var r=arguments.length;if(r<2)throw new ne.InvalidArgument("Too few arguments");for(var o=new Array(r-1);--r;)o[r-1]=arguments[r];n=o.pop();var i=S(o);return[e,i,n]}function xn(e,t,n,r,o){return Be.resolve().then((function(){var i=De.transless||De,s=e._createTransaction(t,n,e._dbSchema,r),a={trans:s,transless:i};r?s.idbtrans=r.idbtrans:s.create();var c,u=N(o);u&&ot();var l=Be.follow((function(){if(c=o.call(s,s))if(u){var e=it.bind(null,null);c.then(e,e)}else"function"==typeof c.next&&"function"==typeof c.throw&&(c=wn(c))}),a);return(c&&"function"==typeof c.then?Be.resolve(c).then((function(e){return s.active?e:mt(new ne.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):l.then((function(){return c}))).then((function(e){return r&&s._resolve(),s._completion.then((function(){return e}))})).catch((function(e){return s._reject(e),mt(e)}))}))}function kn(e,t,n){for(var r=s(e)?e.slice():[e],o=0;o<n;++o)r.push(t);return r}var On={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return r(r({},e),{table:function(t){var n=e.table(t),o=n.schema,i={},s=[];function a(e,t,n){var o=rn(e),c=i[o]=i[o]||[],u=null==e?0:"string"==typeof e?1:e.length,l=t>0,f=r(r({},n),{isVirtual:l,isPrimaryKey:!l&&n.isPrimaryKey,keyTail:t,keyLength:u,extractKey:Qt(e),unique:!l&&n.unique});(c.push(f),f.isPrimaryKey||s.push(f),u>1)&&a(2===u?e[0]:e.slice(0,u-1),t+1,n);return c.sort((function(e,t){return e.keyTail-t.keyTail})),f}var c=a(o.primaryKey.keyPath,0,o.primaryKey);i[":id"]=[c];for(var u=0,l=o.indexes;u<l.length;u++){var f=l[u];a(f.keyPath,0,f)}function d(t){var n,o,i=t.query.index;return i.isVirtual?r(r({},t),{query:{index:i,range:(n=t.query.range,o=i.keyTail,{type:1===n.type?2:n.type,lower:kn(n.lower,n.lowerOpen?e.MAX_KEY:e.MIN_KEY,o),lowerOpen:!0,upper:kn(n.upper,n.upperOpen?e.MIN_KEY:e.MAX_KEY,o),upperOpen:!0})}}):t}return r(r({},n),{schema:r(r({},o),{primaryKey:c,indexes:s,getIndexByKeyPath:function(e){var t=i[rn(e)];return t&&t[0]}}),count:function(e){return n.count(d(e))},query:function(e){return n.query(d(e))},openCursor:function(t){var r=t.query.index,o=r.keyTail,i=r.isVirtual,s=r.keyLength;if(!i)return n.openCursor(t);return n.openCursor(d(t)).then((function(n){return n&&function(n){return Object.create(n,{continue:{value:function(r){null!=r?n.continue(kn(r,t.reverse?e.MAX_KEY:e.MIN_KEY,o)):t.unique?n.continue(kn(n.key,t.reverse?e.MIN_KEY:e.MAX_KEY,o)):n.continue()}},continuePrimaryKey:{value:function(t,r){n.continuePrimaryKey(kn(t,e.MAX_KEY,o),r)}},key:{get:function(){var e=n.key;return 1===s?e[0]:e.slice(0,s)}},value:{get:function(){return n.value}}})}(n)}))}})}})}},Pn={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return r(r({},e),{table:function(t){var n=e.table(t),i=n.schema.primaryKey;return r(r({},n),{mutate:function(e){var s=De.trans,a=s.table(t).hook,c=a.deleting,u=a.creating,l=a.updating;switch(e.type){case"add":if(u.fire===ie)break;return s._promise("readwrite",(function(){return f(e)}),!0);case"put":if(u.fire===ie&&l.fire===ie)break;return s._promise("readwrite",(function(){return f(e)}),!0);case"delete":if(c.fire===ie)break;return s._promise("readwrite",(function(){return f(e)}),!0);case"deleteRange":if(c.fire===ie)break;return s._promise("readwrite",(function(){return function(e){return function e(t,o,s){return n.query({trans:t,values:!1,query:{index:i,range:o},limit:s}).then((function(n){var i=n.result;return f({type:"delete",keys:i,trans:t}).then((function(n){return n.numFailures>0?Promise.reject(n.failures[0]):i.length<s?{failures:[],numFailures:0,lastResult:void 0}:e(t,r(r({},o),{lower:i[i.length-1],lowerOpen:!0}),s)}))}))}(e.trans,e.range,1e4)}(e)}),!0)}return n.mutate(e);function f(e){var t=De.trans,s=e.keys||en(i,e);if(!s)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?r(r({},e),{keys:s,wantResults:!0}):r({},e)).type&&(e.values=o(e.values)),e.keys&&(e.keys=o(e.keys)),function(e,t,n){return"add"===t.type?Promise.resolve(new Array(t.values.length)):e.getMany({trans:t.trans,keys:n})}(n,e,s).then((function(r){var o=s.map((function(n,o){var s=r[o],a={onerror:null,onsuccess:null};if("delete"===e.type)c.fire.call(a,n,s,t);else if("add"===e.type||void 0===s){var f=u.fire.call(a,n,e.values[o],t);null==n&&null!=f&&(n=f,e.keys[o]=n,i.outbound||O(e.values[o],i.keyPath,n))}else{var d=R(s,e.values[o]),p=l.fire.call(a,d,n,s,t);if(p){var h=e.values[o];Object.keys(p).forEach((function(e){O(h,e,p[e])}))}}return a}));return n.mutate(e).then((function(t){for(var n=t.failures,i=t.results,a=t.numFailures,c=t.lastResult,u=0;u<s.length;++u){var l=i?i[u]:s[u],f=o[u];null==l?f.onerror&&f.onerror(n[u]):f.onsuccess&&f.onsuccess("put"===e.type&&r[u]?e.values[u]:l)}return{failures:n,results:i,numFailures:a,lastResult:c}})).catch((function(e){return o.forEach((function(t){return t.onerror&&t.onerror(e)})),Promise.reject(e)}))}))}}})}})}},Cn=function(){function e(t,n){var o=this;this._middlewares={},this.verno=0;var i=e.dependencies;this._options=n=r({addons:e.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var s=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null;var a={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ie,dbReadyPromise:null,cancelOpen:ie,openCanceller:null,autoSchema:!0};a.dbReadyPromise=new Be((function(e){a.dbReadyResolve=e})),a.openCanceller=new Be((function(e,t){a.cancelOpen=t})),this._state=a,this.name=t,this.on=Ct(this,"populate","blocked","versionchange",{ready:[pe,ie]}),this.on.ready.subscribe=b(this.on.ready.subscribe,(function(t){return function(n,r){e.vip((function(){var e=o._state;if(e.openComplete)e.dbOpenError||Be.resolve().then(n),r&&t(n);else if(e.onReadyBeingFired)e.onReadyBeingFired.push(n),r&&t(n);else{t(n);var i=o;r||t((function e(){i.on.ready.unsubscribe(n),i.on.ready.unsubscribe(e)}))}}))}})),this.Collection=function(e){return St(Rt.prototype,(function(t,n){this.db=e;var r=Ot,o=null;if(n)try{r=n()}catch(e){o=e}var i=t._ctx,s=i.table,a=s.hook.reading.fire;this._ctx={table:s,index:i.index,isPrimKey:!i.index||s.schema.primKey.keyPath&&i.index===s.schema.primKey.name,range:r,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:o,or:i.or,valueMapper:a!==se?a:null}}))}(this),this.Table=function(e){return St(Pt.prototype,(function(t,n,r){this.db=e,this._tx=r,this.name=t,this.schema=n,this.hook=e._allTables[t]?e._allTables[t].hook:Ct(null,{creating:[ue,ie],reading:[ae,se],updating:[fe,ie],deleting:[le,ie]})}))}(this),this.Transaction=function(e){return St(Ht.prototype,(function(t,n,r,o){var i=this;this.db=e,this.mode=t,this.storeNames=n,this.schema=r,this.idbtrans=null,this.on=Ct(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Be((function(e,t){i._resolve=e,i._reject=t})),this._completion.then((function(){i.active=!1,i.on.complete.fire()}),(function(e){var t=i.active;return i.active=!1,i.on.error.fire(e),i.parent?i.parent._reject(e):t&&i.idbtrans&&i.idbtrans.abort(),mt(e)}))}))}(this),this.Version=function(e){return St(vn.prototype,(function(t){this.db=e,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}(this),this.WhereClause=function(e){return St(Gt.prototype,(function(t,n,r){this.db=e,this._ctx={table:t,index:":id"===n?null:n,or:r};var o=e._deps.indexedDB;if(!o)throw new ne.MissingAPI("indexedDB API missing");this._cmp=this._ascending=o.cmp.bind(o),this._descending=function(e,t){return o.cmp(t,e)},this._max=function(e,t){return o.cmp(e,t)>0?e:t},this._min=function(e,t){return o.cmp(e,t)<0?e:t},this._IDBKeyRange=e._deps.IDBKeyRange}))}(this),this.on("versionchange",(function(e){e.newVersion>0?console.warn("Another connection wants to upgrade database '"+o.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+o.name+"'. Closing db now to resume the delete request."),o.close()})),this.on("blocked",(function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('"+o.name+"') was blocked"):console.warn("Upgrade '"+o.name+"' blocked by other connection holding version "+e.oldVersion/10)})),this._maxKey=Kt(n.IDBKeyRange),this._createTransaction=function(e,t,n,r){return new o.Transaction(e,t,n,r)},this._fireOnBlocked=function(e){o.on("blocked").fire(e),gt.filter((function(e){return e.name===o.name&&e!==o&&!e._state.vcFired})).map((function(t){return t.on("versionchange").fire(e)}))},this.use(On),this.use(Pn),s.forEach((function(e){return e(o)}))}return e.prototype.version=function(e){if(isNaN(e)||e<.1)throw new ne.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new ne.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter((function(t){return t._cfg.version===e}))[0];return n||(n=new this.Version(e),t.push(n),t.sort(ln),n.stores({}),this._state.autoSchema=!1,n)},e.prototype._whenReady=function(e){var t=this;return this._state.openComplete||De.letThrough?e():new Be((function(e,n){if(!t._state.isBeingOpened){if(!t._options.autoOpen)return void n(new ne.DatabaseClosed);t.open().catch(ie)}t._state.dbReadyPromise.then(e,n)})).then(e)},e.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,o=e.name;o&&this.unuse({stack:t,name:o});var i=this._middlewares[t]||(this._middlewares[t]=[]);return i.push({stack:t,create:n,level:null==r?10:r,name:o}),i.sort((function(e,t){return e.level-t.level})),this},e.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter((function(e){return r?e.create!==r:!!n&&e.name!==n}))),this},e.prototype.open=function(){return bn(this)},e.prototype.close=function(){var e=gt.indexOf(this),t=this._state;if(e>=0&&gt.splice(e,1),this.idbdb){try{this.idbdb.close()}catch(e){}this.idbdb=null}this._options.autoOpen=!1,t.dbOpenError=new ne.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError),t.dbReadyPromise=new Be((function(e){t.dbReadyResolve=e})),t.openCanceller=new Be((function(e,n){t.cancelOpen=n}))},e.prototype.delete=function(){var e=this,t=arguments.length>0,n=this._state;return new Be((function(r,o){var i=function(){e.close();var t=e._deps.indexedDB.deleteDatabase(e.name);t.onsuccess=Xe((function(){yn.remove(e.name),r()})),t.onerror=Yt(o),t.onblocked=e._fireOnBlocked};if(t)throw new ne.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(i):i()}))},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return null!==this.idbdb},e.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},e.prototype.hasFailed=function(){return null!==this._state.dbOpenError},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var e=this;return i(this._allTables).map((function(t){return e._allTables[t]}))},enumerable:!0,configurable:!0}),e.prototype.transaction=function(){var e=_n.apply(this,arguments);return this._transaction.apply(this,e)},e.prototype._transaction=function(e,t,n){var r=this,o=De.trans;o&&o.db===this&&-1===e.indexOf("!")||(o=null);var i,s,a=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(s=t.map((function(e){var t=e instanceof r.Table?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t})),"r"==e||"readonly"===e)i="readonly";else{if("rw"!=e&&"readwrite"!=e)throw new ne.InvalidArgument("Invalid transaction mode: "+e);i="readwrite"}if(o){if("readonly"===o.mode&&"readwrite"===i){if(!a)throw new ne.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o=null}o&&s.forEach((function(e){if(o&&-1===o.storeNames.indexOf(e)){if(!a)throw new ne.SubTransaction("Table "+e+" not included in parent transaction.");o=null}})),a&&o&&!o.active&&(o=null)}}catch(e){return o?o._promise(null,(function(t,n){n(e)})):mt(e)}var c=xn.bind(null,this,i,s,o,n);return o?o._promise(i,c,"lock"):De.trans?ft(De.transless,(function(){return r._whenReady(c)})):this._whenReady(c)},e.prototype.table=function(e){if(!f(this._allTables,e))throw new ne.InvalidTable("Table "+e+" does not exist");return this._allTables[e]},e}(),Sn=Cn;d(Sn,r(r({},oe),{delete:function(e){return new Sn(e).delete()},exists:function(e){return new Sn(e,{addons:[]}).open().then((function(e){return e.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(e){return yn?yn.getDatabaseNames().then(e):Be.resolve([])},defineClass:function(){return function(e){c(this,e)}},ignoreTransaction:function(e){return De.trans?ft(De.transless,e):e()},vip:gn,async:function(e){return function(){try{var t=wn(e.apply(this,arguments));return t&&"function"==typeof t.then?t:Be.resolve(t)}catch(e){return mt(e)}}},spawn:function(e,t,n){try{var r=wn(e.apply(n,t||[]));return r&&"function"==typeof r.then?r:Be.resolve(r)}catch(e){return mt(e)}},currentTransaction:{get:function(){return De.trans||null}},waitFor:function(e,t){var n=Be.resolve("function"==typeof e?Sn.ignoreTransaction(e):e).timeout(t||6e4);return De.trans?De.trans.waitFor(n):n},Promise:Be,debug:{get:function(){return U},set:function(e){V(e,"dexie"===e?function(){return!0}:xt)}},derive:m,extend:c,props:d,override:b,Events:Ct,getByKeyPath:k,setByKeyPath:O,delByKeyPath:function(e,t){"string"==typeof t?O(e,t,void 0):"length"in t&&[].map.call(t,(function(t){O(e,t,void 0)}))},shallowClone:P,deepClone:M,getObjectDiff:R,asap:_,minKey:-1/0,addons:[],connections:gt,errnames:ee,dependencies:function(){try{return{indexedDB:a.indexedDB||a.mozIndexedDB||a.webkitIndexedDB||a.msIndexedDB,IDBKeyRange:a.IDBKeyRange||a.webkitIDBKeyRange}}catch(e){return{indexedDB:null,IDBKeyRange:null}}}(),semVer:"3.0.2",version:"3.0.2".split(".").map((function(e){return parseInt(e)})).reduce((function(e,t,n){return e+t/Math.pow(10,2*n)})),default:Sn,Dexie:Sn})),Sn.maxKey=Kt(Sn.dependencies.IDBKeyRange),function(e){try{yn=function(e){var t,n=e&&"function"==typeof e.databases;if(!n){var r=new Cn("__dbnames",{addons:[]});r.version(1).stores({dbnames:"name"}),t=r.table("dbnames")}return{getDatabaseNames:function(){return n?Be.resolve(e.databases()).then((function(e){return e.map((function(e){return e.name})).filter((function(e){return"__dbnames"!==e}))})):t.toCollection().primaryKeys()},add:function(e){return!n&&"__dbnames"!==e&&t.put({name:e}).catch(ie)},remove:function(e){return!n&&"__dbnames"!==e&&t.delete(e).catch(ie)}}}(e)}catch(e){}}(Cn.dependencies.indexedDB),Be.rejectionMapper=function(e,t){if(!e||e instanceof X||e instanceof TypeError||e instanceof SyntaxError||!e.name||!re[e.name])return e;var n=new re[e.name](t||e.message,e);return"stack"in e&&h(n,"stack",{get:function(){return this.inner.stack}}),n},V(U,xt);var Tn=Cn;const En=new class extends Tn{constructor(){super("voxelsrv-storage"),this.version(1).stores({main:"name, data",resources:"name, data, active",worlds:"name, data, settings, lastplay"})}};async function jn(){const e=(await En.main.where("name").equals("settings").toArray())[0];return console.log(e),null!=e?e.data:{}}async function Mn(e){En.main.put({name:"settings",data:e})}},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var c,u=[],l=!1,f=-1;function d(){l&&c&&(l=!1,c.length?u=c.concat(u):f=-1,u.length&&p())}function p(){if(!l){var e=a(d);l=!0;for(var t=u.length;t;){for(c=u,u=[];++f<t;)c&&c[f].run();f=-1,t=u.length}c=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new h(e,t)),1!==u.length||l||a(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},,,,,,,function(e,t,n){e.exports=o;var r=n(78);function o(e,t){if(!(this instanceof o))return new o(e,t);var n=r.create();r.add(n,e,t),this.base=r.min(r.create(),e,n),this.vec=r.clone(t),this.max=r.max(r.create(),e,n),this.mag=r.length(this.vec)}var i=o.prototype;i.width=function(){return this.vec[0]},i.height=function(){return this.vec[1]},i.depth=function(){return this.vec[2]},i.x0=function(){return this.base[0]},i.y0=function(){return this.base[1]},i.z0=function(){return this.base[2]},i.x1=function(){return this.max[0]},i.y1=function(){return this.max[1]},i.z1=function(){return this.max[2]},i.translate=function(e){return r.add(this.max,this.max,e),r.add(this.base,this.base,e),this},i.setPosition=function(e){return r.add(this.max,e,this.vec),r.copy(this.base,e),this},i.expand=function(e){var t=r.create(),n=r.create();return r.max(t,e.max,this.max),r.min(n,e.base,this.base),r.subtract(t,t,n),new o(n,t)},i.intersects=function(e){return!(e.base[0]>this.max[0])&&(!(e.base[1]>this.max[1])&&(!(e.base[2]>this.max[2])&&(!(e.max[0]<this.base[0])&&(!(e.max[1]<this.base[1])&&!(e.max[2]<this.base[2])))))},i.touches=function(e){var t=this.union(e);return null!==t&&(0==t.width()||0==t.height()||0==t.depth())},i.union=function(e){if(!this.intersects(e))return null;var t=Math.max(e.base[0],this.base[0]),n=Math.max(e.base[1],this.base[1]),r=Math.max(e.base[2],this.base[2]);return new o([t,n,r],[Math.min(e.max[0],this.max[0])-t,Math.min(e.max[1],this.max[1])-n,Math.min(e.max[2],this.max[2])-r])}},function(e,t,n){"use strict";(function(e){var r=n(233),o=n(339),i=n(340).Buffer;e.__TYPEDARRAY_POOL||(e.__TYPEDARRAY_POOL={UINT8:o([32,0]),UINT16:o([32,0]),UINT32:o([32,0]),BIGUINT64:o([32,0]),INT8:o([32,0]),INT16:o([32,0]),INT32:o([32,0]),BIGINT64:o([32,0]),FLOAT:o([32,0]),DOUBLE:o([32,0]),DATA:o([32,0]),UINT8C:o([32,0]),BUFFER:o([32,0])});var s="undefined"!=typeof Uint8ClampedArray,a="undefined"!=typeof BigUint64Array,c="undefined"!=typeof BigInt64Array,u=e.__TYPEDARRAY_POOL;u.UINT8C||(u.UINT8C=o([32,0])),u.BIGUINT64||(u.BIGUINT64=o([32,0])),u.BIGINT64||(u.BIGINT64=o([32,0])),u.BUFFER||(u.BUFFER=o([32,0]));var l=u.DATA,f=u.BUFFER;function d(e){if(e){var t=e.length||e.byteLength,n=r.log2(t);l[n].push(e)}}function p(e){e=r.nextPow2(e);var t=r.log2(e),n=l[t];return n.length>0?n.pop():new ArrayBuffer(e)}function h(e){return new Uint8Array(p(e),0,e)}function m(e){return new Uint16Array(p(2*e),0,e)}function y(e){return new Uint32Array(p(4*e),0,e)}function v(e){return new Int8Array(p(e),0,e)}function g(e){return new Int16Array(p(2*e),0,e)}function b(e){return new Int32Array(p(4*e),0,e)}function w(e){return new Float32Array(p(4*e),0,e)}function _(e){return new Float64Array(p(8*e),0,e)}function x(e){return s?new Uint8ClampedArray(p(e),0,e):h(e)}function k(e){return a?new BigUint64Array(p(8*e),0,e):null}function O(e){return c?new BigInt64Array(p(8*e),0,e):null}function P(e){return new DataView(p(e),0,e)}function C(e){e=r.nextPow2(e);var t=r.log2(e),n=f[t];return n.length>0?n.pop():new i(e)}t.free=function(e){if(i.isBuffer(e))f[r.log2(e.length)].push(e);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(e)&&(e=e.buffer),!e)return;var t=e.length||e.byteLength,n=0|r.log2(t);l[n].push(e)}},t.freeUint8=t.freeUint16=t.freeUint32=t.freeBigUint64=t.freeInt8=t.freeInt16=t.freeInt32=t.freeBigInt64=t.freeFloat32=t.freeFloat=t.freeFloat64=t.freeDouble=t.freeUint8Clamped=t.freeDataView=function(e){d(e.buffer)},t.freeArrayBuffer=d,t.freeBuffer=function(e){f[r.log2(e.length)].push(e)},t.malloc=function(e,t){if(void 0===t||"arraybuffer"===t)return p(e);switch(t){case"uint8":return h(e);case"uint16":return m(e);case"uint32":return y(e);case"int8":return v(e);case"int16":return g(e);case"int32":return b(e);case"float":case"float32":return w(e);case"double":case"float64":return _(e);case"uint8_clamped":return x(e);case"bigint64":return O(e);case"biguint64":return k(e);case"buffer":return C(e);case"data":case"dataview":return P(e);default:return null}return null},t.mallocArrayBuffer=p,t.mallocUint8=h,t.mallocUint16=m,t.mallocUint32=y,t.mallocInt8=v,t.mallocInt16=g,t.mallocInt32=b,t.mallocFloat32=t.mallocFloat=w,t.mallocFloat64=t.mallocDouble=_,t.mallocUint8Clamped=x,t.mallocBigUint64=k,t.mallocBigInt64=O,t.mallocDataView=P,t.mallocBuffer=C,t.clearCache=function(){for(var e=0;e<32;++e)u.UINT8[e].length=0,u.UINT16[e].length=0,u.UINT32[e].length=0,u.INT8[e].length=0,u.INT16[e].length=0,u.INT32[e].length=0,u.FLOAT[e].length=0,u.DOUBLE[e].length=0,u.BIGUINT64[e].length=0,u.BIGINT64[e].length=0,u.UINT8C[e].length=0,l[e].length=0,f[e].length=0}}).call(this,n(168))},function(e,t,n){"use strict";function r(e){var t=32;return(e&=-e)&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t}t.INT_BITS=32,t.INT_MAX=2147483647,t.INT_MIN=-1<<31,t.sign=function(e){return(e>0)-(e<0)},t.abs=function(e){var t=e>>31;return(e^t)-t},t.min=function(e,t){return t^(e^t)&-(e<t)},t.max=function(e,t){return e^(e^t)&-(e<t)},t.isPow2=function(e){return!(e&e-1||!e)},t.log2=function(e){var t,n;return t=(e>65535)<<4,t|=n=((e>>>=t)>255)<<3,t|=n=((e>>>=n)>15)<<2,(t|=n=((e>>>=n)>3)<<1)|(e>>>=n)>>1},t.log10=function(e){return e>=1e9?9:e>=1e8?8:e>=1e7?7:e>=1e6?6:e>=1e5?5:e>=1e4?4:e>=1e3?3:e>=100?2:e>=10?1:0},t.popCount=function(e){return 16843009*((e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)>>>24},t.countTrailingZeros=r,t.nextPow2=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)+1},t.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)-(e>>>1)},t.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,27030>>>(e&=15)&1};var o=new Array(256);!function(e){for(var t=0;t<256;++t){var n=t,r=t,o=7;for(n>>>=1;n;n>>>=1)r<<=1,r|=1&n,--o;e[t]=r<<o&255}}(o),t.reverse=function(e){return o[255&e]<<24|o[e>>>8&255]<<16|o[e>>>16&255]<<8|o[e>>>24&255]},t.interleave2=function(e,t){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e&=65535)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))<<1},t.deinterleave2=function(e,t){return(e=65535&((e=16711935&((e=252645135&((e=858993459&((e=e>>>t&1431655765)|e>>>1))|e>>>2))|e>>>4))|e>>>16))<<16>>16},t.interleave3=function(e,t,n){return e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2),(e|=(t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2))<<1)|(n=1227133513&((n=3272356035&((n=251719695&((n=4278190335&((n&=1023)|n<<16))|n<<8))|n<<4))|n<<2))<<2},t.deinterleave3=function(e,t){return(e=1023&((e=4278190335&((e=251719695&((e=3272356035&((e=e>>>t&1227133513)|e>>>2))|e>>>4))|e>>>8))|e>>>16))<<22>>22},t.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>r(e)+1}},function(e,t,n){"use strict";n.r(t),n.d(t,"updatePositionExtents",(function(){return o}));var r=n(78);function o(e){var t=e.width/2,n=e._localPosition,r=e._extents;r[0]=n[0]-t,r[1]=n[1],r[2]=n[2]-t,r[3]=n[0]+t,r[4]=n[1]+e.height,r[5]=n[2]+t}t.default=function(e){return{name:"position",order:60,state:{position:null,width:1,height:1,_localPosition:null,_renderPosition:null,_extents:null},onAdd:function(t,n){var i=[0,0,0];n.position&&r.copy(i,n.position),n.position=i,n._localPosition=r.create(),n._renderPosition=r.create(),n._extents=new Float32Array(6),e.globalToLocal(n.position,null,n._localPosition),r.copy(n._renderPosition,n._localPosition),o(n)},onRemove:null,system:function(t,n){var i=e.worldOriginOffset;n.forEach(e=>{r.add(e.position,e._localPosition,i),o(e)})}}}},function(e,t,n){"use strict";n.r(t),n.d(t,"setPhysicsFromPosition",(function(){return i}));var r=n(78);t.default=function(e){return{name:"physics",order:40,state:{body:null},onAdd:function(t,n){n.body=e.physics.addBody(),i(n,e.ents.getPositionData(n.__id))},onRemove:function(t,n){if(e.ents.hasPosition(n.__id)){var r=e.ents.getPositionData(n.__id);s(n,r),a(n,r,0,!1)}e.physics.removeBody(n.body)},system:function(t,n){n.forEach(t=>{s(t,e.ents.getPositionData(t.__id))})},renderSystem:function(t,n){var r=(e.positionInCurrentTick*e._tickRate-e._tickRate)/1e3;n.forEach(t=>{var n=t.__id,o=e.ents.getPositionData(n),i=e.ents.cameraSmoothed(n);a(t,o,r,i)})}}};var o=r.create();function i(e,t){var n=e.body.aabb,o=t._extents;r.copy(n.base,o),r.set(n.vec,t.width,t.height,t.width),r.add(n.max,n.base,n.vec)}function s(e,t){var n=e.body.aabb.base,o=t.width/2;r.set(t._localPosition,n[0]+o,n[1],n[2]+o)}function a(e,t,n,i){var s=e.body.velocity;r.scaleAndAdd(o,t._localPosition,s,n),i&&r.lerp(o,t._renderPosition,o,.3),r.copy(t._renderPosition,o)}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return v}));var r=n(163),o=n.n(r),i=n(175),s=n(139),a=n(274),c=n(129),u=n(176),l=n(241),f=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const d=o()("threads:master:messages"),p=o()("threads:master:spawn"),h=o()("threads:master:thread-utils"),m=void 0!==e&&e.env.THREADS_WORKER_INIT_TIMEOUT?Number.parseInt(e.env.THREADS_WORKER_INIT_TIMEOUT,10):1e4;function y(e,t,n,r){const o=n.filter(e=>e.type===u.a.internalError).map(e=>e.error);return Object.assign(e,{[c.a]:o,[c.b]:n,[c.c]:r,[c.e]:t})}function v(e,t){return f(this,void 0,void 0,(function*(){p("Initializing new thread");const n=(yield function(e,t,n){return f(this,void 0,void 0,(function*(){let r;const o=new Promise((e,o)=>{r=setTimeout(()=>o(Error(n)),t)}),i=yield Promise.race([e,o]);return clearTimeout(r),i}))}(function(e){return new Promise((t,n)=>{const r=o=>{var i;d("Message from worker before finishing initialization:",o.data),(i=o.data)&&"init"===i.type?(e.removeEventListener("message",r),t(o.data)):(e=>e&&"uncaughtError"===e.type)(o.data)&&(e.removeEventListener("message",r),n(Object(s.a)(o.data.error)))};e.addEventListener("message",r)})}(e),t&&t.timeout?t.timeout:m,`Timeout: Did not receive an init message from worker after ${m}ms. Make sure the worker calls expose().`)).exposed,{termination:r,terminate:o}=function(e){const[t,n]=Object(a.a)();return{terminate:()=>f(this,void 0,void 0,(function*(){h("Terminating worker"),yield e.terminate(),n()})),termination:t}}(e),c=function(e,t){return new i.a(n=>{const r=e=>{const t={type:u.a.message,data:e.data};n.next(t)},o=e=>{h("Unhandled promise rejection event in thread:",e);const t={type:u.a.internalError,error:Error(e.reason)};n.next(t)};e.addEventListener("message",r),e.addEventListener("unhandledrejection",o),t.then(()=>{const t={type:u.a.termination};e.removeEventListener("message",r),e.removeEventListener("unhandledrejection",o),n.next(t),n.complete()})})}(e,r);if("function"===n.type){return y(Object(l.a)(e),e,c,o)}if("module"===n.type){return y(Object(l.b)(e,n.methods),e,c,o)}{const e=n.type;throw Error("Worker init message states unexpected type of expose(): "+e)}}))}}).call(this,n(224))},function(e,t,n){var r,o,i;o=[n(268)],void 0===(i="function"==typeof(r=function(e){"use strict";var t=e.Reader,n=e.Writer,r=e.util,o=e.roots.default||(e.roots.default={});return o.LoginResponse=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.username="",i.prototype.protocol=0,i.prototype.mobile=!1,i.prototype.client="",i.prototype.uuid="",i.prototype.secret="",i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.username&&Object.hasOwnProperty.call(e,"username")&&t.uint32(10).string(e.username),null!=e.protocol&&Object.hasOwnProperty.call(e,"protocol")&&t.uint32(16).uint32(e.protocol),null!=e.mobile&&Object.hasOwnProperty.call(e,"mobile")&&t.uint32(24).bool(e.mobile),null!=e.client&&Object.hasOwnProperty.call(e,"client")&&t.uint32(34).string(e.client),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(42).string(e.uuid),null!=e.secret&&Object.hasOwnProperty.call(e,"secret")&&t.uint32(50).string(e.secret),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.LoginResponse;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.username=e.string();break;case 2:i.protocol=e.uint32();break;case 3:i.mobile=e.bool();break;case 4:i.client=e.string();break;case 5:i.uuid=e.string();break;case 6:i.secret=e.string();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.username&&e.hasOwnProperty("username")&&!r.isString(e.username)?"username: string expected":null!=e.protocol&&e.hasOwnProperty("protocol")&&!r.isInteger(e.protocol)?"protocol: integer expected":null!=e.mobile&&e.hasOwnProperty("mobile")&&"boolean"!=typeof e.mobile?"mobile: boolean expected":null!=e.client&&e.hasOwnProperty("client")&&!r.isString(e.client)?"client: string expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!r.isString(e.uuid)?"uuid: string expected":null!=e.secret&&e.hasOwnProperty("secret")&&!r.isString(e.secret)?"secret: string expected":null},i.fromObject=function(e){if(e instanceof o.LoginResponse)return e;var t=new o.LoginResponse;return null!=e.username&&(t.username=String(e.username)),null!=e.protocol&&(t.protocol=e.protocol>>>0),null!=e.mobile&&(t.mobile=Boolean(e.mobile)),null!=e.client&&(t.client=String(e.client)),null!=e.uuid&&(t.uuid=String(e.uuid)),null!=e.secret&&(t.secret=String(e.secret)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.username="",n.protocol=0,n.mobile=!1,n.client="",n.uuid="",n.secret=""),null!=e.username&&e.hasOwnProperty("username")&&(n.username=e.username),null!=e.protocol&&e.hasOwnProperty("protocol")&&(n.protocol=e.protocol),null!=e.mobile&&e.hasOwnProperty("mobile")&&(n.mobile=e.mobile),null!=e.client&&e.hasOwnProperty("client")&&(n.client=e.client),null!=e.uuid&&e.hasOwnProperty("uuid")&&(n.uuid=e.uuid),null!=e.secret&&e.hasOwnProperty("secret")&&(n.secret=e.secret),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.ActionMove=function(){function r(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return r.prototype.x=0,r.prototype.y=0,r.prototype.z=0,r.prototype.rotation=0,r.prototype.pitch=0,r.create=function(e){return new r(e)},r.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(9).double(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(17).double(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(25).double(e.z),null!=e.rotation&&Object.hasOwnProperty.call(e,"rotation")&&t.uint32(37).float(e.rotation),null!=e.pitch&&Object.hasOwnProperty.call(e,"pitch")&&t.uint32(45).float(e.pitch),t},r.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},r.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.ActionMove;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.x=e.double();break;case 2:i.y=e.double();break;case 3:i.z=e.double();break;case 4:i.rotation=e.float();break;case 5:i.pitch=e.float();break;default:e.skipType(7&s)}}return i},r.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},r.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&"number"!=typeof e.x?"x: number expected":null!=e.y&&e.hasOwnProperty("y")&&"number"!=typeof e.y?"y: number expected":null!=e.z&&e.hasOwnProperty("z")&&"number"!=typeof e.z?"z: number expected":null!=e.rotation&&e.hasOwnProperty("rotation")&&"number"!=typeof e.rotation?"rotation: number expected":null!=e.pitch&&e.hasOwnProperty("pitch")&&"number"!=typeof e.pitch?"pitch: number expected":null},r.fromObject=function(e){if(e instanceof o.ActionMove)return e;var t=new o.ActionMove;return null!=e.x&&(t.x=Number(e.x)),null!=e.y&&(t.y=Number(e.y)),null!=e.z&&(t.z=Number(e.z)),null!=e.rotation&&(t.rotation=Number(e.rotation)),null!=e.pitch&&(t.pitch=Number(e.pitch)),t},r.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0,n.rotation=0,n.pitch=0),null!=e.x&&e.hasOwnProperty("x")&&(n.x=t.json&&!isFinite(e.x)?String(e.x):e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=t.json&&!isFinite(e.y)?String(e.y):e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=t.json&&!isFinite(e.z)?String(e.z):e.z),null!=e.rotation&&e.hasOwnProperty("rotation")&&(n.rotation=t.json&&!isFinite(e.rotation)?String(e.rotation):e.rotation),null!=e.pitch&&e.hasOwnProperty("pitch")&&(n.pitch=t.json&&!isFinite(e.pitch)?String(e.pitch):e.pitch),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},r}(),o.ActionMessage=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.message="",i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(10).string(e.message),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.ActionMessage;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.message=e.string();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.message&&e.hasOwnProperty("message")&&!r.isString(e.message)?"message: string expected":null},i.fromObject=function(e){if(e instanceof o.ActionMessage)return e;var t=new o.ActionMessage;return null!=e.message&&(t.message=String(e.message)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.message=""),null!=e.message&&e.hasOwnProperty("message")&&(n.message=e.message),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.ActionBlockPlace=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.x=0,i.prototype.y=0,i.prototype.z=0,i.prototype.x2=0,i.prototype.y2=0,i.prototype.z2=0,i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(8).sint32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(16).sint32(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(24).sint32(e.z),null!=e.x2&&Object.hasOwnProperty.call(e,"x2")&&t.uint32(32).sint32(e.x2),null!=e.y2&&Object.hasOwnProperty.call(e,"y2")&&t.uint32(40).sint32(e.y2),null!=e.z2&&Object.hasOwnProperty.call(e,"z2")&&t.uint32(48).sint32(e.z2),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.ActionBlockPlace;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.x=e.sint32();break;case 2:i.y=e.sint32();break;case 3:i.z=e.sint32();break;case 4:i.x2=e.sint32();break;case 5:i.y2=e.sint32();break;case 6:i.z2=e.sint32();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&!r.isInteger(e.x)?"x: integer expected":null!=e.y&&e.hasOwnProperty("y")&&!r.isInteger(e.y)?"y: integer expected":null!=e.z&&e.hasOwnProperty("z")&&!r.isInteger(e.z)?"z: integer expected":null!=e.x2&&e.hasOwnProperty("x2")&&!r.isInteger(e.x2)?"x2: integer expected":null!=e.y2&&e.hasOwnProperty("y2")&&!r.isInteger(e.y2)?"y2: integer expected":null!=e.z2&&e.hasOwnProperty("z2")&&!r.isInteger(e.z2)?"z2: integer expected":null},i.fromObject=function(e){if(e instanceof o.ActionBlockPlace)return e;var t=new o.ActionBlockPlace;return null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.z&&(t.z=0|e.z),null!=e.x2&&(t.x2=0|e.x2),null!=e.y2&&(t.y2=0|e.y2),null!=e.z2&&(t.z2=0|e.z2),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0,n.x2=0,n.y2=0,n.z2=0),null!=e.x&&e.hasOwnProperty("x")&&(n.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=e.z),null!=e.x2&&e.hasOwnProperty("x2")&&(n.x2=e.x2),null!=e.y2&&e.hasOwnProperty("y2")&&(n.y2=e.y2),null!=e.z2&&e.hasOwnProperty("z2")&&(n.z2=e.z2),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.ActionBlockBreak=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.x=0,i.prototype.y=0,i.prototype.z=0,i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(8).sint32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(16).sint32(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(24).sint32(e.z),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.ActionBlockBreak;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.x=e.sint32();break;case 2:i.y=e.sint32();break;case 3:i.z=e.sint32();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&!r.isInteger(e.x)?"x: integer expected":null!=e.y&&e.hasOwnProperty("y")&&!r.isInteger(e.y)?"y: integer expected":null!=e.z&&e.hasOwnProperty("z")&&!r.isInteger(e.z)?"z: integer expected":null},i.fromObject=function(e){if(e instanceof o.ActionBlockBreak)return e;var t=new o.ActionBlockBreak;return null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.z&&(t.z=0|e.z),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0),null!=e.x&&e.hasOwnProperty("x")&&(n.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=e.z),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.ActionInventoryClick=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.slot=0,i.prototype.type="",i.prototype.inventory="",i.prototype.slot2=0,i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.slot&&Object.hasOwnProperty.call(e,"slot")&&t.uint32(8).sint32(e.slot),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(18).string(e.type),null!=e.inventory&&Object.hasOwnProperty.call(e,"inventory")&&t.uint32(26).string(e.inventory),null!=e.slot2&&Object.hasOwnProperty.call(e,"slot2")&&t.uint32(32).sint32(e.slot2),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.ActionInventoryClick;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.slot=e.sint32();break;case 2:i.type=e.string();break;case 3:i.inventory=e.string();break;case 4:i.slot2=e.sint32();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.slot&&e.hasOwnProperty("slot")&&!r.isInteger(e.slot)?"slot: integer expected":null!=e.type&&e.hasOwnProperty("type")&&!r.isString(e.type)?"type: string expected":null!=e.inventory&&e.hasOwnProperty("inventory")&&!r.isString(e.inventory)?"inventory: string expected":null!=e.slot2&&e.hasOwnProperty("slot2")&&!r.isInteger(e.slot2)?"slot2: integer expected":null},i.fromObject=function(e){if(e instanceof o.ActionInventoryClick)return e;var t=new o.ActionInventoryClick;return null!=e.slot&&(t.slot=0|e.slot),null!=e.type&&(t.type=String(e.type)),null!=e.inventory&&(t.inventory=String(e.inventory)),null!=e.slot2&&(t.slot2=0|e.slot2),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.slot=0,n.type="",n.inventory="",n.slot2=0),null!=e.slot&&e.hasOwnProperty("slot")&&(n.slot=e.slot),null!=e.type&&e.hasOwnProperty("type")&&(n.type=e.type),null!=e.inventory&&e.hasOwnProperty("inventory")&&(n.inventory=e.inventory),null!=e.slot2&&e.hasOwnProperty("slot2")&&(n.slot2=e.slot2),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.ActionInventoryOpen=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.inventory="",i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.inventory&&Object.hasOwnProperty.call(e,"inventory")&&t.uint32(10).string(e.inventory),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.ActionInventoryOpen;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.inventory=e.string();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.inventory&&e.hasOwnProperty("inventory")&&!r.isString(e.inventory)?"inventory: string expected":null},i.fromObject=function(e){if(e instanceof o.ActionInventoryOpen)return e;var t=new o.ActionInventoryOpen;return null!=e.inventory&&(t.inventory=String(e.inventory)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.inventory=""),null!=e.inventory&&e.hasOwnProperty("inventory")&&(n.inventory=e.inventory),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.ActionInventoryClose=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.inventory="",i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.inventory&&Object.hasOwnProperty.call(e,"inventory")&&t.uint32(10).string(e.inventory),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.ActionInventoryClose;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.inventory=e.string();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.inventory&&e.hasOwnProperty("inventory")&&!r.isString(e.inventory)?"inventory: string expected":null},i.fromObject=function(e){if(e instanceof o.ActionInventoryClose)return e;var t=new o.ActionInventoryClose;return null!=e.inventory&&(t.inventory=String(e.inventory)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.inventory=""),null!=e.inventory&&e.hasOwnProperty("inventory")&&(n.inventory=e.inventory),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.ActionClick=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.x=0,i.prototype.y=0,i.prototype.z=0,i.prototype.type="",i.prototype.onBlock=!1,i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(8).sint32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(16).sint32(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(24).sint32(e.z),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(34).string(e.type),null!=e.onBlock&&Object.hasOwnProperty.call(e,"onBlock")&&t.uint32(40).bool(e.onBlock),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.ActionClick;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.x=e.sint32();break;case 2:i.y=e.sint32();break;case 3:i.z=e.sint32();break;case 4:i.type=e.string();break;case 5:i.onBlock=e.bool();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&!r.isInteger(e.x)?"x: integer expected":null!=e.y&&e.hasOwnProperty("y")&&!r.isInteger(e.y)?"y: integer expected":null!=e.z&&e.hasOwnProperty("z")&&!r.isInteger(e.z)?"z: integer expected":null!=e.type&&e.hasOwnProperty("type")&&!r.isString(e.type)?"type: string expected":null!=e.onBlock&&e.hasOwnProperty("onBlock")&&"boolean"!=typeof e.onBlock?"onBlock: boolean expected":null},i.fromObject=function(e){if(e instanceof o.ActionClick)return e;var t=new o.ActionClick;return null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.z&&(t.z=0|e.z),null!=e.type&&(t.type=String(e.type)),null!=e.onBlock&&(t.onBlock=Boolean(e.onBlock)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0,n.type="",n.onBlock=!1),null!=e.x&&e.hasOwnProperty("x")&&(n.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=e.z),null!=e.type&&e.hasOwnProperty("type")&&(n.type=e.type),null!=e.onBlock&&e.hasOwnProperty("onBlock")&&(n.onBlock=e.onBlock),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.ActionClickEntity=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.uuid="",i.prototype.type="",i.prototype.distance=0,i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(10).string(e.uuid),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(18).string(e.type),null!=e.distance&&Object.hasOwnProperty.call(e,"distance")&&t.uint32(29).float(e.distance),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.ActionClickEntity;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.uuid=e.string();break;case 2:i.type=e.string();break;case 3:i.distance=e.float();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!r.isString(e.uuid)?"uuid: string expected":null!=e.type&&e.hasOwnProperty("type")&&!r.isString(e.type)?"type: string expected":null!=e.distance&&e.hasOwnProperty("distance")&&"number"!=typeof e.distance?"distance: number expected":null},i.fromObject=function(e){if(e instanceof o.ActionClickEntity)return e;var t=new o.ActionClickEntity;return null!=e.uuid&&(t.uuid=String(e.uuid)),null!=e.type&&(t.type=String(e.type)),null!=e.distance&&(t.distance=Number(e.distance)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.uuid="",n.type="",n.distance=0),null!=e.uuid&&e.hasOwnProperty("uuid")&&(n.uuid=e.uuid),null!=e.type&&e.hasOwnProperty("type")&&(n.type=e.type),null!=e.distance&&e.hasOwnProperty("distance")&&(n.distance=t.json&&!isFinite(e.distance)?String(e.distance):e.distance),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.PluginMessage=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.key="",i.prototype.version=0,i.prototype.value="",i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(16).uint32(e.version),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(26).string(e.value),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.PluginMessage;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.key=e.string();break;case 2:i.version=e.uint32();break;case 3:i.value=e.string();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!r.isString(e.key)?"key: string expected":null!=e.version&&e.hasOwnProperty("version")&&!r.isInteger(e.version)?"version: integer expected":null!=e.value&&e.hasOwnProperty("value")&&!r.isString(e.value)?"value: string expected":null},i.fromObject=function(e){if(e instanceof o.PluginMessage)return e;var t=new o.PluginMessage;return null!=e.key&&(t.key=String(e.key)),null!=e.version&&(t.version=e.version>>>0),null!=e.value&&(t.value=String(e.value)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.key="",n.version=0,n.value=""),null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.version&&e.hasOwnProperty("version")&&(n.version=e.version),null!=e.value&&e.hasOwnProperty("value")&&(n.value=e.value),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o})?r.apply(t,o):r)||(e.exports=i)},function(e,t,n){var r,o,i;o=[n(268)],void 0===(i="function"==typeof(r=function(e){"use strict";var t=e.Reader,n=e.Writer,r=e.util,o=e.roots.default||(e.roots.default={});return o.LoginRequest=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.name="",i.prototype.protocol=0,i.prototype.maxplayers=0,i.prototype.numberplayers=0,i.prototype.motd="",i.prototype.software="",i.prototype.auth=!1,i.prototype.secret="",i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.protocol&&Object.hasOwnProperty.call(e,"protocol")&&t.uint32(16).uint32(e.protocol),null!=e.maxplayers&&Object.hasOwnProperty.call(e,"maxplayers")&&t.uint32(24).uint32(e.maxplayers),null!=e.numberplayers&&Object.hasOwnProperty.call(e,"numberplayers")&&t.uint32(32).uint32(e.numberplayers),null!=e.motd&&Object.hasOwnProperty.call(e,"motd")&&t.uint32(42).string(e.motd),null!=e.software&&Object.hasOwnProperty.call(e,"software")&&t.uint32(50).string(e.software),null!=e.auth&&Object.hasOwnProperty.call(e,"auth")&&t.uint32(56).bool(e.auth),null!=e.secret&&Object.hasOwnProperty.call(e,"secret")&&t.uint32(66).string(e.secret),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.LoginRequest;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.name=e.string();break;case 2:i.protocol=e.uint32();break;case 3:i.maxplayers=e.uint32();break;case 4:i.numberplayers=e.uint32();break;case 5:i.motd=e.string();break;case 6:i.software=e.string();break;case 7:i.auth=e.bool();break;case 8:i.secret=e.string();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.name&&e.hasOwnProperty("name")&&!r.isString(e.name)?"name: string expected":null!=e.protocol&&e.hasOwnProperty("protocol")&&!r.isInteger(e.protocol)?"protocol: integer expected":null!=e.maxplayers&&e.hasOwnProperty("maxplayers")&&!r.isInteger(e.maxplayers)?"maxplayers: integer expected":null!=e.numberplayers&&e.hasOwnProperty("numberplayers")&&!r.isInteger(e.numberplayers)?"numberplayers: integer expected":null!=e.motd&&e.hasOwnProperty("motd")&&!r.isString(e.motd)?"motd: string expected":null!=e.software&&e.hasOwnProperty("software")&&!r.isString(e.software)?"software: string expected":null!=e.auth&&e.hasOwnProperty("auth")&&"boolean"!=typeof e.auth?"auth: boolean expected":null!=e.secret&&e.hasOwnProperty("secret")&&!r.isString(e.secret)?"secret: string expected":null},i.fromObject=function(e){if(e instanceof o.LoginRequest)return e;var t=new o.LoginRequest;return null!=e.name&&(t.name=String(e.name)),null!=e.protocol&&(t.protocol=e.protocol>>>0),null!=e.maxplayers&&(t.maxplayers=e.maxplayers>>>0),null!=e.numberplayers&&(t.numberplayers=e.numberplayers>>>0),null!=e.motd&&(t.motd=String(e.motd)),null!=e.software&&(t.software=String(e.software)),null!=e.auth&&(t.auth=Boolean(e.auth)),null!=e.secret&&(t.secret=String(e.secret)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.name="",n.protocol=0,n.maxplayers=0,n.numberplayers=0,n.motd="",n.software="",n.auth=!1,n.secret=""),null!=e.name&&e.hasOwnProperty("name")&&(n.name=e.name),null!=e.protocol&&e.hasOwnProperty("protocol")&&(n.protocol=e.protocol),null!=e.maxplayers&&e.hasOwnProperty("maxplayers")&&(n.maxplayers=e.maxplayers),null!=e.numberplayers&&e.hasOwnProperty("numberplayers")&&(n.numberplayers=e.numberplayers),null!=e.motd&&e.hasOwnProperty("motd")&&(n.motd=e.motd),null!=e.software&&e.hasOwnProperty("software")&&(n.software=e.software),null!=e.auth&&e.hasOwnProperty("auth")&&(n.auth=e.auth),null!=e.secret&&e.hasOwnProperty("secret")&&(n.secret=e.secret),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.LoginSuccess=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.xPos=0,i.prototype.yPos=0,i.prototype.zPos=0,i.prototype.itemsDef="",i.prototype.blocksDef="",i.prototype.inventory="",i.prototype.armor="",i.prototype.movement="",i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.xPos&&Object.hasOwnProperty.call(e,"xPos")&&t.uint32(9).double(e.xPos),null!=e.yPos&&Object.hasOwnProperty.call(e,"yPos")&&t.uint32(17).double(e.yPos),null!=e.zPos&&Object.hasOwnProperty.call(e,"zPos")&&t.uint32(25).double(e.zPos),null!=e.itemsDef&&Object.hasOwnProperty.call(e,"itemsDef")&&t.uint32(34).string(e.itemsDef),null!=e.blocksDef&&Object.hasOwnProperty.call(e,"blocksDef")&&t.uint32(42).string(e.blocksDef),null!=e.inventory&&Object.hasOwnProperty.call(e,"inventory")&&t.uint32(50).string(e.inventory),null!=e.armor&&Object.hasOwnProperty.call(e,"armor")&&t.uint32(58).string(e.armor),null!=e.movement&&Object.hasOwnProperty.call(e,"movement")&&t.uint32(66).string(e.movement),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.LoginSuccess;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.xPos=e.double();break;case 2:i.yPos=e.double();break;case 3:i.zPos=e.double();break;case 4:i.itemsDef=e.string();break;case 5:i.blocksDef=e.string();break;case 6:i.inventory=e.string();break;case 7:i.armor=e.string();break;case 8:i.movement=e.string();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.xPos&&e.hasOwnProperty("xPos")&&"number"!=typeof e.xPos?"xPos: number expected":null!=e.yPos&&e.hasOwnProperty("yPos")&&"number"!=typeof e.yPos?"yPos: number expected":null!=e.zPos&&e.hasOwnProperty("zPos")&&"number"!=typeof e.zPos?"zPos: number expected":null!=e.itemsDef&&e.hasOwnProperty("itemsDef")&&!r.isString(e.itemsDef)?"itemsDef: string expected":null!=e.blocksDef&&e.hasOwnProperty("blocksDef")&&!r.isString(e.blocksDef)?"blocksDef: string expected":null!=e.inventory&&e.hasOwnProperty("inventory")&&!r.isString(e.inventory)?"inventory: string expected":null!=e.armor&&e.hasOwnProperty("armor")&&!r.isString(e.armor)?"armor: string expected":null!=e.movement&&e.hasOwnProperty("movement")&&!r.isString(e.movement)?"movement: string expected":null},i.fromObject=function(e){if(e instanceof o.LoginSuccess)return e;var t=new o.LoginSuccess;return null!=e.xPos&&(t.xPos=Number(e.xPos)),null!=e.yPos&&(t.yPos=Number(e.yPos)),null!=e.zPos&&(t.zPos=Number(e.zPos)),null!=e.itemsDef&&(t.itemsDef=String(e.itemsDef)),null!=e.blocksDef&&(t.blocksDef=String(e.blocksDef)),null!=e.inventory&&(t.inventory=String(e.inventory)),null!=e.armor&&(t.armor=String(e.armor)),null!=e.movement&&(t.movement=String(e.movement)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.xPos=0,n.yPos=0,n.zPos=0,n.itemsDef="",n.blocksDef="",n.inventory="",n.armor="",n.movement=""),null!=e.xPos&&e.hasOwnProperty("xPos")&&(n.xPos=t.json&&!isFinite(e.xPos)?String(e.xPos):e.xPos),null!=e.yPos&&e.hasOwnProperty("yPos")&&(n.yPos=t.json&&!isFinite(e.yPos)?String(e.yPos):e.yPos),null!=e.zPos&&e.hasOwnProperty("zPos")&&(n.zPos=t.json&&!isFinite(e.zPos)?String(e.zPos):e.zPos),null!=e.itemsDef&&e.hasOwnProperty("itemsDef")&&(n.itemsDef=e.itemsDef),null!=e.blocksDef&&e.hasOwnProperty("blocksDef")&&(n.blocksDef=e.blocksDef),null!=e.inventory&&e.hasOwnProperty("inventory")&&(n.inventory=e.inventory),null!=e.armor&&e.hasOwnProperty("armor")&&(n.armor=e.armor),null!=e.movement&&e.hasOwnProperty("movement")&&(n.movement=e.movement),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.PlayerKick=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.reason="",i.prototype.time=r.Long?r.Long.fromBits(0,0,!0):0,i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.reason&&Object.hasOwnProperty.call(e,"reason")&&t.uint32(10).string(e.reason),null!=e.time&&Object.hasOwnProperty.call(e,"time")&&t.uint32(16).uint64(e.time),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.PlayerKick;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.reason=e.string();break;case 2:i.time=e.uint64();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.reason&&e.hasOwnProperty("reason")&&!r.isString(e.reason)?"reason: string expected":null!=e.time&&e.hasOwnProperty("time")&&!(r.isInteger(e.time)||e.time&&r.isInteger(e.time.low)&&r.isInteger(e.time.high))?"time: integer|Long expected":null},i.fromObject=function(e){if(e instanceof o.PlayerKick)return e;var t=new o.PlayerKick;return null!=e.reason&&(t.reason=String(e.reason)),null!=e.time&&(r.Long?(t.time=r.Long.fromValue(e.time)).unsigned=!0:"string"==typeof e.time?t.time=parseInt(e.time,10):"number"==typeof e.time?t.time=e.time:"object"==typeof e.time&&(t.time=new r.LongBits(e.time.low>>>0,e.time.high>>>0).toNumber(!0))),t},i.toObject=function(e,t){t||(t={});var n={};if(t.defaults)if(n.reason="",r.Long){var o=new r.Long(0,0,!0);n.time=t.longs===String?o.toString():t.longs===Number?o.toNumber():o}else n.time=t.longs===String?"0":0;return null!=e.reason&&e.hasOwnProperty("reason")&&(n.reason=e.reason),null!=e.time&&e.hasOwnProperty("time")&&("number"==typeof e.time?n.time=t.longs===String?String(e.time):e.time:n.time=t.longs===String?r.Long.prototype.toString.call(e.time):t.longs===Number?new r.LongBits(e.time.low>>>0,e.time.high>>>0).toNumber(!0):e.time),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.PlayerEntity=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.uuid="",i.prototype.model="",i.prototype.texture="",i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(10).string(e.uuid),null!=e.model&&Object.hasOwnProperty.call(e,"model")&&t.uint32(18).string(e.model),null!=e.texture&&Object.hasOwnProperty.call(e,"texture")&&t.uint32(26).string(e.texture),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.PlayerEntity;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.uuid=e.string();break;case 2:i.model=e.string();break;case 3:i.texture=e.string();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!r.isString(e.uuid)?"uuid: string expected":null!=e.model&&e.hasOwnProperty("model")&&!r.isString(e.model)?"model: string expected":null!=e.texture&&e.hasOwnProperty("texture")&&!r.isString(e.texture)?"texture: string expected":null},i.fromObject=function(e){if(e instanceof o.PlayerEntity)return e;var t=new o.PlayerEntity;return null!=e.uuid&&(t.uuid=String(e.uuid)),null!=e.model&&(t.model=String(e.model)),null!=e.texture&&(t.texture=String(e.texture)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.uuid="",n.model="",n.texture=""),null!=e.uuid&&e.hasOwnProperty("uuid")&&(n.uuid=e.uuid),null!=e.model&&e.hasOwnProperty("model")&&(n.model=e.model),null!=e.texture&&e.hasOwnProperty("texture")&&(n.texture=e.texture),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.PlayerTeleport=function(){function r(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return r.prototype.x=0,r.prototype.y=0,r.prototype.z=0,r.create=function(e){return new r(e)},r.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(9).double(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(17).double(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(25).double(e.z),t},r.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},r.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.PlayerTeleport;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.x=e.double();break;case 2:i.y=e.double();break;case 3:i.z=e.double();break;default:e.skipType(7&s)}}return i},r.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},r.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&"number"!=typeof e.x?"x: number expected":null!=e.y&&e.hasOwnProperty("y")&&"number"!=typeof e.y?"y: number expected":null!=e.z&&e.hasOwnProperty("z")&&"number"!=typeof e.z?"z: number expected":null},r.fromObject=function(e){if(e instanceof o.PlayerTeleport)return e;var t=new o.PlayerTeleport;return null!=e.x&&(t.x=Number(e.x)),null!=e.y&&(t.y=Number(e.y)),null!=e.z&&(t.z=Number(e.z)),t},r.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0),null!=e.x&&e.hasOwnProperty("x")&&(n.x=t.json&&!isFinite(e.x)?String(e.x):e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=t.json&&!isFinite(e.y)?String(e.y):e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=t.json&&!isFinite(e.z)?String(e.z):e.z),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},r}(),o.PlayerInventory=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.type="",i.prototype.inventory="",i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(10).string(e.type),null!=e.inventory&&Object.hasOwnProperty.call(e,"inventory")&&t.uint32(18).string(e.inventory),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.PlayerInventory;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.type=e.string();break;case 2:i.inventory=e.string();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.type&&e.hasOwnProperty("type")&&!r.isString(e.type)?"type: string expected":null!=e.inventory&&e.hasOwnProperty("inventory")&&!r.isString(e.inventory)?"inventory: string expected":null},i.fromObject=function(e){if(e instanceof o.PlayerInventory)return e;var t=new o.PlayerInventory;return null!=e.type&&(t.type=String(e.type)),null!=e.inventory&&(t.inventory=String(e.inventory)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.type="",n.inventory=""),null!=e.type&&e.hasOwnProperty("type")&&(n.type=e.type),null!=e.inventory&&e.hasOwnProperty("inventory")&&(n.inventory=e.inventory),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.PlayerSlotUpdate=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.slot=0,i.prototype.type="",i.prototype.data="",i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.slot&&Object.hasOwnProperty.call(e,"slot")&&t.uint32(8).uint32(e.slot),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(18).string(e.type),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(26).string(e.data),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.PlayerSlotUpdate;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.slot=e.uint32();break;case 2:i.type=e.string();break;case 3:i.data=e.string();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.slot&&e.hasOwnProperty("slot")&&!r.isInteger(e.slot)?"slot: integer expected":null!=e.type&&e.hasOwnProperty("type")&&!r.isString(e.type)?"type: string expected":null!=e.data&&e.hasOwnProperty("data")&&!r.isString(e.data)?"data: string expected":null},i.fromObject=function(e){if(e instanceof o.PlayerSlotUpdate)return e;var t=new o.PlayerSlotUpdate;return null!=e.slot&&(t.slot=e.slot>>>0),null!=e.type&&(t.type=String(e.type)),null!=e.data&&(t.data=String(e.data)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.slot=0,n.type="",n.data=""),null!=e.slot&&e.hasOwnProperty("slot")&&(n.slot=e.slot),null!=e.type&&e.hasOwnProperty("type")&&(n.type=e.type),null!=e.data&&e.hasOwnProperty("data")&&(n.data=e.data),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.PlayerApplyImpulse=function(){function r(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return r.prototype.x=0,r.prototype.y=0,r.prototype.z=0,r.create=function(e){return new r(e)},r.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(13).float(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(21).float(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(29).float(e.z),t},r.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},r.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.PlayerApplyImpulse;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.x=e.float();break;case 2:i.y=e.float();break;case 3:i.z=e.float();break;default:e.skipType(7&s)}}return i},r.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},r.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&"number"!=typeof e.x?"x: number expected":null!=e.y&&e.hasOwnProperty("y")&&"number"!=typeof e.y?"y: number expected":null!=e.z&&e.hasOwnProperty("z")&&"number"!=typeof e.z?"z: number expected":null},r.fromObject=function(e){if(e instanceof o.PlayerApplyImpulse)return e;var t=new o.PlayerApplyImpulse;return null!=e.x&&(t.x=Number(e.x)),null!=e.y&&(t.y=Number(e.y)),null!=e.z&&(t.z=Number(e.z)),t},r.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0),null!=e.x&&e.hasOwnProperty("x")&&(n.x=t.json&&!isFinite(e.x)?String(e.x):e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=t.json&&!isFinite(e.y)?String(e.y):e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=t.json&&!isFinite(e.z)?String(e.z):e.z),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},r}(),o.PlayerUpdateMovement=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.key="",i.prototype.value=0,i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(17).double(e.value),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.PlayerUpdateMovement;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.key=e.string();break;case 2:i.value=e.double();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!r.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&"number"!=typeof e.value?"value: number expected":null},i.fromObject=function(e){if(e instanceof o.PlayerUpdateMovement)return e;var t=new o.PlayerUpdateMovement;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=Number(e.value)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.key="",n.value=0),null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(n.value=t.json&&!isFinite(e.value)?String(e.value):e.value),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.PlayerUpdatePhysics=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.key="",i.prototype.value=0,i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(17).double(e.value),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.PlayerUpdatePhysics;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.key=e.string();break;case 2:i.value=e.double();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!r.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&"number"!=typeof e.value?"value: number expected":null},i.fromObject=function(e){if(e instanceof o.PlayerUpdatePhysics)return e;var t=new o.PlayerUpdatePhysics;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=Number(e.value)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.key="",n.value=0),null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(n.value=t.json&&!isFinite(e.value)?String(e.value):e.value),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.PlayerHealth=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.value=0,i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(8).sint32(e.value),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.PlayerHealth;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.value=e.sint32();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.value&&e.hasOwnProperty("value")&&!r.isInteger(e.value)?"value: integer expected":null},i.fromObject=function(e){if(e instanceof o.PlayerHealth)return e;var t=new o.PlayerHealth;return null!=e.value&&(t.value=0|e.value),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.value=0),null!=e.value&&e.hasOwnProperty("value")&&(n.value=e.value),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.PlayerOpenInventory=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.name="",i.prototype.type="",i.prototype.data="",i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(18).string(e.type),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(26).string(e.data),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.PlayerOpenInventory;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.name=e.string();break;case 2:i.type=e.string();break;case 3:i.data=e.string();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.name&&e.hasOwnProperty("name")&&!r.isString(e.name)?"name: string expected":null!=e.type&&e.hasOwnProperty("type")&&!r.isString(e.type)?"type: string expected":null!=e.data&&e.hasOwnProperty("data")&&!r.isString(e.data)?"data: string expected":null},i.fromObject=function(e){if(e instanceof o.PlayerOpenInventory)return e;var t=new o.PlayerOpenInventory;return null!=e.name&&(t.name=String(e.name)),null!=e.type&&(t.type=String(e.type)),null!=e.data&&(t.data=String(e.data)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.name="",n.type="",n.data=""),null!=e.name&&e.hasOwnProperty("name")&&(n.name=e.name),null!=e.type&&e.hasOwnProperty("type")&&(n.type=e.type),null!=e.data&&e.hasOwnProperty("data")&&(n.data=e.data),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.SoundPlay=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.sound="",i.prototype.volume=0,i.prototype.x=0,i.prototype.y=0,i.prototype.z=0,i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.sound&&Object.hasOwnProperty.call(e,"sound")&&t.uint32(10).string(e.sound),null!=e.volume&&Object.hasOwnProperty.call(e,"volume")&&t.uint32(16).uint32(e.volume),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(25).double(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(33).double(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(41).double(e.z),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.SoundPlay;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.sound=e.string();break;case 2:i.volume=e.uint32();break;case 3:i.x=e.double();break;case 4:i.y=e.double();break;case 5:i.z=e.double();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.sound&&e.hasOwnProperty("sound")&&!r.isString(e.sound)?"sound: string expected":null!=e.volume&&e.hasOwnProperty("volume")&&!r.isInteger(e.volume)?"volume: integer expected":null!=e.x&&e.hasOwnProperty("x")&&"number"!=typeof e.x?"x: number expected":null!=e.y&&e.hasOwnProperty("y")&&"number"!=typeof e.y?"y: number expected":null!=e.z&&e.hasOwnProperty("z")&&"number"!=typeof e.z?"z: number expected":null},i.fromObject=function(e){if(e instanceof o.SoundPlay)return e;var t=new o.SoundPlay;return null!=e.sound&&(t.sound=String(e.sound)),null!=e.volume&&(t.volume=e.volume>>>0),null!=e.x&&(t.x=Number(e.x)),null!=e.y&&(t.y=Number(e.y)),null!=e.z&&(t.z=Number(e.z)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.sound="",n.volume=0,n.x=0,n.y=0,n.z=0),null!=e.sound&&e.hasOwnProperty("sound")&&(n.sound=e.sound),null!=e.volume&&e.hasOwnProperty("volume")&&(n.volume=e.volume),null!=e.x&&e.hasOwnProperty("x")&&(n.x=t.json&&!isFinite(e.x)?String(e.x):e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=t.json&&!isFinite(e.y)?String(e.y):e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=t.json&&!isFinite(e.z)?String(e.z):e.z),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.ChatMessage=function(){function i(e){if(this.message={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.message=r.emptyObject,i.prototype.time=r.Long?r.Long.fromBits(0,0,!0):0,i.create=function(e){return new i(e)},i.encode=function(e,t){if(t||(t=n.create()),null!=e.message&&Object.hasOwnProperty.call(e,"message"))for(var r=Object.keys(e.message),i=0;i<r.length;++i)t.uint32(10).fork().uint32(8).uint32(r[i]),o.ChatMessage.ChatComponent.encode(e.message[r[i]],t.uint32(18).fork()).ldelim().ldelim();return null!=e.time&&Object.hasOwnProperty.call(e,"time")&&t.uint32(16).uint64(e.time),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var i,s,a=void 0===n?e.len:e.pos+n,c=new o.ChatMessage;e.pos<a;){var u=e.uint32();switch(u>>>3){case 1:c.message===r.emptyObject&&(c.message={});var l=e.uint32()+e.pos;for(i=0,s=null;e.pos<l;){var f=e.uint32();switch(f>>>3){case 1:i=e.uint32();break;case 2:s=o.ChatMessage.ChatComponent.decode(e,e.uint32());break;default:e.skipType(7&f)}}c.message[i]=s;break;case 2:c.time=e.uint64();break;default:e.skipType(7&u)}}return c},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.message&&e.hasOwnProperty("message")){if(!r.isObject(e.message))return"message: object expected";for(var t=Object.keys(e.message),n=0;n<t.length;++n){if(!r.key32Re.test(t[n]))return"message: integer key{k:uint32} expected";var i=o.ChatMessage.ChatComponent.verify(e.message[t[n]]);if(i)return"message."+i}}return null!=e.time&&e.hasOwnProperty("time")&&!(r.isInteger(e.time)||e.time&&r.isInteger(e.time.low)&&r.isInteger(e.time.high))?"time: integer|Long expected":null},i.fromObject=function(e){if(e instanceof o.ChatMessage)return e;var t=new o.ChatMessage;if(e.message){if("object"!=typeof e.message)throw TypeError(".ChatMessage.message: object expected");t.message={};for(var n=Object.keys(e.message),i=0;i<n.length;++i){if("object"!=typeof e.message[n[i]])throw TypeError(".ChatMessage.message: object expected");t.message[n[i]]=o.ChatMessage.ChatComponent.fromObject(e.message[n[i]])}}return null!=e.time&&(r.Long?(t.time=r.Long.fromValue(e.time)).unsigned=!0:"string"==typeof e.time?t.time=parseInt(e.time,10):"number"==typeof e.time?t.time=e.time:"object"==typeof e.time&&(t.time=new r.LongBits(e.time.low>>>0,e.time.high>>>0).toNumber(!0))),t},i.toObject=function(e,t){t||(t={});var n,i={};if((t.objects||t.defaults)&&(i.message={}),t.defaults)if(r.Long){var s=new r.Long(0,0,!0);i.time=t.longs===String?s.toString():t.longs===Number?s.toNumber():s}else i.time=t.longs===String?"0":0;if(e.message&&(n=Object.keys(e.message)).length){i.message={};for(var a=0;a<n.length;++a)i.message[n[a]]=o.ChatMessage.ChatComponent.toObject(e.message[n[a]],t)}return null!=e.time&&e.hasOwnProperty("time")&&("number"==typeof e.time?i.time=t.longs===String?String(e.time):e.time:i.time=t.longs===String?r.Long.prototype.toString.call(e.time):t.longs===Number?new r.LongBits(e.time.low>>>0,e.time.high>>>0).toNumber(!0):e.time),i},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i.ChatComponent=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.text="",i.prototype.font="",i.prototype.color="",i.prototype.linethrough=!1,i.prototype.underline=!1,i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.text&&Object.hasOwnProperty.call(e,"text")&&t.uint32(10).string(e.text),null!=e.font&&Object.hasOwnProperty.call(e,"font")&&t.uint32(18).string(e.font),null!=e.color&&Object.hasOwnProperty.call(e,"color")&&t.uint32(26).string(e.color),null!=e.linethrough&&Object.hasOwnProperty.call(e,"linethrough")&&t.uint32(32).bool(e.linethrough),null!=e.underline&&Object.hasOwnProperty.call(e,"underline")&&t.uint32(40).bool(e.underline),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.ChatMessage.ChatComponent;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.text=e.string();break;case 2:i.font=e.string();break;case 3:i.color=e.string();break;case 4:i.linethrough=e.bool();break;case 5:i.underline=e.bool();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.text&&e.hasOwnProperty("text")&&!r.isString(e.text)?"text: string expected":null!=e.font&&e.hasOwnProperty("font")&&!r.isString(e.font)?"font: string expected":null!=e.color&&e.hasOwnProperty("color")&&!r.isString(e.color)?"color: string expected":null!=e.linethrough&&e.hasOwnProperty("linethrough")&&"boolean"!=typeof e.linethrough?"linethrough: boolean expected":null!=e.underline&&e.hasOwnProperty("underline")&&"boolean"!=typeof e.underline?"underline: boolean expected":null},i.fromObject=function(e){if(e instanceof o.ChatMessage.ChatComponent)return e;var t=new o.ChatMessage.ChatComponent;return null!=e.text&&(t.text=String(e.text)),null!=e.font&&(t.font=String(e.font)),null!=e.color&&(t.color=String(e.color)),null!=e.linethrough&&(t.linethrough=Boolean(e.linethrough)),null!=e.underline&&(t.underline=Boolean(e.underline)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.text="",n.font="",n.color="",n.linethrough=!1,n.underline=!1),null!=e.text&&e.hasOwnProperty("text")&&(n.text=e.text),null!=e.font&&e.hasOwnProperty("font")&&(n.font=e.font),null!=e.color&&e.hasOwnProperty("color")&&(n.color=e.color),null!=e.linethrough&&e.hasOwnProperty("linethrough")&&(n.linethrough=e.linethrough),null!=e.underline&&e.hasOwnProperty("underline")&&(n.underline=e.underline),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i}(),o.TabUpdate=function(){function i(e){if(this.message={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.message=r.emptyObject,i.prototype.time=r.Long?r.Long.fromBits(0,0,!0):0,i.create=function(e){return new i(e)},i.encode=function(e,t){if(t||(t=n.create()),null!=e.message&&Object.hasOwnProperty.call(e,"message"))for(var r=Object.keys(e.message),i=0;i<r.length;++i)t.uint32(10).fork().uint32(8).uint32(r[i]),o.TabUpdate.ChatComponent.encode(e.message[r[i]],t.uint32(18).fork()).ldelim().ldelim();return null!=e.time&&Object.hasOwnProperty.call(e,"time")&&t.uint32(16).uint64(e.time),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var i,s,a=void 0===n?e.len:e.pos+n,c=new o.TabUpdate;e.pos<a;){var u=e.uint32();switch(u>>>3){case 1:c.message===r.emptyObject&&(c.message={});var l=e.uint32()+e.pos;for(i=0,s=null;e.pos<l;){var f=e.uint32();switch(f>>>3){case 1:i=e.uint32();break;case 2:s=o.TabUpdate.ChatComponent.decode(e,e.uint32());break;default:e.skipType(7&f)}}c.message[i]=s;break;case 2:c.time=e.uint64();break;default:e.skipType(7&u)}}return c},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.message&&e.hasOwnProperty("message")){if(!r.isObject(e.message))return"message: object expected";for(var t=Object.keys(e.message),n=0;n<t.length;++n){if(!r.key32Re.test(t[n]))return"message: integer key{k:uint32} expected";var i=o.TabUpdate.ChatComponent.verify(e.message[t[n]]);if(i)return"message."+i}}return null!=e.time&&e.hasOwnProperty("time")&&!(r.isInteger(e.time)||e.time&&r.isInteger(e.time.low)&&r.isInteger(e.time.high))?"time: integer|Long expected":null},i.fromObject=function(e){if(e instanceof o.TabUpdate)return e;var t=new o.TabUpdate;if(e.message){if("object"!=typeof e.message)throw TypeError(".TabUpdate.message: object expected");t.message={};for(var n=Object.keys(e.message),i=0;i<n.length;++i){if("object"!=typeof e.message[n[i]])throw TypeError(".TabUpdate.message: object expected");t.message[n[i]]=o.TabUpdate.ChatComponent.fromObject(e.message[n[i]])}}return null!=e.time&&(r.Long?(t.time=r.Long.fromValue(e.time)).unsigned=!0:"string"==typeof e.time?t.time=parseInt(e.time,10):"number"==typeof e.time?t.time=e.time:"object"==typeof e.time&&(t.time=new r.LongBits(e.time.low>>>0,e.time.high>>>0).toNumber(!0))),t},i.toObject=function(e,t){t||(t={});var n,i={};if((t.objects||t.defaults)&&(i.message={}),t.defaults)if(r.Long){var s=new r.Long(0,0,!0);i.time=t.longs===String?s.toString():t.longs===Number?s.toNumber():s}else i.time=t.longs===String?"0":0;if(e.message&&(n=Object.keys(e.message)).length){i.message={};for(var a=0;a<n.length;++a)i.message[n[a]]=o.TabUpdate.ChatComponent.toObject(e.message[n[a]],t)}return null!=e.time&&e.hasOwnProperty("time")&&("number"==typeof e.time?i.time=t.longs===String?String(e.time):e.time:i.time=t.longs===String?r.Long.prototype.toString.call(e.time):t.longs===Number?new r.LongBits(e.time.low>>>0,e.time.high>>>0).toNumber(!0):e.time),i},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i.ChatComponent=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.text="",i.prototype.font="",i.prototype.color="",i.prototype.linethrough=!1,i.prototype.underline=!1,i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.text&&Object.hasOwnProperty.call(e,"text")&&t.uint32(10).string(e.text),null!=e.font&&Object.hasOwnProperty.call(e,"font")&&t.uint32(18).string(e.font),null!=e.color&&Object.hasOwnProperty.call(e,"color")&&t.uint32(26).string(e.color),null!=e.linethrough&&Object.hasOwnProperty.call(e,"linethrough")&&t.uint32(32).bool(e.linethrough),null!=e.underline&&Object.hasOwnProperty.call(e,"underline")&&t.uint32(40).bool(e.underline),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.TabUpdate.ChatComponent;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.text=e.string();break;case 2:i.font=e.string();break;case 3:i.color=e.string();break;case 4:i.linethrough=e.bool();break;case 5:i.underline=e.bool();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.text&&e.hasOwnProperty("text")&&!r.isString(e.text)?"text: string expected":null!=e.font&&e.hasOwnProperty("font")&&!r.isString(e.font)?"font: string expected":null!=e.color&&e.hasOwnProperty("color")&&!r.isString(e.color)?"color: string expected":null!=e.linethrough&&e.hasOwnProperty("linethrough")&&"boolean"!=typeof e.linethrough?"linethrough: boolean expected":null!=e.underline&&e.hasOwnProperty("underline")&&"boolean"!=typeof e.underline?"underline: boolean expected":null},i.fromObject=function(e){if(e instanceof o.TabUpdate.ChatComponent)return e;var t=new o.TabUpdate.ChatComponent;return null!=e.text&&(t.text=String(e.text)),null!=e.font&&(t.font=String(e.font)),null!=e.color&&(t.color=String(e.color)),null!=e.linethrough&&(t.linethrough=Boolean(e.linethrough)),null!=e.underline&&(t.underline=Boolean(e.underline)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.text="",n.font="",n.color="",n.linethrough=!1,n.underline=!1),null!=e.text&&e.hasOwnProperty("text")&&(n.text=e.text),null!=e.font&&e.hasOwnProperty("font")&&(n.font=e.font),null!=e.color&&e.hasOwnProperty("color")&&(n.color=e.color),null!=e.linethrough&&e.hasOwnProperty("linethrough")&&(n.linethrough=e.linethrough),null!=e.underline&&e.hasOwnProperty("underline")&&(n.underline=e.underline),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i}(),o.EntityCreate=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.uuid="",i.prototype.data="",i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(10).string(e.uuid),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).string(e.data),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.EntityCreate;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.uuid=e.string();break;case 2:i.data=e.string();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!r.isString(e.uuid)?"uuid: string expected":null!=e.data&&e.hasOwnProperty("data")&&!r.isString(e.data)?"data: string expected":null},i.fromObject=function(e){if(e instanceof o.EntityCreate)return e;var t=new o.EntityCreate;return null!=e.uuid&&(t.uuid=String(e.uuid)),null!=e.data&&(t.data=String(e.data)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.uuid="",n.data=""),null!=e.uuid&&e.hasOwnProperty("uuid")&&(n.uuid=e.uuid),null!=e.data&&e.hasOwnProperty("data")&&(n.data=e.data),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.EntityRemove=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.uuid="",i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(10).string(e.uuid),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.EntityRemove;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.uuid=e.string();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!r.isString(e.uuid)?"uuid: string expected":null},i.fromObject=function(e){if(e instanceof o.EntityRemove)return e;var t=new o.EntityRemove;return null!=e.uuid&&(t.uuid=String(e.uuid)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.uuid=""),null!=e.uuid&&e.hasOwnProperty("uuid")&&(n.uuid=e.uuid),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.EntityMove=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.uuid="",i.prototype.x=0,i.prototype.y=0,i.prototype.z=0,i.prototype.rotation=0,i.prototype.pitch=0,i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(10).string(e.uuid),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(17).double(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(25).double(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(33).double(e.z),null!=e.rotation&&Object.hasOwnProperty.call(e,"rotation")&&t.uint32(45).float(e.rotation),null!=e.pitch&&Object.hasOwnProperty.call(e,"pitch")&&t.uint32(53).float(e.pitch),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.EntityMove;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.uuid=e.string();break;case 2:i.x=e.double();break;case 3:i.y=e.double();break;case 4:i.z=e.double();break;case 5:i.rotation=e.float();break;case 6:i.pitch=e.float();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!r.isString(e.uuid)?"uuid: string expected":null!=e.x&&e.hasOwnProperty("x")&&"number"!=typeof e.x?"x: number expected":null!=e.y&&e.hasOwnProperty("y")&&"number"!=typeof e.y?"y: number expected":null!=e.z&&e.hasOwnProperty("z")&&"number"!=typeof e.z?"z: number expected":null!=e.rotation&&e.hasOwnProperty("rotation")&&"number"!=typeof e.rotation?"rotation: number expected":null!=e.pitch&&e.hasOwnProperty("pitch")&&"number"!=typeof e.pitch?"pitch: number expected":null},i.fromObject=function(e){if(e instanceof o.EntityMove)return e;var t=new o.EntityMove;return null!=e.uuid&&(t.uuid=String(e.uuid)),null!=e.x&&(t.x=Number(e.x)),null!=e.y&&(t.y=Number(e.y)),null!=e.z&&(t.z=Number(e.z)),null!=e.rotation&&(t.rotation=Number(e.rotation)),null!=e.pitch&&(t.pitch=Number(e.pitch)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.uuid="",n.x=0,n.y=0,n.z=0,n.rotation=0,n.pitch=0),null!=e.uuid&&e.hasOwnProperty("uuid")&&(n.uuid=e.uuid),null!=e.x&&e.hasOwnProperty("x")&&(n.x=t.json&&!isFinite(e.x)?String(e.x):e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=t.json&&!isFinite(e.y)?String(e.y):e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=t.json&&!isFinite(e.z)?String(e.z):e.z),null!=e.rotation&&e.hasOwnProperty("rotation")&&(n.rotation=t.json&&!isFinite(e.rotation)?String(e.rotation):e.rotation),null!=e.pitch&&e.hasOwnProperty("pitch")&&(n.pitch=t.json&&!isFinite(e.pitch)?String(e.pitch):e.pitch),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.EntityUpdate=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.uuid="",i.prototype.key="",i.prototype.value="",i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(10).string(e.uuid),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(18).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(26).string(e.value),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.EntityUpdate;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.uuid=e.string();break;case 2:i.key=e.string();break;case 3:i.value=e.string();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!r.isString(e.uuid)?"uuid: string expected":null!=e.key&&e.hasOwnProperty("key")&&!r.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&!r.isString(e.value)?"value: string expected":null},i.fromObject=function(e){if(e instanceof o.EntityUpdate)return e;var t=new o.EntityUpdate;return null!=e.uuid&&(t.uuid=String(e.uuid)),null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=String(e.value)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.uuid="",n.key="",n.value=""),null!=e.uuid&&e.hasOwnProperty("uuid")&&(n.uuid=e.uuid),null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(n.value=e.value),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.EntityAnimate=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.uuid="",i.prototype.animation="",i.prototype.time=0,i.prototype.replace=!1,i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(10).string(e.uuid),null!=e.animation&&Object.hasOwnProperty.call(e,"animation")&&t.uint32(18).string(e.animation),null!=e.time&&Object.hasOwnProperty.call(e,"time")&&t.uint32(24).uint32(e.time),null!=e.replace&&Object.hasOwnProperty.call(e,"replace")&&t.uint32(32).bool(e.replace),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.EntityAnimate;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.uuid=e.string();break;case 2:i.animation=e.string();break;case 3:i.time=e.uint32();break;case 4:i.replace=e.bool();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!r.isString(e.uuid)?"uuid: string expected":null!=e.animation&&e.hasOwnProperty("animation")&&!r.isString(e.animation)?"animation: string expected":null!=e.time&&e.hasOwnProperty("time")&&!r.isInteger(e.time)?"time: integer expected":null!=e.replace&&e.hasOwnProperty("replace")&&"boolean"!=typeof e.replace?"replace: boolean expected":null},i.fromObject=function(e){if(e instanceof o.EntityAnimate)return e;var t=new o.EntityAnimate;return null!=e.uuid&&(t.uuid=String(e.uuid)),null!=e.animation&&(t.animation=String(e.animation)),null!=e.time&&(t.time=e.time>>>0),null!=e.replace&&(t.replace=Boolean(e.replace)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.uuid="",n.animation="",n.time=0,n.replace=!1),null!=e.uuid&&e.hasOwnProperty("uuid")&&(n.uuid=e.uuid),null!=e.animation&&e.hasOwnProperty("animation")&&(n.animation=e.animation),null!=e.time&&e.hasOwnProperty("time")&&(n.time=e.time),null!=e.replace&&e.hasOwnProperty("replace")&&(n.replace=e.replace),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.WorldBlockUpdate=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.x=0,i.prototype.y=0,i.prototype.z=0,i.prototype.id=0,i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(8).sint32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(16).sint32(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(24).sint32(e.z),null!=e.id&&Object.hasOwnProperty.call(e,"id")&&t.uint32(32).uint32(e.id),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.WorldBlockUpdate;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.x=e.sint32();break;case 2:i.y=e.sint32();break;case 3:i.z=e.sint32();break;case 4:i.id=e.uint32();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&!r.isInteger(e.x)?"x: integer expected":null!=e.y&&e.hasOwnProperty("y")&&!r.isInteger(e.y)?"y: integer expected":null!=e.z&&e.hasOwnProperty("z")&&!r.isInteger(e.z)?"z: integer expected":null!=e.id&&e.hasOwnProperty("id")&&!r.isInteger(e.id)?"id: integer expected":null},i.fromObject=function(e){if(e instanceof o.WorldBlockUpdate)return e;var t=new o.WorldBlockUpdate;return null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.z&&(t.z=0|e.z),null!=e.id&&(t.id=e.id>>>0),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0,n.id=0),null!=e.x&&e.hasOwnProperty("x")&&(n.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=e.z),null!=e.id&&e.hasOwnProperty("id")&&(n.id=e.id),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.WorldChunkLoad=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.x=0,i.prototype.y=0,i.prototype.z=0,i.prototype.data=r.newBuffer([]),i.prototype.type=!1,i.prototype.compressed=!1,i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(8).sint32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(16).sint32(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(24).sint32(e.z),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(34).bytes(e.data),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(40).bool(e.type),null!=e.compressed&&Object.hasOwnProperty.call(e,"compressed")&&t.uint32(48).bool(e.compressed),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.WorldChunkLoad;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.x=e.sint32();break;case 2:i.y=e.sint32();break;case 3:i.z=e.sint32();break;case 4:i.data=e.bytes();break;case 5:i.type=e.bool();break;case 6:i.compressed=e.bool();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&!r.isInteger(e.x)?"x: integer expected":null!=e.y&&e.hasOwnProperty("y")&&!r.isInteger(e.y)?"y: integer expected":null!=e.z&&e.hasOwnProperty("z")&&!r.isInteger(e.z)?"z: integer expected":null!=e.data&&e.hasOwnProperty("data")&&!(e.data&&"number"==typeof e.data.length||r.isString(e.data))?"data: buffer expected":null!=e.type&&e.hasOwnProperty("type")&&"boolean"!=typeof e.type?"type: boolean expected":null!=e.compressed&&e.hasOwnProperty("compressed")&&"boolean"!=typeof e.compressed?"compressed: boolean expected":null},i.fromObject=function(e){if(e instanceof o.WorldChunkLoad)return e;var t=new o.WorldChunkLoad;return null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.z&&(t.z=0|e.z),null!=e.data&&("string"==typeof e.data?r.base64.decode(e.data,t.data=r.newBuffer(r.base64.length(e.data)),0):e.data.length&&(t.data=e.data)),null!=e.type&&(t.type=Boolean(e.type)),null!=e.compressed&&(t.compressed=Boolean(e.compressed)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0,t.bytes===String?n.data="":(n.data=[],t.bytes!==Array&&(n.data=r.newBuffer(n.data))),n.type=!1,n.compressed=!1),null!=e.x&&e.hasOwnProperty("x")&&(n.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=e.z),null!=e.data&&e.hasOwnProperty("data")&&(n.data=t.bytes===String?r.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data),null!=e.type&&e.hasOwnProperty("type")&&(n.type=e.type),null!=e.compressed&&e.hasOwnProperty("compressed")&&(n.compressed=e.compressed),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.WorldChunkUnload=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.x=0,i.prototype.y=0,i.prototype.z=0,i.prototype.type=!1,i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(8).sint32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(16).sint32(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(24).sint32(e.z),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(32).bool(e.type),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.WorldChunkUnload;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.x=e.sint32();break;case 2:i.y=e.sint32();break;case 3:i.z=e.sint32();break;case 4:i.type=e.bool();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&!r.isInteger(e.x)?"x: integer expected":null!=e.y&&e.hasOwnProperty("y")&&!r.isInteger(e.y)?"y: integer expected":null!=e.z&&e.hasOwnProperty("z")&&!r.isInteger(e.z)?"z: integer expected":null!=e.type&&e.hasOwnProperty("type")&&"boolean"!=typeof e.type?"type: boolean expected":null},i.fromObject=function(e){if(e instanceof o.WorldChunkUnload)return e;var t=new o.WorldChunkUnload;return null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.z&&(t.z=0|e.z),null!=e.type&&(t.type=Boolean(e.type)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0,n.type=!1),null!=e.x&&e.hasOwnProperty("x")&&(n.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=e.z),null!=e.type&&e.hasOwnProperty("type")&&(n.type=e.type),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.RegistryUpdate=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.itemsDef="",i.prototype.blocksDef="",i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.itemsDef&&Object.hasOwnProperty.call(e,"itemsDef")&&t.uint32(10).string(e.itemsDef),null!=e.blocksDef&&Object.hasOwnProperty.call(e,"blocksDef")&&t.uint32(18).string(e.blocksDef),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.RegistryUpdate;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.itemsDef=e.string();break;case 2:i.blocksDef=e.string();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.itemsDef&&e.hasOwnProperty("itemsDef")&&!r.isString(e.itemsDef)?"itemsDef: string expected":null!=e.blocksDef&&e.hasOwnProperty("blocksDef")&&!r.isString(e.blocksDef)?"blocksDef: string expected":null},i.fromObject=function(e){if(e instanceof o.RegistryUpdate)return e;var t=new o.RegistryUpdate;return null!=e.itemsDef&&(t.itemsDef=String(e.itemsDef)),null!=e.blocksDef&&(t.blocksDef=String(e.blocksDef)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.itemsDef="",n.blocksDef=""),null!=e.itemsDef&&e.hasOwnProperty("itemsDef")&&(n.itemsDef=e.itemsDef),null!=e.blocksDef&&e.hasOwnProperty("blocksDef")&&(n.blocksDef=e.blocksDef),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.UpdateGameplaySetting=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.key="",i.prototype.value="",i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.UpdateGameplaySetting;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.key=e.string();break;case 2:i.value=e.string();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!r.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&!r.isString(e.value)?"value: string expected":null},i.fromObject=function(e){if(e instanceof o.UpdateGameplaySetting)return e;var t=new o.UpdateGameplaySetting;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=String(e.value)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.key="",n.value=""),null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(n.value=e.value),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o.PluginMessage=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.key="",i.prototype.version=0,i.prototype.value="",i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=n.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(16).uint32(e.version),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(26).string(e.value),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,i=new o.PluginMessage;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:i.key=e.string();break;case 2:i.version=e.uint32();break;case 3:i.value=e.string();break;default:e.skipType(7&s)}}return i},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!r.isString(e.key)?"key: string expected":null!=e.version&&e.hasOwnProperty("version")&&!r.isInteger(e.version)?"version: integer expected":null!=e.value&&e.hasOwnProperty("value")&&!r.isString(e.value)?"value: string expected":null},i.fromObject=function(e){if(e instanceof o.PluginMessage)return e;var t=new o.PluginMessage;return null!=e.key&&(t.key=String(e.key)),null!=e.version&&(t.version=e.version>>>0),null!=e.value&&(t.value=String(e.value)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.key="",n.version=0,n.value=""),null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.version&&e.hasOwnProperty("version")&&(n.version=e.version),null!=e.value&&e.hasOwnProperty("value")&&(n.value=e.value),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),o})?r.apply(t,o):r)||(e.exports=i)},function(e){e.exports=JSON.parse('["LoginResponse","ActionMove","ActionMessage","ActionBlockPlace","ActionBlockBreak","ActionInventoryClick","ActionInventoryOpen","ActionInventoryClose","ActionClick","ActionClickEntity","PluginMessage"]')},function(e){e.exports=JSON.parse('["LoginRequest","LoginSuccess","PlayerKick","PlayerEntity","PlayerTeleport","PlayerInventory","PlayerSlotUpdate","PlayerApplyImpulse","PlayerUpdateMovement","PlayerUpdatePhysics","PlayerHealth","PlayerOpenInventory","SoundPlay","ChatMessage","TabUpdate","EntityCreate","EntityRemove","EntityMove","EntityUpdate","EntityAnimate","WorldBlockUpdate","WorldChunkLoad","WorldChunkUnload","RegistryUpdate","UpdateGameplaySetting","PluginMessage"]')},function(e,t,n){"use strict";n.d(t,"a",(function(){return _})),n.d(t,"b",(function(){return x}));var r=n(163),o=n.n(r),i=n(175);class s extends i.a{constructor(){super(e=>(this._observers.add(e),()=>this._observers.delete(e))),this._observers=new Set}next(e){for(const t of this._observers)t.next(e)}error(e){for(const t of this._observers)t.error(e)}complete(){for(const e of this._observers)e.complete()}}var a=s;var c=function(e){"function"==typeof e?e():e&&"function"==typeof e.unsubscribe&&e.unsubscribe()};var u=function(e){const t=new a;let n,r=0;return new i.a(o=>{n||(n=e.subscribe(t));const i=t.subscribe(o);return r++,()=>{r--,i.unsubscribe(),0===r&&(c(n),n=void 0)}})},l=n(139);const f=()=>{},d=e=>e,p=e=>Promise.resolve().then(e);function h(e){throw e}class m extends i.a{constructor(e){super(t=>{const n=this,r=Object.assign(Object.assign({},t),{complete(){t.complete(),n.onCompletion()},error(e){t.error(e),n.onError(e)},next(e){t.next(e),n.onNext(e)}});try{return this.initHasRun=!0,e(r)}catch(e){r.error(e)}}),this.initHasRun=!1,this.fulfillmentCallbacks=[],this.rejectionCallbacks=[],this.firstValueSet=!1,this.state="pending"}onNext(e){this.firstValueSet||(this.firstValue=e,this.firstValueSet=!0)}onError(e){this.state="rejected",this.rejection=e;for(const t of this.rejectionCallbacks)p(()=>t(e))}onCompletion(){this.state="fulfilled";for(const e of this.fulfillmentCallbacks)p(()=>e(this.firstValue))}then(e,t){const n=e||d,r=t||h;let o=!1;return new Promise((e,t)=>{const i=n=>{if(!o){o=!0;try{e(r(n))}catch(e){t(e)}}};return this.initHasRun||this.subscribe({error:i}),"fulfilled"===this.state?e(n(this.firstValue)):"rejected"===this.state?(o=!0,e(r(this.rejection))):(this.fulfillmentCallbacks.push(t=>{try{e(n(t))}catch(e){i(e)}}),void this.rejectionCallbacks.push(i))})}catch(e){return this.then(void 0,e)}finally(e){const t=e||f;return this.then(e=>(t(),e),()=>t())}static from(e){return function(e){return e&&"function"==typeof e.then}(e)?new m(t=>{e.then(e=>{t.next(e),t.complete()},e=>{t.error(e)})}):super.from(e)}}var y=n(275),v=n(164);const g=o()("threads:master:messages");let b=1;function w(e,t){return new i.a(n=>{let r;const o=i=>{var s;if(g("Message from worker:",i.data),i.data&&i.data.uid===t)if((s=i.data)&&s.type===v.b.running)r=i.data.resultType;else if((e=>e&&e.type===v.b.result)(i.data))"promise"===r?(void 0!==i.data.payload&&n.next(Object(l.a)(i.data.payload)),n.complete(),e.removeEventListener("message",o)):(i.data.payload&&n.next(Object(l.a)(i.data.payload)),i.data.complete&&(n.complete(),e.removeEventListener("message",o)));else if((e=>e&&e.type===v.b.error)(i.data)){const t=Object(l.a)(i.data.error);n.error(t),e.removeEventListener("message",o)}};return e.addEventListener("message",o),()=>{if("observable"===r||!r){const n={type:v.a.cancel,uid:t};e.postMessage(n)}e.removeEventListener("message",o)}})}function _(e,t){return(...n)=>{const r=b++,{args:o,transferables:i}=function(e){if(0===e.length)return{args:[],transferables:[]};const t=[],n=[];for(const r of e)Object(y.a)(r)?(t.push(Object(l.b)(r.send)),n.push(...r.transferables)):t.push(Object(l.b)(r));return{args:t,transferables:0===n.length?n:(r=n,Array.from(new Set(r)))};var r}(n),s={type:v.a.run,uid:r,method:t,args:o};g("Sending command to run function to worker:",s);try{e.postMessage(s,i)}catch(e){return m.from(Promise.reject(e))}return m.from(u(w(e,r)))}}function x(e,t){const n={};for(const r of t)n[r]=_(e,r);return n}},,function(e,t){e.exports=1e-6},function(e,t){e.exports=function(){var e=new Float32Array(3);return e[0]=0,e[1]=0,e[2]=0,e}},function(e,t){e.exports=function(e,t,n){var r=new Float32Array(3);return r[0]=e,r[1]=t,r[2]=n,r}},function(e,t){e.exports=function(e,t){var n=t[0],r=t[1],o=t[2],i=n*n+r*r+o*o;i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i);return e}},function(e,t){e.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}},function(e,t){e.exports=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2];return Math.sqrt(n*n+r*r+o*o)}},function(e,t){e.exports=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2];return n*n+r*r+o*o}},function(e,t){e.exports=function(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)}},function(e,t){e.exports=function(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}},function(e,t,n){"use strict";e.exports=function(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=n;return t}},,,,,,,,,function(e,t,n){"use strict";var r=[],o=[],i=[],s=[],a=[],c=[],u=[],l=[],f=[],d=[],p=[],h=[];e.exports=function(e,t,n,m,y,v){for(var g=u,b=f,w=d,_=h,x=0;x<3;x++)g[x]=+n[x],w[x]=+t.max[x],b[x]=+t.base[x];v||(v=1e-10);var k=function(e,t,n,u,f,d){var h=r,m=o,y=i,v=s,g=a,b=c,w=l,_=Math.floor,x=0,k=0,O=0,P=0,C=0;if(S(),0===O)return 0;for(P=j();k<=O;){if(T(P))if(E())return x;P=j()}for(x+=O,C=0;C<3;C++)u[C]+=n[C],f[C]+=n[C];return x;function S(){if(k=0,0!==(O=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2])))for(var e=0;e<3;e++){var t=n[e]>=0;v[e]=t?1:-1;var r=t?f[e]:u[e];h[e]=t?u[e]:f[e],m[e]=M(r,v[e]),y[e]=D(h[e],v[e]),w[e]=n[e]/O,g[e]=Math.abs(1/w[e]);var o=t?m[e]+1-r:r-m[e];b[e]=g[e]<1/0?g[e]*o:1/0}}function T(t){for(var n=v[0],r=0===t?m[0]:y[0],o=m[0]+n,i=v[1],s=1===t?m[1]:y[1],a=m[1]+i,c=v[2],u=2===t?m[2]:y[2],l=m[2]+c,f=r;f!=o;f+=n)for(var d=s;d!=a;d+=i)for(var p=u;p!=l;p+=c)if(e(f,d,p))return!0;return!1}function E(){x+=k;var e=v[P],r=k/O,o=p;for(C=0;C<3;C++){var i=n[C]*r;u[C]+=i,f[C]+=i,o[C]=n[C]-i}if(e>0?f[P]=Math.round(f[P]):u[P]=Math.round(u[P]),t(x,P,e,o))return!0;for(C=0;C<3;C++)n[C]=o[C];return S(),0===O}function j(){var e=b[0]<b[1]?b[0]<b[2]?0:2:b[1]<b[2]?1:2,t=b[e]-k;for(k=b[e],m[e]+=v[e],b[e]+=g[e],C=0;C<3;C++)h[C]+=t*w[C],y[C]=D(h[C],v[C]);return e}function M(e,t){return _(e-t*d)}function D(e,t){return _(e+t*d)}}(e,m,g,b,w,v);if(!y){for(x=0;x<3;x++)_[x]=n[x]>0?w[x]-t.max[x]:b[x]-t.base[x];t.translate(_)}return k}},function(e,t,n){"use strict";e.exports={init:function(e){var t=o.nextPow2(e);s.length<t&&(r.free(s),s=r.mallocInt32(t));a.length<t&&(r.free(a),a=r.mallocInt32(t));c.length<t&&(r.free(c),c=r.mallocInt32(t));u.length<t&&(r.free(u),u=r.mallocInt32(t));l.length<t&&(r.free(l),l=r.mallocInt32(t));f.length<t&&(r.free(f),f=r.mallocInt32(t));var n=8*t;d.length<n&&(r.free(d),d=r.mallocDouble(n))},sweepBipartite:function(e,t,n,r,o,l,f,m,y,v){for(var g=0,b=2*e,w=e-1,_=b-1,x=n;x<r;++x){var k=l[x],O=b*x;d[g++]=o[O+w],d[g++]=-(k+1),d[g++]=o[O+_],d[g++]=k}for(x=f;x<m;++x){k=v[x]+(1<<28);var P=b*x;d[g++]=y[P+w],d[g++]=-k,d[g++]=y[P+_],d[g++]=k}var C=g>>>1;i(d,C);var S=0,T=0;for(x=0;x<C;++x){var E=0|d[2*x+1];if(E>=1<<28)p(c,u,T--,E=E-(1<<28)|0);else if(E>=0)p(s,a,S--,E);else if(E<=-(1<<28)){E=-E-(1<<28)|0;for(var j=0;j<S;++j){if(void 0!==(M=t(s[j],E)))return M}h(c,u,T++,E)}else{E=-E-1|0;for(j=0;j<T;++j){var M;if(void 0!==(M=t(E,c[j])))return M}h(s,a,S++,E)}}},sweepComplete:function(e,t,n,r,o,m,y,v,g,b){for(var w=0,_=2*e,x=e-1,k=_-1,O=n;O<r;++O){var P=m[O]+1<<1,C=_*O;d[w++]=o[C+x],d[w++]=-P,d[w++]=o[C+k],d[w++]=P}for(O=y;O<v;++O){P=b[O]+1<<1;var S=_*O;d[w++]=g[S+x],d[w++]=1|-P,d[w++]=g[S+k],d[w++]=1|P}var T=w>>>1;i(d,T);var E=0,j=0,M=0;for(O=0;O<T;++O){var D=0|d[2*O+1],A=1&D;if(O<T-1&&D>>1==d[2*O+3]>>1&&(A=2,O+=1),D<0){for(var I=-(D>>1)-1,R=0;R<M;++R){if(void 0!==(B=t(l[R],I)))return B}if(0!==A)for(R=0;R<E;++R){if(void 0!==(B=t(s[R],I)))return B}if(1!==A)for(R=0;R<j;++R){var B;if(void 0!==(B=t(c[R],I)))return B}0===A?h(s,a,E++,I):1===A?h(c,u,j++,I):2===A&&h(l,f,M++,I)}else{I=(D>>1)-1;0===A?p(s,a,E--,I):1===A?p(c,u,j--,I):2===A&&p(l,f,M--,I)}}},scanBipartite:function(e,t,n,r,o,c,u,l,f,m,y,v){var g=0,b=2*e,w=t,_=t+e,x=1,k=1;r?k=1<<28:x=1<<28;for(var O=o;O<c;++O){var P=O+x,C=b*O;d[g++]=u[C+w],d[g++]=-P,d[g++]=u[C+_],d[g++]=P}for(O=f;O<m;++O){P=O+k;var S=b*O;d[g++]=y[S+w],d[g++]=-P}var T=g>>>1;i(d,T);var E=0;for(O=0;O<T;++O){var j=0|d[2*O+1];if(j<0){var M=!1;if((P=-j)>=1<<28?(M=!r,P-=1<<28):(M=!!r,P-=1),M)h(s,a,E++,P);else{var D=v[P],A=b*P,I=y[A+t+1],R=y[A+t+1+e];e:for(var B=0;B<E;++B){var L=s[B],z=b*L;if(!(R<u[z+t+1]||u[z+t+1+e]<I)){for(var F=t+2;F<e;++F)if(y[A+F+e]<u[z+F]||u[z+F+e]<y[A+F])continue e;var N,U=l[L];if(void 0!==(N=r?n(D,U):n(U,D)))return N}}}}else p(s,a,E--,j-x)}},scanComplete:function(e,t,n,r,o,a,c,u,l,f,p){for(var h=0,m=2*e,y=t,v=t+e,g=r;g<o;++g){var b=g+(1<<28),w=m*g;d[h++]=a[w+y],d[h++]=-b,d[h++]=a[w+v],d[h++]=b}for(g=u;g<l;++g){b=g+1;var _=m*g;d[h++]=f[_+y],d[h++]=-b}var x=h>>>1;i(d,x);var k=0;for(g=0;g<x;++g){var O=0|d[2*g+1];if(O<0){if((b=-O)>=1<<28)s[k++]=b-(1<<28);else{var P=p[b-=1],C=m*b,S=f[C+t+1],T=f[C+t+1+e];e:for(var E=0;E<k;++E){var j=s[E],M=c[j];if(M===P)break;var D=m*j;if(!(T<a[D+t+1]||a[D+t+1+e]<S)){for(var A=t+2;A<e;++A)if(f[C+A+e]<a[D+A]||a[D+A+e]<f[C+A])continue e;var I=n(M,P);if(void 0!==I)return I}}}}else{for(b=O-(1<<28),E=k-1;E>=0;--E)if(s[E]===b){for(A=E+1;A<k;++A)s[A-1]=s[A];break}--k}}}};var r=n(232),o=n(233),i=n(344),s=r.mallocInt32(1024),a=r.mallocInt32(1024),c=r.mallocInt32(1024),u=r.mallocInt32(1024),l=r.mallocInt32(1024),f=r.mallocInt32(1024),d=r.mallocDouble(8192);function p(e,t,n,r){var o=t[r],i=e[n-1];e[o]=i,t[i]=o}function h(e,t,n,r){e[n]=r,t[r]=n}},function(e,t,n){"use strict";e.exports=function(e,t){var n="abcdef".split("").concat(t),r=[];e.indexOf("lo")>=0&&r.push("lo=e[k+n]");e.indexOf("hi")>=0&&r.push("hi=e[k+o]");return n.push("for(var j=2*a,k=j*c,l=k,m=c,n=b,o=a+b,p=c;d>p;++p,k+=j){var _;if($)if(m===p)m+=1,l+=j;else{for(var s=0;j>s;++s){var t=e[k+s];e[k+s]=e[l],e[l++]=t}var u=f[p];f[p]=f[m],f[m++]=u}}return m".replace("_",r.join()).replace("$",e)),Function.apply(void 0,n)}},,function(e,t,n){"use strict";e.exports=n(357)},function(e,t,n){"use strict";e.exports=f;var r,o=n(146),i=o.LongBits,s=o.base64,a=o.utf8;function c(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function u(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function f(){this.len=0,this.head=new c(u,0,0),this.tail=this.head,this.states=null}var d=function(){return o.Buffer?function(){return(f.create=function(){return new r})()}:function(){return new f}};function p(e,t,n){t[n]=255&e}function h(e,t){this.len=e,this.next=void 0,this.val=t}function m(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function y(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}f.create=d(),f.alloc=function(e){return new o.Array(e)},o.Array!==Array&&(f.alloc=o.pool(f.alloc,o.Array.prototype.subarray)),f.prototype._push=function(e,t,n){return this.tail=this.tail.next=new c(e,t,n),this.len+=t,this},h.prototype=Object.create(c.prototype),h.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},f.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new h((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},f.prototype.int32=function(e){return e<0?this._push(m,10,i.fromNumber(e)):this.uint32(e)},f.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},f.prototype.uint64=function(e){var t=i.from(e);return this._push(m,t.length(),t)},f.prototype.int64=f.prototype.uint64,f.prototype.sint64=function(e){var t=i.from(e).zzEncode();return this._push(m,t.length(),t)},f.prototype.bool=function(e){return this._push(p,1,e?1:0)},f.prototype.fixed32=function(e){return this._push(y,4,e>>>0)},f.prototype.sfixed32=f.prototype.fixed32,f.prototype.fixed64=function(e){var t=i.from(e);return this._push(y,4,t.lo)._push(y,4,t.hi)},f.prototype.sfixed64=f.prototype.fixed64,f.prototype.float=function(e){return this._push(o.float.writeFloatLE,4,e)},f.prototype.double=function(e){return this._push(o.float.writeDoubleLE,8,e)};var v=o.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};f.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(p,1,0);if(o.isString(e)){var n=f.alloc(t=s.length(e));s.decode(e,n,0),e=n}return this.uint32(t)._push(v,t,e)},f.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(p,1,0)},f.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new c(u,0,0),this.len=0,this},f.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(u,0,0),this.len=0),this},f.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},f.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},f._configure=function(e){r=e,f.create=d(),r._configure()}},function(e,t,n){"use strict";e.exports=c;var r,o=n(146),i=o.LongBits,s=o.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var u,l="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},f=function(){return o.Buffer?function(e){return(c.create=function(e){return o.Buffer.isBuffer(e)?new r(e):l(e)})(e)}:l};function d(){var e=new i(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function p(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function h(){if(this.pos+8>this.len)throw a(this,8);return new i(p(this.buf,this.pos+=4),p(this.buf,this.pos+=4))}c.create=f(),c.prototype._slice=o.Array.prototype.subarray||o.Array.prototype.slice,c.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return u;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return u}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return p(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|p(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=o.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=o.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},c.prototype.string=function(){var e=this.bytes();return s.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){r=e,c.create=f(),r._configure();var t=o.Long?"toLong":"toNumber";o.merge(c.prototype,{int64:function(){return d.call(this)[t](!1)},uint64:function(){return d.call(this)[t](!0)},sint64:function(){return d.call(this).zzDecode()[t](!1)},fixed64:function(){return h.call(this)[t](!0)},sfixed64:function(){return h.call(this)[t](!1)}})}},function(e,t,n){parcelRequire=function(t,r,o,i){var s,a="function"==typeof parcelRequire&&parcelRequire;function c(e,o){if(!r[e]){if(!t[e]){var i="function"==typeof parcelRequire&&parcelRequire;if(!o&&i)return i(e,!0);if(a)return a(e,!0);if("string"==typeof e)return n(371)(e);var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}l.resolve=function(n){return t[e][1][n]||n},l.cache={};var u=r[e]=new c.Module(e);t[e][0].call(u.exports,l,u,u.exports,this)}return r[e].exports;function l(e){return c(l.resolve(e))}}c.isParcelRequire=!0,c.Module=function(e){this.id=e,this.bundle=c,this.exports={}},c.modules=t,c.cache=r,c.parent=a,c.register=function(e,n){t[e]=[function(e,t){t.exports=n},{}]};for(var u=0;u<o.length;u++)try{c(o[u])}catch(t){s||(s=t)}if(o.length){var l=c(o[o.length-1]);e.exports=l}if(parcelRequire=c,s)throw s;return c}({EgBh:[function(e,t,n){var r={};r.useBlobBuilder=function(){try{return new Blob([]),!1}catch(e){return!0}}(),r.useArrayBufferView=!r.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(e){return!0}}(),t.exports.binaryFeatures=r;var o=t.exports.BlobBuilder;function i(){this._pieces=[],this._parts=[]}"undefined"!=typeof window&&(o=t.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder),i.prototype.append=function(e){"number"==typeof e?this._pieces.push(e):(this.flush(),this._parts.push(e))},i.prototype.flush=function(){if(this._pieces.length>0){var e=new Uint8Array(this._pieces);r.useArrayBufferView||(e=e.buffer),this._parts.push(e),this._pieces=[]}},i.prototype.getBuffer=function(){if(this.flush(),r.useBlobBuilder){for(var e=new o,t=0,n=this._parts.length;t<n;t++)e.append(this._parts[t]);return e.getBlob()}return new Blob(this._parts)},t.exports.BufferBuilder=i},{}],kdPp:[function(e,t,n){var r=e("./bufferbuilder").BufferBuilder,o=e("./bufferbuilder").binaryFeatures,i={unpack:function(e){return new s(e).unpack()},pack:function(e){var t=new a;return t.pack(e),t.getBuffer()}};function s(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function a(){this.bufferBuilder=new r}function c(e){var t=e.charCodeAt(0);return t<=2047?"00":t<=65535?"000":t<=2097151?"0000":t<=67108863?"00000":"000000"}t.exports=i,s.prototype.unpack=function(){var e,t=this.unpack_uint8();if(t<128)return t;if((224^t)<32)return(224^t)-32;if((e=160^t)<=15)return this.unpack_raw(e);if((e=176^t)<=15)return this.unpack_string(e);if((e=144^t)<=15)return this.unpack_array(e);if((e=128^t)<=15)return this.unpack_map(e);switch(t){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:case 213:case 214:case 215:return;case 216:return e=this.unpack_uint16(),this.unpack_string(e);case 217:return e=this.unpack_uint32(),this.unpack_string(e);case 218:return e=this.unpack_uint16(),this.unpack_raw(e);case 219:return e=this.unpack_uint32(),this.unpack_raw(e);case 220:return e=this.unpack_uint16(),this.unpack_array(e);case 221:return e=this.unpack_uint32(),this.unpack_array(e);case 222:return e=this.unpack_uint16(),this.unpack_map(e);case 223:return e=this.unpack_uint32(),this.unpack_map(e)}},s.prototype.unpack_uint8=function(){var e=255&this.dataView[this.index];return this.index++,e},s.prototype.unpack_uint16=function(){var e=this.read(2),t=256*(255&e[0])+(255&e[1]);return this.index+=2,t},s.prototype.unpack_uint32=function(){var e=this.read(4),t=256*(256*(256*e[0]+e[1])+e[2])+e[3];return this.index+=4,t},s.prototype.unpack_uint64=function(){var e=this.read(8),t=256*(256*(256*(256*(256*(256*(256*e[0]+e[1])+e[2])+e[3])+e[4])+e[5])+e[6])+e[7];return this.index+=8,t},s.prototype.unpack_int8=function(){var e=this.unpack_uint8();return e<128?e:e-256},s.prototype.unpack_int16=function(){var e=this.unpack_uint16();return e<32768?e:e-65536},s.prototype.unpack_int32=function(){var e=this.unpack_uint32();return e<Math.pow(2,31)?e:e-Math.pow(2,32)},s.prototype.unpack_int64=function(){var e=this.unpack_uint64();return e<Math.pow(2,63)?e:e-Math.pow(2,64)},s.prototype.unpack_raw=function(e){if(this.length<this.index+e)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+e+" "+this.length);var t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t},s.prototype.unpack_string=function(e){for(var t,n,r=this.read(e),o=0,i="";o<e;)(t=r[o])<128?(i+=String.fromCharCode(t),o++):(192^t)<32?(n=(192^t)<<6|63&r[o+1],i+=String.fromCharCode(n),o+=2):(n=(15&t)<<12|(63&r[o+1])<<6|63&r[o+2],i+=String.fromCharCode(n),o+=3);return this.index+=e,i},s.prototype.unpack_array=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=this.unpack();return t},s.prototype.unpack_map=function(e){for(var t={},n=0;n<e;n++){var r=this.unpack(),o=this.unpack();t[r]=o}return t},s.prototype.unpack_float=function(){var e=this.unpack_uint32(),t=(e>>23&255)-127;return(0==e>>31?1:-1)*(8388607&e|8388608)*Math.pow(2,t-23)},s.prototype.unpack_double=function(){var e=this.unpack_uint32(),t=this.unpack_uint32(),n=(e>>20&2047)-1023;return(0==e>>31?1:-1)*((1048575&e|1048576)*Math.pow(2,n-20)+t*Math.pow(2,n-52))},s.prototype.read=function(e){var t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")},a.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},a.prototype.pack=function(e){var t=typeof e;if("string"===t)this.pack_string(e);else if("number"===t)Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if("boolean"===t)!0===e?this.bufferBuilder.append(195):!1===e&&this.bufferBuilder.append(194);else if("undefined"===t)this.bufferBuilder.append(192);else{if("object"!==t)throw new Error('Type "'+t+'" not yet supported');if(null===e)this.bufferBuilder.append(192);else{var n=e.constructor;if(n==Array)this.pack_array(e);else if(n==Blob||n==File||e instanceof Blob||e instanceof File)this.pack_bin(e);else if(n==ArrayBuffer)o.useArrayBufferView?this.pack_bin(new Uint8Array(e)):this.pack_bin(e);else if("BYTES_PER_ELEMENT"in e)o.useArrayBufferView?this.pack_bin(new Uint8Array(e.buffer)):this.pack_bin(e.buffer);else if(n==Object||n.toString().startsWith("class"))this.pack_object(e);else if(n==Date)this.pack_string(e.toString());else{if("function"!=typeof e.toBinaryPack)throw new Error('Type "'+n.toString()+'" not yet supported');this.bufferBuilder.append(e.toBinaryPack())}}}this.bufferBuilder.flush()},a.prototype.pack_bin=function(e){var t=e.length||e.byteLength||e.size;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this.bufferBuilder.append(218),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(t)}this.bufferBuilder.append(e)},a.prototype.pack_string=function(e){var t=function(e){return e.length>600?new Blob([e]).size:e.replace(/[^\u0000-\u007F]/g,c).length}(e);if(t<=15)this.pack_uint8(176+t);else if(t<=65535)this.bufferBuilder.append(216),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(t)}this.bufferBuilder.append(e)},a.prototype.pack_array=function(e){var t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this.bufferBuilder.append(220),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(t)}for(var n=0;n<t;n++)this.pack(e[n])},a.prototype.pack_integer=function(e){if(e>=-32&&e<=127)this.bufferBuilder.append(255&e);else if(e>=0&&e<=255)this.bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this.bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this.bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this.bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this.bufferBuilder.append(210),this.pack_int32(e);else if(e>=-0x8000000000000000&&e<=0x8000000000000000)this.bufferBuilder.append(211),this.pack_int64(e);else{if(!(e>=0&&e<=0x10000000000000000))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(e)}},a.prototype.pack_double=function(e){var t=0;e<0&&(t=1,e=-e);var n=Math.floor(Math.log(e)/Math.LN2),r=e/Math.pow(2,n)-1,o=Math.floor(r*Math.pow(2,52)),i=Math.pow(2,32),s=t<<31|n+1023<<20|o/i&1048575,a=o%i;this.bufferBuilder.append(203),this.pack_int32(s),this.pack_int32(a)},a.prototype.pack_object=function(e){var t=Object.keys(e).length;if(t<=15)this.pack_uint8(128+t);else if(t<=65535)this.bufferBuilder.append(222),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(t)}for(var n in e)e.hasOwnProperty(n)&&(this.pack(n),this.pack(e[n]))},a.prototype.pack_uint8=function(e){this.bufferBuilder.append(e)},a.prototype.pack_uint16=function(e){this.bufferBuilder.append(e>>8),this.bufferBuilder.append(255&e)},a.prototype.pack_uint32=function(e){var t=4294967295&e;this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t)},a.prototype.pack_uint64=function(e){var t=e/Math.pow(2,32),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)},a.prototype.pack_int8=function(e){this.bufferBuilder.append(255&e)},a.prototype.pack_int16=function(e){this.bufferBuilder.append((65280&e)>>8),this.bufferBuilder.append(255&e)},a.prototype.pack_int32=function(e){this.bufferBuilder.append(e>>>24&255),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},a.prototype.pack_int64=function(e){var t=Math.floor(e/Math.pow(2,32)),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)}},{"./bufferbuilder":"EgBh"}],iSxC:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.extractVersion=s,n.wrapPeerConnectionEvent=function(e,t,n){if(e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype,o=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return o.apply(this,arguments);var i=function(e){var t=n(e);t&&r(t)};return this._eventMap=this._eventMap||{},this._eventMap[r]=i,o.apply(this,[e,i])};var i=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[n])return i.apply(this,arguments);var r=this._eventMap[n];return delete this._eventMap[n],i.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}},n.disableLog=function(e){return"boolean"!=typeof e?new Error("Argument type: "+r(e)+". Please use a boolean."):(o=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},n.disableWarnings=function(e){return"boolean"!=typeof e?new Error("Argument type: "+r(e)+". Please use a boolean."):(i=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},n.log=function(){if("object"===("undefined"==typeof window?"undefined":r(window))){if(o)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},n.deprecated=function(e,t){i&&console.warn(e+" is deprecated, please use "+t+" instead.")},n.detectBrowser=function(e){var{navigator:t}=e,n={browser:null,version:null};if(void 0===e||!e.navigator)return n.browser="Not a browser.",n;if(t.mozGetUserMedia)n.browser="firefox",n.version=s(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)n.browser="chrome",n.version=s(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))n.browser="edge",n.version=s(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return n.browser="Not a supported browser.",n;n.browser="safari",n.version=s(t.userAgent,/AppleWebKit\/(\d+)\./,1),n.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return n},n.compactObject=function e(t){return a(t)?Object.keys(t).reduce((function(n,r){var o=a(t[r]),i=o?e(t[r]):t[r],s=o&&!Object.keys(i).length;return void 0===i||s?n:Object.assign(n,function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},r,i))}),{}):t},n.walkStats=c,n.filterStats=function(e,t,n){var r=n?"outbound-rtp":"inbound-rtp",o=new Map;if(null===t)return o;var i=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&i.push(e)})),i.forEach((function(t){e.forEach((function(n){n.type===r&&n.trackId===t.id&&c(e,n,o)}))})),o};var o=!0,i=!0;function s(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function a(e){return"[object Object]"===Object.prototype.toString.call(e)}function c(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((function(r){r.endsWith("Id")?c(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach((function(t){c(e,e.get(t),n)}))})))}},{}],s6SN:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices){var n=r.detectBrowser(e),o=function(e){if("object"!==i(e)||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"===i(e[n])?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var o=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var s={};"number"==typeof r.ideal?(s[o("min",n)]=r.ideal,t.optional.push(s),(s={})[o("max",n)]=r.ideal,t.optional.push(s)):(s[o("",n)]=r.ideal,t.optional.push(s))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[o("",n)]=r.exact):["min","max"].forEach((function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[o(e,n)]=r[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},a=function(e,r){if(n.version>=61)return r(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===i(e.audio)){var a=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};a((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),a(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=o(e.audio)}if(e&&"object"===i(e.video)){var c=e.video.facingMode;c=c&&("object"===i(c)?c:{ideal:c});var u,l=n.version<66;if(c&&("user"===c.exact||"environment"===c.exact||"user"===c.ideal||"environment"===c.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||l)&&(delete e.video.facingMode,"environment"===c.exact||"environment"===c.ideal?u=["back","rear"]:"user"!==c.exact&&"user"!==c.ideal||(u=["front"]),u))return t.mediaDevices.enumerateDevices().then((function(t){var n=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return u.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!n&&t.length&&u.includes("back")&&(n=t[t.length-1]),n&&(e.video.deviceId=c.exact?{exact:n.deviceId}:{ideal:n.deviceId}),e.video=o(e.video),s("chrome: "+JSON.stringify(e)),r(e)}));e.video=o(e.video)}return s("chrome: "+JSON.stringify(e)),r(e)},c=function(e){return n.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(t.getUserMedia=function(e,n,r){a(e,(function(e){t.webkitGetUserMedia(e,n,(function(e){r&&r(c(e))}))}))}.bind(t),t.mediaDevices.getUserMedia){var u=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return a(e,(function(e){return u(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(c(e))}))}))}}}};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var s=r?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../utils.js"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s=r.log},{"../utils.js":"iSxC"}],VHa8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((function(t){var r=n.video&&n.video.width,o=n.video&&n.video.height,i=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:i||3}},r&&(n.video.mandatory.maxWidth=r),o&&(n.video.mandatory.maxHeight=o),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},{}],uI5X:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},n.shimOnTrack=function(e){if("object"!==c(e)||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype)r.wrapPeerConnectionEvent(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}));else{Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(r){var o;o=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.track.id})):{track:r.track};var i=new Event("track");i.track=r.track,i.receiver=o,i.transceiver={receiver:o},i.streams=[t.stream],n.dispatchEvent(i)})),t.stream.getTracks().forEach((function(r){var o;o=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.id})):{track:r};var i=new Event("track");i.track=r,i.receiver=o,i.transceiver={receiver:o},i.streams=[t.stream],n.dispatchEvent(i)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}},n.shimGetSendersWithDtmf=function(e){if("object"===c(e)&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){var o=n.apply(this,arguments);return o||(o=t(this,e),this._senders.push(o)),o};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var o=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach((function(e){n._senders.push(t(n,e))}))};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((function(e){var n=t._senders.find((function(t){return t.track===e}));n&&t._senders.splice(t._senders.indexOf(n),1)}))}}else if("object"===c(e)&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var s=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=s.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},n.shimGetStats=function(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,[n,r,o]=arguments;if(arguments.length>0&&"function"==typeof n)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof n))return t.apply(this,[]);var i=function(e){var t={};return e.result().forEach((function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){n[t]=e.stat(t)})),t[n.id]=n})),t},s=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};return arguments.length>=2?t.apply(this,[function(e){r(s(i(e)))},n]):new Promise((function(n,r){t.apply(e,[function(e){n(s(i(e)))},r])})).then(r,o)}}},n.shimSenderReceiverGetStats=function(e){if("object"===c(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return r.filterStats(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var o=e.RTCPeerConnection.prototype.getReceivers;o&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=o.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),r.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return r.filterStats(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t,n,r,o=arguments[0];return this.getSenders().forEach((function(e){e.track===o&&(t?r=!0:t=e)})),this.getReceivers().forEach((function(e){return e.track===o&&(n?r=!0:n=e),e.track===o})),r||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return i.apply(this,arguments)}}}},n.shimAddTrackRemoveTrackWithNative=u,n.shimAddTrackRemoveTrack=function(e){if(e.RTCPeerConnection){var t=r.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return u(e);var n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=n.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var o=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var n=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(n.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var r=new e.MediaStream(t.getTracks());this._streams[t.id]=r,this._reverseStreams[r.id]=t,t=r}o.apply(this,[t])};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var o=[].slice.call(arguments,1);if(1!==o.length||!o[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((function(e){return e.track===t})))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var i=this._streams[n.id];if(i)i.addTrack(t),Promise.resolve().then((function(){r.dispatchEvent(new Event("negotiationneeded"))}));else{var s=new e.MediaStream([t]);this._streams[n.id]=s,this._reverseStreams[s.id]=n,this.addStream(s)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=a({},t,(function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[function(n){var r=l(e,n);t[0].apply(null,[r])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):n.apply(this,arguments).then((function(t){return l(e,t)}))}));e.RTCPeerConnection.prototype[t]=r[t]}));var s=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=(e=this,n=(t=arguments[0]).sdp,Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],o=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),o.id)})),new RTCSessionDescription({type:t.type,sdp:n})),s.apply(this,arguments)):s.apply(this,arguments);var e,t,n};var c=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=c.get.apply(this);return""===e.type?e:l(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach((function(r){n._streams[r].getTracks().find((function(t){return e.track===t}))&&(t=n._streams[r])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function l(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],o=e._streams[r.id];n=n.replace(new RegExp(o.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}},n.shimPeerConnection=function(e){var t=r.detectBrowser(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection){t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=a({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=r[t]}));var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?t.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},n.fixNegotiationNeeded=function(e){r.wrapPeerConnectionEvent(e,"negotiationneeded",(function(e){if("stable"===e.target.signalingState)return e}))},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return o.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(e("../utils.js")),o=e("./getusermedia"),i=e("./getdisplaymedia");function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var r=this.getSenders();n.apply(this,arguments);var o=this.getSenders().filter((function(e){return-1===r.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(o)};var r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};var o=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(n){var r=t._shimmedLocalStreams[n].indexOf(e);-1!==r&&t._shimmedLocalStreams[n].splice(r,1),1===t._shimmedLocalStreams[n].length&&delete t._shimmedLocalStreams[n]})),o.apply(this,arguments)}}},{"../utils.js":"iSxC","./getusermedia":"s6SN","./getdisplaymedia":"VHa8"}],NZ1C:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.filterIceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&r.deprecated("RTCIceServer.url","RTCIceServer.urls");var o="string"==typeof t;return o&&(t=[t]),t=t.filter((function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?(n=!0,!0):t&&!n})),delete e.url,e.urls=o?t[0]:t,!!t.length}}))};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var s=r?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../utils"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}},{"../utils":"iSxC"}],YHvh:[function(e,t,n){"use strict";var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},r.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},r.getDescription=function(e){var t=r.splitSections(e);return t&&t[0]},r.getMediaSections=function(e){var t=r.splitSections(e);return t.shift(),t},r.matchPrefix=function(e,t){return r.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},r.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:n[t[r]]=t[r+1]}return n},r.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},r.parseIceOptions=function(e){return e.substr(14).split(" ")},r.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},r.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},r.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},r.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),o=0;o<r.length;o++)n[(t=r[o].trim().split("="))[0].trim()]=t[1];return n},r.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)})),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},r.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},r.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},r.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},r.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},r.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:r.matchPrefix(e+t,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},r.getIceParameters=function(e,t){var n=r.splitLines(e);return{usernameFragment:(n=n.concat(r.splitLines(t))).filter((function(e){return 0===e.indexOf("a=ice-ufrag:")}))[0].substr(12),password:n.filter((function(e){return 0===e.indexOf("a=ice-pwd:")}))[0].substr(10)}},r.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e)[0].split(" "),o=3;o<n.length;o++){var i=n[o],s=r.matchPrefix(e,"a=rtpmap:"+i+" ")[0];if(s){var a=r.parseRtpMap(s),c=r.matchPrefix(e,"a=fmtp:"+i+" ");switch(a.parameters=c.length?r.parseFmtp(c[0]):{},a.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+i+" ").map(r.parseRtcpFb),t.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(a.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(r.parseExtmap(e))})),t},r.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)}));var o=0;return t.codecs.forEach((function(e){e.maxptime>o&&(o=e.maxptime)})),o>0&&(n+="a=maxptime:"+o+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach((function(e){n+=r.writeExtmap(e)})),n},r.parseRtpEncodingParameters=function(e){var t,n=[],o=r.parseRtpParameters(e),i=-1!==o.fecMechanisms.indexOf("RED"),s=-1!==o.fecMechanisms.indexOf("ULPFEC"),a=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=a.length>0&&a[0].ssrc,u=r.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));u.length>0&&u[0].length>1&&u[0][0]===c&&(t=u[0][1]),o.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(r.rtx={ssrc:t}),n.push(r),i&&((r=JSON.parse(JSON.stringify(r))).fec={ssrc:c,mechanism:s?"red+ulpfec":"red"},n.push(r))}})),0===n.length&&c&&n.push({ssrc:c});var l=r.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,n.forEach((function(e){e.maxBitrate=l}))),n},r.parseRtcpParameters=function(e){var t={},n=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var o=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=o.length>0,t.compound=0===o.length;var i=r.matchPrefix(e,"a=rtcp-mux");return t.mux=i.length>0,t},r.parseMsid=function(e){var t,n=r.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};var o=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return o.length>0?{stream:(t=o[0].value.split(" "))[0],track:t[1]}:void 0},r.parseSctpDescription=function(e){var t,n=r.parseMLine(e),o=r.matchPrefix(e,"a=max-message-size:");o.length>0&&(t=parseInt(o[0].substr(19),10)),isNaN(t)&&(t=65536);var i=r.matchPrefix(e,"a=sctp-port:");if(i.length>0)return{port:parseInt(i[0].substr(12),10),protocol:n.fmt,maxMessageSize:t};if(r.matchPrefix(e,"a=sctpmap:").length>0){var s=r.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(s[0],10),protocol:s[1],maxMessageSize:t}}},r.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(e,t,n){var o=void 0!==t?t:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||r.generateSessionId())+" "+o+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,n,o){var i=r.writeRtpDescription(e.kind,t);if(i+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),i+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),i+="a=mid:"+e.mid+"\r\n",e.direction?i+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?i+="a=sendrecv\r\n":e.rtpSender?i+="a=sendonly\r\n":e.rtpReceiver?i+="a=recvonly\r\n":i+="a=inactive\r\n",e.rtpSender){var s="msid:"+o.id+" "+e.rtpSender.track.id+"\r\n";i+="a="+s,i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,i+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),i},r.getDirection=function(e,t){for(var n=r.splitLines(e),o=0;o<n.length;o++)switch(n[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[o].substr(2)}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){return r.splitLines(e)[0].split(" ")[0].substr(2)},r.isRejected=function(e){return"0"===e.split(" ",2)[1]},r.parseMLine=function(e){var t=r.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},r.parseOLine=function(e){var t=r.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},r.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=r.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||"="!==t[n].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=r)},{}],NJ2u:[function(e,t,n){"use strict";var r=e("sdp");function o(e,t,n,o,i){var s=r.writeRtpDescription(e.kind,t);if(s+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),s+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":i||"active"),s+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?s+="a=sendrecv\r\n":e.rtpSender?s+="a=sendonly\r\n":e.rtpReceiver?s+="a=recvonly\r\n":s+="a=inactive\r\n",e.rtpSender){var a=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=a;var c="msid:"+(o?o.id:"-")+" "+a+"\r\n";s+="a="+c,s+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,s+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return s+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),s}function i(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},o=function(e,t,n,o){var i=r(e.parameters.apt,n),s=r(t.parameters.apt,o);return i&&s&&i.name.toLowerCase()===s.name.toLowerCase()};return e.codecs.forEach((function(r){for(var i=0;i<t.codecs.length;i++){var s=t.codecs[i];if(r.name.toLowerCase()===s.name.toLowerCase()&&r.clockRate===s.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&s.parameters.apt&&!o(r,s,e.codecs,t.codecs))continue;(s=JSON.parse(JSON.stringify(s))).numChannels=Math.min(r.numChannels,s.numChannels),n.codecs.push(s),s.rtcpFeedback=s.rtcpFeedback.filter((function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var r=0;r<t.headerExtensions.length;r++){var o=t.headerExtensions[r];if(e.uri===o.uri){n.headerExtensions.push(o);break}}})),n}function s(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function a(e,t){var n=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return n||e.addRemoteCandidate(t),!n}function c(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}t.exports=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function u(t,n,r,o){var i=new Event("track");i.track=n,i.receiver=r,i.transceiver={receiver:r},i.streams=o,e.setTimeout((function(){t._dispatchEvent("track",i)}))}var l=function(n){var o=this,i=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){o[e]=i[e].bind(i)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var o="string"==typeof r;return o&&(r=[r]),r=r.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(n=!0,!0)})),delete e.url,e.urls=o?r[0]:r,!!r.length}}))}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var s=n.iceCandidatePoolSize;s>0;s--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=r.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(l.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(l.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),l.prototype.onicecandidate=null,l.prototype.onaddstream=null,l.prototype.ontrack=null,l.prototype.onremovestream=null,l.prototype.onsignalingstatechange=null,l.prototype.oniceconnectionstatechange=null,l.prototype.onconnectionstatechange=null,l.prototype.onicegatheringstatechange=null,l.prototype.onnegotiationneeded=null,l.prototype.ondatachannel=null,l.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},l.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},l.prototype.getConfiguration=function(){return this._config},l.prototype.getLocalStreams=function(){return this.localStreams},l.prototype.getRemoteStreams=function(){return this.remoteStreams},l.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var o=this._createIceAndDtlsTransports();r.iceTransport=o.iceTransport,r.dtlsTransport=o.dtlsTransport}return t||this.transceivers.push(r),r},l.prototype.addTrack=function(t,n){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find((function(e){return e.track===t})))throw c("InvalidAccessError","Track already exists.");for(var o=0;o<this.transceivers.length;o++)this.transceivers[o].track||this.transceivers[o].kind!==t.kind||(r=this.transceivers[o]);return r||(r=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),r.track=t,r.stream=n,r.rtpSender=new e.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},l.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach((function(t){n.addTrack(t,e)}));else{var r=e.clone();e.getTracks().forEach((function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",(function(e){n.enabled=e.enabled}))})),r.getTracks().forEach((function(e){n.addTrack(e,r)}))}},l.prototype.removeTrack=function(t){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find((function(e){return e.rtpSender===t}));if(!n)throw c("InvalidAccessError","Sender was not created by this connection.");var r=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},l.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var n=t.getSenders().find((function(t){return t.track===e}));n&&t.removeTrack(n)}))},l.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},l.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},l.prototype._createIceGatherer=function(t,n){var r=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var o=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(o,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;o.state=n?"completed":"gathering",null!==r.transceivers[t].bufferedCandidateEvents&&r.transceivers[t].bufferedCandidateEvents.push(e)},o.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),o},l.prototype._gather=function(t,n){var o=this,i=this.transceivers[n].iceGatherer;if(!i.onlocalcandidate){var s=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,i.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),i.onlocalcandidate=function(e){if(!(o.usingBundle&&n>0)){var s=new Event("icecandidate");s.candidate={sdpMid:t,sdpMLineIndex:n};var a=e.candidate,c=!a||0===Object.keys(a).length;if(c)"new"!==i.state&&"gathering"!==i.state||(i.state="completed");else{"new"===i.state&&(i.state="gathering"),a.component=1,a.ufrag=i.getLocalParameters().usernameFragment;var u=r.writeCandidate(a);s.candidate=Object.assign(s.candidate,r.parseCandidate(u)),s.candidate.candidate=u,s.candidate.toJSON=function(){return{candidate:s.candidate.candidate,sdpMid:s.candidate.sdpMid,sdpMLineIndex:s.candidate.sdpMLineIndex,usernameFragment:s.candidate.usernameFragment}}}var l=r.getMediaSections(o._localDescription.sdp);l[s.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+s.candidate.candidate+"\r\n",o._localDescription.sdp=r.getDescription(o._localDescription.sdp)+l.join("");var f=o.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==o.iceGatheringState&&(o.iceGatheringState="gathering",o._emitGatheringStateChange()),c||o._dispatchEvent("icecandidate",s),f&&(o._dispatchEvent("icecandidate",new Event("icecandidate")),o.iceGatheringState="complete",o._emitGatheringStateChange())}},e.setTimeout((function(){s.forEach((function(e){i.onlocalcandidate(e)}))}),0)}},l.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var r=new e.RTCDtlsTransport(n);return r.ondtlsstatechange=function(){t._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:r}},l.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var r=this.transceivers[e].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[e].dtlsTransport)},l.prototype._transceive=function(e,n,o){var s=i(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(s.encodings=e.sendEncodingParameters,s.rtcp={cname:r.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(s.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(s)),o&&e.rtpReceiver&&s.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?s.encodings=e.recvEncodingParameters:s.encodings=[{}],s.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(s.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(s.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(s))},l.prototype.setLocalDescription=function(e){var t,n,o=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(c("TypeError",'Unsupported type "'+e.type+'"'));if(!s("setLocalDescription",e.type,o.signalingState)||o._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+e.type+" in state "+o.signalingState));if("offer"===e.type)t=r.splitSections(e.sdp),n=t.shift(),t.forEach((function(e,t){var n=r.parseRtpParameters(e);o.transceivers[t].localCapabilities=n})),o.transceivers.forEach((function(e,t){o._gather(e.mid,t)}));else if("answer"===e.type){t=r.splitSections(o._remoteDescription.sdp),n=t.shift();var a=r.matchPrefix(n,"a=ice-lite").length>0;t.forEach((function(e,t){var s=o.transceivers[t],c=s.iceGatherer,u=s.iceTransport,l=s.dtlsTransport,f=s.localCapabilities,d=s.remoteCapabilities;if(!(r.isRejected(e)&&0===r.matchPrefix(e,"a=bundle-only").length||s.rejected)){var p=r.getIceParameters(e,n),h=r.getDtlsParameters(e,n);a&&(h.role="server"),o.usingBundle&&0!==t||(o._gather(s.mid,t),"new"===u.state&&u.start(c,p,a?"controlling":"controlled"),"new"===l.state&&l.start(h));var m=i(f,d);o._transceive(s,m.codecs.length>0,!1)}}))}return o._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?o._updateSignalingState("have-local-offer"):o._updateSignalingState("stable"),Promise.resolve()},l.prototype.setRemoteDescription=function(o){var l=this;if(-1===["offer","answer"].indexOf(o.type))return Promise.reject(c("TypeError",'Unsupported type "'+o.type+'"'));if(!s("setRemoteDescription",o.type,l.signalingState)||l._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+o.type+" in state "+l.signalingState));var f={};l.remoteStreams.forEach((function(e){f[e.id]=e}));var d=[],p=r.splitSections(o.sdp),h=p.shift(),m=r.matchPrefix(h,"a=ice-lite").length>0,y=r.matchPrefix(h,"a=group:BUNDLE ").length>0;l.usingBundle=y;var v=r.matchPrefix(h,"a=ice-options:")[0];return l.canTrickleIceCandidates=!!v&&v.substr(14).split(" ").indexOf("trickle")>=0,p.forEach((function(s,c){var u=r.splitLines(s),p=r.getKind(s),v=r.isRejected(s)&&0===r.matchPrefix(s,"a=bundle-only").length,g=u[0].substr(2).split(" ")[2],b=r.getDirection(s,h),w=r.parseMsid(s),_=r.getMid(s)||r.generateIdentifier();if(v||"application"===p&&("DTLS/SCTP"===g||"UDP/DTLS/SCTP"===g))l.transceivers[c]={mid:_,kind:p,protocol:g,rejected:!0};else{var x,k,O,P,C,S,T,E,j;!v&&l.transceivers[c]&&l.transceivers[c].rejected&&(l.transceivers[c]=l._createTransceiver(p,!0));var M,D,A=r.parseRtpParameters(s);v||(M=r.getIceParameters(s,h),(D=r.getDtlsParameters(s,h)).role="client"),T=r.parseRtpEncodingParameters(s);var I=r.parseRtcpParameters(s),R=r.matchPrefix(s,"a=end-of-candidates",h).length>0,B=r.matchPrefix(s,"a=candidate:").map((function(e){return r.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===o.type||"answer"===o.type)&&!v&&y&&c>0&&l.transceivers[c]&&(l._disposeIceAndDtlsTransports(c),l.transceivers[c].iceGatherer=l.transceivers[0].iceGatherer,l.transceivers[c].iceTransport=l.transceivers[0].iceTransport,l.transceivers[c].dtlsTransport=l.transceivers[0].dtlsTransport,l.transceivers[c].rtpSender&&l.transceivers[c].rtpSender.setTransport(l.transceivers[0].dtlsTransport),l.transceivers[c].rtpReceiver&&l.transceivers[c].rtpReceiver.setTransport(l.transceivers[0].dtlsTransport)),"offer"!==o.type||v)"answer"!==o.type||v||(k=(x=l.transceivers[c]).iceGatherer,O=x.iceTransport,P=x.dtlsTransport,C=x.rtpReceiver,S=x.sendEncodingParameters,E=x.localCapabilities,l.transceivers[c].recvEncodingParameters=T,l.transceivers[c].remoteCapabilities=A,l.transceivers[c].rtcpParameters=I,B.length&&"new"===O.state&&(!m&&!R||y&&0!==c?B.forEach((function(e){a(x.iceTransport,e)})):O.setRemoteCandidates(B)),y&&0!==c||("new"===O.state&&O.start(k,M,"controlling"),"new"===P.state&&P.start(D)),!i(x.localCapabilities,x.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&x.sendEncodingParameters[0].rtx&&delete x.sendEncodingParameters[0].rtx,l._transceive(x,"sendrecv"===b||"recvonly"===b,"sendrecv"===b||"sendonly"===b),!C||"sendrecv"!==b&&"sendonly"!==b?delete x.rtpReceiver:(j=C.track,w?(f[w.stream]||(f[w.stream]=new e.MediaStream),n(j,f[w.stream]),d.push([j,C,f[w.stream]])):(f.default||(f.default=new e.MediaStream),n(j,f.default),d.push([j,C,f.default]))));else{(x=l.transceivers[c]||l._createTransceiver(p)).mid=_,x.iceGatherer||(x.iceGatherer=l._createIceGatherer(c,y)),B.length&&"new"===x.iceTransport.state&&(!R||y&&0!==c?B.forEach((function(e){a(x.iceTransport,e)})):x.iceTransport.setRemoteCandidates(B)),E=e.RTCRtpReceiver.getCapabilities(p),t<15019&&(E.codecs=E.codecs.filter((function(e){return"rtx"!==e.name}))),S=x.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var L,z=!1;"sendrecv"===b||"sendonly"===b?(z=!x.rtpReceiver,C=x.rtpReceiver||new e.RTCRtpReceiver(x.dtlsTransport,p),z&&(j=C.track,w&&"-"===w.stream||(w?(f[w.stream]||(f[w.stream]=new e.MediaStream,Object.defineProperty(f[w.stream],"id",{get:function(){return w.stream}})),Object.defineProperty(j,"id",{get:function(){return w.track}}),L=f[w.stream]):(f.default||(f.default=new e.MediaStream),L=f.default)),L&&(n(j,L),x.associatedRemoteMediaStreams.push(L)),d.push([j,C,L]))):x.rtpReceiver&&x.rtpReceiver.track&&(x.associatedRemoteMediaStreams.forEach((function(t){var n,r,o=t.getTracks().find((function(e){return e.id===x.rtpReceiver.track.id}));o&&(n=o,(r=t).removeTrack(n),r.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:n})))})),x.associatedRemoteMediaStreams=[]),x.localCapabilities=E,x.remoteCapabilities=A,x.rtpReceiver=C,x.rtcpParameters=I,x.sendEncodingParameters=S,x.recvEncodingParameters=T,l._transceive(l.transceivers[c],!1,z)}}})),void 0===l._dtlsRole&&(l._dtlsRole="offer"===o.type?"active":"passive"),l._remoteDescription={type:o.type,sdp:o.sdp},"offer"===o.type?l._updateSignalingState("have-remote-offer"):l._updateSignalingState("stable"),Object.keys(f).forEach((function(t){var n=f[t];if(n.getTracks().length){if(-1===l.remoteStreams.indexOf(n)){l.remoteStreams.push(n);var r=new Event("addstream");r.stream=n,e.setTimeout((function(){l._dispatchEvent("addstream",r)}))}d.forEach((function(e){var t=e[0],r=e[1];n.id===e[2].id&&u(l,t,r,[n])}))}})),d.forEach((function(e){e[2]||u(l,e[0],e[1],[])})),e.setTimeout((function(){l&&l.transceivers&&l.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},l.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},l.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},l.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},l.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},l.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},l.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var i=n.transceivers.filter((function(e){return"audio"===e.kind})).length,s=n.transceivers.filter((function(e){return"video"===e.kind})).length,a=arguments[0];if(a){if(a.mandatory||a.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==a.offerToReceiveAudio&&(i=!0===a.offerToReceiveAudio?1:!1===a.offerToReceiveAudio?0:a.offerToReceiveAudio),void 0!==a.offerToReceiveVideo&&(s=!0===a.offerToReceiveVideo?1:!1===a.offerToReceiveVideo?0:a.offerToReceiveVideo)}for(n.transceivers.forEach((function(e){"audio"===e.kind?--i<0&&(e.wantReceive=!1):"video"===e.kind&&--s<0&&(e.wantReceive=!1)}));i>0||s>0;)i>0&&(n._createTransceiver("audio"),i--),s>0&&(n._createTransceiver("video"),s--);var u=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach((function(o,i){var s=o.track,a=o.kind,c=o.mid||r.generateIdentifier();o.mid=c,o.iceGatherer||(o.iceGatherer=n._createIceGatherer(i,n.usingBundle));var u=e.RTCRtpSender.getCapabilities(a);t<15019&&(u.codecs=u.codecs.filter((function(e){return"rtx"!==e.name}))),u.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),o.remoteCapabilities&&o.remoteCapabilities.codecs&&o.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),u.headerExtensions.forEach((function(e){(o.remoteCapabilities&&o.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var l=o.sendEncodingParameters||[{ssrc:1001*(2*i+1)}];s&&t>=15019&&"video"===a&&!l[0].rtx&&(l[0].rtx={ssrc:l[0].ssrc+1}),o.wantReceive&&(o.rtpReceiver=new e.RTCRtpReceiver(o.dtlsTransport,a)),o.localCapabilities=u,o.sendEncodingParameters=l})),"max-compat"!==n._config.bundlePolicy&&(u+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),u+="a=ice-options:trickle\r\n",n.transceivers.forEach((function(e,t){u+=o(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),u+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,u+="a="+r.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(u+="a=end-of-candidates\r\n"))}));var l=new e.RTCSessionDescription({type:"offer",sdp:u});return Promise.resolve(l)},l.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var s=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(s+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),s+="a=ice-options:trickle\r\n";var a=r.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(e,r){if(!(r+1>a)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?s+="m=application 0 DTLS/SCTP 5000\r\n":s+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?s+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(s+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(s+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var c;e.stream&&("audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var u=i(e.localCapabilities,e.remoteCapabilities);!u.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,s+=o(e,u,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(s+="a=rtcp-rsize\r\n")}}));var u=new e.RTCSessionDescription({type:"answer",sdp:s});return Promise.resolve(u)},l.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(o,i){if(!n._remoteDescription)return i(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var s=e.sdpMLineIndex;if(e.sdpMid)for(var u=0;u<n.transceivers.length;u++)if(n.transceivers[u].mid===e.sdpMid){s=u;break}var l=n.transceivers[s];if(!l)return i(c("OperationError","Can not add ICE candidate"));if(l.rejected)return o();var f=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if("tcp"===f.protocol&&(0===f.port||9===f.port))return o();if(f.component&&1!==f.component)return o();if((0===s||s>0&&l.iceTransport!==n.transceivers[0].iceTransport)&&!a(l.iceTransport,f))return i(c("OperationError","Can not add ICE candidate"));var d=e.candidate.trim();0===d.indexOf("a=")&&(d=d.substr(2)),(t=r.getMediaSections(n._remoteDescription.sdp))[s]+="a="+(f.type?d:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var p=0;p<n.transceivers.length&&(n.transceivers[p].rejected||(n.transceivers[p].iceTransport.addRemoteCandidate({}),(t=r.getMediaSections(n._remoteDescription.sdp))[p]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));p++);o()}))},l.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)})),!n)throw c("InvalidAccessError","Invalid selector.");return n.getStats()}var r=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&r.push(e[t].getStats())}))})),Promise.all(r).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var r=n.prototype.getStats;n.prototype.getStats=function(){return r.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(n){e[n].type=function(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}(e[n]),t.set(n,e[n])})),t}))}}}));var f=["createOffer","createAnswer"];return f.forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(f=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),l}},{sdp:"YHvh"}],YdKx:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch((function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))}))}}},{}],P3bV:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}},{}],XRic:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimPeerConnection=function(e){var t=r.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){n.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var s=(0,i.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,o.filterIceServers)(e.iceServers,t.version),r.log("ICE servers after filtering:",e.iceServers)),new s(e)},e.RTCPeerConnection.prototype=s.prototype},n.shimReplaceTrack=function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return s.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return a.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(e("../utils")),o=e("./filtericeservers"),i=function(e){return e&&e.__esModule?e:{default:e}}(e("rtcpeerconnection-shim")),s=e("./getusermedia"),a=e("./getdisplaymedia");function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}},{"../utils":"iSxC","./filtericeservers":"NZ1C","rtcpeerconnection-shim":"NJ2u","./getusermedia":"YdKx","./getdisplaymedia":"P3bV"}],GzSv:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=r.detectBrowser(e),n=e&&e.navigator,o=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,o){r.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,o)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var s=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"===i(e)&&"object"===i(e.audio)&&(e=JSON.parse(JSON.stringify(e)),s(e.audio,"autoGainControl","mozAutoGainControl"),s(e.audio,"noiseSuppression","mozNoiseSuppression")),a(e)},o&&o.prototype.getSettings){var c=o.prototype.getSettings;o.prototype.getSettings=function(){var e=c.apply(this,arguments);return s(e,"mozAutoGainControl","autoGainControl"),s(e,"mozNoiseSuppression","noiseSuppression"),e}}if(o&&o.prototype.applyConstraints){var u=o.prototype.applyConstraints;o.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===i(e)&&(e=JSON.parse(JSON.stringify(e)),s(e,"autoGainControl","mozAutoGainControl"),s(e,"noiseSuppression","mozNoiseSuppression")),u.apply(this,[e])}}}};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var s=r?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../utils"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../utils":"iSxC"}],UuGU:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){var r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}},{}],Fzdr:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimOnTrack=function(e){"object"===a(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimPeerConnection=function(e){var t=r.detectBrowser(e);if("object"===a(e)&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){if(!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=r[t]})),t.version<68){var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var o={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var[e,n,r]=arguments;return i.apply(this,[e||null]).then((function(e){if(t.version<53&&!n)try{e.forEach((function(e){e.type=o[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,n){e.set(n,Object.assign({},t,{type:o[t.type]||t.type}))}))}return e})).then(n,r)}}},n.shimSenderGetStats=function(e){if("object"===a(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},n.shimReceiverGetStats=function(e){if("object"===a(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n}),r.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},n.shimRemoveStream=function(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;r.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(n){n.track&&e.getTracks().includes(n.track)&&t.removeTrack(n)}))})},n.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},n.shimAddTransceiver=function(e){if("object"===a(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach((function(e){if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var r=t.apply(this,arguments);if(n){var{sender:o}=r,i=o.getParameters();"encodings"in i||(i.encodings=e.sendEncodings,this.setParametersPromises.push(o.setParameters(i).catch((function(){}))))}return r})}},n.shimCreateOffer=function(e){if("object"===a(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(n,e)})).finally((function(){n.setParametersPromises=[]})):t.apply(this,arguments)}}},n.shimCreateAnswer=function(e){if("object"===a(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(n,e)})).finally((function(){n.setParametersPromises=[]})):t.apply(this,arguments)}}},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return o.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(e("../utils")),o=e("./getusermedia"),i=e("./getdisplaymedia");function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../utils":"iSxC","./getusermedia":"GzSv","./getdisplaymedia":"UuGU"}],t1lL:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimLocalStreamsAPI=function(e){if("object"===i(e)&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(r){return t.call(n,r,e)})),e.getVideoTracks().forEach((function(r){return t.call(n,r,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e){var n=arguments[1];return n&&(this._localStreams?this._localStreams.includes(n)||this._localStreams.push(n):this._localStreams=[n]),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var n=this._localStreams.indexOf(e);if(-1!==n){this._localStreams.splice(n,1);var r=e.getTracks();this.getSenders().forEach((function(e){r.includes(e.track)&&t.removeTrack(e)}))}})}},n.shimRemoteStreamsAPI=function(e){if("object"===i(e)&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var n=new Event("addstream");n.stream=e,t.dispatchEvent(n)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}}))}),t.apply(e,arguments)}}},n.shimCallbacksAPI=function(e){if("object"===i(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,o=t.setLocalDescription,s=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],o=n.apply(this,[r]);return t?(o.then(e,t),Promise.resolve()):o},t.createAnswer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],o=r.apply(this,[n]);return t?(o.then(e,t),Promise.resolve()):o};var c=function(e,t,n){var r=o.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r};t.setLocalDescription=c,c=function(e,t,n){var r=s.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.setRemoteDescription=c,c=function(e,t,n){var r=a.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.addIceCandidate=c}},n.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var n=t.mediaDevices,r=n.getUserMedia.bind(n);t.mediaDevices.getUserMedia=function(e){return r(s(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))},n.shimConstraints=s,n.shimRTCIceServerUrls=function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){for(var o=[],i=0;i<e.iceServers.length;i++){var s=e.iceServers[i];!s.hasOwnProperty("urls")&&s.hasOwnProperty("url")?(r.deprecated("RTCIceServer.url","RTCIceServer.urls"),(s=JSON.parse(JSON.stringify(s))).urls=s.url,delete s.url,o.push(s)):o.push(e.iceServers[i])}e.iceServers=o}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},n.shimTrackEventTransceiver=function(e){"object"===i(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimCreateOfferLegacy=function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var n=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveAudio||n||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var r=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveVideo||r||this.addTransceiver("video")}return t.apply(this,arguments)}};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var s=r?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../utils"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e){return e&&void 0!==e.video?Object.assign({},e,{video:r.compactObject(e.video)}):e}},{"../utils":"iSxC"}],GOQK:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimRTCIceCandidate=function(e){if(e.RTCIceCandidate&&(!e.RTCIceCandidate||!("foundation"in e.RTCIceCandidate.prototype))){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===s(e)&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var n=new t(e),o=r.default.parseCandidate(e.candidate),i=Object.assign(n,o);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,o.wrapPeerConnectionEvent(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}},n.shimMaxMessageSize=function(e){if(e.RTCPeerConnection){var t=o.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){var{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;var t=r.default.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=r.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){var o,i=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var n=parseInt(t[1],10);return n!=n?-1:n}(arguments[0]),s=(u=i,l=65536,"firefox"===t.browser&&(l=t.version<57?-1===u?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),l),a=function(e,n){var o=65536;"firefox"===t.browser&&57===t.version&&(o=65535);var i=r.default.matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?o=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(o=2147483637),o}(arguments[0],i);o=0===s&&0===a?Number.POSITIVE_INFINITY:0===s||0===a?Math.max(s,a):Math.min(s,a);var c={};Object.defineProperty(c,"maxMessageSize",{get:function(){return o}}),this._sctp=c}var u,l;return n.apply(this,arguments)}}},n.shimSendThrowTypeError=function(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return n(e,this),e},o.wrapPeerConnectionEvent(e,"datachannel",(function(e){return n(e.channel,e.target),e}))}function n(e,t){var n=e.send;e.send=function(){var r=arguments[0],o=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&o>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}},n.shimConnectionState=function(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}},n.removeAllowExtmapMixed=function(e){if(e.RTCPeerConnection){var t=o.detectBrowser(e);if(!("chrome"===t.browser&&t.version>=71)){var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n")),n.apply(this,arguments)}}}};var r=function(e){return e&&e.__esModule?e:{default:e}}(e("sdp")),o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(e("./utils"));function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{sdp:"YHvh","./utils":"iSxC"}],KtlG:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.adapterFactory=function(){var{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},n=r.log,u=r.detectBrowser(e),l={browserDetails:u,commonShim:c,extractVersion:r.extractVersion,disableLog:r.disableLog,disableWarnings:r.disableWarnings};switch(u.browser){case"chrome":if(!o||!o.shimPeerConnection||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),l;n("adapter.js shimming chrome."),l.browserShim=o,o.shimGetUserMedia(e),o.shimMediaStream(e),o.shimPeerConnection(e),o.shimOnTrack(e),o.shimAddTrackRemoveTrack(e),o.shimGetSendersWithDtmf(e),o.shimGetStats(e),o.shimSenderReceiverGetStats(e),o.fixNegotiationNeeded(e),c.shimRTCIceCandidate(e),c.shimConnectionState(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e),c.removeAllowExtmapMixed(e);break;case"firefox":if(!s||!s.shimPeerConnection||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),l;n("adapter.js shimming firefox."),l.browserShim=s,s.shimGetUserMedia(e),s.shimPeerConnection(e),s.shimOnTrack(e),s.shimRemoveStream(e),s.shimSenderGetStats(e),s.shimReceiverGetStats(e),s.shimRTCDataChannel(e),s.shimAddTransceiver(e),s.shimCreateOffer(e),s.shimCreateAnswer(e),c.shimRTCIceCandidate(e),c.shimConnectionState(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e);break;case"edge":if(!i||!i.shimPeerConnection||!t.shimEdge)return n("MS edge shim is not included in this adapter release."),l;n("adapter.js shimming edge."),l.browserShim=i,i.shimGetUserMedia(e),i.shimGetDisplayMedia(e),i.shimPeerConnection(e),i.shimReplaceTrack(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e);break;case"safari":if(!a||!t.shimSafari)return n("Safari shim is not included in this adapter release."),l;n("adapter.js shimming safari."),l.browserShim=a,a.shimRTCIceServerUrls(e),a.shimCreateOfferLegacy(e),a.shimCallbacksAPI(e),a.shimLocalStreamsAPI(e),a.shimRemoteStreamsAPI(e),a.shimTrackEventTransceiver(e),a.shimGetUserMedia(e),c.shimRTCIceCandidate(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e),c.removeAllowExtmapMixed(e);break;default:n("Unsupported browser!")}return l};var r=l(e("./utils")),o=l(e("./chrome/chrome_shim")),i=l(e("./edge/edge_shim")),s=l(e("./firefox/firefox_shim")),a=l(e("./safari/safari_shim")),c=l(e("./common_shim"));function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function l(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}},{"./utils":"iSxC","./chrome/chrome_shim":"uI5X","./edge/edge_shim":"XRic","./firefox/firefox_shim":"Fzdr","./safari/safari_shim":"t1lL","./common_shim":"GOQK"}],tI1X:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=(0,e("./adapter_factory.js").adapterFactory)({window:window});n.default=r},{"./adapter_factory.js":"KtlG"}],sXtV:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var o=r(e("webrtc-adapter"));n.webRTCAdapter=o.default},{"webrtc-adapter":"tI1X"}],I31f:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./adapter");n.Supports=new(function(){function e(){this.isIOS=["iPad","iPhone","iPod"].includes(navigator.platform),this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}return e.prototype.isWebRTCSupported=function(){return"undefined"!=typeof RTCPeerConnection},e.prototype.isBrowserSupported=function(){var e=this.getBrowser(),t=this.getVersion();return!!this.supportedBrowsers.includes(e)&&("chrome"===e?t>=this.minChromeVersion:"firefox"===e?t>=this.minFirefoxVersion:"safari"===e&&!this.isIOS&&t>=this.minSafariVersion)},e.prototype.getBrowser=function(){return r.webRTCAdapter.browserDetails.browser},e.prototype.getVersion=function(){return r.webRTCAdapter.browserDetails.version||0},e.prototype.isUnifiedPlanSupported=function(){var e,t=this.getBrowser(),n=r.webRTCAdapter.browserDetails.version||0;if("chrome"===t&&n<72)return!1;if("firefox"===t&&n>=59)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;var o=!1;try{(e=new RTCPeerConnection).addTransceiver("audio"),o=!0}catch(e){}finally{e&&e.close()}return o},e.prototype.toString=function(){return"Supports: \n    browser:"+this.getBrowser()+" \n    version:"+this.getVersion()+" \n    isIOS:"+this.isIOS+" \n    isWebRTCSupported:"+this.isWebRTCSupported()+" \n    isBrowserSupported:"+this.isBrowserSupported()+" \n    isUnifiedPlanSupported:"+this.isUnifiedPlanSupported()},e}())},{"./adapter":"sXtV"}],BHXf:[function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(n,"__esModule",{value:!0});var o=r(e("peerjs-js-binarypack")),i=e("./supports"),s={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:0.peerjs.com:3478",username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};n.util=new(function(){function e(){this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.chunkedMTU=16300,this.defaultConfig=s,this.browser=i.Supports.getBrowser(),this.browserVersion=i.Supports.getVersion(),this.supports=function(){var e,t={browser:i.Supports.isBrowserSupported(),webRTC:i.Supports.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!t.webRTC)return t;try{e=new RTCPeerConnection(s),t.audioVideo=!0;var n=void 0;try{n=e.createDataChannel("_PEERJSTEST",{ordered:!0}),t.data=!0,t.reliable=!!n.ordered;try{n.binaryType="blob",t.binaryBlob=!i.Supports.isIOS}catch(e){}}catch(e){}finally{n&&n.close()}}catch(e){}finally{e&&e.close()}return t}(),this.pack=o.pack,this.unpack=o.unpack,this._dataCount=1}return e.prototype.noop=function(){},e.prototype.validateId=function(e){return!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(e)},e.prototype.chunk=function(e){for(var t=[],r=e.size,o=Math.ceil(r/n.util.chunkedMTU),i=0,s=0;s<r;){var a=Math.min(r,s+n.util.chunkedMTU),c=e.slice(s,a),u={__peerData:this._dataCount,n:i,data:c,total:o};t.push(u),s=a,i++}return this._dataCount++,t},e.prototype.blobToArrayBuffer=function(e,t){var n=new FileReader;return n.onload=function(e){e.target&&t(e.target.result)},n.readAsArrayBuffer(e),n},e.prototype.binaryStringToArrayBuffer=function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=255&e.charCodeAt(n);return t.buffer},e.prototype.randomToken=function(){return Math.random().toString(36).substr(2)},e.prototype.isSecure=function(){return"https:"===location.protocol},e}())},{"peerjs-js-binarypack":"kdPp","./supports":"I31f"}],JJlS:[function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,o="~";function i(){}function s(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function a(e,t,n,r,i){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new s(n,r||e,i),c=o?o+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function c(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function u(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(o=!1)),u.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(o?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},u.prototype.listeners=function(e){var t=o?o+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,i=n.length,s=new Array(i);r<i;r++)s[r]=n[r].fn;return s},u.prototype.listenerCount=function(e){var t=o?o+e:e,n=this._events[t];return n?n.fn?1:n.length:0},u.prototype.emit=function(e,t,n,r,i,s){var a=o?o+e:e;if(!this._events[a])return!1;var c,u,l=this._events[a],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,r),!0;case 5:return l.fn.call(l.context,t,n,r,i),!0;case 6:return l.fn.call(l.context,t,n,r,i,s),!0}for(u=1,c=new Array(f-1);u<f;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var d,p=l.length;for(u=0;u<p;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),f){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,n);break;case 4:l[u].fn.call(l[u].context,t,n,r);break;default:if(!c)for(d=1,c=new Array(f-1);d<f;d++)c[d-1]=arguments[d];l[u].fn.apply(l[u].context,c)}}return!0},u.prototype.on=function(e,t,n){return a(this,e,t,n,!1)},u.prototype.once=function(e,t,n){return a(this,e,t,n,!0)},u.prototype.removeListener=function(e,t,n,r){var i=o?o+e:e;if(!this._events[i])return this;if(!t)return c(this,i),this;var s=this._events[i];if(s.fn)s.fn!==t||r&&!s.once||n&&s.context!==n||c(this,i);else{for(var a=0,u=[],l=s.length;a<l;a++)(s[a].fn!==t||r&&!s[a].once||n&&s[a].context!==n)&&u.push(s[a]);u.length?this._events[i]=1===u.length?u[0]:u:c(this,i)}return this},u.prototype.removeAllListeners=function(e){var t;return e?(t=o?o+e:e,this._events[t]&&c(this,t)):(this._events=new i,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=o,u.EventEmitter=u,void 0!==t&&(t.exports=u)},{}],WOs9:[function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(n,"__esModule",{value:!0});var i,s="PeerJS: ";!function(e){e[e.Disabled=0]="Disabled",e[e.Errors=1]="Errors",e[e.Warnings=2]="Warnings",e[e.All=3]="All"}(i=n.LogLevel||(n.LogLevel={}));var a=function(){function e(){this._logLevel=i.Disabled}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){this._logLevel=e},enumerable:!0,configurable:!0}),e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=i.All&&this._print.apply(this,o([i.All],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=i.Warnings&&this._print.apply(this,o([i.Warnings],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=i.Errors&&this._print.apply(this,o([i.Errors],e))},e.prototype.setLogFunction=function(e){this._print=e},e.prototype._print=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=o([s],t);for(var a in r)r[a]instanceof Error&&(r[a]="("+r[a].name+") "+r[a].message);e>=i.All?console.log.apply(console,o(r)):e>=i.Warnings?console.warn.apply(console,o(["WARNING"],r)):e>=i.Errors&&console.error.apply(console,o(["ERROR"],r))},e}();n.default=new a},{}],ZRYf:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(e){e.Open="open",e.Stream="stream",e.Data="data",e.Close="close",e.Error="error",e.IceStateChanged="iceStateChanged"}(n.ConnectionEventType||(n.ConnectionEventType={})),function(e){e.Data="data",e.Media="media"}(n.ConnectionType||(n.ConnectionType={})),function(e){e.Open="open",e.Close="close",e.Connection="connection",e.Call="call",e.Disconnected="disconnected",e.Error="error"}(n.PeerEventType||(n.PeerEventType={})),function(e){e.BrowserIncompatible="browser-incompatible",e.Disconnected="disconnected",e.InvalidID="invalid-id",e.InvalidKey="invalid-key",e.Network="network",e.PeerUnavailable="peer-unavailable",e.SslUnavailable="ssl-unavailable",e.ServerError="server-error",e.SocketError="socket-error",e.SocketClosed="socket-closed",e.UnavailableID="unavailable-id",e.WebRTC="webrtc"}(n.PeerErrorType||(n.PeerErrorType={})),function(e){e.Binary="binary",e.BinaryUTF8="binary-utf8",e.JSON="json"}(n.SerializationType||(n.SerializationType={})),function(e){e.Message="message",e.Disconnected="disconnected",e.Error="error",e.Close="close"}(n.SocketEventType||(n.SocketEventType={})),function(e){e.Heartbeat="HEARTBEAT",e.Candidate="CANDIDATE",e.Offer="OFFER",e.Answer="ANSWER",e.Open="OPEN",e.Error="ERROR",e.IdTaken="ID-TAKEN",e.InvalidKey="INVALID-KEY",e.Leave="LEAVE",e.Expire="EXPIRE"}(n.ServerMessageType||(n.ServerMessageType={}))},{}],wJlv:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e},s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var c=e("eventemitter3"),u=a(e("./logger")),l=e("./enums"),f=function(e){function t(t,n,r,o,i,s){void 0===s&&(s=5e3);var a=e.call(this)||this;a.pingInterval=s,a._disconnected=!0,a._messagesQueue=[];var c=t?"wss://":"ws://";return a._baseUrl=c+n+":"+r+o+"peerjs?key="+i,a}return r(t,e),t.prototype.start=function(e,t){var n=this;this._id=e;var r=this._baseUrl+"&id="+e+"&token="+t;!this._socket&&this._disconnected&&(this._socket=new WebSocket(r),this._disconnected=!1,this._socket.onmessage=function(e){var t;try{t=JSON.parse(e.data),u.default.log("Server message received:",t)}catch(t){return void u.default.log("Invalid server message",e.data)}n.emit(l.SocketEventType.Message,t)},this._socket.onclose=function(e){n._disconnected||(u.default.log("Socket closed.",e),n._cleanup(),n._disconnected=!0,n.emit(l.SocketEventType.Disconnected))},this._socket.onopen=function(){n._disconnected||(n._sendQueuedMessages(),u.default.log("Socket open"),n._scheduleHeartbeat())})},t.prototype._scheduleHeartbeat=function(){var e=this;this._wsPingTimer=setTimeout((function(){e._sendHeartbeat()}),this.pingInterval)},t.prototype._sendHeartbeat=function(){if(this._wsOpen()){var e=JSON.stringify({type:l.ServerMessageType.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}else u.default.log("Cannot send heartbeat, because socket closed")},t.prototype._wsOpen=function(){return!!this._socket&&1===this._socket.readyState},t.prototype._sendQueuedMessages=function(){var e,t,n=i(this._messagesQueue);this._messagesQueue=[];try{for(var r=s(n),o=r.next();!o.done;o=r.next()){var a=o.value;this.send(a)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},t.prototype.send=function(e){if(!this._disconnected)if(this._id)if(e.type){if(this._wsOpen()){var t=JSON.stringify(e);this._socket.send(t)}}else this.emit(l.SocketEventType.Error,"Invalid message");else this._messagesQueue.push(e)},t.prototype.close=function(){this._disconnected||(this._cleanup(),this._disconnected=!0)},t.prototype._cleanup=function(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)},t}(c.EventEmitter);n.Socket=f},{eventemitter3:"JJlS","./logger":"WOs9","./enums":"ZRYf"}],HCdX:[function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./util"),c=s(e("./logger")),u=e("./enums"),l=function(){function e(e){this.connection=e}return e.prototype.startConnection=function(e){var t=this._startPeerConnection();if(this.connection.peerConnection=t,this.connection.type===u.ConnectionType.Media&&e._stream&&this._addTracksToConnection(e._stream,t),e.originator){if(this.connection.type===u.ConnectionType.Data){var n=this.connection,r={ordered:!!e.reliable},o=t.createDataChannel(n.label,r);n.initialize(o)}this._makeOffer()}else this.handleSDP("OFFER",e.sdp)},e.prototype._startPeerConnection=function(){c.default.log("Creating RTCPeerConnection.");var e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e},e.prototype._setupListeners=function(e){var t=this,n=this.connection.peer,r=this.connection.connectionId,o=this.connection.type,i=this.connection.provider;c.default.log("Listening for ICE candidates."),e.onicecandidate=function(e){e.candidate&&e.candidate.candidate&&(c.default.log("Received ICE candidates for "+n+":",e.candidate),i.socket.send({type:u.ServerMessageType.Candidate,payload:{candidate:e.candidate,type:o,connectionId:r},dst:n}))},e.oniceconnectionstatechange=function(){switch(e.iceConnectionState){case"failed":c.default.log("iceConnectionState is failed, closing connections to "+n),t.connection.emit(u.ConnectionEventType.Error,new Error("Negotiation of connection to "+n+" failed.")),t.connection.close();break;case"closed":c.default.log("iceConnectionState is closed, closing connections to "+n),t.connection.emit(u.ConnectionEventType.Error,new Error("Connection to "+n+" closed.")),t.connection.close();break;case"disconnected":c.default.log("iceConnectionState changed to disconnected on the connection with "+n);break;case"completed":e.onicecandidate=a.util.noop}t.connection.emit(u.ConnectionEventType.IceStateChanged,e.iceConnectionState)},c.default.log("Listening for data channel"),e.ondatachannel=function(e){c.default.log("Received data channel");var t=e.channel;i.getConnection(n,r).initialize(t)},c.default.log("Listening for remote stream"),e.ontrack=function(e){c.default.log("Received remote stream");var o=e.streams[0],s=i.getConnection(n,r);if(s.type===u.ConnectionType.Media){var a=s;t._addStreamToMediaConnection(o,a)}}},e.prototype.cleanup=function(){c.default.log("Cleaning up PeerConnection to "+this.connection.peer);var e=this.connection.peerConnection;if(e){this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=function(){};var t="closed"!==e.signalingState,n=!1;if(this.connection.type===u.ConnectionType.Data){var r=this.connection.dataChannel;r&&(n=!!r.readyState&&"closed"!==r.readyState)}(t||n)&&e.close()}},e.prototype._makeOffer=function(){return o(this,void 0,Promise,(function(){var e,t,n,o,s,l,f;return i(this,(function(i){switch(i.label){case 0:e=this.connection.peerConnection,t=this.connection.provider,i.label=1;case 1:return i.trys.push([1,7,,8]),[4,e.createOffer(this.connection.options.constraints)];case 2:n=i.sent(),c.default.log("Created offer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp),i.label=3;case 3:return i.trys.push([3,5,,6]),[4,e.setLocalDescription(n)];case 4:return i.sent(),c.default.log("Set localDescription:",n,"for:"+this.connection.peer),o={sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata,browser:a.util.browser},this.connection.type===u.ConnectionType.Data&&(s=this.connection,o=r(r({},o),{label:s.label,reliable:s.reliable,serialization:s.serialization})),t.socket.send({type:u.ServerMessageType.Offer,payload:o,dst:this.connection.peer}),[3,6];case 5:return"OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"!=(l=i.sent())&&(t.emitError(u.PeerErrorType.WebRTC,l),c.default.log("Failed to setLocalDescription, ",l)),[3,6];case 6:return[3,8];case 7:return f=i.sent(),t.emitError(u.PeerErrorType.WebRTC,f),c.default.log("Failed to createOffer, ",f),[3,8];case 8:return[2]}}))}))},e.prototype._makeAnswer=function(){return o(this,void 0,Promise,(function(){var e,t,n,r,o;return i(this,(function(i){switch(i.label){case 0:e=this.connection.peerConnection,t=this.connection.provider,i.label=1;case 1:return i.trys.push([1,7,,8]),[4,e.createAnswer()];case 2:n=i.sent(),c.default.log("Created answer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp),i.label=3;case 3:return i.trys.push([3,5,,6]),[4,e.setLocalDescription(n)];case 4:return i.sent(),c.default.log("Set localDescription:",n,"for:"+this.connection.peer),t.socket.send({type:u.ServerMessageType.Answer,payload:{sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,browser:a.util.browser},dst:this.connection.peer}),[3,6];case 5:return r=i.sent(),t.emitError(u.PeerErrorType.WebRTC,r),c.default.log("Failed to setLocalDescription, ",r),[3,6];case 6:return[3,8];case 7:return o=i.sent(),t.emitError(u.PeerErrorType.WebRTC,o),c.default.log("Failed to create answer, ",o),[3,8];case 8:return[2]}}))}))},e.prototype.handleSDP=function(e,t){return o(this,void 0,Promise,(function(){var n,r,o,s;return i(this,(function(i){switch(i.label){case 0:t=new RTCSessionDescription(t),n=this.connection.peerConnection,r=this.connection.provider,c.default.log("Setting remote description",t),o=this,i.label=1;case 1:return i.trys.push([1,5,,6]),[4,n.setRemoteDescription(t)];case 2:return i.sent(),c.default.log("Set remoteDescription:"+e+" for:"+this.connection.peer),"OFFER"!==e?[3,4]:[4,o._makeAnswer()];case 3:i.sent(),i.label=4;case 4:return[3,6];case 5:return s=i.sent(),r.emitError(u.PeerErrorType.WebRTC,s),c.default.log("Failed to setRemoteDescription, ",s),[3,6];case 6:return[2]}}))}))},e.prototype.handleCandidate=function(e){return o(this,void 0,Promise,(function(){var t,n,r,o,s,a;return i(this,(function(i){switch(i.label){case 0:c.default.log("handleCandidate:",e),t=e.candidate,n=e.sdpMLineIndex,r=e.sdpMid,o=this.connection.peerConnection,s=this.connection.provider,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,o.addIceCandidate(new RTCIceCandidate({sdpMid:r,sdpMLineIndex:n,candidate:t}))];case 2:return i.sent(),c.default.log("Added ICE candidate for:"+this.connection.peer),[3,4];case 3:return a=i.sent(),s.emitError(u.PeerErrorType.WebRTC,a),c.default.log("Failed to handleCandidate, ",a),[3,4];case 4:return[2]}}))}))},e.prototype._addTracksToConnection=function(e,t){if(c.default.log("add tracks from stream "+e.id+" to peer connection"),!t.addTrack)return c.default.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach((function(n){t.addTrack(n,e)}))},e.prototype._addStreamToMediaConnection=function(e,t){c.default.log("add stream "+e.id+" to media connection "+t.connectionId),t.addStream(e)},e}();n.Negotiator=l},{"./util":"BHXf","./logger":"WOs9","./enums":"ZRYf"}],tQFK:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=function(e){function t(t,n,r){var o=e.call(this)||this;return o.peer=t,o.provider=n,o.options=r,o._open=!1,o.metadata=r.metadata,o}return r(t,e),Object.defineProperty(t.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),t}(e("eventemitter3").EventEmitter);n.BaseConnection=o},{eventemitter3:"JJlS"}],dbHP:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./util"),c=s(e("./logger")),u=e("./negotiator"),l=e("./enums"),f=function(e){function t(n,r,o){var i=e.call(this,n,r,o)||this;return i._localStream=i.options._stream,i.connectionId=i.options.connectionId||t.ID_PREFIX+a.util.randomToken(),i._negotiator=new u.Negotiator(i),i._localStream&&i._negotiator.startConnection({_stream:i._localStream,originator:!0}),i}return r(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return l.ConnectionType.Media},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"localStream",{get:function(){return this._localStream},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"remoteStream",{get:function(){return this._remoteStream},enumerable:!0,configurable:!0}),t.prototype.addStream=function(t){c.default.log("Receiving stream",t),this._remoteStream=t,e.prototype.emit.call(this,l.ConnectionEventType.Stream,t)},t.prototype.handleMessage=function(e){var t=e.type,n=e.payload;switch(e.type){case l.ServerMessageType.Answer:this._negotiator.handleSDP(t,n.sdp),this._open=!0;break;case l.ServerMessageType.Candidate:this._negotiator.handleCandidate(n.candidate);break;default:c.default.warn("Unrecognized message type:"+t+" from peer:"+this.peer)}},t.prototype.answer=function(e,t){var n,r;if(void 0===t&&(t={}),this._localStream)c.default.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");else{this._localStream=e,t&&t.sdpTransform&&(this.options.sdpTransform=t.sdpTransform),this._negotiator.startConnection(o(o({},this.options._payload),{_stream:e}));var s=this.provider._getMessages(this.connectionId);try{for(var a=i(s),u=a.next();!u.done;u=a.next()){var l=u.value;this.handleMessage(l)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}this._open=!0}},t.prototype.close=function(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,e.prototype.emit.call(this,l.ConnectionEventType.Close))},t.ID_PREFIX="mc_",t}(e("./baseconnection").BaseConnection);n.MediaConnection=f},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK"}],GGp6:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var i=e("eventemitter3"),s=o(e("./logger")),a=function(e){function t(){var t=e.call(this)||this;return t.fileReader=new FileReader,t._queue=[],t._processing=!1,t.fileReader.onload=function(e){t._processing=!1,e.target&&t.emit("done",e.target.result),t.doNextTask()},t.fileReader.onerror=function(e){s.default.error("EncodingQueue error:",e),t._processing=!1,t.destroy(),t.emit("error",e)},t}return r(t,e),Object.defineProperty(t.prototype,"queue",{get:function(){return this._queue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.queue.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"processing",{get:function(){return this._processing},enumerable:!0,configurable:!0}),t.prototype.enque=function(e){this.queue.push(e),this.processing||this.doNextTask()},t.prototype.destroy=function(){this.fileReader.abort(),this._queue=[]},t.prototype.doNextTask=function(){0!==this.size&&(this.processing||(this._processing=!0,this.fileReader.readAsArrayBuffer(this.queue.shift())))},t}(i.EventEmitter);n.EncodingQueue=a},{eventemitter3:"JJlS","./logger":"WOs9"}],GBTQ:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var s=e("./util"),a=i(e("./logger")),c=e("./negotiator"),u=e("./enums"),l=e("./baseconnection"),f=e("./encodingQueue"),d=function(e){function t(n,r,o){var i=e.call(this,n,r,o)||this;return i.stringify=JSON.stringify,i.parse=JSON.parse,i._buffer=[],i._bufferSize=0,i._buffering=!1,i._chunkedData={},i._encodingQueue=new f.EncodingQueue,i.connectionId=i.options.connectionId||t.ID_PREFIX+s.util.randomToken(),i.label=i.options.label||i.connectionId,i.serialization=i.options.serialization||u.SerializationType.Binary,i.reliable=!!i.options.reliable,i._encodingQueue.on("done",(function(e){i._bufferedSend(e)})),i._encodingQueue.on("error",(function(){a.default.error("DC#"+i.connectionId+": Error occured in encoding from blob to arraybuffer, close DC"),i.close()})),i._negotiator=new c.Negotiator(i),i._negotiator.startConnection(i.options._payload||{originator:!0}),i}return r(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return u.ConnectionType.Data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataChannel",{get:function(){return this._dc},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bufferSize",{get:function(){return this._bufferSize},enumerable:!0,configurable:!0}),t.prototype.initialize=function(e){this._dc=e,this._configureDataChannel()},t.prototype._configureDataChannel=function(){var e=this;s.util.supports.binaryBlob&&!s.util.supports.reliable||(this.dataChannel.binaryType="arraybuffer"),this.dataChannel.onopen=function(){a.default.log("DC#"+e.connectionId+" dc connection success"),e._open=!0,e.emit(u.ConnectionEventType.Open)},this.dataChannel.onmessage=function(t){a.default.log("DC#"+e.connectionId+" dc onmessage:",t.data),e._handleDataMessage(t)},this.dataChannel.onclose=function(){a.default.log("DC#"+e.connectionId+" dc closed for:",e.peer),e.close()}},t.prototype._handleDataMessage=function(t){var n=this,r=t.data,o=r.constructor,i=r;if(this.serialization===u.SerializationType.Binary||this.serialization===u.SerializationType.BinaryUTF8){if(o===Blob)return void s.util.blobToArrayBuffer(r,(function(e){var t=s.util.unpack(e);n.emit(u.ConnectionEventType.Data,t)}));if(o===ArrayBuffer)i=s.util.unpack(r);else if(o===String){var a=s.util.binaryStringToArrayBuffer(r);i=s.util.unpack(a)}}else this.serialization===u.SerializationType.JSON&&(i=this.parse(r));i.__peerData?this._handleChunk(i):e.prototype.emit.call(this,u.ConnectionEventType.Data,i)},t.prototype._handleChunk=function(e){var t=e.__peerData,n=this._chunkedData[t]||{data:[],count:0,total:e.total};if(n.data[e.n]=e.data,n.count++,this._chunkedData[t]=n,n.total===n.count){delete this._chunkedData[t];var r=new Blob(n.data);this._handleDataMessage({data:r})}},t.prototype.close=function(){this._buffer=[],this._bufferSize=0,this._chunkedData={},this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this._dc=null),this._encodingQueue&&(this._encodingQueue.destroy(),this._encodingQueue.removeAllListeners(),this._encodingQueue=null),this.open&&(this._open=!1,e.prototype.emit.call(this,u.ConnectionEventType.Close))},t.prototype.send=function(t,n){if(this.open)if(this.serialization===u.SerializationType.JSON)this._bufferedSend(this.stringify(t));else if(this.serialization===u.SerializationType.Binary||this.serialization===u.SerializationType.BinaryUTF8){var r=s.util.pack(t);if(!n&&r.size>s.util.chunkedMTU)return void this._sendChunks(r);s.util.supports.binaryBlob?this._bufferedSend(r):this._encodingQueue.enque(r)}else this._bufferedSend(t);else e.prototype.emit.call(this,u.ConnectionEventType.Error,new Error("Connection is not open. You should listen for the `open` event before sending messages."))},t.prototype._bufferedSend=function(e){!this._buffering&&this._trySend(e)||(this._buffer.push(e),this._bufferSize=this._buffer.length)},t.prototype._trySend=function(e){var n=this;if(!this.open)return!1;if(this.dataChannel.bufferedAmount>t.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout((function(){n._buffering=!1,n._tryBuffer()}),50),!1;try{this.dataChannel.send(e)}catch(e){return a.default.error("DC#:"+this.connectionId+" Error when sending:",e),this._buffering=!0,this.close(),!1}return!0},t.prototype._tryBuffer=function(){if(this.open&&0!==this._buffer.length){var e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}},t.prototype._sendChunks=function(e){var t,n,r=s.util.chunk(e);a.default.log("DC#"+this.connectionId+" Try to send "+r.length+" chunks...");try{for(var i=o(r),c=i.next();!c.done;c=i.next()){var u=c.value;this.send(u,!0)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},t.prototype.handleMessage=function(e){var t=e.payload;switch(e.type){case u.ServerMessageType.Answer:this._negotiator.handleSDP(e.type,t.sdp);break;case u.ServerMessageType.Candidate:this._negotiator.handleCandidate(t.candidate);break;default:a.default.warn("Unrecognized message type:",e.type,"from peer:",this.peer)}},t.ID_PREFIX="dc_",t.MAX_BUFFERED_AMOUNT=8388608,t}(l.BaseConnection);n.DataConnection=d},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK","./encodingQueue":"GGp6"}],in7L:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var s=e("./util"),a=i(e("./logger")),c=function(){function e(e){this._options=e}return e.prototype._buildUrl=function(e){return(this._options.secure?"https://":"http://")+this._options.host+":"+this._options.port+this._options.path+this._options.key+"/"+e+"?ts="+(new Date).getTime()+Math.random()},e.prototype.retrieveId=function(){return r(this,void 0,Promise,(function(){var e,t,n,r;return o(this,(function(o){switch(o.label){case 0:e=this._buildUrl("id"),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(e)];case 2:if(200!==(t=o.sent()).status)throw new Error("Error. Status:"+t.status);return[2,t.text()];case 3:throw n=o.sent(),a.default.error("Error retrieving ID",n),r="","/"===this._options.path&&this._options.host!==s.util.CLOUD_HOST&&(r=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+r);case 4:return[2]}}))}))},e.prototype.listAllPeers=function(){return r(this,void 0,Promise,(function(){var e,t,n,r;return o(this,(function(o){switch(o.label){case 0:e=this._buildUrl("peers"),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(e)];case 2:if(200!==(t=o.sent()).status){if(401===t.status)throw"",n=this._options.host===s.util.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+n);throw new Error("Error. Status:"+t.status)}return[2,t.json()];case 3:throw r=o.sent(),a.default.error("Error retrieving list peers",r),new Error("Could not get list peers from the server."+r);case 4:return[2]}}))}))},e}();n.API=c},{"./util":"BHXf","./logger":"WOs9"}],Hxpd:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var c=e("eventemitter3"),u=e("./util"),l=a(e("./logger")),f=e("./socket"),d=e("./mediaconnection"),p=e("./dataconnection"),h=e("./enums"),m=e("./api"),y=function(e){function t(n,r){var i,s=e.call(this)||this;return s._id=null,s._lastServerId=null,s._destroyed=!1,s._disconnected=!1,s._open=!1,s._connections=new Map,s._lostMessages=new Map,n&&n.constructor==Object?r=n:n&&(i=n.toString()),r=o({debug:0,host:u.util.CLOUD_HOST,port:u.util.CLOUD_PORT,path:"/",key:t.DEFAULT_KEY,token:u.util.randomToken(),config:u.util.defaultConfig},r),s._options=r,"/"===s._options.host&&(s._options.host=window.location.hostname),s._options.path&&("/"!==s._options.path[0]&&(s._options.path="/"+s._options.path),"/"!==s._options.path[s._options.path.length-1]&&(s._options.path+="/")),void 0===s._options.secure&&s._options.host!==u.util.CLOUD_HOST?s._options.secure=u.util.isSecure():s._options.host==u.util.CLOUD_HOST&&(s._options.secure=!0),s._options.logFunction&&l.default.setLogFunction(s._options.logFunction),l.default.logLevel=s._options.debug||0,s._api=new m.API(r),s._socket=s._createServerConnection(),u.util.supports.audioVideo||u.util.supports.data?i&&!u.util.validateId(i)?(s._delayedAbort(h.PeerErrorType.InvalidID,'ID "'+i+'" is invalid'),s):(i?s._initialize(i):s._api.retrieveId().then((function(e){return s._initialize(e)})).catch((function(e){return s._abort(h.PeerErrorType.ServerError,e)})),s):(s._delayedAbort(h.PeerErrorType.BrowserIncompatible,"The current browser does not support WebRTC"),s)}return r(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"socket",{get:function(){return this._socket},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"connections",{get:function(){var e,t,n=Object.create(null);try{for(var r=i(this._connections),o=r.next();!o.done;o=r.next()){var a=s(o.value,2),c=a[0],u=a[1];n[c]=u}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"disconnected",{get:function(){return this._disconnected},enumerable:!0,configurable:!0}),t.prototype._createServerConnection=function(){var e=this,t=new f.Socket(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return t.on(h.SocketEventType.Message,(function(t){e._handleMessage(t)})),t.on(h.SocketEventType.Error,(function(t){e._abort(h.PeerErrorType.SocketError,t)})),t.on(h.SocketEventType.Disconnected,(function(){e.disconnected||(e.emitError(h.PeerErrorType.Network,"Lost connection to server."),e.disconnect())})),t.on(h.SocketEventType.Close,(function(){e.disconnected||e._abort(h.PeerErrorType.SocketClosed,"Underlying socket is already closed.")})),t},t.prototype._initialize=function(e){this._id=e,this.socket.start(e,this._options.token)},t.prototype._handleMessage=function(e){var t,n,r=e.type,o=e.payload,s=e.src;switch(r){case h.ServerMessageType.Open:this._lastServerId=this.id,this._open=!0,this.emit(h.PeerEventType.Open,this.id);break;case h.ServerMessageType.Error:this._abort(h.PeerErrorType.ServerError,o.msg);break;case h.ServerMessageType.IdTaken:this._abort(h.PeerErrorType.UnavailableID,'ID "'+this.id+'" is taken');break;case h.ServerMessageType.InvalidKey:this._abort(h.PeerErrorType.InvalidKey,'API KEY "'+this._options.key+'" is invalid');break;case h.ServerMessageType.Leave:l.default.log("Received leave message from "+s),this._cleanupPeer(s),this._connections.delete(s);break;case h.ServerMessageType.Expire:this.emitError(h.PeerErrorType.PeerUnavailable,"Could not connect to peer "+s);break;case h.ServerMessageType.Offer:var a=o.connectionId;if((y=this.getConnection(s,a))&&(y.close(),l.default.warn("Offer received for existing Connection ID:"+a)),o.type===h.ConnectionType.Media)y=new d.MediaConnection(s,this,{connectionId:a,_payload:o,metadata:o.metadata}),this._addConnection(s,y),this.emit(h.PeerEventType.Call,y);else{if(o.type!==h.ConnectionType.Data)return void l.default.warn("Received malformed connection type:"+o.type);y=new p.DataConnection(s,this,{connectionId:a,_payload:o,metadata:o.metadata,label:o.label,serialization:o.serialization,reliable:o.reliable}),this._addConnection(s,y),this.emit(h.PeerEventType.Connection,y)}var c=this._getMessages(a);try{for(var u=i(c),f=u.next();!f.done;f=u.next()){var m=f.value;y.handleMessage(m)}}catch(e){t={error:e}}finally{try{f&&!f.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}break;default:if(!o)return void l.default.warn("You received a malformed message from "+s+" of type "+r);var y;a=o.connectionId,(y=this.getConnection(s,a))&&y.peerConnection?y.handleMessage(e):a?this._storeMessage(a,e):l.default.warn("You received an unrecognized message:",e)}},t.prototype._storeMessage=function(e,t){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(t)},t.prototype._getMessages=function(e){var t=this._lostMessages.get(e);return t?(this._lostMessages.delete(e),t):[]},t.prototype.connect=function(e,t){if(void 0===t&&(t={}),this.disconnected)return l.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),void this.emitError(h.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");var n=new p.DataConnection(e,this,t);return this._addConnection(e,n),n},t.prototype.call=function(e,t,n){if(void 0===n&&(n={}),this.disconnected)return l.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),void this.emitError(h.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");if(t){n._stream=t;var r=new d.MediaConnection(e,this,n);return this._addConnection(e,r),r}l.default.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.")},t.prototype._addConnection=function(e,t){l.default.log("add connection "+t.type+":"+t.connectionId+" to peerId:"+e),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(t)},t.prototype._removeConnection=function(e){var t=this._connections.get(e.peer);if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}this._lostMessages.delete(e.connectionId)},t.prototype.getConnection=function(e,t){var n,r,o=this._connections.get(e);if(!o)return null;try{for(var s=i(o),a=s.next();!a.done;a=s.next()){var c=a.value;if(c.connectionId===t)return c}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return null},t.prototype._delayedAbort=function(e,t){var n=this;setTimeout((function(){n._abort(e,t)}),0)},t.prototype._abort=function(e,t){l.default.error("Aborting!"),this.emitError(e,t),this._lastServerId?this.disconnect():this.destroy()},t.prototype.emitError=function(e,t){var n;l.default.error("Error:",t),(n="string"==typeof t?new Error(t):t).type=e,this.emit(h.PeerEventType.Error,n)},t.prototype.destroy=function(){this.destroyed||(l.default.log("Destroy peer with ID:"+this.id),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit(h.PeerEventType.Close))},t.prototype._cleanup=function(){var e,t;try{for(var n=i(this._connections.keys()),r=n.next();!r.done;r=n.next()){var o=r.value;this._cleanupPeer(o),this._connections.delete(o)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.socket.removeAllListeners()},t.prototype._cleanupPeer=function(e){var t,n,r=this._connections.get(e);if(r)try{for(var o=i(r),s=o.next();!s.done;s=o.next())s.value.close()}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},t.prototype.disconnect=function(){if(!this.disconnected){var e=this.id;l.default.log("Disconnect peer with ID:"+e),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit(h.PeerEventType.Disconnected,e)}},t.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)l.default.log("Attempting reconnection to server with ID "+this._lastServerId),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(this.disconnected||this.open)throw new Error("Peer "+this.id+" cannot reconnect because it is not disconnected from the server!");l.default.error("In a hurry? We're still trying to make the initial connection!")}},t.prototype.listAllPeers=function(e){var t=this;void 0===e&&(e=function(e){}),this._api.listAllPeers().then((function(t){return e(t)})).catch((function(e){return t._abort(h.PeerErrorType.ServerError,e)}))},t.DEFAULT_KEY="peerjs",t}(c.EventEmitter);n.Peer=y},{eventemitter3:"JJlS","./util":"BHXf","./logger":"WOs9","./socket":"wJlv","./mediaconnection":"dbHP","./dataconnection":"GBTQ","./enums":"ZRYf","./api":"in7L"}],iTK6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./util"),o=e("./peer");n.peerjs={Peer:o.Peer,util:r.util},n.default=o.Peer,window.peerjs=n.peerjs,window.Peer=o.Peer},{"./util":"BHXf","./peer":"Hxpd"}]},{},["iTK6"])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(6);function o(e){console.log("Using mobile controls");Object(r.d)(1),Object(r.e)(1);let t=0,n=0,o=!1,i=null,s=null;let a=[0,0];e.container.canvas.ontouchstart=function(r){a=[r.clientX,r.clientY],r.target==e.container.canvas&&(r.preventDefault(),null!=i&&(clearInterval(i),clearInterval(s)),o=!0,n=(new Date).getTime()/1e3,i=setInterval((function(){t=(new Date).getTime()/1e3-n}),2),s=setInterval((function(){t>.7&&e.inputs.down.emit("fire")}),400))},e.container.canvas.ontouchmove=function(e){e.preventDefault();let t=Math.abs(a[0]-e.targetTouches[0].clientX),r=Math.abs(a[1]-e.targetTouches[0].clientY);(t>3||r>3)&&(n=(new Date).getTime()/1e3+.5),a=[e.targetTouches[0].clientX,e.targetTouches[0].clientY]},e.container.canvas.ontouchend=function(n){n.target==e.container.canvas&&(n.preventDefault(),0<=t&&t<.7&&e.inputs.down.emit("alt-fire"),null!=i&&(clearInterval(i),clearInterval(s)),o=!1,t=0)},e.container.canvas.ontouchcancel=function(n){n.target==e.container.canvas&&(n.preventDefault(),null!=i&&(clearInterval(i),clearInterval(s)),o=!1,t=0)};const c=document.createElement("div");c.id="game_mobile_controls",document.body.appendChild(c);let u=null,l={x:0,y:0};var f=document.createElement("div");function d(t,n){t=Math.round(t/50),0==(n=Math.round(n/50))?(e.inputs.state.forward=!1,e.inputs.state.backward=!1):n>0?(e.inputs.state.forward=!1,e.inputs.state.backward=!0):n<0&&(e.inputs.state.forward=!0,e.inputs.state.backward=!1),0==t?(e.inputs.state.left=!1,e.inputs.state.right=!1):t>0?(e.inputs.state.left=!1,e.inputs.state.right=!0):t<0&&(e.inputs.state.left=!0,e.inputs.state.right=!1)}f.id="game_mobile_joystick",f.ontouchstart=function(e){e.target==f&&(e.preventDefault(),f.style.transition="0s",u=(e.changedTouches,{x:e.targetTouches[0].clientX,y:e.targetTouches[0].clientY}))},f.ontouchmove=function(e){if(e.target!=f)return;if(null===u)return;e.preventDefault();const t=e.targetTouches[0].clientX-u.x,n=e.targetTouches[0].clientY-u.y,r=Math.atan2(n,t),o=Math.min(50,Math.hypot(t,n)),i=o*Math.cos(r),s=o*Math.sin(r);f.style.transform="translate("+(i+16)+"px, "+(s+16)+"px)",l={x:i,y:s},d(i,s)},f.ontouchend=function(e){e.target==f&&(e.preventDefault(),null!==u&&(f.style.transition=".1s",f.style.transform="translate(16px, 16px)",u=null,l={x:0,y:0},d(0,0)))},c.appendChild(f);var p=document.createElement("div");p.id="game_mobile_jump",p.ontouchstart=function(){e.inputs.state.jump=!0},p.ontouchend=function(){e.inputs.state.jump=!1},p.ontouchcancel=function(){e.inputs.state.jump=!1},document.body.appendChild(p);var h=document.createElement("div");h.id="game_mobile_topbuttons",document.body.appendChild(h);var m=document.createElement("div");m.id="game_mobile_chat",m.innerHTML="",m.ontouchstart=function(t){t.preventDefault(),e.inputs.down.emit("chat")},h.appendChild(m);var y=document.createElement("div");y.id="game_mobile_menu",y.ontouchstart=function(t){t.preventDefault(),e.inputs.down.emit("menu")},h.appendChild(y)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(35);function o(e){let t=null,n=!1,o=!1,i=!1;e.on("beforeRender",(function(){t=r.c.gamepad&&null!=navigator.getGamepads()[0]?navigator.getGamepads()[0]:null,null!=t&&(!function(t,n,r,o){t=Math.round(t),0==(n=Math.round(n))?(e.inputs.state.forward=!1,e.inputs.state.backward=!1):n>0?(e.inputs.state.forward=!1,e.inputs.state.backward=!0):n<0&&(e.inputs.state.forward=!0,e.inputs.state.backward=!1);0==t?(e.inputs.state.left=!1,e.inputs.state.right=!1):t>0?(e.inputs.state.left=!1,e.inputs.state.right=!0):t<0&&(e.inputs.state.left=!0,e.inputs.state.right=!1);e.camera.heading=e.camera.heading+Math.trunc(10*r)/500,e.camera.pitch=e.camera.pitch+Math.trunc(10*o)/500}(t.axes[0],t.axes[1],t.axes[2],t.axes[3]),e.inputs.state.jump=t.buttons[0].pressed,t.buttons[13].pressed&&e.inputs.down.emit("mid-fire"),t.buttons[2].pressed&&!n&&(e.inputs.down.emit("inventory"),n=!0,setTimeout((function(){n=!1}),200)),t.buttons[6].pressed&&!o&&(e.inputs.down.emit("alt-fire"),o=!0,setTimeout((function(){o=!1}),200)),t.buttons[7].pressed&&!i&&(e.inputs.down.emit("fire"),i=!0,setTimeout((function(){i=!1}),200)))})),setInterval((function(){null!=t&&(t.buttons[4].pressed?e.inputs.state.scrolly=-1:t.buttons[5].pressed?e.inputs.state.scrolly=1:e.inputs.state.scrolly=0)}),140)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));const r=()=>{};function o(){let e,t=!1,n=r;return[new Promise(r=>{t?r(e):n=r}),r=>{t=!0,e=r,n()}]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(129);function o(e){return e&&"object"==typeof e&&e[r.d]}},function(e,t,n){"use strict";var r=n(317),o=n(119).EventEmitter;function i(e,t){t=t||{},this._noa=e,this._tickRate=t.tickRate,this.element=t.domElement||function(){var e=document.createElement("div");return e.tabindex=1,e.style.position="fixed",e.style.left="0px",e.style.right="0px",e.style.top="0px",e.style.bottom="0px",e.style.height="100%",e.style.overflow="hidden",document.body.appendChild(e),document.body.style.overflow="hidden",document.body.style.height="100%",e.id="noa-container",e}(),this.canvas=function(e){var t=e.querySelector("canvas");t||((t=document.createElement("canvas")).style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.height="100%",t.style.width="100%",t.id="noa-canvas",e.insertBefore(t,e.firstChild));return t}(this.element),this._shell=function(e,t){(t=Object.assign({pointerLock:!1,preventDefaults:!1},t)).element=e;var n=r(t);return n.preventDefaults=t.preventDefaults,n}(this.canvas,t),this.hasPointerLock=!1,this.supportsPointerLock=!1,this.pointerInGame=!1,this.isFocused=document.hasFocus();var n=this,o=function(e){!function(e,t){var n=document.pointerLockElement||document.mozPointerLockElement||document.webkitPointerLockElement;n?(e.hasPointerLock=!0,e.emit("gainedPointerLock")):(e.hasPointerLock=!1,e.emit("lostPointerLock"));n&&(e.pointerInGame=!0)}(n)};document.addEventListener("pointerlockchange",o,!1),document.addEventListener("mozpointerlockchange",o,!1),document.addEventListener("webkitpointerlockchange",o,!1),function(e){if("pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document){e.supportsPointerLock=!0;var t=function(n){e.supportsPointerLock=!1,document.removeEventListener(n.type,t)};document.addEventListener("touchmove",t)}}(n),n.element.addEventListener("mouseenter",(function(){n.pointerInGame=!0})),n.element.addEventListener("mouseleave",(function(){n.pointerInGame=!1})),window.addEventListener("focus",(function(){n.isFocused=!0})),window.addEventListener("blur",(function(){n.isFocused=!1})),this._shell.on("init",s.bind(null,this))}function s(e){var t=e._noa;e._shell.on("resize",t.rendering.resize.bind(t.rendering)),function(e){var t=e._noa,n=e._tickRate,r=performance.now(),o=0,i=function(){var e=performance.now();o+=e-r;for(var s=2;o>n&&s-- >0;)t.tick(n),o-=n;o>n&&(o=0);var a=performance.now(),c=o+(a-e),u=Math.min(1,c/n);t.render(u),r=e,requestAnimationFrame(i)};requestAnimationFrame(i)}(e),e.emit("DOMready")}function a(e,t){var n=e.indexOf(t);n<0||(n===e.length-1?e.pop():e[n]=e.pop())}function c(e,t,n){for(var r=(n||performance.now())+e,o=0;o<1e3;o++){if(t()||performance.now()>r)return}}i.prototype=Object.create(o.prototype),i.prototype.appendTo=function(e){this.element.appendChild(e)},i.prototype.setPointerLock=function(e){this._shell.pointerLock=!!e};var u=0,l=0;function f(e,t,n,r,o){e?function(e,t,n,r,o,i,s,a,c,u,l){for(var f=0;f<i;f++)for(var d=0;d<s;d++)for(var p=e.index(n+f,r+d,o),h=t.index(c+f,u+d,l),m=0;m<a;m++)t.data[h]=e.data[p],p+=e.stride[2],h+=t.stride[2]}(e,t,n[0],n[1],n[2],r[0],r[1],r[2],o[0],o[1],o[2]):function(e,t,n,r,o,i,s){for(var a=0;a<o;a++)for(var c=0;c<i;c++)for(var u=e.index(t+a,n+c,r),l=0;l<s;l++)e.data[u]=0,u+=e.stride[2]}(t,o[0],o[1],o[2],r[0],r[1],r[2])}function d(){this.arr=[],this.hash={}}d.prototype.includes=function(e){return this.hash[e]},d.prototype.add=function(e){this.hash[e]||(this.arr.push(e),this.hash[e]=!0)},d.prototype.remove=function(e){this.hash[e]&&(this.arr.splice(this.arr.indexOf(e),1),delete this.hash[e])},d.prototype.count=function(){return this.arr.length},d.prototype.forEach=function(e,t){return this.arr.forEach(e,t)},d.prototype.slice=function(e,t){return this.arr.slice(e,t)},d.prototype.isEmpty=function(){return 0===this.arr.length},d.prototype.empty=function(){this.arr.length=0,this.hash={}},d.prototype.pop=function(){var e=this.arr.pop();return delete this.hash[e],e},d.prototype.sort=function(e){var t={};this.arr.forEach(n=>{t[n]=e(n)}),this.arr.sort((e,n)=>t[n]-t[e])},d.prototype.copyFrom=function(e){this.arr=e.arr.slice(),this.hash=Object.assign({},e.hash)};var p=n(19),h=n(66),m=n(124),y=n(157),v=n(13),g=n(88),b=n(30),w=n(24),_=n(7),x=n(217),k=(n(187),n(78)),O={showFPS:!1,antiAlias:!0,clearColor:[.8,.9,1],ambientColor:[1,1,1],lightDiffuse:[1,1,1],lightSpecular:[1,1,1],groundLightColor:[.5,.5,.5],useAO:!0,AOmultipliers:[.93,.8,.5],reverseAOmultiplier:1,preserveDrawingBuffer:!0};function P(e,t,n){this.noa=e,t=Object.assign({},O,t),this.useAO=!!t.useAO,this.aoVals=t.AOmultipliers,this.revAoVal=t.reverseAOmultiplier,this.meshingCutoffTime=6,this._resizeDebounce=250,function(e,t,n){e._engine=new v.a(t,n.antiAlias,{preserveDrawingBuffer:n.preserveDrawingBuffer},n.adaptToDeviceRatio),e._multiscenes=new Array,e._scene=new p.a(e._engine);var r=e._scene;e._multiscenes.push(r),r.detachControl(),r._addComponent(new x.c(r)),e._octree=new m.a(e=>{}),e._octree.blocks=[],r._selectionOctree=e._octree,e._cameraHolder=new _.a("camHolder",r),e._camera=new h.a("camera",new w.z(0,0,0),r),e._camera.parent=e._cameraHolder,e._camera.minZ=.01,e._cameraHolder.visibility=!1,e._camScreen=_.a.CreatePlane("camScreen",10,r),e.addMeshToScene(e._camScreen),e._camScreen.position.z=.1,e._camScreen.parent=e._camera,e._camScreenMat=e.makeStandardMaterial("camscreenmat"),e._camScreen.material=e._camScreenMat,e._camScreen.setEnabled(!1),e._camLocBlock=0;var o=new w.z(.1,1,.3);function i(e){return new w.e(e[0],e[1],e[2])}e._light=new g.a("light",o,r),r.clearColor=i(n.clearColor),r.ambientColor=i(n.ambientColor),e._light.diffuse=i(n.lightDiffuse),e._light.specular=i(n.lightSpecular),e._light.groundColor=i(n.groundLightColor),e.flatMaterial=e.makeStandardMaterial("flatmat")}(this,n,t),t.showFPS&&function(){var e=document.createElement("div");e.id="noa_fps";"color:white; background-color:rgba(0,0,0,0.5);","font:14px monospace; text-align:center;","min-width:2em; margin:4px;",e.style="position:absolute; top:0; right:0; z-index:0;color:white; background-color:rgba(0,0,0,0.5);font:14px monospace; text-align:center;min-width:2em; margin:4px;",document.body.appendChild(e);var t=0,n=0,r=performance.now(),o=r;E=function(){t++;var i=performance.now();if(i-o>n&&(n=i-o),o=i,!(i-r<1e3)){var s=Math.round(t/(i-r)*1e3),a=Math.round(1/n*1e3);e.innerHTML=s+"<br>"+a,t=0,n=0,r=i}}}()}P.prototype.getScene=function(){return this._scene},P.prototype.getEngine=function(){return this._engine},P.prototype.addScene=function(e){this._multiscenes.push(e)},P.prototype.getSceneArray=function(e){return this._multiscenes},P.prototype.tick=function(e){},P.prototype.render=function(e){T("start"),function(e){var t=e.noa.camera,n=t._localGetTargetPosition();e._cameraHolder.position.copyFromFloats(n[0],n[1],n[2]),e._cameraHolder.rotation.x=t.pitch,e._cameraHolder.rotation.y=t.heading,e._camera.position.z=-t.currentZoom;var r=t._localGetPosition(),o=e.noa.worldOriginOffset,i=Math.floor(r[0]+o[0]),s=Math.floor(r[1]+o[1]),a=Math.floor(r[2]+o[2]),c=e.noa.getBlock(i,s,a);!function(e,t){if(t===e._camLocBlock)return;if(0===t)e._camScreen.setEnabled(!1);else{var n=e.noa.registry.getBlockFaceMaterial(t,0);if(n){var r=e.noa.registry.getMaterialData(n),o=r.color,i=r.alpha;o&&i&&i<1&&(e._camScreenMat.diffuseColor.set(0,0,0),e._camScreenMat.ambientColor.set(o[0],o[1],o[2]),e._camScreenMat.alpha=i,e._camScreen.setEnabled(!0))}}e._camLocBlock=t}(e,c)}(this),T("updateCamera"),this._engine.beginFrame(),T("beginFrame"),this._multiscenes.forEach(e=>{e.render()}),T("render"),E(),this._engine.endFrame(),T("endFrame"),T("end")},P.prototype.resize=function(e){C||(C=!0,setTimeout(()=>{this._engine.resize(),C=!1},this._resizeDebounce))};var C=!1;P.prototype.highlightBlockFace=function(e,t,n){var r=function(e){var t=e._highlightMesh;if(!t){t=_.a.CreatePlane("highlight",1,e._scene);var n=e.makeStandardMaterial("highlightMat");n.backFaceCulling=!1,n.emissiveColor=new w.e(1,1,1),n.alpha=.2,t.material=n;var r=.5,o=_.a.CreateLines("hightlightLines",[new w.z(r,r,0),new w.z(r,-r,0),new w.z(-r,-r,0),new w.z(-r,r,0),new w.z(r,r,0)],e._scene);o.color=new w.e(1,1,1),o.parent=t,e.addMeshToScene(t),e.addMeshToScene(o),e._highlightMesh=t}return t}(this);if(e){this.noa.globalToLocal(t,null,S);for(var o=.001+.001*k.dist(this.noa.camera._localGetPosition(),S),i=0;i<3;i++)0===n[i]?S[i]+=.5:S[i]+=n[i]>0?1+o:-o;r.position.copyFromFloats(S[0],S[1],S[2]),r.rotation.x=n[1]?Math.PI/2:0,r.rotation.y=n[0]?Math.PI/2:0}r.setEnabled(e)};var S=[];P.prototype.addMeshToScene=function(e,t,n,r){if(!e._noaContainingChunk&&!this._octree.dynamicContent.includes(e)){if(!e.parent){n||(n=[e.position.x,e.position.y,e.position.z]);var o=[];this.noa.globalToLocal(n,null,o),e.position.copyFromFloats(o[0],o[1],o[2])}var i=!1;if(t){var s=r||this.noa.world._getChunkByCoords(n[0],n[1],n[2]);i=!(!s||!s.octreeBlock)}i?(s.octreeBlock.entries.push(e),e._noaContainingChunk=s):this._octree.dynamicContent.push(e),t&&(e.freezeWorldMatrix(),e.freezeNormals());var a=this.removeMeshFromScene.bind(this,e);e.onDisposeObservable.add(a)}},P.prototype.removeMeshFromScene=function(e){e._noaContainingChunk&&e._noaContainingChunk.octreeBlock&&a(e._noaContainingChunk.octreeBlock.entries,e),e._noaContainingChunk=null,a(this._octree.dynamicContent,e)},P.prototype.makeStandardMaterial=function(e){var t=new b.a(e,this._scene);return t.specularColor.copyFromFloats(0,0,0),t.ambientColor.copyFromFloats(1,1,1),t.diffuseColor.copyFromFloats(1,1,1),t},P.prototype.prepareChunkForRendering=function(e){var t=e.size,n=[];this.noa.globalToLocal([e.x,e.y,e.z],null,n);var r=new w.z(n[0],n[1],n[2]),o=new w.z(n[0]+t,n[1]+t,n[2]+t);e.octreeBlock=new y.a(r,o,void 0,void 0,void 0,e=>{}),this._octree.blocks.push(e.octreeBlock)},P.prototype.disposeChunkForRendering=function(e){e.octreeBlock&&(a(this._octree.blocks,e.octreeBlock),e.octreeBlock.entries.length=0,e.octreeBlock=null)},P.prototype._rebaseOrigin=function(e){var t=new w.z(e[0],e[1],e[2]);this._scene.meshes.forEach(e=>{e.parent||(e.position.subtractInPlace(t),e._isWorldMatrixFrozen&&e.markAsDirty())}),this._octree.blocks.forEach(e=>{e.minPoint.subtractInPlace(t),e.maxPoint.subtractInPlace(t),e._boundingVectors.forEach(e=>{e.subtractInPlace(t)})})},P.prototype.debug_SceneCheck=function(){var e=this._scene.meshes,t=this._octree.dynamicContent,n=[],r=0,o=0,i=this._scene.materials,s=[];i.forEach(e=>{e.subMaterials?e.subMaterials.forEach(e=>s.push(e)):s.push(e)}),this._octree.blocks.forEach((function(e){r++,e.entries.forEach(e=>n.push(e))})),e.forEach((function(e){if(e._isDisposed&&u(e,"disposed mesh in scene"),0!==e.getIndices().length)if(l(e,t,n)&&u(e,"non-empty mesh missing from octree"),e.material){o+=e.subMeshes?e.subMeshes.length:1;var r=e.material.subMaterials||[e.material];r.forEach((function(e){l(e,r)&&u(e,"mesh material not in scene")}))}else u(e,"non-empty scene mesh with no material")}));var a=[];s.forEach(t=>{var n=!1;e.forEach(e=>{e.material===t&&(n=!0),e.material&&e.material.subMaterials&&e.material.subMaterials.includes(t)&&(n=!0)}),n||a.push(t.name)}),a.length&&console.warn("Materials unused by any mesh: ",a.join(", ")),t.forEach((function(t){l(t,e)&&u(t,"octree/dynamic mesh not in scene")})),n.forEach((function(t){l(t,e)&&u(t,"octree block mesh not in scene")}));var c=Math.round(10*n.length/r)/10;function u(e,t){console.warn(e.name+" --- "+t)}function l(e,t,n){return!!e&&(!t.includes(e)&&(!n||!n.includes(e)))}return console.log("meshes - octree:",n.length,"  dynamic:",t.length,"   subMeshes:",o,"   avg meshes/octreeBlock:",c),"done."},P.prototype.debug_MeshCount=function(){var e={};for(var t in this._scene.meshes.forEach(t=>{var n=t.name||"";n=(n=(n=(n=n.replace(/-\d+.*/,"#")).replace(/\d+.*/,"#")).replace(/(rotHolder|camHolder|camScreen)/,"rendering use")).replace(/atlas sprite .*/,"atlas sprites"),e[n]=e[n]||0,e[n]++}),e)console.log("   "+(e[t]+"       ").substr(0,7)+t)};var T=()=>{},E=function(){};var j=n(95),M=n.n(j),D=n(72),A=n(16),I=n(80),R=n(11),B=function(e){var t=new V(e),n=new U(e);this.meshChunk=function(r,o,i,s,a,c,u){W("start");var l=o||e.registry.getBlockFaceMaterial,d=i||e.registry._getMaterialVertexColor,p=void 0===a?e.rendering.useAO:a,h=c||e.rendering.aoVals,m=isNaN(u)?e.rendering.revAoVal:u,y=function(e){var t=e.voxels.shape[0],n=z;if(t+2!==n.shape[0]){var r=t+2;n=new M.a(new Uint16Array(r*r*r),[r,r,r]),z=n}var o=F[0],i=F[1],s=F[2],a=F[3],c=F[4],u=F[5],l=F[6];t!==L&&(L=t,function(e,t,n,r){for(var o=0;o<3;o++)t[o]=[e-1,0,0][o],n[o]=[1,e,1][o],r[o]=[0,1,e+1][o]}(t,c,u,l));for(var d=0;d<3;d++){o[0]=d;for(var p=0;p<3;p++){o[1]=p;for(var h=0;h<3;h++){o[2]=h;for(var m=0;m<3;m++){var y=o[m];i[m]=c[y],s[m]=u[y],a[m]=l[y]}var v=e._neighbors.get(d-1,p-1,h-1);f(v?v.voxels:null,n,i,s,a)}}}return n}(r);W("copy");var v,g=r.isFull||r.isEmpty,b=t.mesh(y,l,d,p,h,m,g);return b.length&&(v=n.build(r,b,s),W("terrain")),W("end"),v||null}};var L,z=new M.a(new Uint16Array(27),[3,3,3]),F=Array.from(Array(10)).map(e=>[0,0,0]);function N(e){this.id=0|e,this.positions=[],this.indices=[],this.normals=[],this.colors=[],this.uvs=[],this.mergeable=!1}function U(e){function t(e,t){for(var r=[],o=[],i=[],s=null,a=0;a<e.length;++a){var c=e[a];if(t||c.mergeable)if(r.push(c.positions.length),o.push(c.indices.length),i.push(c.id),s){var u=s.positions.length/3;n(s.positions,c.positions),n(s.normals,c.normals),n(s.colors,c.colors),n(s.uvs,c.uvs);for(var l=0,f=c.indices.length;l<f;++l)s.indices.push(c.indices[l]+u);e.splice(a,1),c.dispose(),a--}else s=c}return{vertices:r,indices:o,matIDs:i}}function n(e,t){for(var n=0;n<t.length;n++)e.push(t[n])}this.build=function(n,o,i){for(var s=0,a=0;a<o.length;a++){var c=o[a];if(i)c.mergeable=!0;else{var u=e.registry.getMaterialTexture(c.id),l=e.registry.getMaterialData(c.id);c.mergeable=!u&&1===l.alpha&&!l.renderMat}c.mergeable&&s++}s>1&&t(o,!1);var f=t(o,!0);return function(t,n,r,o,i){var s=e.rendering.getScene(),a=new _.a(n,s),c=new A.a;if(c.positions=t.positions,c.indices=t.indices,c.normals=t.normals,c.colors=t.colors,c.uvs=t.uvs,c.applyToMesh(a),t.dispose(),1===r.length)a.material=r[0];else{var u=new I.a("multimat "+n,s);a.subMeshes=[];for(var l=0,f=0,d=0;d<r.length;d++){u.subMaterials[d]=r[d];var p=new D.a(d,l,o[d],f,i[d],a);a.subMeshes[d]=p,l+=o[d],f+=i[d]}a.material=u}return a}(o[0],"chunk_"+n.id,f.matIDs.map(t=>function(t,n){if(n)return e.rendering.flatMaterial;var o="terrain mat "+t;r[o]||(r[o]=function(t){var n=e.registry.getMaterialData(t);if(n.renderMat)return n.renderMat;var r=e.registry.getMaterialTexture(t),o=n.alpha;if(!r&&1===o)return e.rendering.flatMaterial;var i=e.rendering.flatMaterial.clone("terrain"+t);if(r){var s=e.rendering.getScene(),a=new R.a(r,s,!0,!1,R.a.NEAREST_SAMPLINGMODE);n.textureAlpha&&(a.hasAlpha=!0),i.diffuseTexture=a}n.alpha<1&&(i.alpha=n.alpha);return i}(t));return r[o]}(t,i)),f.vertices,f.indices)};var r={}}function V(e){var t=new Int16Array(16),n=new Uint16Array(16),r=null,o=e.registry._solidityLookup,i=e.registry._opacityLookup;function s(e,o,i,s){for(var c=i.shape[1],u=t,l=n,f=0,d=2*o,p=i.data,h=i.index(e-1,0,0),m=i.stride[0],y=i.stride[1],v=i.stride[2],g=0;g<c;++g){var b=h;h+=v;for(var w=0;w<c;w++,f++,b+=y){var _=p[b],x=p[b+m];if(_!==x){var k=a(_,x,s,d);k&&(u[f]=k>0?s(_,d):-s(x,d+1),r&&(l[f]=k>0?r(i,e,e-1,w,g):r(i,e-1,e,w,g)))}}}}function a(e,t,n,r){var o=i[e],s=i[t];if(o&&s)return 0;if(o)return 1;if(s)return-1;var a=n(e,r),c=n(t,r+1);return a===c?0:0===a?-1:0===c?1:0}function c(e,r,o,i,s,a,c,p,h,m,y){var v=0,g=t,b=n,w=[0,0,0],_=[0,0,0],x=[0,0,0];w[r]=e;for(var k=[0,0,0],O=c?u:l,P=c?d:f,C=0;C<a;++C)for(var S=1,T=1,E=0;E<s;E+=S,v+=S){var j=0|g[v];if(j){var M=0|b[v];for(S=1;S<s-E&&O(v+S,g,j,b,M);++S);e:for(T=1;T<a-C;++T)for(var D=0;D<S;++D){if(!O(v+D+T*s,g,j,b,M))break e}var A=Math.abs(j);p[A]||(p[A]=new N(A));var I=p[A],R=P(I.colors,h(A),M,m,y);w[o]=E,w[i]=C,_[o]=S,x[i]=T;var B=I.positions;B.push(w[0],w[1],w[2],w[0]+_[0],w[1]+_[1],w[2]+_[2],w[0]+_[0]+x[0],w[1]+_[1]+x[1],w[2]+_[2]+x[2],w[0]+x[0],w[1]+x[1],w[2]+x[2]);var L=j>0?1:-1;2===r?I.uvs.push(0,T,-L*S,T,-L*S,0,0,0):I.uvs.push(0,S,0,0,L*T,0,L*T,S);var z=B.length/3-4;j<0?R?I.indices.push(z,z+1,z+2,z,z+2,z+3):I.indices.push(z+1,z+2,z+3,z,z+1,z+3):R?I.indices.push(z,z+2,z+1,z,z+3,z+2):I.indices.push(z+3,z+1,z,z+3,z+2,z+1),k[r]=L,I.normals.push(k[0],k[1],k[2],k[0],k[1],k[2],k[0],k[1],k[2],k[0],k[1],k[2]);for(var F=0;F<T;++F)for(var U=0;U<S;++U)g[v+U+F*s]=0}else S=1}}function u(e,t,n,r,o){return n===t[e]&&o===r[e]}function l(e,t,n,r,o){return n===t[e]}function f(e,t,n,r,o){return e.push(t[0],t[1],t[2],1),e.push(t[0],t[1],t[2],1),e.push(t[0],t[1],t[2],1),e.push(t[0],t[1],t[2],1),!0}function d(e,t,n,r,o){var i=m(n,0,0),s=m(n,1,0),a=m(n,1,1),c=m(n,0,1);y(e,t,i,r,o),y(e,t,s,r,o),y(e,t,a,r,o),y(e,t,c,r,o);return i===a?c!==s||2===c:c!==s&&i+a>c+s}function p(e,t,n,r,i){var s=1,a=1,c=1,u=1;return o[e.get(t,r+1,i)]&&(++c,++u),o[e.get(t,r-1,i)]&&(++s,++a),o[e.get(t,r,i+1)]&&(++a,++u),o[e.get(t,r,i-1)]&&(++s,++c),o[e.get(t,r,i)]?(u=3===u||o[e.get(t,r+1,i+1)]?3:2,a=3===a||o[e.get(t,r-1,i+1)]?3:2,c=3===c||o[e.get(t,r+1,i-1)]?3:2,s=3===s||o[e.get(t,r-1,i-1)]?3:2):(1===u&&o[e.get(t,r+1,i+1)]&&(u=2),1===a&&o[e.get(t,r-1,i+1)]&&(a=2),1===c&&o[e.get(t,r+1,i-1)]&&(c=2),1===s&&o[e.get(t,r-1,i-1)]&&(s=2)),u<<6|c<<4|a<<2|s}function h(e,t,n,r,i){var s=1,a=1,c=1,u=1;return o[e.get(t,r+1,i)]&&(++c,++u),o[e.get(t,r-1,i)]&&(++s,++a),o[e.get(t,r,i+1)]&&(++a,++u),o[e.get(t,r,i-1)]&&(++s,++c),o[e.get(t,r,i)]?(u=3===u||o[e.get(t,r+1,i+1)]?3:2,a=3===a||o[e.get(t,r-1,i+1)]?3:2,c=3===c||o[e.get(t,r+1,i-1)]?3:2,s=3===s||o[e.get(t,r-1,i-1)]?3:2):(1===u&&(o[e.get(t,r+1,i+1)]?u=2:o[e.get(n,r,i+1)]&&o[e.get(n,r+1,i)]&&o[e.get(n,r+1,i+1)]||(u=0)),1===c&&(o[e.get(t,r+1,i-1)]?c=2:o[e.get(n,r,i-1)]&&o[e.get(n,r+1,i)]&&o[e.get(n,r+1,i-1)]||(c=0)),1===a&&(o[e.get(t,r-1,i+1)]?a=2:o[e.get(n,r,i+1)]&&o[e.get(n,r-1,i)]&&o[e.get(n,r-1,i+1)]||(a=0)),1===s&&(o[e.get(t,r-1,i-1)]?s=2:o[e.get(n,r,i-1)]&&o[e.get(n,r-1,i)]&&o[e.get(n,r-1,i-1)]||(s=0))),u<<6|c<<4|a<<2|s}function m(e,t,n){return e>>(t?n?6:4:n?2:0)&3}function y(e,t,n,r,o){var i=0===n?o:r[n-1];e.push(t[0]*i,t[1]*i,t[2]*i,1)}this.mesh=function(a,u,l,f,d,m,y){o=e.registry._solidityLookup,i=e.registry._opacityLookup;var v={},g=m===d[0];r=f?g?p:h:null;for(var b=0;b<3;++b){var w=(b+1)%3,_=(b+2)%3,x=a.shape,k=a.transpose(b,w,_).lo(1,1,1).hi(x[b]-2,x[w]-2,x[_]-2),O=k.shape[0]-1,P=k.shape[1],C=k.shape[2];t.length<P*C&&(t=new Int16Array(P*C),n=new Uint16Array(P*C));for(var S=0;S<=O;++S)s(S,b,k,u),W("masks"),c(S,b,w,_,P,C,f,v,l,d,m),y&&(S+=O-1),W("submeshes")}return Object.keys(v).map(e=>v[e])}}N.prototype.dispose=function(){this.positions=null,this.indices=null,this.normals=null,this.colors=null,this.uvs=null};var W=()=>{},G=n(212),q=new function(){function e(e,t,n,r,o,i){var s=e._objectBlocks,a=new G.a("object_sps_"+e.id,t,{updatable:!1}),c=e.noa.registry._blockHandlerLookup,u=e.noa.registry._blockMeshLookup;for(var l in n){var f,d=u[l],p=n[l],h=p.length,m=c[l];m&&(f=m.onCustomMeshCreate);a.addShape(d,h,{positionFunction:function(e,t,n){var a=p[n],c=s[a];e.position.set(c.x+.5,c.y,c.z+.5),f&&f(e,r+c.x,o+c.y,i+c.z)}}),p.length=0}return a}this.initChunk=function(e){e._objectBlocks={},e._objectSystems=[]},this.disposeChunk=function(e){this.removeObjectMeshes(e),e._objectBlocks=null},this.addObjectBlock=function(e,t,n,r,o){var i=n+"|"+r+"|"+o;e._objectBlocks[i]=new K(t,n,r,o,null)},this.removeObjectBlock=function(e,t,n,r){var o=t+"|"+n+"|"+r;e._objectBlocks[o]&&delete e._objectBlocks[o]},this.removeObjectMeshes=function(e){for(var t=e._objectSystems||[];t.length;){var n=t.pop();n.mesh&&n.mesh.dispose(),n.dispose()}},this.buildObjectMeshes=function(t){Z("start");var n=t.noa.rendering.getScene(),r=t.noa.registry._blockMeshLookup,o={};for(var i in t._objectBlocks){var s=t._objectBlocks[i].id,a=r[s].material,c=a?n.materials.indexOf(a):-1;o[c]||(o[c]={}),o[c][s]||(o[c][s]=[]),o[c][s].push(i)}Z("preprocess");var u=t.i*t.size,l=t.j*t.size,f=t.k*t.size,d=[];for(var p in o){var h=e(t,n,o[p],u,l,f);Z("made SPS");var m=h.buildMesh();Z("built mesh"),m.material=p>-1?n.materials[p]:null,d.push(m),t._objectSystems.push(h)}return Z("end"),d}};function K(e,t,n,r){this.id=0|e,this.x=0|t,this.y=0|n,this.z=0|r}var Y,J,H,X,$,Z=()=>{},Q=n(95),ee=te;function te(e,t,n,r,o,i,s){this.id=t,this.requestID="",this.noa=e,this.isDisposed=!1,this.octreeBlock=null,this.voxels=s,this.i=n,this.j=r,this.k=o,this.size=i,this.x=n*i,this.y=r*i,this.z=o*i,this._terrainDirty=!1,this._objectsDirty=!1,Y=e.registry._solidityLookup,J=e.registry._opacityLookup,H=e.registry._objectLookup,X=e.registry._blockHandlerLookup,this._terrainMesh=null,this._objectBlocks=null,this._objectSystems=null,q.initChunk(this),this.isFull=!1,this.isEmpty=!1;var a=Array.from(Array(27)).map(()=>null);this._neighbors=new Q(a,[3,3,3]).lo(1,1,1),this._neighbors.set(0,0,0,this),this._neighborCount=0,this._maxMeshedNeighbors=0,this._timesMeshed=0,oe(this)}function ne(e,t,n,r,o,i){var s=X[t];if(s){var a=s[n];a&&a(e.x+r,e.y+o,e.z+i)}}function re(e){return 0!==e&&(!!Y[e]||!H[e])}function oe(e){for(var t=!0,n=!0,r=!1,o=e.voxels,i=o.shape[0],s=0;s<i;++s)for(var a=0;a<i;++a)for(var c=o.index(s,a,0),u=0;u<i;++u,++c){var l=o.data[c];0!==l?(t=t&&J[l],n=!1,H[l]&&(ie(e,l,s,a,u),r=!0),ne(e,l,"onLoad",s,a,u)):t=!1}e.isFull=t,e.isEmpty=n,e._terrainDirty=!e.isEmpty,e._objectsDirty=r}function ie(e,t,n,r,o){q.addObjectBlock(e,t,n,r,o),e._objectsDirty=!0}function se(e,t){for(var n=e.voxels,r=n.shape[0],o=0;o<r;++o)for(var i=0;i<r;++i)for(var s=0;s<r;++s){var a=n.get(o,i,s);a>0&&ne(e,a,t,o,i,s)}}te._createVoxelArray=function(e){var t=new Uint16Array(e*e*e);return new Q(t,[e,e,e])},te.prototype._updateVoxelArray=function(e){se(this,"onUnload"),q.disposeChunk(this),this.voxels=e,this._terrainDirty=!1,this._objectsDirty=!1,q.initChunk(this),oe(this)},te.prototype.get=function(e,t,n){return this.voxels.get(e,t,n)},te.prototype.getSolidityAt=function(e,t,n){return Y[this.voxels.get(e,t,n)]},te.prototype.set=function(e,t,n,r){var o=this.voxels.get(e,t,n),i=o;if(r!==i){this.voxels.set(e,t,n,r),H[o]&&function(e,t,n,r){q.removeObjectBlock(e,t,n,r),e._objectsDirty=!0}(this,e,t,n),H[r]&&ie(this,r,e,t,n),ne(this,i,"onUnset",e,t,n),ne(this,r,"onSet",e,t,n),J[r]||(this.isFull=!1),0!==r&&(this.isEmpty=!1),(re(r)||re(o))&&(this._terrainDirty=!0),(this._terrainDirty||this._objectsDirty)&&this.noa.world._queueChunkForRemesh(this);var s=!1;if(Y[o]!==Y[r]&&(s=!0),J[o]!==J[r]&&(s=!0),s){var a=this.size-1,c=0===e?-1:e<a?0:1,u=0===t?-1:t<a?0:1,l=0===n?-1:n<a?0:1;if(c|u|l){var f=u?[0,u]:[0],d=l?[0,l]:[0];(c?[0,c]:[0]).forEach(e=>{f.forEach(t=>{d.forEach(n=>{if(0!=(e|t|n)){var r=this._neighbors.get(e,t,n);r&&(r._terrainDirty=!0,this.noa.world._queueChunkForRemesh(r))}})})})}}}},te.prototype.mesh=function(e,t,n,r,o){return $||($=new B(this.noa)),$.meshChunk(this,e,t,!1,n,r,o)},te.prototype.updateMeshes=function(){var e=this.noa.rendering;if(this._terrainDirty){this._terrainMesh&&this._terrainMesh.dispose();var t=this.mesh();if(t&&t.getIndices().length>0){var n=[this.x,this.y,this.z];e.addMeshToScene(t,!0,n,this)}this._terrainMesh=t||null,this._terrainDirty=!1,this._timesMeshed++,this._maxMeshedNeighbors=Math.max(this._maxMeshedNeighbors,this._neighborCount)}if(this._objectsDirty){q.removeObjectMeshes(this);var r=q.buildObjectMeshes(this),o=[this.x,this.y,this.z];r.forEach(t=>e.addMeshToScene(t,!0,o,this)),this._objectsDirty=!1}},te.prototype.dispose=function(){se(this,"onUnload"),q.disposeChunk(this),this._terrainMesh&&this._terrainMesh.dispose(),this.voxels.data=null,this.voxels=null,this._neighbors.data=null,this._neighbors=null,this.isDisposed=!0};var ae=n(119).EventEmitter,ce={chunkSize:24,chunkAddDistance:3,chunkRemoveDistance:4,worldGenWhilePaused:!1,manuallyControlChunkLoading:!1};function ue(e,t){var n;this.noa=e,t=Object.assign({},ce,t),this.playerChunkLoaded=!1,this.Chunk=ee,this.chunkSize=t.chunkSize,this.chunkAddDistance=t.chunkAddDistance,this.chunkRemoveDistance=t.chunkRemoveDistance,this.chunkRemoveDistance<this.chunkAddDistance&&(this.chunkRemoveDistance=this.chunkAddDistance),this.manuallyControlChunkLoading=!!t.manuallyControlChunkLoading,this.minNeighborsToMesh=6,this.maxChunksPendingCreation=10,this.maxChunksPendingMeshing=10,this.maxProcessingPerTick=9,this.maxProcessingPerRender=5,this.worldGenWhilePaused=t.worldGenWhilePaused,this._cachedWorldName="",this._lastPlayerChunkID="",this._chunkStorage={},(n=this)._chunkIDsKnown=new d,n._chunkIDsToRequest=new d,n._chunkIDsPending=new d,n._chunkIDsToMesh=new d,n._chunkIDsToMeshFirst=new d,n._chunkIDsToRemove=new d,n._queueChunkForRemesh=e=>{ve(n,e)},function(e){e._getChunk=(t,n,r)=>{var o=fe(t,n,r);return e._chunkStorage[o]||null},e._setChunk=(t,n,r,o)=>{var i=fe(t,n,r);o?e._chunkStorage[i]=o:delete e._chunkStorage[i]},e._getChunkByCoords=function(t,n,r){var o=e._worldCoordToChunkCoord(t),i=e._worldCoordToChunkCoord(n),s=e._worldCoordToChunkCoord(r);return e._getChunk(o,i,s)}}(this),this.removeChunk=function(e){ye(this,e)};var r=this.chunkSize;if(0==(r&r-1)){var o=0|Math.log2(r),i=r-1|0;this._worldCoordToChunkCoord=e=>e>>o|0,this._worldCoordToChunkIndex=e=>e&i|0}else this._worldCoordToChunkCoord=e=>0|Math.floor(e/r),this._worldCoordToChunkIndex=e=>(e%r+r)%r|0}ue.prototype=Object.create(ae.prototype),ue.prototype.getBlockID=function(e,t,n){var r=this._getChunkByCoords(e,t,n);return r?r.get(this._worldCoordToChunkIndex(e),this._worldCoordToChunkIndex(t),this._worldCoordToChunkIndex(n)):0},ue.prototype.getBlockSolidity=function(e,t,n){var r=this._getChunkByCoords(e,t,n);return!!r&&!!r.getSolidityAt(this._worldCoordToChunkIndex(e),this._worldCoordToChunkIndex(t),this._worldCoordToChunkIndex(n))},ue.prototype.getBlockOpacity=function(e,t,n){var r=this.getBlockID(e,t,n);return this.noa.registry.getBlockOpacity(r)},ue.prototype.getBlockFluidity=function(e,t,n){var r=this.getBlockID(e,t,n);return this.noa.registry.getBlockFluidity(r)},ue.prototype.getBlockProperties=function(e,t,n){var r=this.getBlockID(e,t,n);return this.noa.registry.getBlockProps(r)},ue.prototype.getBlockObjectMesh=function(e,t,n){var r=this._getChunkByCoords(e,t,n);return r?r.getObjectMeshAt(this._worldCoordToChunkIndex(e),this._worldCoordToChunkIndex(t),this._worldCoordToChunkIndex(n)):0},ue.prototype.setBlockID=function(e,t,n,r){var o=this._worldCoordToChunkCoord(t),i=this._worldCoordToChunkCoord(n),s=this._worldCoordToChunkCoord(r),a=this._worldCoordToChunkIndex(t),c=this._worldCoordToChunkIndex(n),u=this._worldCoordToChunkIndex(r),l=this._getChunk(o,i,s);l&&l.set(a,c,u,e)},ue.prototype.isBoxUnobstructed=function(e){for(var t=e.base,n=e.max,r=Math.floor(t[0]);r<n[0]+1;r++)for(var o=Math.floor(t[1]);o<n[1]+1;o++)for(var i=Math.floor(t[2]);i<n[2]+1;i++)if(this.getBlockSolidity(r,o,i))return!1;return!0},ue.prototype.setChunkData=function(e,t,n){!function(e,t,n,r){var o=t.split("|"),i=parseInt(o.shift()),s=parseInt(o.shift()),a=parseInt(o.shift()),c=o.join("|"),u=fe(i,s,a);if(e._chunkIDsPending.remove(u),c!==e.noa.worldName)return;if(!e._chunkIDsKnown.includes(u))return;if(e._chunkIDsToRemove.includes(u))return;var l=e._chunkStorage[u];if(l){l._updateVoxelArray(n),l._neighbors.data.forEach(t=>{t&&t!==l&&t._neighborCount>20&&ve(e,t)})}else{var f=e.chunkSize;l=new ee(e.noa,u,i,s,a,f,n),e._setChunk(i,s,a,l),l.requestID=t,l.userData=r,be(e,i,s,a,l),e.noa.rendering.prepareChunkForRendering(l),e.emit("chunkAdded",l)}ve(e,l),xe("receive")}(this,e,t,n)},ue.prototype.invalidateVoxelsInAABB=function(e){!function(e,t){var n=t.base.map(t=>Math.floor(e._worldCoordToChunkCoord(t))),r=t.max.map(t=>Math.floor(e._worldCoordToChunkCoord(t)));e._chunkIDsKnown.forEach(t=>{for(var o=de(t),i=0;i<3;i++)if(o[i]<n[i]||o[i]>r[i])return;e._chunkIDsToRemove.includes(t)||e._chunkIDsToRequest.add(t)})}(this,e)},ue.prototype.manuallyLoadChunk=function(e,t,n){if(!this.manuallyControlChunkLoading)throw le;var r=fe(this._worldCoordToChunkCoord(e),this._worldCoordToChunkCoord(t),this._worldCoordToChunkCoord(n));this._chunkIDsKnown.add(r),this._chunkIDsToRequest.add(r)},ue.prototype.manuallyUnloadChunk=function(e,t,n){if(!this.manuallyControlChunkLoading)throw le;var r=fe(this._worldCoordToChunkCoord(e),this._worldCoordToChunkCoord(t),this._worldCoordToChunkCoord(n));this._chunkIDsToRemove.add(r),this._chunkIDsToRequest.remove(r),this._chunkIDsToMesh.remove(r),this._chunkIDsToMeshFirst.remove(r)};var le="Set `noa.world.manuallyControlChunkLoading` if you need this API";function fe(e,t,n){return e+"|"+t+"|"+n}function de(e){return e.split("|").map(e=>parseInt(e))}function pe(e){var t=e.noa.entities.getPosition(e.noa.playerEntity);return[e._worldCoordToChunkCoord(t[0]),e._worldCoordToChunkCoord(t[1]),e._worldCoordToChunkCoord(t[2])]}ue.prototype.tick=function(){var e=performance.now();this._cachedWorldName!==this.noa.worldName&&(!function(e){e._chunkIDsToRemove.copyFrom(e._chunkIDsKnown),e._chunkIDsToRequest.empty(),e._chunkIDsToMesh.empty(),e._chunkIDsToMeshFirst.empty();var t=pe(e);ge(e._chunkIDsToRemove,t[0],t[1],t[2])}(this),this._cachedWorldName=this.noa.worldName);var t,n,r,o,i,s,a=pe(this),f=fe(a[0],a[1],a[2]),d=f!=this._lastPlayerChunkID;if(d&&(this.emit("playerEnteredChunk",a[0],a[1],a[2]),this._lastPlayerChunkID=f),_e("start"),xe("start"),!this.manuallyControlChunkLoading){d&&(t=this,n=a[0],r=a[1],o=a[2],i=t.chunkRemoveDistance*t.chunkRemoveDistance,s=t._chunkIDsToRemove,t._chunkIDsKnown.forEach(e=>{if(!s.includes(e)){var a=de(e),c=a[0]-n,u=a[1]-r,l=a[2]-o;c*c+u*u+l*l<i||(t._chunkIDsToRemove.add(e),t._chunkIDsToRequest.remove(e),t._chunkIDsToMesh.remove(e),t._chunkIDsToMeshFirst.remove(e))}}),ge(s,n,r,o),_e("remQueue"));var p=function(e){if(e===u)return l;for(var t=Math.ceil(e),n=0,r=e*e,o=-t;o<=t;++o)for(var i=-t;i<=t;++i)for(var s=-t;s<=t;++s){o*o+i*i+s*s<r&&n++}return u=e,l=n,n}(this.chunkAddDistance);(d||this._chunkIDsKnown.count()<p)&&(!function(e,t,n,r){for(var o=Math.ceil(e.chunkAddDistance),i=e.chunkAddDistance*e.chunkAddDistance,s=e._chunkIDsKnown,a=e._chunkIDsToRequest,c=t-o;c<=t+o;++c)for(var u=n-o;u<=n+o;++u)for(var l=r-o;l<=r+o;++l){var f=fe(c,u,l);if(!s.includes(f)){var d=c-t,p=u-n,h=l-r;d*d+p*p+h*h>i||(s.add(f),a.add(f))}}ge(a,t,n,r)}(this,a[0],a[1],a[2]),_e("addQueue"))}c(this.maxProcessingPerTick,()=>{var e=function(e){var t=e._chunkIDsToRequest;if(t.isEmpty())return!0;var n=e._chunkIDsPending.count(),r=e._chunkIDsToMesh.count();if(n>=e.maxChunksPendingCreation)return!0;if(r>=e.maxChunksPendingMeshing)return!0;var o=t.pop();return function(e,t){var n=de(t),r=n[0],o=n[1],i=n[2],s=e.chunkSize,a=ee._createVoxelArray(e.chunkSize),c=e.noa.worldName,u=[r,o,i,c].join("|"),l=r*s,f=o*s,d=i*s;e._chunkIDsPending.add(t),e.emit("worldDataNeeded",u,a,l,f,d,c),xe("request")}(e,o),t.isEmpty()}(this);return _e("requests"),e=e&&function(e){var t=e._chunkIDsToRemove;return!!t.isEmpty()||(ye(e,t.pop()),t.isEmpty())}(this),_e("removes"),e=e&&me(this,!1),_e("meshes"),e},e),performance.now()-e+2<this.maxProcessingPerTick&&(!function(e){for(var t=e._chunkIDsKnown.arr,n=Math.min(50,t.length),r=e._chunkIDsToMesh.count()+e._chunkIDsToMeshFirst.count(),o=0;o<n;o++){he=(he+1)%t.length;var i=t[he],s=e._chunkStorage[i];if(s){var a=s._neighborCount;if(!(a<e.minNeighborsToMesh)&&!(a<=s._maxMeshedNeighbors)&&(ve(e,s),++r>10))return}}}(this),_e("looking"),c(this.maxProcessingPerTick,()=>{var e=me(this,!1);return _e("meshes"),e},e));var h=this._getChunk(a[0],a[1],a[2]);this.playerChunkLoaded=!!h,xe("end",this),_e("end")},ue.prototype.render=function(){c(this.maxProcessingPerRender,()=>me(this,!0))};var he=-1;function me(e,t){var n=e._chunkIDsToMeshFirst;if(n.isEmpty()&&!t&&(n=e._chunkIDsToMesh),n.isEmpty())return!0;var r=n.pop();if(!e._chunkIDsToRemove.includes(r)){var o=e._chunkStorage[r];o&&function(e,t){e._chunkIDsToMesh.remove(t.id),e._chunkIDsToMeshFirst.remove(t.id),t.updateMeshes(),xe("mesh")}(e,o)}}function ye(e,t){var n=de(t),r=e._getChunk(n[0],n[1],n[2]);r&&(e.emit("chunkBeingRemoved",r.requestID,r.voxels,r.userData),e.noa.rendering.disposeChunkForRendering(r),r.dispose(),xe("dispose"),be(e,n[0],n[1],n[2],null)),e._setChunk(n[0],n[1],n[2],null),e._chunkIDsKnown.remove(t),e._chunkIDsToMesh.remove(t),e._chunkIDsToMeshFirst.remove(t)}function ve(e,t){var n=t._neighborCount;n<Math.min(e.minNeighborsToMesh,26)||(t._terrainDirty=!0,(26===n?e._chunkIDsToMeshFirst:e._chunkIDsToMesh).add(t.id))}function ge(e,t,n,r){e.sort(e=>{var o=de(e),i=o[0]-t,s=o[1]-n,a=o[2]-r;return i*i+a*a+Math.abs(s)})}function be(e,t,n,r,o){for(var i=-1;i<=1;i++)for(var s=-1;s<=1;s++)for(var a=-1;a<=1;a++)if(0!=(i|s|a)){var c=fe(t+i,n+s,r+a),u=e._chunkStorage[c];u&&(o?(o._neighborCount++,o._neighbors.set(i,s,a,u),u._neighborCount++,u._neighbors.set(-i,-s,-a,o),26===u._neighborCount&&ve(e,u)):(u._neighborCount--,u._neighbors.set(-i,-s,-a,null)))}}function we(e,t,n,r){var o=0,i=0,s=0,a=0,c=[];n.forEach(t=>{var n=e._chunkStorage[t];n&&(s++,c.push(n._timesMeshed),n.isFull&&o++,n.isEmpty&&i++,26===n._neighborCount&&a++)});var u=n.length.toString().padEnd(8);if(u+=("exist: "+s).padEnd(12),u+=("full: "+o).padEnd(12),u+=("empty: "+i).padEnd(12),u+=("surr: "+a).padEnd(12),r){var l=c.reduce((e,t)=>e+t,0),f=c.reduce((e,t)=>Math.max(e,t),0),d=c.reduce((e,t)=>Math.min(e,t),0);u+="times meshed: avg "+(l/s).toFixed(2),u+="  max "+f,u+="  min "+d}console.log(t,u)}ue.prototype.report=function(){console.log("World report - playerChunkLoaded: ",this.playerChunkLoaded),we(this,"  known:     ",this._chunkIDsKnown.arr,!0),we(this,"  to request:",this._chunkIDsToRequest.arr),we(this,"  to remove: ",this._chunkIDsToRemove.arr),we(this,"  creating:  ",this._chunkIDsPending.arr),we(this,"  to mesh:   ",this._chunkIDsToMesh.arr.concat(this._chunkIDsToMeshFirst.arr))};var _e=()=>{},xe=()=>{};var ke=n(329),Oe=function(e,t,n){return function(e,t,n){t=Object.assign({},Pe,t);var r=ke(n,t),o=t.bindings;for(var i in o){var s=Array.isArray(o[i])?o[i]:[o[i]];s.unshift(i),r.bind.apply(r,s)}return r}(0,t,n)},Pe={bindings:{forward:["W","<up>"],left:["A","<left>"],backward:["S","<down>"],right:["D","<right>"],fire:"<mouse 1>","mid-fire":["<mouse 2>","Q"],"alt-fire":["<mouse 3>","E"],jump:"<space>",sprint:"<shift>",crouch:"<control>"}};var Ce=n(332),Se=function(e,t){return function(e,t){t=Object.assign({},Te,t);var n=e.world,r=e.registry._solidityLookup,o=e.registry._fluidityLookup,i=e.worldOriginOffset;return Ce(t,(e,t,o)=>{var s=n.getBlockID(e+i[0],t+i[1],o+i[2]);return r[s]},(e,t,r)=>{var s=n.getBlockID(e+i[0],t+i[1],r+i[2]);return o[s]})}(e,t)},Te={gravity:[0,-10,0],airDrag:.1};var Ee=n(78),je=n(231),Me=n(264),De={inverseX:!1,inverseY:!1,sensitivityX:10,sensitivityY:10,initialZoom:0,zoomSpeed:.2};function Ae(e,t){this.noa=e,t=Object.assign({},De,t),this.sensitivityX=t.sensitivityX,this.sensitivityY=t.sensitivityY,this.inverseX=t.inverseX,this.inverseY=t.inverseY,this.heading=0,this.pitch=0,this.cameraTarget=this.noa.ents.createEntity(["position"]);var n=.9*e.ents.getPositionData(e.playerEntity).height;e.ents.addComponent(this.cameraTarget,"followsEntity",{entity:e.playerEntity,offset:[0,n,0]}),this.zoomDistance=t.initialZoom,this.zoomSpeed=t.zoomSpeed,this.currentZoom=t.initialZoom,this._dirVector=Ee.fromValues(0,1,0)}Ae.prototype._localGetTargetPosition=function(){var e=this.noa.ents.getPositionData(this.cameraTarget);return Ee.copy(Ie,e._renderPosition)},Ae.prototype._localGetPosition=function(){var e=this._localGetTargetPosition();return 0===this.currentZoom?e:Ee.scaleAndAdd(e,e,this._dirVector,-this.currentZoom)};var Ie=Ee.create();Ae.prototype.getTargetPosition=function(){var e=this._localGetTargetPosition();return this.noa.localToGlobal(e,Re)};var Re=[];Ae.prototype.getPosition=function(){var e=this._localGetPosition();return this.noa.localToGlobal(e,Re)},Ae.prototype.getDirection=function(){return this._dirVector},Ae.prototype.applyInputsToCamera=function(){var e=this.noa.inputs.state;!function(e){var t=e.dx,n=e.dy,r=document.body.clientWidth/6,o=document.body.clientHeight/6,i=Math.abs(t)>r&&t/Ve<-1,s=Math.abs(n)>o&&n/We<-1;i||s?(e.dx=Ve,e.dy=We,Ve=t>0?1:-1,We=n>0?1:-1):(t&&(Ve=t),n&&(We=n))}(e);var t=.0066*Math.PI/180,n=e.dy*this.sensitivityY*t,r=e.dx*this.sensitivityX*t;this.inverseY&&(n=-n),this.inverseX&&(r=-r);var o=2*Math.PI;this.heading+=r<0?r+o:r,this.heading>o&&(this.heading-=o);var i=Math.PI/2-.001;this.pitch=Math.max(-i,Math.min(i,this.pitch+n)),Ee.set(this._dirVector,0,0,1),Ee.rotateX(this._dirVector,this._dirVector,Be,this.pitch),Ee.rotateY(this._dirVector,this._dirVector,Be,this.heading)};var Be=Ee.create();Ae.prototype.updateBeforeEntityRenderSystems=function(){this.currentZoom+=(this.zoomDistance-this.currentZoom)*this.zoomSpeed},Ae.prototype.updateAfterEntityRenderSystems=function(){var e=function(e){if(!Le){var t=e.noa.worldOriginOffset;Le=new je([0,0,0],Ee.clone(Fe)),ze=(n,r,o)=>e.noa.world.getBlockSolidity(n+t[0],r+t[1],o+t[2]),Ee.scale(Fe,Fe,-.5)}Le.setPosition(e._localGetTargetPosition()),Le.translate(Fe);var n=Math.max(e.zoomDistance,e.currentZoom)+.1;return Ee.scale(Ne,e.getDirection(),-n),Me(ze,Le,Ne,Ue,!0)}(this);this.currentZoom>e&&(this.currentZoom=e)};var Le,ze,Fe=Ee.fromValues(.2,.2,.2),Ne=Ee.create(),Ue=()=>!0;var Ve=0,We=0,Ge={texturePath:""},qe={solid:!0,opaque:!0,fluidDensity:1,viscosity:.5};function Ke(e,t){this.noa=e,t=Object.assign({},Ge,t);var n=[!1],r=[!1],o=[!1],i=[!1],s=[0,0,0,0,0,0],a=[null],c=[null],u=[null],l={},f=[null],d=t.texturePath;this.registerBlock=function(e,t){t=t||{},qe.solid=!t.fluid,qe.opaque=!t.fluid;var f=Object.assign({},qe,t);if(e<1||e>65535)throw"Block id out of range: "+e;for(;e>n.length;)this.registerBlock(n.length,{});n[e]=!!f.solid,r[e]=!!f.opaque,o[e]=!!f.fluid,i[e]=!!f.blockMesh,c[e]=f.blockMesh||null;var d,p=f.material||null;if(p)if("string"==typeof p)d=[p,p,p,p,p,p];else if(p.length&&2==p.length)d=[p[1],p[1],p[0],p[0],p[1],p[1]];else if(p.length&&3==p.length)d=[p[2],p[2],p[0],p[1],p[2],p[2]];else{if(!p.length||6!=p.length)throw"Invalid material parameter: "+p;d=p}else d=[null,null,null,null,null,null];for(var h=0;h<6;++h)s[6*e+h]=Ye(this,l,d[h],!0);a[e]={},o[e]&&(a[e].fluidDensity=f.fluidDensity,a[e].viscosity=f.viscosity);var m=f.onLoad||f.onUnload||f.onSet||f.onUnset||f.onCustomMeshCreate;return u[e]=m?new Je(f):null,e},this.registerMaterial=function(e,t,n,r,o){var i=l[e]||f.length;l[e]=i;var s=1;return t&&4==t.length&&(s=t.pop()),f[i]={color:t||[1,1,1],alpha:s,texture:n?d+n:"",textureAlpha:!!r,renderMat:o||null},i},this.getBlockSolidity=function(e){return n[e]},this.getBlockOpacity=function(e){return r[e]},this.getBlockFluidity=function(e){return o[e]},this.getBlockProps=function(e){return a[e]},this.getBlockFaceMaterial=function(e,t){return s[6*e+t]},this.getMaterialColor=function(e){return f[e].color},this.getMaterialTexture=function(e){return f[e].texture},this.getMaterialData=function(e){return f[e]},this._solidityLookup=n,this._opacityLookup=r,this._fluidityLookup=o,this._objectLookup=i,this._blockMeshLookup=c,this._blockHandlerLookup=u,this._getMaterialVertexColor=function(e){return f[e].texture?p:f[e].color};var p=[1,1,1];this.registerMaterial("dirt",[.4,.3,0],null),this.registerBlock(1,{material:"dirt"})}function Ye(e,t,n,r){if(!n)return 0;var o=t[n];return void 0===o&&r&&(o=e.registerMaterial(n)),o}function Je(e){this.onLoad=e.onLoad||null,this.onUnload=e.onUnload||null,this.onSet=e.onSet||null,this.onUnset=e.onUnset||null,this.onCustomMeshCreate=e.onCustomMeshCreate||null}var He=n(234),Xe=n(235),$e=n(78),Ze=n(334),Qe={shadowDistance:10};function et(e,t){Ze.call(this),this.noa=e,t=Object.assign({},Qe,t),this.names={};var r={shadow:t.shadowDistance},o=n(336);o.keys().forEach(t=>{var n=/\.\/(.*)\.js/.exec(t)[1],i=r[n]||void 0,s=o(t);s.default&&(s=s.default);var a=s(e,i),c=this.createComponent(a);this.names[n]=c}),this.isPlayer=function(t){return t===e.playerEntity},this.hasPhysics=this.getComponentAccessor(this.names.physics),this.cameraSmoothed=this.getComponentAccessor(this.names.smoothCamera),this.hasMesh=this.getComponentAccessor(this.names.mesh),this.hasPosition=this.getComponentAccessor(this.names.position);var i=this.getStateAccessor(this.names.position);function s(t,n){$e.copy(n._renderPosition,n._localPosition),$e.add(n.position,n._localPosition,e.worldOriginOffset),Object(He.updatePositionExtents)(n);var r=a(t);r&&Object(Xe.setPhysicsFromPosition)(r,n)}this.getPositionData=i,this._localGetPosition=function(e){return i(e)._localPosition},this.getPosition=function(e){return i(e).position},this._localSetPosition=function(e,t){var n=i(e);$e.copy(n._localPosition,t),s(e,n)},this.setPosition=(t,n,r,o)=>{"number"==typeof n&&(n=[n,r,o]);var i=e.globalToLocal(n,null,[]);this._localSetPosition(t,i)},this.setEntitySize=function(e,t,n,r){var o=i(e);o.width=(t+r)/2,o.height=n,s(e,o)},this._rebaseOrigin=function(e){this.getStatesList(this.names.position).forEach(t=>{$e.subtract(t._localPosition,t._localPosition,e),s(t.__id,t)})};var a=this.getStateAccessor(this.names.physics);this.getPhysics=a,this.getPhysicsBody=function(e){return a(e).body},this.getMeshData=this.getStateAccessor(this.names.mesh),this.getMovement=this.getStateAccessor(this.names.movement),this.getCollideTerrain=this.getStateAccessor(this.names.collideTerrain),this.getCollideEntities=this.getStateAccessor(this.names.collideEntities),this.onPairwiseEntityCollision=function(e,t){}}function tt(e,t){return!(e[0]>t[3])&&(!(e[1]>t[4])&&(!(e[2]>t[5])&&(!(e[3]<t[0])&&(!(e[4]<t[1])&&!(e[5]<t[2])))))}et.prototype=Object.create(Ze.prototype),et.prototype.constructor=et,et.prototype.addComponentAgain=function(e,t,n){this.hasComponent(e,t)&&this.removeComponent(e,t,!0),this.addComponent(e,t,n)},et.prototype.isTerrainBlocked=function(e,t,n){for(var r=this.noa.worldOriginOffset,o=Math.floor(e-r[0]),i=Math.floor(t-r[1]),s=Math.floor(n-r[2]),a=[o+.001,i+.001,s+.001,o+.999,i+.999,s+.999],c=this.getStatesList(this.names.collideTerrain),u=0;u<c.length;u++){var l=c[u].__id;if(tt(a,this.getPositionData(l)._extents))return!0}return!1},et.prototype.getEntitiesInAABB=function(e,t){var n=this.noa.worldOriginOffset,r=[e.base[0]+n[0],e.base[1]+n[1],e.base[2]+n[2],e.max[0]+n[0],e.max[1]+n[1],e.max[2]+n[2]],o=t?this.getStatesList(t).map(e=>this.getPositionData(e.__id)):this.getStatesList(this.names.position),i=[];return o.forEach(e=>{tt(r,e._extents)&&i.push(e.__id)}),i},et.prototype.add=function(e,t,n,r,o,i,s){var a=this,c=this.createEntity();if(this.addComponent(c,this.names.position,{position:e||[0,0,0],width:t,height:n}),i){this.addComponent(c,this.names.physics);var u=this.getPhysicsBody(c),l=this.names.smoothCamera;u.onStep=function(){a.addComponentAgain(c,l)}}return r&&(o||(o=$e.create()),this.addComponent(c,this.names.mesh,{mesh:r,offset:o})),s&&this.addComponent(c,this.names.shadow,{size:t}),c}
/*!
 * noa: an experimental voxel game engine.
 * @url      github.com/andyhall/noa
 * @author   Andy Hall <andy@fenomas.com>
 * @license  MIT
 */;var nt=n(78),rt=n(95),ot=n(316),it=n(119).EventEmitter,st=(t.a=at,{debug:!1,silent:!1,playerHeight:1.8,playerWidth:.6,playerStart:[0,10,0],playerAutoStep:!1,tickRate:33,blockTestDistance:10,stickyPointerLock:!0,dragCameraOutsidePointerLock:!0,skipDefaultHighlighting:!1,originRebaseDistance:25});function at(e){if(!(this instanceof at))return new at(e);this.version=n(356).version,e=Object.assign({},st,e),this._tickRate=e.tickRate,this._lastRenderTime=0,this._paused=!1,this._dragOutsideLock=e.dragCameraOutsidePointerLock;var t=this;if(!e.silent){var r=e.debug?" (debug)":"";console.log(`noa-engine v${this.version}${r}`)}this.worldOriginOffset=[0,0,0],this._originRebaseDistance=e.originRebaseDistance,this.vec3=nt,this.positionInCurrentTick=0,this.worldName="default",this.container=function(e,t){return new i(e,t)}(this,e),this.inputs=Oe(0,e,this.container.element),this.registry=function(e,t){return new Ke(e,t)}(this,e),this.world=function(e,t){return new ue(e,t)}(this,e),this.rendering=function(e,t,n){return new P(e,t,n)}(this,e,this.container.canvas),this.physics=Se(this,e),this.entities=function(e,t){return new et(e,t)}(this,e),this.ents=this.entities;var o=this.ents;this.playerEntity=o.add(e.playerStart,e.playerWidth,e.playerHeight,null,null,!0,!0),o.addComponent(this.playerEntity,o.names.collideTerrain),o.addComponent(this.playerEntity,o.names.collideEntities);var s=o.getPhysicsBody(this.playerEntity);s.gravityMultiplier=2,s.autoStep=e.playerAutoStep,o.addComponent(this.playerEntity,o.names.receivesInputs),o.addComponent(this.playerEntity,o.names.fadeOnZoom);var a,c,u;o.addComponent(this.playerEntity,o.names.movement,{airJumps:1}),this.camera=function(e,t){return new Ae(e,t)}(this,e),this.blockTestDistance=e.blockTestDistance,this.blockTargetIdCheck=this.registry.getBlockSolidity,this.targetedBlock=null,e.skipDefaultHighlighting||(this.defaultBlockHighlightFunction=function(e){e?t.rendering.highlightBlockFace(!0,e.position,e.normal):t.rendering.highlightBlockFace(!1)},this.on("targetBlockChanged",this.defaultBlockHighlightFunction)),e.debug&&(window.noa=this,window.scene=this.rendering._scene,window.ndarray=rt,window.vec3=nt,o.getMovement(1).airJumps=999,this.setViewDistance=function(e){var t=this.world.chunkSize;this.world.chunkAddDistance=e/t,this.world.chunkRemoveDistance=e/t+1,this.world._lastPlayerChunkID=""}),c="0.27",(u=(e,t,n)=>{var r=()=>{throw`This property changed in ${c} - ${n}`};Object.defineProperty(e,t,{get:r,set:r})})(a=this,"getPlayerEyePosition","to get the camera/player offset see API docs for `noa.camera.cameraTarget`"),u(a,"setPlayerEyePosition","to set the camera/player offset see API docs for `noa.camera.cameraTarget`"),u(a,"getPlayerPosition","use `noa.ents.getPosition(noa.playerEntity)` or similar"),u(a,"getCameraVector","use `noa.camera.getDirection`"),u(a,"getPlayerMesh","use `noa.ents.getMeshData(noa.playerEntity).mesh` or similar"),u(a,"playerBody","use `noa.ents.getPhysicsBody(noa.playerEntity)`"),u(a.rendering,"zoomDistance","use `noa.camera.zoomDistance`"),u(a.rendering,"_currentZoom","use `noa.camera.currentZoom`"),u(a.rendering,"_cameraZoomSpeed","use `noa.camera.zoomSpeed`"),u(a.rendering,"getCameraVector","use `noa.camera.getDirection`"),u(a.rendering,"getCameraPosition","use `noa.camera.getLocalPosition`"),u(a.rendering,"getCameraRotation","use `noa.camera.heading` and `noa.camera.pitch`"),u(a.rendering,"setCameraRotation","to customize camera behavior see API docs for `noa.camera`"),c="0.28",u(a.rendering,"makeMeshInstance","removed, use Babylon's `mesh.createInstance`"),u(a.world,"_maxChunksPendingCreation",'use `maxChunksPendingCreation` (no "_")'),u(a.world,"_maxChunksPendingMeshing",'use `maxChunksPendingMeshing` (no "_")'),u(a.world,"_maxProcessingPerTick",'use `maxProcessingPerTick` (no "_")'),u(a.world,"_maxProcessingPerRender",'use `maxProcessingPerRender` (no "_")'),c="0.29",u(a,"_constants","removed, voxel IDs are no longer packed with bit flags")}at.prototype=Object.create(it.prototype),at.prototype.tick=function(){if(this._paused)this.world.worldGenWhilePaused&&this.world.tick(e);else{dt("start"),function(e){var t=e.ents.getPositionData(e.playerEntity)._localPosition,n=e._originRebaseDistance;if(nt.sqrLen(t)<n*n)return;for(var r=[],o=0;o<3;o++){var i=Math.floor(t[o]);r[o]=i,e.worldOriginOffset[o]+=i}e.rendering._rebaseOrigin(r),e.entities._rebaseOrigin(r)}(this);var e=this._tickRate;this.world.tick(e),dt("world"),this.physics.tick(e),dt("physics"),this.rendering.tick(e),dt("rendering"),function(e){var t="",n=e.blockTargetIdCheck||e.registry.getBlockSolidity,r=e._localPick(null,null,null,n);if(r){var o=lt;nt.floor(o.adjacent,r.position),nt.copy(o.normal,r.normal),nt.sub(o.position,o.adjacent,o.normal),o.blockID=e.world.getBlockID(o.position[0],o.position[1],o.position[2]),e.targetedBlock=o,t=o.position.join("|")+o.normal.join("|")+"|"+o.blockID}else e.targetedBlock=null;t!=ft&&(e.emit("targetBlockChanged",e.targetedBlock),ft=t)}(this),dt("targets"),this.entities.tick(e),dt("entities"),this.emit("tick",e),dt("tick event"),dt("end");var t=this.inputs.state;t.scrollx=t.scrolly=t.scrollz=0}},at.prototype.render=function(e){this.positionInCurrentTick=e;var t=performance.now(),n=t-(this._lastRenderTime||t-16);this._lastRenderTime=t,this._paused?this.world.worldGenWhilePaused&&this.world.render():(pt("start"),(this.container.hasPointerLock||!this.container.supportsPointerLock||this._dragOutsideLock&&this.inputs.state.fire)&&this.camera.applyInputsToCamera(),pt("init"),this.world.render(n),pt("meshing"),this.camera.updateBeforeEntityRenderSystems(),this.entities.render(n),this.camera.updateAfterEntityRenderSystems(),pt("entities"),this.emit("beforeRender",n),pt("before render"),this.rendering.render(n),pt("render"),this.emit("afterRender",n),pt("after render"),pt("end"),this.inputs.state.dx=this.inputs.state.dy=0)},at.prototype.globalToLocal=function(e,t,n){var r=this.worldOriginOffset;if(t){for(var o=0;o<3;o++){var i=e[o]-r[o];i+=t[o],n[o]=i}return n}return nt.sub(n,e,r)},at.prototype.localToGlobal=function(e,t,n){var r=this.worldOriginOffset;if(n){for(var o=0;o<3;o++){var i=Math.floor(e[o]);t[o]=i+r[o],n[o]=e[o]-i}return t}return nt.add(t,e,r)},at.prototype.setPaused=function(e){this._paused=!!e,e||(this.inputs.state.dx=this.inputs.state.dy=0)},at.prototype.getBlock=function(e,t,n){return e.length?this.world.getBlockID(e[0],e[1],e[2]):this.world.getBlockID(e,t,n)},at.prototype.setBlock=function(e,t,n,r){return t.length?this.world.setBlockID(e,t[0],t[1],t[2]):this.world.setBlockID(e,t,n,r)},at.prototype.addBlock=function(e,t,n,r){if(t.length){if(this.entities.isTerrainBlocked(t[0],t[1],t[2]))return;return this.world.setBlockID(e,t[0],t[1],t[2]),e}if(!this.entities.isTerrainBlocked(t,n,r))return this.world.setBlockID(e,t,n,r),e},at.prototype.pick=function(e,t,n,r){return 0===n?null:(e&&(this.globalToLocal(e,null,ct),e=ct),this._localPick(e,t,n,r))};var ct=nt.create();at.prototype._localPick=function(e,t,n,r){if(0===n)return null;var o=r||this.registry.getBlockSolidity,i=this.world,s=this.worldOriginOffset;e||(e=this.camera._localGetTargetPosition()),t=t||this.camera.getDirection(),n=n||this.blockTestDistance;var a=ut._localPosition,c=ut.normal;return ot((function(e,t,n){var r=i.getBlockID(e+s[0],t+s[1],n+s[2]);return o(r)}),e,t,n,a,c)?(nt.scaleAndAdd(a,a,c,.01),this.localToGlobal(a,ut.position),ut):null};var ut={_localPosition:nt.create(),position:[0,0,0],normal:[0,0,0]};var lt={blockID:0,position:[],normal:[],adjacent:[]},ft="";var dt=()=>{},pt=()=>{}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(25),o=n(52),i=n(94),s=n(6);function a(){const e=function(e,t,n,o){const a=Object(s.d)(1),c=new r.f;c.width=e*s.f+"px",c.height=t*s.f+"px",c.zIndex=1e3,c.thickness=0,c.verticalAlignment=0,c.horizontalAlignment=0,c.background="#EEEEEEDB";let u=!1,l=[],f=[c.leftInPixels,c.topInPixels];const d=new r.f;if(d.width=e*s.f+"px",d.height=12*s.f+"px",d.thickness=0,d.background="#2b2b2bed",d.verticalAlignment=0,o){d.onPointerDownObservable.add(e=>{u=!0,l=[e.x,e.y],f=[c.leftInPixels,c.topInPixels]}),d.onPointerUpObservable.add(()=>{u=!1});const e=a.onPointerMoveObservable.add(e=>{u&&(console.log(),c.left=-(l[0]-e.x)+f[0],c.top=-(l[1]-e.y)+f[1])});c.onDisposeObservable.add(()=>{a.onPointerMoveObservable.remove(e)})}c.addControl(d);const p=new i.a;p.fontSize=6.5*s.f+"px",p.text="string"==typeof n?[{text:n,color:"white"}]:n,d.addControl(p);const h=new r.c;h.width=7*s.f+"px",h.height=7*s.f+"px",h.left=-2*s.f+"px",h.thickness=0,h.isPointerBlocker=!0,h.zIndex=200,h.background="#DD4444AE",h.verticalAlignment=2,h.horizontalAlignment=1,h.onPointerClickObservable.add(()=>{c.dispose()}),d.addControl(h);const m=new r.f;return m.top=12*s.f+"px",m.width=e*s.f+"px",m.height=(t-12)*s.f+"px",m.thickness=0,m.verticalAlignment=0,c.addControl(m),{main:m,bar:d,text:p,window:c}}(200,100,"Warning!",!1),t=new r.j;t.text="Warning. Firefox might have performance issues. For the best performance, you should use Chromium(-based) browser.\n\t\t\t\tI know you aren't too happy about it, but I can't do much about it.",t.textWrapping=1,t.fontSize=20,t.color="#111111",t.textVerticalAlignment=0,e.main.paddingTop=10,e.main.paddingRight=10,e.main.paddingLeft=10,e.main.paddingBottom=10,e.main.addControl(t);const n=Object(o.d)();n.item.verticalAlignment=1,n.text.text=[{text:"Okay, let me play",color:"#222222"}],n.item.onPointerClickObservable.add(()=>e.window.dispose()),e.main.addControl(n.item),console.log("Firefox detected! Displaying warning!"),e.window.isVisible=!0,e.window.verticalAlignment=2,e.window.horizontalAlignment=2,Object(s.d)(1).addControl(e.window)}},,,function(e,t,n){"use strict";n.r(t),function(e){var t=n(74),r=n(276),o=n(220),i=n(222),s=n(35),a=n(6),c=n(115),u=n(223),l=n(173),f=n(137),d=n(61),p=n(272),h=n(273),m=n(277),y=n(131),v=n(95),g=n(236),b=n(376);Object(g.a)(new b.a(e)).then(e=>{window.inflate=e}),s.a.forEach(e=>document.fonts.load(`10pt "${e}"`)),Object(u.a)().then(e=>Object(s.k)(e));const w=new r.a(Object(s.g)());w.ents.createComponent({name:"inventory",state:{items:{},selected:0,tempslot:{},armor:{},crafting:{}}}),Object(s.i)(w),w.ents.getPhysics(w.playerEntity).body.airDrag=9999,w.world.maxChunksPendingCreation=1/0,Object(a.a)(w),Object(l.b)(w),Object(i.b)(w),Object(o.a)(w),Object(h.a)(w),w.world.on("worldDataNeeded",async(e,t)=>{const n=e.split("|");e=`${n[0]}|${n[1]}|${n[2]}`,Object(y.d)(e).then(t=>w.world.setChunkData(`${e}|${n[3]}`,t)).catch(()=>{w.world._chunkIDsPending.remove(e)})}),y.c.on("loadany",(e,t)=>{w.world.setChunkData(e,new v(t.data,t.shape))});let _=0;w.on("beforeRender",async()=>{s.h.ingame||(_++,w.camera.heading=_/2e3,w.camera.pitch=0)}),window.onerror=function(e,t,n,r,o){alert(e+"\nPlease report this error at: https://github.com/VoxelSrv/voxelsrv/issues")},window.connect=e=>{Object(d.a)(w,new c.a(e))},window.peer=e=>{Object(d.a)(w,new c.b(e))},window.forceplay=()=>{Object(s.j)({ingame:!0})},setTimeout(()=>{if(t.isMobile){Object(p.a)(w);const e=document.createElement("link");e.rel="stylesheet",e.href="mobile.css",document.head.appendChild(e),document.documentElement.addEventListener("click",(function(){document.fullscreenElement||(document.documentElement.requestFullscreen(),screen.orientation.lock("landscape"))}))}t.isFirefox&&Object(m.a)();const e=new URLSearchParams(window.location.search);if(e.get("server")){const t=new c.a("ws://"+e.get("server"));Object(d.a)(w,t)}else if(e.get("peer")){const t=new c.b(e.get("peer"));Object(d.a)(w,t)}else setTimeout(()=>{Object(f.a)(w)},50);null!=window.electron&&window.electron.on("world-started",(e,t)=>{Object(d.a)(w,new c.a("ws://localhost:"+t))})},1e3)}.call(this,n(281))},function(e,t,n){e.exports=n.p+"0.bundle.worker.js"},function(e,t){e.exports=function(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}},function(e,t,n){e.exports=function(e,t){var n=r(e[0],e[1],e[2]),s=r(t[0],t[1],t[2]);o(n,n),o(s,s);var a=i(n,s);return a>1?0:Math.acos(a)};var r=n(245),o=n(246),i=n(247)},function(e,t){e.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}},function(e,t){e.exports=function(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}},function(e,t,n){e.exports=function(e,t){var n=e[0],o=e[1],i=e[2],s=t[0],a=t[1],c=t[2];return Math.abs(n-s)<=r*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(o-a)<=r*Math.max(1,Math.abs(o),Math.abs(a))&&Math.abs(i-c)<=r*Math.max(1,Math.abs(i),Math.abs(c))};var r=n(243)},function(e,t){e.exports=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}},function(e,t,n){e.exports=n(248)},function(e,t,n){e.exports=n(249)},function(e,t,n){e.exports=n(250)},function(e,t){e.exports=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}},function(e,t){e.exports=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}},function(e,t){e.exports=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}},function(e,t){e.exports=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}},function(e,t){e.exports=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}},function(e,t){e.exports=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}},function(e,t,n){e.exports=n(251)},function(e,t,n){e.exports=n(252)},function(e,t,n){e.exports=n(253)},function(e,t,n){e.exports=n(254)},function(e,t){e.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}},function(e,t){e.exports=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}},function(e,t){e.exports=function(e,t,n){var r=t[0],o=t[1],i=t[2],s=n[0],a=n[1],c=n[2];return e[0]=o*c-i*a,e[1]=i*s-r*c,e[2]=r*a-o*s,e}},function(e,t){e.exports=function(e,t,n,r){var o=t[0],i=t[1],s=t[2];return e[0]=o+r*(n[0]-o),e[1]=i+r*(n[1]-i),e[2]=s+r*(n[2]-s),e}},function(e,t){e.exports=function(e,t){t=t||1;var n=2*Math.random()*Math.PI,r=2*Math.random()-1,o=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*o,e[1]=Math.sin(n)*o,e[2]=r*t,e}},function(e,t){e.exports=function(e,t,n){var r=t[0],o=t[1],i=t[2],s=n[3]*r+n[7]*o+n[11]*i+n[15];return s=s||1,e[0]=(n[0]*r+n[4]*o+n[8]*i+n[12])/s,e[1]=(n[1]*r+n[5]*o+n[9]*i+n[13])/s,e[2]=(n[2]*r+n[6]*o+n[10]*i+n[14])/s,e}},function(e,t){e.exports=function(e,t,n){var r=t[0],o=t[1],i=t[2];return e[0]=r*n[0]+o*n[3]+i*n[6],e[1]=r*n[1]+o*n[4]+i*n[7],e[2]=r*n[2]+o*n[5]+i*n[8],e}},function(e,t){e.exports=function(e,t,n){var r=t[0],o=t[1],i=t[2],s=n[0],a=n[1],c=n[2],u=n[3],l=u*r+a*i-c*o,f=u*o+c*r-s*i,d=u*i+s*o-a*r,p=-s*r-a*o-c*i;return e[0]=l*u+p*-s+f*-c-d*-a,e[1]=f*u+p*-a+d*-s-l*-c,e[2]=d*u+p*-c+l*-a-f*-s,e}},function(e,t){e.exports=function(e,t,n,r){var o=n[1],i=n[2],s=t[1]-o,a=t[2]-i,c=Math.sin(r),u=Math.cos(r);return e[0]=t[0],e[1]=o+s*u-a*c,e[2]=i+s*c+a*u,e}},function(e,t){e.exports=function(e,t,n,r){var o=n[0],i=n[2],s=t[0]-o,a=t[2]-i,c=Math.sin(r),u=Math.cos(r);return e[0]=o+a*c+s*u,e[1]=t[1],e[2]=i+a*u-s*c,e}},function(e,t){e.exports=function(e,t,n,r){var o=n[0],i=n[1],s=t[0]-o,a=t[1]-i,c=Math.sin(r),u=Math.cos(r);return e[0]=o+s*u-a*c,e[1]=i+s*c+a*u,e[2]=t[2],e}},function(e,t,n){e.exports=function(e,t,n,o,i,s){var a,c;t||(t=3);n||(n=0);c=o?Math.min(o*t+n,e.length):e.length;for(a=n;a<c;a+=t)r[0]=e[a],r[1]=e[a+1],r[2]=e[a+2],i(r,r,s),e[a]=r[0],e[a+1]=r[1],e[a+2]=r[2];return e};var r=n(244)()},function(e,t){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(n(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,o,i){var s=+t[0],a=+t[1],c=+t[2],u=+n[0],l=+n[1],f=+n[2],d=Math.sqrt(u*u+l*l+f*f);if(0===d)throw new Error("Can't raycast along a zero vector");return function(e,t,n,r,o,i,s,a,c,u){for(var l=0,f=Math.floor,d=0|f(t),p=0|f(n),h=0|f(r),m=o>0?1:-1,y=i>0?1:-1,v=s>0?1:-1,g=Math.abs(1/o),b=Math.abs(1/i),w=Math.abs(1/s),_=g<1/0?g*(m>0?d+1-t:t-d):1/0,x=b<1/0?b*(y>0?p+1-n:n-p):1/0,k=w<1/0?w*(v>0?h+1-r:r-h):1/0,O=-1;l<=a;){var P=e(d,p,h);if(P)return c&&(c[0]=t+l*o,c[1]=n+l*i,c[2]=r+l*s),u&&(u[0]=u[1]=u[2]=0,0===O&&(u[0]=-m),1===O&&(u[1]=-y),2===O&&(u[2]=-v)),P;_<x?_<k?(d+=m,l=_,_+=g,O=0):(h+=v,l=k,k+=w,O=2):x<k?(p+=y,l=x,x+=b,O=1):(h+=v,l=k,k+=w,O=2)}return c&&(c[0]=t+l*o,c[1]=n+l*i,c[2]=r+l*s),u&&(u[0]=u[1]=u[2]=0),0}(e,s,a,c,u/=d,l/=d,f/=d,r=void 0===r?64:+r,o,i)}},function(e,t,n){"use strict";var r=n(119).EventEmitter,o=n(318),i=n(321),s=n(322),a=n(323),c=n(324),u=n(325),l=n(255),f=Math.min;n(326);var d=n(327),p=n(328),h=function(){var e,t,n=new Array(256);for(e=0;e<256;++e)n[e]="UNK";for(e in s)"<"===(t=s[e]).charAt(0)&&">"===t.charAt(t.length-1)&&(t=t.substring(1,t.length-1)),t=t.replace(/\s/g,"-"),n[parseInt(e)]=t;return n}(),m=c(Object.keys(a(h)));function y(e){return u.eq(m,e)}function v(e){return y(h[e])}function g(){r.call(this),this._curKeyState=new Array(m.length),this._pressCount=new Array(m.length),this._releaseCount=new Array(m.length),this._tickInterval=null,this._rafHandle=null,this._tickRate=0,this._lastTick=p(),this._frameTime=0,this._paused=!0,this._width=0,this._height=0,this._wantFullscreen=!1,this._wantPointerLock=!1,this._fullscreenActive=!1,this._pointerLockActive=!1,this._rafFunction=S.bind(void 0,this,!0),this.preventDefaults=!0,this.stopPropagation=!1;for(var e=0;e<m.length;++e)this._curKeyState[e]=!1,this._pressCount[e]=this._releaseCount[e]=0;this.element=null,this.bindings={},this.frameSkip=100,this.tickCount=0,this.frameCount=0,this.startTime=p(),this.tickTime=this._tickRate,this.frameTime=10,this.stickyFullscreen=!1,this.stickyPointerLock=!1,this.scroll=[0,0,0],this.mouseX=0,this.mouseY=0,this.prevMouseX=0,this.prevMouseY=0}o.inherits(g,r);var b=g.prototype;function w(e,t,n){if(n in t){for(var r=t[n],o=0,i=0,s=r.length;i<s;++i)o+=e[y(r[i])];return o}var a=y(n);return a>=0?e[a]:0}function _(e){var t=e.element;e._wantFullscreen&&!e._fullscreenActive&&(t.requestFullscreen||t.requestFullScreen||t.webkitRequestFullscreen||t.webkitRequestFullScreen||t.mozRequestFullscreen||t.mozRequestFullScreen||function(){}).call(t);e._wantPointerLock&&!e._pointerLockActive&&(t.requestPointerLock||t.webkitRequestPointerLock||t.mozRequestPointerLock||t.msRequestPointerLock||t.oRequestPointerLock||function(){}).call(t)}b.keyNames=m,b.bind=function(e){var t,n;t=e in this.bindings?this.bindings[e]:[];for(var r=1,o=arguments.length;r<o;++r)if(y(n=arguments[r])>=0)t.push(n);else if(n in this.bindings)for(var i=this.bindings[n],s=0;s<i.length;++s)t.push(i[s]);(t=c(t)).length>0&&(this.bindings[e]=t),this.emit("bind",e,t)},b.unbind=function(e){e in this.bindings&&delete this.bindings[e],this.emit("unbind",e)},b.down=function(e){return function(e,t,n){if(n in t){for(var r=t[n],o=0,i=r.length;o<i;++o)if(e[y(r[o])])return!0;return!1}var s=y(n);return s>=0&&e[s]}(this._curKeyState,this.bindings,e)},b.wasDown=function(e){return this.down(e)||!!this.press(e)},b.up=function(e){return!this.down(e)},b.wasUp=function(e){return this.up(e)||!!this.release(e)},b.press=function(e){return w(this._pressCount,this.bindings,e)},b.release=function(e){return w(this._releaseCount,this.bindings,e)},Object.defineProperty(b,"paused",{get:function(){return this._paused},set:function(e){!!e!==this._paused&&(this._paused?(this._paused=!1,this._lastTick=p()-Math.floor(this._frameTime*this._tickRate),this._tickInterval=setInterval(S,this._tickRate,this,!1),this._rafHandle=requestAnimationFrame(this._rafFunction)):(this._paused=!0,this._frameTime=f(1,(p()-this._lastTick)/this._tickRate),clearInterval(this._tickInterval)))}});var x=document.exitFullscreen||document.cancelFullscreen||document.cancelFullScreen||document.webkitCancelFullscreen||document.webkitCancelFullScreen||document.mozCancelFullscreen||document.mozCancelFullScreen||function(){};function k(e){e._fullscreenActive=document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||!1,!e.stickyFullscreen&&e._fullscreenActive&&(e._wantFullscreen=!1)}Object.defineProperty(b,"fullscreen",{get:function(){return this._fullscreenActive},set:function(e){!e?(this._wantFullscreen=!1,(document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||!1)&&x.call(document)):(this._wantFullscreen=!0,_(this));return this._fullscreenActive}});var O=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock||function(){};function P(e,t){e._pointerLockActive=e.element===(document.pointerLockElement||document.mozPointerLockElement||document.webkitPointerLockElement||null),!e.stickyPointerLock&&e._pointerLockActive&&(e._wantPointerLock=!1)}function C(e,t,n){e._curKeyState[t]!==n&&(n?e._pressCount[t]++:e._releaseCount[t]++,e._curKeyState[t]=n)}function S(e,t){!function(e){var t,n,r,o=p()+e.frameSkip,i=e._pressCount,s=e._releaseCount,a=e._tickRate,c=m.length;for(;!e._paused&&p()>=e._lastTick+a;){if(p()>o)return void(e._lastTick=p()+a);for(n=p(),e.emit("tick"),r=p(),e.tickTime=r-n,++e.tickCount,e._lastTick+=a,t=0;t<c;++t)i[t]=s[t]=0;e._pointerLockActive?(e.prevMouseX=e.mouseX=e.width>>1,e.prevMouseY=e.mouseY=e.height>>1):(e.prevMouseX=e.mouseX,e.prevMouseY=e.mouseY),e.scroll[0]=e.scroll[1]=e.scroll[2]=0}}(e),t&&function(e){var t;e._rafHandle=requestAnimationFrame(e._rafFunction),t=e._paused?e._frameTime:f(1,(p()-e._lastTick)/e._tickRate);++e.frameCount;var n=p();e.emit("render",t);var r=p();e.frameTime=r-n}(e)}function T(e,t){e.preventDefaults&&t.preventDefault(),e.stopPropagation&&t.stopPropagation()}function E(e,t){T(e,t);var n=v(t.keyCode||t.char||t.which||t.charCode);n>=0&&C(e,n,!1)}function j(e,t){if(function(e){return document.activeElement===document.body||document.activeElement===e.element}(e))if(T(e,t),t.metaKey)F(e,t);else{var n=v(t.keyCode||t.char||t.which||t.charCode);n>=0&&C(e,n,!0)}}Object.defineProperty(b,"pointerLock",{get:function(){return this._pointerLockActive},set:function(e){return!!e?(this._wantPointerLock=!0,_(this)):(this._wantPointerLock=!1,O.call(document)),this._pointerLockActive}}),Object.defineProperty(b,"width",{get:function(){return this.element.clientWidth}}),Object.defineProperty(b,"height",{get:function(){return this.element.clientHeight}});var M=l(32).map((function(e){return y("mouse-"+(e+1))}));function D(e,t){if(T(e,t),e._pointerLockActive){var n=t.movementX||t.mozMovementX||t.webkitMovementX||0,r=t.movementY||t.mozMovementY||t.webkitMovementY||0;e.mouseX+=n,e.mouseY+=r}else e.mouseX=t.clientX-e.element.offsetLeft,e.mouseY=t.clientY-e.element.offsetTop;return!1}function A(e,t){return T(e,t),C(e,M[t.button],!0),!1}function I(e,t){return T(e,t),C(e,M[t.button],!1),!1}function R(e,t){return T(e,t),e._pointerLockActive?(e.prevMouseX=e.mouseX=e.width>>1,e.prevMouseY=e.mouseY=e.height>>1):(e.prevMouseX=e.mouseX=t.clientX-e.element.offsetLeft,e.prevMouseY=e.mouseY=t.clientY-e.element.offsetTop),!1}function B(e,t){return T(e,t),function(e,t){for(var n=0;n<32;++n)C(e,M[n],!!(t&1<<n))}(e,0),!1}function L(e,t){T(e,t);var n=1;switch(t.deltaMode){case 0:n=1;break;case 1:n=12;break;case 2:n=e.height}return e.scroll[0]+=t.deltaX*n,e.scroll[1]+=t.deltaY*n,e.scroll[2]+=t.deltaZ*n||0,!1}function z(e,t){return T(e,t),!1}function F(e,t){var n,r=m.length,o=e._curKeyState,i=e._releaseCount;for(n=0;n<r;++n)o[n]&&++i[n],o[n]=!1;return!1}function N(e,t){var n=0|e.element.clientWidth,r=0|e.element.clientHeight;n===e._width&&r===e._height||(e._width=n,e._height=r,e.emit("resize",n,r))}function U(){var e=document.createElement("div");return e.tabindex=1,e.style.position="absolute",e.style.left="0px",e.style.right="0px",e.style.top="0px",e.style.bottom="0px",e.style.height="100%",e.style.overflow="hidden",document.body.appendChild(e),document.body.style.overflow="hidden",document.body.style.height="100%",e}e.exports=function(e){var t=!!(e=e||{}).fullscreen,n=t;void 0!==typeof e.pointerLock&&(n=!!e.pointerLock);var r=new g;return r._tickRate=e.tickRate||30,r.frameSkip=e.frameSkip||5*(r._tickRate+5),r.stickyFullscreen=!!e.stickyFullscreen||!!e.sticky,r.stickyPointerLock=!!e.stickyPointerLock||!!e.sticky,e.bindings&&(r.bindings=e.bindings),setTimeout((function(){i((function(){var o=e.element;if("string"==typeof o){var i=document.querySelector(o);i||(i=document.getElementById(o)),i||(i=document.getElementByClass(o)[0]),i||(i=U()),r.element=i}else r.element="object"==typeof o&&o?o:"function"==typeof o?o():U();r.element.style&&(r.element.style["-webkit-touch-callout"]="none",r.element.style["-webkit-user-select"]="none",r.element.style["-khtml-user-select"]="none",r.element.style["-moz-user-select"]="none",r.element.style["-ms-user-select"]="none",r.element.style["user-select"]="none"),r._width=r.element.clientWidth,r._height=r.element.clientHeight;var s=N.bind(void 0,r);"undefined"!=typeof MutationObserver?new MutationObserver(s).observe(r.element,{attributes:!0,subtree:!0}):r.element.addEventListener("DOMSubtreeModified",s,!1);window.addEventListener("resize",s,!1),window.addEventListener("keydown",j.bind(void 0,r),!1),window.addEventListener("keyup",E.bind(void 0,r),!1),r.element.oncontextmenu=z.bind(void 0,r),r.element.addEventListener("mousedown",A.bind(void 0,r),!1),r.element.addEventListener("mouseup",I.bind(void 0,r),!1),r.element.addEventListener("mousemove",D.bind(void 0,r),!1),r.element.addEventListener("mouseenter",R.bind(void 0,r),!1);var a=B.bind(void 0,r);r.element.addEventListener("mouseleave",a,!1),r.element.addEventListener("mouseout",a,!1),window.addEventListener("mouseleave",a,!1),window.addEventListener("mouseout",a,!1);var c=F.bind(void 0,r);r.element.addEventListener("blur",c,!1),r.element.addEventListener("focusout",c,!1),r.element.addEventListener("focus",c,!1),window.addEventListener("blur",c,!1),window.addEventListener("focusout",c,!1),window.addEventListener("focus",c,!1),d(r.element,L.bind(void 0,r),!1);var u=k.bind(void 0,r);document.addEventListener("fullscreenchange",u,!1),document.addEventListener("mozfullscreenchange",u,!1),document.addEventListener("webkitfullscreenchange",u,!1),r.element.addEventListener("click",_.bind(void 0,r),!1);var l=P.bind(void 0,r);document.addEventListener("pointerlockchange",l,!1),document.addEventListener("mozpointerlockchange",l,!1),document.addEventListener("webkitpointerlockchange",l,!1),document.addEventListener("pointerlocklost",l,!1),document.addEventListener("webkitpointerlocklost",l,!1),document.addEventListener("mozpointerlocklost",l,!1),r.fullscreen=t,r.pointerLock=n,r.bind("mouse-left","mouse-1"),r.bind("mouse-right","mouse-3"),r.bind("mouse-middle","mouse-2"),r._lastTick=p(),r.startTime=p(),r.paused=!1,r.emit("init")}))}),0),r}},function(e,t,n){(function(e){var r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},o=/%[sdj%]/g;t.format=function(e){if(!v(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(a(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,i=r.length,s=String(e).replace(o,(function(e){if("%%"===e)return"%";if(n>=i)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),c=r[n];n<i;c=r[++n])m(c)||!w(c)?s+=" "+c:s+=" "+a(c);return s},t.deprecate=function(n,r){if(void 0!==e&&!0===e.noDeprecation)return n;if(void 0===e)return function(){return t.deprecate(n,r).apply(this,arguments)};var o=!1;return function(){if(!o){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),o=!0}return n.apply(this,arguments)}};var i,s={};function a(e,n){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),h(n)?r.showHidden=n:n&&t._extend(r,n),g(r.showHidden)&&(r.showHidden=!1),g(r.depth)&&(r.depth=2),g(r.colors)&&(r.colors=!1),g(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),l(r,e,r.depth)}function c(e,t){var n=a.styles[t];return n?"["+a.colors[n][0]+"m"+e+"["+a.colors[n][1]+"m":e}function u(e,t){return e}function l(e,n,r){if(e.customInspect&&n&&k(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,e);return v(o)||(o=l(e,o,r)),o}var i=function(e,t){if(g(t))return e.stylize("undefined","undefined");if(v(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(y(t))return e.stylize(""+t,"number");if(h(t))return e.stylize(""+t,"boolean");if(m(t))return e.stylize("null","null")}(e,n);if(i)return i;var s=Object.keys(n),a=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(n)),x(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return f(n);if(0===s.length){if(k(n)){var c=n.name?": "+n.name:"";return e.stylize("[Function"+c+"]","special")}if(b(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(_(n))return e.stylize(Date.prototype.toString.call(n),"date");if(x(n))return f(n)}var u,w="",O=!1,P=["{","}"];(p(n)&&(O=!0,P=["[","]"]),k(n))&&(w=" [Function"+(n.name?": "+n.name:"")+"]");return b(n)&&(w=" "+RegExp.prototype.toString.call(n)),_(n)&&(w=" "+Date.prototype.toUTCString.call(n)),x(n)&&(w=" "+f(n)),0!==s.length||O&&0!=n.length?r<0?b(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),u=O?function(e,t,n,r,o){for(var i=[],s=0,a=t.length;s<a;++s)T(t,String(s))?i.push(d(e,t,n,r,String(s),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(d(e,t,n,r,o,!0))})),i}(e,n,r,a,s):s.map((function(t){return d(e,n,r,a,t,O)})),e.seen.pop(),function(e,t,n){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(u,w,P)):P[0]+w+P[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,n,r,o,i){var s,a,c;if((c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),T(r,o)||(s="["+o+"]"),a||(e.seen.indexOf(c.value)<0?(a=m(n)?l(e,c.value,null):l(e,c.value,n-1)).indexOf("\n")>-1&&(a=i?a.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),g(s)){if(i&&o.match(/^\d+$/))return a;(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function p(e){return Array.isArray(e)}function h(e){return"boolean"==typeof e}function m(e){return null===e}function y(e){return"number"==typeof e}function v(e){return"string"==typeof e}function g(e){return void 0===e}function b(e){return w(e)&&"[object RegExp]"===O(e)}function w(e){return"object"==typeof e&&null!==e}function _(e){return w(e)&&"[object Date]"===O(e)}function x(e){return w(e)&&("[object Error]"===O(e)||e instanceof Error)}function k(e){return"function"==typeof e}function O(e){return Object.prototype.toString.call(e)}function P(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(n){if(g(i)&&(i=e.env.NODE_DEBUG||""),n=n.toUpperCase(),!s[n])if(new RegExp("\\b"+n+"\\b","i").test(i)){var r=e.pid;s[n]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",n,r,e)}}else s[n]=function(){};return s[n]},t.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=p,t.isBoolean=h,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=y,t.isString=v,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=g,t.isRegExp=b,t.isObject=w,t.isDate=_,t.isError=x,t.isFunction=k,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(319);var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function S(){var e=new Date,t=[P(e.getHours()),P(e.getMinutes()),P(e.getSeconds())].join(":");return[e.getDate(),C[e.getMonth()],t].join(" ")}function T(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",S(),t.format.apply(t,arguments))},t.inherits=n(320),t._extend=function(e,t){if(!t||!w(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var E="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function j(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(E&&e[E]){var t;if("function"!=typeof(t=e[E]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,E,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,r=new Promise((function(e,r){t=e,n=r})),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push((function(e,r){e?n(e):t(r)}));try{e.apply(this,o)}catch(e){n(e)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),E&&Object.defineProperty(t,E,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},t.promisify.custom=E,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var o=n.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var i=this,s=function(){return o.apply(i,arguments)};t.apply(this,n).then((function(t){e.nextTick(s,null,t)}),(function(t){e.nextTick(j,t,s)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.defineProperties(n,r(t)),n}}).call(this,n(224))},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){var r,o,i,s,a;e.exports=(o=[],i=document,s=i.documentElement.doScroll,(a=(s?/^loaded|^c/:/^loaded|^i|^c/).test(i.readyState))||i.addEventListener("DOMContentLoaded",r=function(){for(i.removeEventListener("DOMContentLoaded",r),a=1;r=o.shift();)r()}),function(e){a?setTimeout(e,0):o.push(e)})},function(e,t){var n,r="undefined"!=typeof window?window.navigator.userAgent:"",o=/OS X/.test(r),i=/Opera/.test(r),s=!/like Gecko/.test(r)&&!i,a=e.exports={0:o?"<menu>":"<UNK>",1:"<mouse 1>",2:"<mouse 2>",3:"<break>",4:"<mouse 3>",5:"<mouse 4>",6:"<mouse 5>",8:"<backspace>",9:"<tab>",12:"<clear>",13:"<enter>",16:"<shift>",17:"<control>",18:"<alt>",19:"<pause>",20:"<caps-lock>",21:"<ime-hangul>",23:"<ime-junja>",24:"<ime-final>",25:"<ime-kanji>",27:"<escape>",28:"<ime-convert>",29:"<ime-nonconvert>",30:"<ime-accept>",31:"<ime-mode-change>",27:"<escape>",32:"<space>",33:"<page-up>",34:"<page-down>",35:"<end>",36:"<home>",37:"<left>",38:"<up>",39:"<right>",40:"<down>",41:"<select>",42:"<print>",43:"<execute>",44:"<snapshot>",45:"<insert>",46:"<delete>",47:"<help>",91:"<meta>",92:"<meta>",93:o?"<meta>":"<menu>",95:"<sleep>",106:"<num-*>",107:"<num-+>",108:"<num-enter>",109:"<num--\x3e",110:"<num-.>",111:"<num-/>",144:"<num-lock>",145:"<scroll-lock>",160:"<shift-left>",161:"<shift-right>",162:"<control-left>",163:"<control-right>",164:"<alt-left>",165:"<alt-right>",166:"<browser-back>",167:"<browser-forward>",168:"<browser-refresh>",169:"<browser-stop>",170:"<browser-search>",171:"<browser-favorites>",172:"<browser-home>",173:o&&s?"-":"<volume-mute>",174:"<volume-down>",175:"<volume-up>",176:"<next-track>",177:"<prev-track>",178:"<stop>",179:"<play-pause>",180:"<launch-mail>",181:"<launch-media-select>",182:"<launch-app 1>",183:"<launch-app 2>",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"<meta>",224:"<meta>",226:"<alt-gr>",229:"<ime-process>",231:i?"`":"<unicode>",246:"<attention>",247:"<crsel>",248:"<exsel>",249:"<erase-eof>",250:"<play>",251:"<zoom>",252:"<no-name>",253:"<pa-1>",254:"<clear>"};for(n=58;n<65;++n)a[n]=String.fromCharCode(n);for(n=48;n<58;++n)a[n]=n-48+"";for(n=65;n<91;++n)a[n]=String.fromCharCode(n);for(n=96;n<106;++n)a[n]="<num-"+(n-96)+">";for(n=112;n<136;++n)a[n]="F"+(n-111)},function(e,t,n){"use strict";e.exports=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}},function(e,t,n){"use strict";e.exports=function(e,t,n){return 0===e.length?e:t?(n||e.sort(t),function(e,t){for(var n=1,r=e.length,o=e[0],i=e[0],s=1;s<r;++s)if(i=o,t(o=e[s],i)){if(s===n){n++;continue}e[n++]=o}return e.length=n,e}(e,t)):(n||e.sort(),function(e){for(var t=1,n=e.length,r=e[0],o=e[0],i=1;i<n;++i,o=r)if(o=r,(r=e[i])!==o){if(i===t){t++;continue}e[t++]=r}return e.length=t,e}(e))}},function(e,t,n){"use strict";function r(e,t,n,r,o,i){var s=["function ",e,"(a,l,h,",r.join(","),"){",i?"":"var i=",n?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",o?".get(m)":"[m]"];return i?t.indexOf("c")<0?s.push(";if(x===y){return m}else if(x<=y){"):s.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):s.push(";if(",t,"){i=m;"),n?s.push("l=m+1}else{h=m-1}"):s.push("h=m-1}else{l=m+1}"),s.push("}"),i?s.push("return -1};"):s.push("return i};"),s.join("")}function o(e,t,n,o){return new Function([r("A","x"+e+"y",t,["y"],!1,o),r("B","x"+e+"y",t,["y"],!0,o),r("P","c(x,y)"+e+"0",t,["y","c"],!1,o),r("Q","c(x,y)"+e+"0",t,["y","c"],!0,o),"function dispatchBsearch",n,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",n].join(""))()}e.exports={ge:o(">=",!1,"GE"),gt:o(">",!1,"GT"),lt:o("<",!0,"LT"),le:o("<=",!0,"LE"),eq:o("-",!0,"EQ",!0)}},function(e,t){for(var n=0,r=["ms","moz","webkit","o"],o=0;o<r.length&&!window.requestAnimationFrame;++o)window.requestAnimationFrame=window[r[o]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[r[o]+"CancelAnimationFrame"]||window[r[o]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,t){var r=(new Date).getTime(),o=Math.max(0,16-(r-n)),i=window.setTimeout((function(){e(r+o)}),o);return n=r+o,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})},function(e,t){var n,r,o="";function i(e,t,i,s){e[n](o+t,"wheel"==r?i:function(e){!e&&(e=window.event);var t={originalEvent:e,target:e.target||e.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==e.type?0:1,deltaX:0,delatZ:0,preventDefault:function(){e.preventDefault?e.preventDefault():e.returnValue=!1}};return"mousewheel"==r?(t.deltaY=-1/40*e.wheelDelta,e.wheelDeltaX&&(t.deltaX=-1/40*e.wheelDeltaX)):t.deltaY=e.detail,i(t)},s||!1)}window.addEventListener?n="addEventListener":(n="attachEvent",o="on"),r="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",e.exports=function(e,t,n){i(e,r,t,n),"DOMMouseScroll"==r&&i(e,"MozMousePixelScroll",t,n)}},function(e,t){"object"==typeof window.performance?window.performance.now?e.exports=function(){return window.performance.now()}:window.performance.webkitNow&&(e.exports=function(){return window.performance.webkitNow()}):Date.now?e.exports=Date.now:e.exports=function(){return(new Date).getTime()}},function(e,t,n){var r=n(330),o=n(119).EventEmitter,i=n(331);function s(e,t){this.element=e||document,t=t||{},this.preventDefaults=!!t.preventDefaults,this.stopPropagation=!!t.stopPropagation,this.allowContextMenu=!!t.allowContextMenu,this.disabled=!!t.disabled,this.down=new o,this.up=new o,this.state={dx:0,dy:0,scrollx:0,scrolly:0,scrollz:0},this._keybindmap={},this._keyStates={},this._bindPressCounts={},this._ignoreMousemoveOnce=!1,this.initEvents()}function a(e,t,n){v(n.keyCode,r[n.keyCode],t,e,n)}function c(e,t,n){return v(-1-n.button,"<mouse "+(n.button+1)+">",t,e,n),!1}function u(e){if(!e.allowContextMenu)return!1}function l(e,t){if(e._ignoreMousemoveOnce)e._ignoreMousemoveOnce=!1;else{var n=t.movementX||t.mozMovementX||0,r=t.movementY||t.mozMovementY||0;if(t.touches&&0==(n|r)){var o=function(e){for(var t,n=e.changedTouches,r=0;r<n.length;++r)n[r].identifier==p&&(t=n[r]);if(!t)return[0,0];var o=[t.clientX-f,t.clientY-d];return f=t.clientX,d=t.clientY,o}(t);n=o[0],r=o[1]}e.state.dx+=n,e.state.dy+=r}}e.exports=function(e,t){return new s(e,t)},s.prototype.initEvents=function(){window.addEventListener("keydown",a.bind(void 0,this,!0),!1),window.addEventListener("keyup",a.bind(void 0,this,!1),!1),this.element.addEventListener("mousedown",c.bind(void 0,this,!0),!1),this.element.addEventListener("mouseup",c.bind(void 0,this,!1),!1),this.element.oncontextmenu=u.bind(void 0,this),this.element.addEventListener("dragstart",c.bind(void 0,this,!1),!1),this.element.addEventListener("mousemove",l.bind(void 0,this),!1),this.element.addEventListener("touchmove",l.bind(void 0,this),!1),this.element.addEventListener("touchstart",h.bind(void 0,this),!1),i(this.element,m.bind(void 0,this),!1),document.addEventListener("pointerlockchange",y.bind(void 0,this),!1),document.addEventListener("mozpointerlockchange",y.bind(void 0,this),!1)},s.prototype.bind=function(e){for(var t=1;t<arguments.length;++t){var n=arguments[t],r=this._keybindmap[n]||[];-1==r.indexOf(e)&&r.push(e),this._keybindmap[n]=r}this.state[e]=!!this.state[e]},s.prototype.unbind=function(e){for(var t in this._keybindmap){var n=this._keybindmap[t],r=n.indexOf(e);r>-1&&n.splice(r,1)}},s.prototype.tick=function(){this.state.dx=this.state.dy=0,this.state.scrollx=this.state.scrolly=this.state.scrollz=0},s.prototype.getBoundKeys=function(){var e=[];for(var t in this._keybindmap)e.push(t);return e};var f=0,d=0,p=null;function h(e,t){var n=t.changedTouches[0];f=n.clientX,d=n.clientY,p=n.identifier}function m(e,t){var n=1;switch(t.deltaMode){case 0:n=1;break;case 1:n=12;break;case 2:n=e.element.clientHeight||window.innerHeight}return e.state.scrollx+=t.deltaX*n,e.state.scrolly+=t.deltaY*n,e.state.scrollz+=t.deltaZ*n||0,!1}function y(e,t){(document.pointerLockElement||document.mozPointerLockElement||null)&&(e._ignoreMousemoveOnce=!0)}function v(e,t,n,r,o){var i=r._keybindmap[t];if(i){if(r.preventDefaults&&o.preventDefault(),r.stopPropagation&&o.stopPropagation(),b(r._keyStates[e],n))for(var s=0;s<i.length;++s)g(i[s],n,r,o);r._keyStates[e]=n}}function g(e,t,n,r){var o=n._bindPressCounts[e]||0;if((o+=t?1:-1)<0&&(o=0),n._bindPressCounts[e]=o,b(n.state[e],o)){var i=t?n.down:n.up;n.disabled||i.emit(e,r)}n.state[e]=!!o}function b(e,t){return e?!t:t}},function(e,t,n){"use strict";var r,o="undefined"!=typeof window?window.navigator.userAgent:"",i=/OS X/.test(o),s=/Opera/.test(o),a=!/like Gecko/.test(o)&&!s,c=e.exports={0:i?"<menu>":"<UNK>",1:"<mouse 1>",2:"<mouse 2>",3:"<break>",4:"<mouse 3>",5:"<mouse 4>",6:"<mouse 5>",8:"<backspace>",9:"<tab>",12:"<clear>",13:"<enter>",16:"<shift>",17:"<control>",18:"<alt>",19:"<pause>",20:"<caps-lock>",21:"<ime-hangul>",23:"<ime-junja>",24:"<ime-final>",25:"<ime-kanji>",27:"<escape>",28:"<ime-convert>",29:"<ime-nonconvert>",30:"<ime-accept>",31:"<ime-mode-change>",32:"<space>",33:"<page-up>",34:"<page-down>",35:"<end>",36:"<home>",37:"<left>",38:"<up>",39:"<right>",40:"<down>",41:"<select>",42:"<print>",43:"<execute>",44:"<snapshot>",45:"<insert>",46:"<delete>",47:"<help>",91:"<meta>",92:"<meta>",93:i?"<meta>":"<menu>",95:"<sleep>",106:"<num-*>",107:"<num-+>",108:"<num-enter>",109:"<num--\x3e",110:"<num-.>",111:"<num-/>",144:"<num-lock>",145:"<scroll-lock>",160:"<shift-left>",161:"<shift-right>",162:"<control-left>",163:"<control-right>",164:"<alt-left>",165:"<alt-right>",166:"<browser-back>",167:"<browser-forward>",168:"<browser-refresh>",169:"<browser-stop>",170:"<browser-search>",171:"<browser-favorites>",172:"<browser-home>",173:i&&a?"-":"<volume-mute>",174:"<volume-down>",175:"<volume-up>",176:"<next-track>",177:"<prev-track>",178:"<stop>",179:"<play-pause>",180:"<launch-mail>",181:"<launch-media-select>",182:"<launch-app 1>",183:"<launch-app 2>",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"<meta>",224:"<meta>",226:"<alt-gr>",229:"<ime-process>",231:s?"`":"<unicode>",246:"<attention>",247:"<crsel>",248:"<exsel>",249:"<erase-eof>",250:"<play>",251:"<zoom>",252:"<no-name>",253:"<pa-1>",254:"<clear>"};for(r=58;r<65;++r)c[r]=String.fromCharCode(r);for(r=48;r<58;++r)c[r]=r-48+"";for(r=65;r<91;++r)c[r]=String.fromCharCode(r);for(r=96;r<106;++r)c[r]="<num-"+(r-96)+">";for(r=112;r<136;++r)c[r]="F"+(r-111)},function(e,t){var n,r,o="";function i(e,t,i,s){e[n](o+t,"wheel"==r?i:function(e){!e&&(e=window.event);var t={originalEvent:e,target:e.target||e.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==e.type?0:1,deltaX:0,delatZ:0,preventDefault:function(){e.preventDefault?e.preventDefault():e.returnValue=!1}};return"mousewheel"==r?(t.deltaY=-1/40*e.wheelDelta,e.wheelDeltaX&&(t.deltaX=-1/40*e.wheelDeltaX)):t.deltaY=e.detail,i(t)},s||!1)}window.addEventListener?n="addEventListener":(n="attachEvent",o="on"),r="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",e.exports=function(e,t,n){i(e,r,t,n),"DOMMouseScroll"==r&&i(e,"MozMousePixelScroll",t,n)}},function(e,t,n){"use strict";var r=n(231),o=n(78),i=n(264),s=n(333);e.exports=function(e,t,n){return new c(e,t,n)};var a={gravity:[0,-10,0],minBounceImpulse:.5,airDrag:.1,fluidDrag:.4,fluidDensity:2};function c(e,t,n){e=Object.assign({},a,e),this.gravity=e.gravity,this.airDrag=e.airDrag,this.fluidDensity=e.fluidDensity,this.fluidDrag=e.fluidDrag,this.minBounceImpulse=e.minBounceImpulse,this.bodies=[],this.testSolid=t,this.testFluid=n}c.prototype.addBody=function(e,t,n,o,i,a){e=e||new r([0,0,0],[1,1,1]),void 0===t&&(t=1),void 0===n&&(n=1),void 0===o&&(o=0),void 0===i&&(i=1);var c=new s(e,t,n,o,i,a);return this.bodies.push(c),c},c.prototype.removeBody=function(e){var t=this.bodies.indexOf(e);t<0||(this.bodies.splice(t,1),e.aabb=e.onCollide=null)};var u=o.create(),l=o.create(),f=o.create(),d=o.create(),p=o.create();c.prototype.tick=function(e){e/=1e3;var t=O(0,o.squaredLength(this.gravity));this.bodies.forEach(n=>function(e,t,n,r){if(o.copy(p,t.resting),t.mass<=0)return o.set(t.velocity,0,0,0),o.set(t._forces,0,0,0),void o.set(t._impulses,0,0,0);var s=r||0===t.gravityMultiplier;if(function(e,t,n,r){if(t._sleepFrameCount>0)return!1;if(r)return!0;var s=!1,a=.5*n*n*t.gravityMultiplier;return o.scale(k,e.gravity,a),i(e.testSolid,t.aabb,k,(function(){return s=!0,!0}),!0),s}(e,t,n,s))return;t._sleepFrameCount--,function(e,t){var n=t.aabb,r=Math.floor(n.base[0]),i=Math.floor(n.base[2]),s=Math.floor(n.base[1]),a=Math.floor(n.max[1]);if(!e.testFluid(r,s,i))return t.inFluid=!1,void(t.ratioInFluid=0);var c=1,u=s+1;for(;u<=a&&e.testFluid(r,u,i);)c++,u++;var l=(s+c-n.base[1])/n.vec[1];l>1&&(l=1);var f=n.vec[0]*n.vec[1]*n.vec[2]*l,d=h;o.scale(d,e.gravity,-e.fluidDensity*f),t.applyForce(d),t.inFluid=!0,t.ratioInFluid=l}(e,t),C(t._forces),C(t._impulses),C(t.velocity),C(t.resting),o.scale(u,t._forces,1/t.mass),o.scaleAndAdd(u,u,e.gravity,t.gravityMultiplier),o.scale(l,t._impulses,1/t.mass),o.scaleAndAdd(l,l,u,n),o.add(t.velocity,t.velocity,l),t.friction&&(m(0,t,l),m(1,t,l),m(2,t,l));var a=t.airDrag>=0?t.airDrag:e.airDrag;t.inFluid&&(a=t.fluidDrag>=0?t.fluidDrag:e.fluidDrag,a*=1-(1-t.ratioInFluid)**2);var c=Math.max(1-a*n/t.mass,0);o.scale(t.velocity,t.velocity,c),o.scale(f,t.velocity,n),o.set(t._forces,0,0,0),o.set(t._impulses,0,0,0),t.autoStep&&P(g,t.aabb);v(e,t.aabb,f,t.resting),t.autoStep&&function(e,t,n,r){if(t.resting[1]>=0&&!t.inFluid)return;var s=0!==t.resting[0],a=0!==t.resting[2];if(!s&&!a)return;var c=Math.abs(r[0]/r[2]);if(!s&&c>4)return;if(!a&&c<1/4)return;o.add(w,n.base,r);var u=e.testSolid;i(u,n,r,(function(e,t,n,r){if(1!==t)return!0;r[t]=0}));var l=t.aabb.base[1],f=Math.floor(l+1.001)-l;o.set(_,0,f,0);var d=!1;if(i(u,n,_,(function(e,t,n,r){return d=!0,!0})),d)return;if(o.subtract(x,w,n.base),x[1]=0,v(e,n,x,b),s&&!O(n.base[0],w[0]))return;if(a&&!O(n.base[2],w[2]))return;P(t.aabb,n),t.resting[0]=b[0],t.resting[2]=b[2],t.onStep&&t.onStep()}(e,t,g,f);for(var y=0;y<3;++y)d[y]=0,t.resting[y]&&(p[y]||(d[y]=-t.velocity[y]),t.velocity[y]=0);var S=o.length(d);S>.001&&(o.scale(d,d,t.mass),t.onCollide&&t.onCollide(d),t.restitution>0&&S>e.minBounceImpulse&&(o.scale(d,d,t.restitution),t.applyImpulse(d)));o.squaredLength(t.velocity)>1e-5&&t._markActive()}(this,n,e,t))};var h=o.create();function m(e,t,n){var r=t.resting[e],i=n[e];if(0!==r&&!(r*i<=0)){o.copy(y,t.velocity),y[e]=0;var s=o.length(y);if(!O(s,0)){var a=Math.abs(t.friction*i),c=s>a?(s-a)/s:0;t.velocity[(e+1)%3]*=c,t.velocity[(e+2)%3]*=c}}}var y=o.create();function v(e,t,n,r){return o.set(r,0,0,0),i(e.testSolid,t,n,(function(e,t,n,o){r[t]=n,o[t]=0}))}var g=new r([],[]),b=o.create(),w=o.create(),_=o.create(),x=o.create();var k=o.create();function O(e,t){return Math.abs(e-t)<1e-5}function P(e,t){for(var n=0;n<3;n++)e.base[n]=t.base[n],e.max[n]=t.max[n],e.vec[n]=t.vec[n]}var C=function(){}},function(e,t,n){"use strict";var r=n(231),o=n(78);function i(e,t,n,i,s,a,c){this.aabb=new r(e.base,e.vec),this.mass=t,this.friction=n,this.restitution=i,this.gravityMultiplier=s,this.onCollide=a,this.autoStep=!!c,this.airDrag=-1,this.fluidDrag=-1,this.onStep=null,this.velocity=o.create(),this.resting=[0,0,0],this.inFluid=!1,this._ratioInFluid=0,this._forces=o.create(),this._impulses=o.create(),this._sleepFrameCount=10}e.exports=i,i.prototype.setPosition=function(e){s(e),o.subtract(e,e,this.aabb.base),this.aabb.translate(e),this._markActive()},i.prototype.getPosition=function(){return o.clone(this.aabb.base)},i.prototype.applyForce=function(e){s(e),o.add(this._forces,this._forces,e),this._markActive()},i.prototype.applyImpulse=function(e){s(e),o.add(this._impulses,this._impulses,e),this._markActive()},i.prototype._markActive=function(){this._sleepFrameCount=10},i.prototype.atRestX=function(){return this.resting[0]},i.prototype.atRestY=function(){return this.resting[1]},i.prototype.atRestZ=function(){return this.resting[2]};var s=function(){}},function(e,t,n){"use strict";e.exports=
/*!
 * ent-comp: a light, *fast* Entity Component System in JS
 * @url      github.com/andyhall/ent-comp
 * @author   Andy Hall <andy@fenomas.com>
 * @license  MIT
*/
function e(){var t=this;this.components={},this.comps=this.components;var n=this.components,o=1,i={},s=[],a=[],c=[],u=[],l=[];function f(e){Object.keys(i).forEach(t=>{i[t].hash[e]&&d(e,t)})}function d(e,t){var o=n[t],s=i[t];s&&s.hash[e]&&(o.onRemove&&(o.multi?s.hash[e].forEach(t=>{o.onRemove(e,t)}):o.onRemove(e,s.hash[e])),o.multi&&(s.hash[e].length=0),r.remove(s,e))}function p(e,t,r){var o=n[t],s=i[t].hash[e];if(s){var a=s.indexOf(r);a<0||(o.onRemove&&o.onRemove(e,r),s.splice(a,1),0===s.length&&d(e,t))}}function h(){m||(m=!0,setTimeout((function(){m=!1,y()}),1))}this._storage=i,this._systems=s,this._renderSystems=a,this.createEntity=function(e){var n=o++;return e&&e.length&&e.forEach(e=>t.addComponent(n,e)),n},this.deleteEntity=function(e,n){return n?f(e):(c.push(e),h()),t},this.createComponent=function(e){if(!e)throw"Missing component definition";var t=e.name;if(!t)throw"Component definition must have a name property.";if("string"!=typeof t)throw"Component name must be a string.";if(""===t)throw"Component name must be a non-empty string.";if(i[t])throw`Component ${t} already exists.`;var o={};return o.name=t,o.order=isNaN(e.order)?99:e.order,o.state=e.state||{},o.onAdd=e.onAdd||null,o.onRemove=e.onRemove||null,o.system=e.system||null,o.renderSystem=e.renderSystem||null,o.multi=!!e.multi,n[t]=o,i[t]=r.create(),o.system&&(s.push(t),s.sort((e,t)=>n[e].order-n[t].order)),o.renderSystem&&(a.push(t),a.sort((e,t)=>n[e].order-n[t].order)),t},this.deleteComponent=function(e){var r=i[e];if(!r)throw"Unknown component: "+e;r.list.forEach(n=>{var r=n.__id||n[0].__id;t.removeComponent(r,e,!0)});var o=s.indexOf(e),c=a.indexOf(e);return o>-1&&s.splice(o,1),c>-1&&a.splice(c,1),delete n[e],delete i[e],t},this.addComponent=function(e,t,o){var s=n[t],a=i[t];if(!a)throw`Unknown component: ${t}.`;var c=!1;if(u.forEach(n=>{n.id===e&&n.compName===t&&(c=!0)}),c&&v(),a.hash[e]&&!s.multi)throw`Entity ${e} already has component: ${t}.`;var l=Object.assign({},{__id:e},s.state,o);if(l.__id=e,s.multi){var f=a.hash[e];f||(f=[],r.add(a,e,f)),f.push(l)}else r.add(a,e,l);return s.onAdd&&s.onAdd(e,l),this},this.hasComponent=function(e,t){var n=i[t];if(!n)throw`Unknown component: ${t}.`;return void 0!==n.hash[e]},this.removeComponent=function(e,r,o){var s=n[r],a=i[r];if(!a)throw`Unknown component: ${r}.`;if(!a.hash[e]){if(s.multi)return t;throw`Entity ${e} does not have component: ${r} to remove.`}return o?d(e,r):(u.push({id:e,compName:r}),h()),t},this.getState=function(e,t){var n=i[t];if(!n)throw`Unknown component: ${t}.`;return n.hash[e]},e.prototype.getStatesList=function(e){var t=i[e];if(!t)throw`Unknown component: ${e}.`;return t.list},this.getStateAccessor=function(e){if(!i[e])throw`Unknown component: ${e}.`;var t=i[e].hash;return function(e){return t[e]}},this.getComponentAccessor=function(e){if(!i[e])throw`Unknown component: ${e}.`;var t=i[e].hash;return function(e){return void 0!==t[e]}},this.tick=function(e){return y(),s.forEach(t=>{var r=i[t].list;n[t].system(e,r)}),y(),t},this.render=function(e){return y(),a.forEach(t=>{var r=i[t].list;n[t].renderSystem(e,r)}),y(),t},this.removeMultiComponent=function(e,r,o,s){var a=n[r],c=i[r];if(!c)throw`Unknown component: ${r}.`;if(!a.multi)throw"removeMultiComponent called on non-multi component";var u=c.hash[e];if(!u||!u[o])throw`Multicomponent ${r} instance not found at index ${o}`;var f=u[o];return s?p(e,r,f):l.push({id:e,compName:r,state:f}),t};var m=!1;function y(){v(),function(e){for(;l.length;){var t=l.pop();p(t.id,t.compName,t.state),t.state=null}}(),function(){for(;c.length;){f(c.pop())}}()}function v(){for(;u.length;){var e=u.pop();d(e.id,e.compName)}}};var r=n(335)},function(e,t,n){"use strict";e.exports={create:function(){return{list:[],hash:{},_map:{}}},add:function(e,t,n){e.list.push(n),e.hash[t]=n,e._map[t]=e.list.length-1},remove:function(e,t){var n=e._map[t];if(n===e.list.length-1)e.list.pop();else{var r=e.list.pop();e.list[n]=r;var o=r.__id||r[0].__id;e._map[o]=n}delete e.hash[t],delete e._map[t]}}},function(e,t,n){var r={"./collideEntities.js":337,"./collideTerrain.js":348,"./fadeOnZoom.js":349,"./followsEntity.js":350,"./mesh.js":351,"./movement.js":352,"./physics.js":235,"./position.js":234,"./receivesInputs.js":353,"./shadow.js":354,"./smoothCamera.js":355};function o(e){var t=i(e);return n(t)}function i(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=i,e.exports=o,o.id=336},function(e,t,n){"use strict";n.r(t);var r=n(338);t.default=function(e){var t=[];return{name:"collideEntities",order:70,state:{cylinder:!1,collideBits:1,collideMask:1,callback:null},onAdd:null,onRemove:null,system:function(o,i){for(var s=e.ents,a=0;a<i.length;a++){var c=i[a].__id,u=s.getPositionData(c);t[a]=u._extents}t.length=i.length,r(t,(function(r,o){var s=i[r],a=i[o];(function(e,t,r,o){if(e.cylinder)return t.cylinder?function(e,t){var n=(e[3]-e[0])/2,r=(t[3]-t[0])/2,o=e[0]+n-(t[0]+r),i=e[2]+n-(t[2]+r),s=n+r;return o*o+i*i<=s*s}(r,o):n(r,o);if(t.cylinder)return n(o,r);return!0})(s,a,t[r],t[o])&&function(e,t,n){var r=t.__id,o=n.__id;t.collideMask&n.collideBits&&t.callback&&t.callback(o);n.collideMask&t.collideBits&&n.callback&&n.callback(r);e.ents.onPairwiseEntityCollision(r,o)}(e,s,a)}))}};function n(e,t){var n=(e[3]-e[0])/2,r=e[0]+n,i=e[2]+n,s=o(r,t[0],t[3])-r,a=o(i,t[2],t[5])-i;return s*s+a*a<=n*n}function o(e,t,n){return e<t?t:e>n?n:e}}},function(e,t,n){"use strict";e.exports=function(e,t,n){switch(arguments.length){case 1:return f(e);case 2:return"function"==typeof t?u(e,e,t,!0):d(e,t);case 3:return u(e,t,n,!1);default:throw new Error("box-intersect: Invalid arguments")}};var r,o=n(232),i=n(265),s=n(345);function a(e,t){for(var n=0;n<e;++n)if(!(t[n]<=t[n+e]))return!0;return!1}function c(e,t,n,r){for(var o=0,i=0,s=0,c=e.length;s<c;++s){var u=e[s];if(!a(t,u)){for(var l=0;l<2*t;++l)n[o++]=u[l];r[i++]=s}}return i}function u(e,t,n,r){var a=e.length,u=t.length;if(!(a<=0||u<=0)){var l=e[0].length>>>1;if(!(l<=0)){var f,d=o.mallocDouble(2*l*a),p=o.mallocInt32(a);if((a=c(e,l,d,p))>0){if(1===l&&r)i.init(a),f=i.sweepComplete(l,n,0,a,d,p,0,a,d,p);else{var h=o.mallocDouble(2*l*u),m=o.mallocInt32(u);(u=c(t,l,h,m))>0&&(i.init(a+u),f=1===l?i.sweepBipartite(l,n,0,a,d,p,0,u,h,m):s(l,n,r,a,d,p,u,h,m),o.free(h),o.free(m))}o.free(d),o.free(p)}return f}}}function l(e,t){r.push([e,t])}function f(e){return r=[],u(e,e,l,!0),r}function d(e,t){return r=[],u(e,t,l,!1),r}},function(e,t,n){"use strict";e.exports=function(e,t){switch(void 0===t&&(t=0),typeof e){case"number":if(e>0)return function(e,t){var n,r;for(n=new Array(e),r=0;r<e;++r)n[r]=t;return n}(0|e,t);break;case"object":if("number"==typeof e.length)return function e(t,n,r){var o=0|t[r];if(o<=0)return[];var i,s=new Array(o);if(r===t.length-1)for(i=0;i<o;++i)s[i]=n;else for(i=0;i<o;++i)s[i]=e(t,n,r+1);return s}(e,t,0)}return[]}},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n(341),o=n(342),i=n(343);function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return f(this,e)}return u(this,e,t,n)}function u(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=d(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|h(t,n),o=(e=a(e,r)).write(t,n);o!==r&&(e=e.slice(0,o));return e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|p(t.length);return 0===(e=a(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?a(e,0):d(e,t);if("Buffer"===t.type&&i(t.data))return d(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function f(e,t){if(l(t),e=a(e,t<0?0:0|p(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function d(e,t){var n=t.length<0?0:0|p(t.length);e=a(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function p(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function h(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return N(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return U(e).length;default:if(r)return N(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return E(this,t,n);case"utf8":case"utf-8":return C(this,t,n);case"ascii":return S(this,t,n);case"latin1":case"binary":return T(this,t,n);case"base64":return P(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return j(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function y(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:g(e,t,n,r,o);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):g(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function g(e,t,n,r,o){var i,s=1,a=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,n/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(o){var l=-1;for(i=n;i<a;i++)if(u(e,i)===u(t,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===c)return l*s}else-1!==l&&(i-=i-l),l=-1}else for(n+c>a&&(n=a-c),i=n;i>=0;i--){for(var f=!0,d=0;d<c;d++)if(u(e,i+d)!==u(t,d)){f=!1;break}if(f)return i}return-1}function b(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function w(e,t,n,r){return V(N(t,e.length-n),e,n,r)}function _(e,t,n,r){return V(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function x(e,t,n,r){return _(e,t,n,r)}function k(e,t,n,r){return V(U(t),e,n,r)}function O(e,t,n,r){return V(function(e,t){for(var n,r,o,i=[],s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(t,e.length-n),e,n,r)}function P(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function C(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i,s,a,c,u=e[o],l=null,f=u>239?4:u>223?3:u>191?2:1;if(o+f<=n)switch(f){case 1:u<128&&(l=u);break;case 2:128==(192&(i=e[o+1]))&&(c=(31&u)<<6|63&i)>127&&(l=c);break;case 3:i=e[o+1],s=e[o+2],128==(192&i)&&128==(192&s)&&(c=(15&u)<<12|(63&i)<<6|63&s)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:i=e[o+1],s=e[o+2],a=e[o+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&i)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(l=c)}null===l?(l=65533,f=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),o+=f}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return u(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,r){return l(t),t<=0?a(e,t):void 0!==n?"string"==typeof r?a(e,t).fill(n,r):a(e,t).fill(n):a(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return f(null,e)},c.allocUnsafeSlow=function(e){return f(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=c.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var s=e[n];if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,o),o+=s.length}return r},c.byteLength=h,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?C(this,0,e):m.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,r,o){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0),a=Math.min(i,s),u=this.slice(r,o),l=e.slice(t,n),f=0;f<a;++f)if(u[f]!==l[f]){i=u[f],s=l[f];break}return i<s?-1:s<i?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return w(this,e,t,n);case"ascii":return _(this,e,t,n);case"latin1":case"binary":return x(this,e,t,n);case"base64":return k(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function S(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function T(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function E(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=F(e[i]);return o}function j(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function M(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function D(e,t,n,r,o,i){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function A(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function I(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function R(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(e,t,n,r,i){return i||R(e,0,n,4),o.write(e,t,n,r,23,4),n+4}function L(e,t,n,r,i){return i||R(e,0,n,8),o.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var o=t-e;n=new c(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},c.prototype.readUInt8=function(e,t){return t||M(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||M(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||M(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||M(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||M(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},c.prototype.readInt8=function(e,t){return t||M(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||M(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||M(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||M(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||M(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||M(e,4,this.length),o.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||M(e,4,this.length),o.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||M(e,8,this.length),o.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||M(e,8,this.length),o.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||D(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||D(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):A(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):A(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):I(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):I(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);D(this,e,t,n,o-1,-o)}var i=0,s=1,a=0;for(this[t]=255&e;++i<n&&(s*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);D(this,e,t,n,o-1,-o)}var i=n-1,s=1,a=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):A(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):A(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):I(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):I(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return B(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return B(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return L(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return L(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,i=r-n;if(this===e&&n<t&&t<r)for(o=i-1;o>=0;--o)e[o+t]=this[o+n];else if(i<1e3||!c.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var s=c.isBuffer(e)?e:N(new c(e,r).toString()),a=s.length;for(i=0;i<n-t;++i)this[i+t]=s[i%a]}return this};var z=/[^+\/0-9A-Za-z-_]/g;function F(e){return e<16?"0"+e.toString(16):e.toString(16)}function N(e,t){var n;t=t||1/0;for(var r=e.length,o=null,i=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function U(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(z,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function V(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}}).call(this,n(168))},function(e,t,n){"use strict";t.byteLength=function(e){var t=u(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=u(e),s=r[0],a=r[1],c=new i(function(e,t,n){return 3*(t+n)/4-n}(0,s,a)),l=0,f=a>0?s-4:s;for(n=0;n<f;n+=4)t=o[e.charCodeAt(n)]<<18|o[e.charCodeAt(n+1)]<<12|o[e.charCodeAt(n+2)]<<6|o[e.charCodeAt(n+3)],c[l++]=t>>16&255,c[l++]=t>>8&255,c[l++]=255&t;2===a&&(t=o[e.charCodeAt(n)]<<2|o[e.charCodeAt(n+1)]>>4,c[l++]=255&t);1===a&&(t=o[e.charCodeAt(n)]<<10|o[e.charCodeAt(n+1)]<<4|o[e.charCodeAt(n+2)]>>2,c[l++]=t>>8&255,c[l++]=255&t);return c},t.fromByteArray=function(e){for(var t,n=e.length,o=n%3,i=[],s=0,a=n-o;s<a;s+=16383)i.push(l(e,s,s+16383>a?a:s+16383));1===o?(t=e[n-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===o&&(t=(e[n-2]<<8)+e[n-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return i.join("")};for(var r=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=s.length;a<c;++a)r[a]=s[a],o[s.charCodeAt(a)]=a;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var o,i,s=[],a=t;a<n;a+=3)o=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return s.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,o){var i,s,a=8*o-r-1,c=(1<<a)-1,u=c>>1,l=-7,f=n?o-1:0,d=n?-1:1,p=e[t+f];for(f+=d,i=p&(1<<-l)-1,p>>=-l,l+=a;l>0;i=256*i+e[t+f],f+=d,l-=8);for(s=i&(1<<-l)-1,i>>=-l,l+=r;l>0;s=256*s+e[t+f],f+=d,l-=8);if(0===i)i=1-u;else{if(i===c)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),i-=u}return(p?-1:1)*s*Math.pow(2,i-r)},t.write=function(e,t,n,r,o,i){var s,a,c,u=8*i-o-1,l=(1<<u)-1,f=l>>1,d=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,h=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+f>=1?d/c:d*Math.pow(2,1-f))*c>=2&&(s++,c/=2),s+f>=l?(a=0,s=l):s+f>=1?(a=(t*c-1)*Math.pow(2,o),s+=f):(a=t*Math.pow(2,f-1)*Math.pow(2,o),s=0));o>=8;e[n+p]=255&a,p+=h,a/=256,o-=8);for(s=s<<o|a,u+=o;u>0;e[n+p]=255&s,p+=h,s/=256,u-=8);e[n+p-h]|=128*m}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";e.exports=function(e,t){t<=128?r(0,t-1,e):function e(t,n,l){var f=(n-t+1)/6|0,d=t+f,p=n-f,h=t+n>>1,m=h-f,y=h+f,v=d,g=m,b=h,w=y,_=p,x=t+1,k=n-1,O=0;c(v,g,l)&&(O=v,v=g,g=O);c(w,_,l)&&(O=w,w=_,_=O);c(v,b,l)&&(O=v,v=b,b=O);c(g,b,l)&&(O=g,g=b,b=O);c(v,w,l)&&(O=v,v=w,w=O);c(b,w,l)&&(O=b,b=w,w=O);c(g,_,l)&&(O=g,g=_,_=O);c(g,b,l)&&(O=g,g=b,b=O);c(w,_,l)&&(O=w,w=_,_=O);for(var P=l[2*g],C=l[2*g+1],S=l[2*w],T=l[2*w+1],E=2*v,j=2*b,M=2*_,D=2*d,A=2*h,I=2*p,R=0;R<2;++R){var B=l[E+R],L=l[j+R],z=l[M+R];l[D+R]=B,l[A+R]=L,l[I+R]=z}i(m,t,l),i(y,n,l);for(var F=x;F<=k;++F)if(u(F,P,C,l))F!==x&&o(F,x,l),++x;else if(!u(F,S,T,l))for(;;){if(u(k,S,T,l)){u(k,P,C,l)?(s(F,x,k,l),++x,--k):(o(F,k,l),--k);break}if(--k<F)break}a(t,x-1,P,C,l),a(n,k+1,S,T,l),x-2-t<=32?r(t,x-2,l):e(t,x-2,l);n-(k+2)<=32?r(k+2,n,l):e(k+2,n,l);k-x<=32?r(x,k,l):e(x,k,l)}(0,t-1,e)};function r(e,t,n){for(var r=2*(e+1),o=e+1;o<=t;++o){for(var i=n[r++],s=n[r++],a=o,c=r-2;a-- >e;){var u=n[c-2],l=n[c-1];if(u<i)break;if(u===i&&l<s)break;n[c]=u,n[c+1]=l,c-=2}n[c]=i,n[c+1]=s}}function o(e,t,n){t*=2;var r=n[e*=2],o=n[e+1];n[e]=n[t],n[e+1]=n[t+1],n[t]=r,n[t+1]=o}function i(e,t,n){t*=2,n[e*=2]=n[t],n[e+1]=n[t+1]}function s(e,t,n,r){t*=2,n*=2;var o=r[e*=2],i=r[e+1];r[e]=r[t],r[e+1]=r[t+1],r[t]=r[n],r[t+1]=r[n+1],r[n]=o,r[n+1]=i}function a(e,t,n,r,o){t*=2,o[e*=2]=o[t],o[t]=n,o[e+1]=o[t+1],o[t+1]=r}function c(e,t,n){t*=2;var r=n[e*=2],o=n[t];return!(r<o)&&(r!==o||n[e+1]>n[t+1])}function u(e,t,n,r){var o=r[e*=2];return o<t||o===t&&r[e+1]<n}},function(e,t,n){"use strict";e.exports=function(e,t,n,i,l,x,k,O,P){!function(e,t){var n=8*o.log2(t+1)*(e+1)|0,i=o.nextPow2(6*n);v.length<i&&(r.free(v),v=r.mallocInt32(i));var s=o.nextPow2(2*n);g.length<s&&(r.free(g),g=r.mallocDouble(s))}(e,i+k);var C,S=0,T=2*e;b(S++,0,0,i,0,k,n?16:0,-1/0,1/0),n||b(S++,0,0,k,0,i,1,-1/0,1/0);for(;S>0;){var E=6*(S-=1),j=v[E],M=v[E+1],D=v[E+2],A=v[E+3],I=v[E+4],R=v[E+5],B=2*S,L=g[B],z=g[B+1],F=1&R,N=!!(16&R),U=l,V=x,W=O,G=P;if(F&&(U=O,V=P,W=l,G=x),!(2&R&&(D=p(e,j,M,D,U,V,z),M>=D)||4&R&&(M=h(e,j,M,D,U,V,L))>=D)){var q=D-M,K=I-A;if(N){if(e*q*(q+K)<1<<22){if(void 0!==(C=c.scanComplete(e,j,t,M,D,U,V,A,I,W,G)))return C;continue}}else{if(e*Math.min(q,K)<128){if(void 0!==(C=s(e,j,t,F,M,D,U,V,A,I,W,G)))return C;continue}if(e*q*K<1<<22){if(void 0!==(C=c.scanBipartite(e,j,t,F,M,D,U,V,A,I,W,G)))return C;continue}}var Y=f(e,j,M,D,U,V,L,z);if(M<Y)if(e*(Y-M)<128){if(void 0!==(C=a(e,j+1,t,M,Y,U,V,A,I,W,G)))return C}else if(j===e-2){if(void 0!==(C=F?c.sweepBipartite(e,t,A,I,W,G,M,Y,U,V):c.sweepBipartite(e,t,M,Y,U,V,A,I,W,G)))return C}else b(S++,j+1,M,Y,A,I,F,-1/0,1/0),b(S++,j+1,A,I,M,Y,1^F,-1/0,1/0);if(Y<D){var J=u(e,j,A,I,W,G),H=W[T*J+j],X=d(e,j,J,I,W,G,H);if(X<I&&b(S++,j,Y,D,X,I,(4|F)+(N?16:0),H,z),A<J&&b(S++,j,Y,D,A,J,(2|F)+(N?16:0),L,H),J+1===X){if(void 0!==(C=N?_(e,j,t,Y,D,U,V,J,W,G[J]):w(e,j,t,F,Y,D,U,V,J,W,G[J])))return C}else if(J<X){var $;if(N){if($=m(e,j,Y,D,U,V,H),Y<$){var Z=d(e,j,Y,$,U,V,H);if(j===e-2){if(Y<Z&&void 0!==(C=c.sweepComplete(e,t,Y,Z,U,V,J,X,W,G)))return C;if(Z<$&&void 0!==(C=c.sweepBipartite(e,t,Z,$,U,V,J,X,W,G)))return C}else Y<Z&&b(S++,j+1,Y,Z,J,X,16,-1/0,1/0),Z<$&&(b(S++,j+1,Z,$,J,X,0,-1/0,1/0),b(S++,j+1,J,X,Z,$,1,-1/0,1/0))}}else $=F?y(e,j,Y,D,U,V,H):m(e,j,Y,D,U,V,H),Y<$&&(j===e-2?C=F?c.sweepBipartite(e,t,J,X,W,G,Y,$,U,V):c.sweepBipartite(e,t,Y,$,U,V,J,X,W,G):(b(S++,j+1,Y,$,J,X,F,-1/0,1/0),b(S++,j+1,J,X,Y,$,1^F,-1/0,1/0)))}}}}};var r=n(232),o=n(233),i=n(346),s=i.partial,a=i.full,c=n(265),u=n(347),l=n(266),f=l("!(lo>=p0)&&!(p1>=hi)",["p0","p1"]),d=l("lo===p0",["p0"]),p=l("lo<p0",["p0"]),h=l("hi<=p0",["p0"]),m=l("lo<=p0&&p0<=hi",["p0"]),y=l("lo<p0&&p0<=hi",["p0"]),v=r.mallocInt32(1024),g=r.mallocDouble(1024);function b(e,t,n,r,o,i,s,a,c){var u=6*e;v[u]=t,v[u+1]=n,v[u+2]=r,v[u+3]=o,v[u+4]=i,v[u+5]=s;var l=2*e;g[l]=a,g[l+1]=c}function w(e,t,n,r,o,i,s,a,c,u,l){var f=2*e,d=c*f,p=u[d+t];e:for(var h=o,m=o*f;h<i;++h,m+=f){var y=s[m+t],v=s[m+t+e];if(!(p<y||v<p)&&(!r||p!==y)){for(var g,b=a[h],w=t+1;w<e;++w){y=s[m+w],v=s[m+w+e];var _=u[d+w],x=u[d+w+e];if(v<_||x<y)continue e}if(void 0!==(g=r?n(l,b):n(b,l)))return g}}}function _(e,t,n,r,o,i,s,a,c,u){var l=2*e,f=a*l,d=c[f+t];e:for(var p=r,h=r*l;p<o;++p,h+=l){var m=s[p];if(m!==u){var y=i[h+t],v=i[h+t+e];if(!(d<y||v<d)){for(var g=t+1;g<e;++g){y=i[h+g],v=i[h+g+e];var b=c[f+g],w=c[f+g+e];if(v<b||w<y)continue e}var _=n(m,u);if(void 0!==_)return _}}}}},function(e,t,n){"use strict";var r=["d","ax","vv","rs","re","rb","ri","bs","be","bb","bi"];function o(e){var t="bruteForce"+(e?"Full":"Partial"),n=[],o=r.slice();e||o.splice(3,0,"fp");var i=["function "+t+"("+o.join()+"){"];function s(t,o){var s=function(e,t,n){var o="bruteForce"+(e?"Red":"Blue")+(t?"Flip":"")+(n?"Full":""),i=["function ",o,"(",r.join(),"){","var ","es","=2*","d",";"],s="for(var i=rs,rp=es*rs;i<re;++i,rp+=es){var x0=rb[ax+rp],x1=rb[ax+rp+d],xi=ri[i];",a="for(var j=bs,bp=es*bs;j<be;++j,bp+=es){var y0=bb[ax+bp],"+(n?"y1=bb[ax+bp+d],":"")+"yi=bi[j];";return e?i.push(s,"Q",":",a):i.push(a,"Q",":",s),n?i.push("if(y1<x0||x1<y0)continue;"):t?i.push("if(y0<=x0||x1<y0)continue;"):i.push("if(y0<x0||x1<y0)continue;"),i.push("for(var k=ax+1;k<d;++k){var r0=rb[k+rp],r1=rb[k+d+rp],b0=bb[k+bp],b1=bb[k+d+bp];if(r1<b0||b1<r0)continue Q;}var rv=vv("),t?i.push("yi,xi"):i.push("xi,yi"),i.push(");if(rv!==void 0)return rv;}}}"),{name:o,code:i.join("")}}(t,o,e);n.push(s.code),i.push("return "+s.name+"("+r.join()+");")}i.push("if(re-rs>be-bs){"),e?(s(!0,!1),i.push("}else{"),s(!1,!1)):(i.push("if(fp){"),s(!0,!0),i.push("}else{"),s(!0,!1),i.push("}}else{if(fp){"),s(!1,!0),i.push("}else{"),s(!1,!1),i.push("}")),i.push("}}return "+t);var a=n.join("")+i.join("");return new Function(a)()}t.partial=o(!1),t.full=o(!0)},function(e,t,n){"use strict";e.exports=function(e,t,n,i,s,a){if(i<=n+1)return n;var c=n,u=i,l=i+n>>>1,f=2*e,d=l,p=s[f*l+t];for(;c<u;){if(u-c<8){o(e,t,c,u,s,a),p=s[f*l+t];break}var h=u-c,m=Math.random()*h+c|0,y=s[f*m+t],v=Math.random()*h+c|0,g=s[f*v+t],b=Math.random()*h+c|0,w=s[f*b+t];y<=g?w>=g?(d=v,p=g):y>=w?(d=m,p=y):(d=b,p=w):g>=w?(d=v,p=g):w>=y?(d=m,p=y):(d=b,p=w);for(var _=f*(u-1),x=f*d,k=0;k<f;++k,++_,++x){var O=s[_];s[_]=s[x],s[x]=O}var P=a[u-1];a[u-1]=a[d],a[d]=P,d=r(e,t,c,u-1,s,a,p);for(_=f*(u-1),x=f*d,k=0;k<f;++k,++_,++x){O=s[_];s[_]=s[x],s[x]=O}P=a[u-1];if(a[u-1]=a[d],a[d]=P,l<d){for(u=d-1;c<u&&s[f*(u-1)+t]===p;)u-=1;u+=1}else{if(!(d<l))break;for(c=d+1;c<u&&s[f*c+t]===p;)c+=1}}return r(e,t,n,l,s,a,s[f*l+t])};var r=n(266)("lo<p0",["p0"]);function o(e,t,n,r,o,i){for(var s=2*e,a=s*(n+1)+t,c=n+1;c<r;++c,a+=s)for(var u=o[a],l=c,f=s*(c-1);l>n&&o[f+t]>u;--l,f-=s){for(var d=f,p=f+s,h=0;h<s;++h,++d,++p){var m=o[d];o[d]=o[p],o[p]=m}var y=i[l];i[l]=i[l-1],i[l-1]=y}}},function(e,t,n){"use strict";n.r(t),t.default=function(e){return{name:"collideTerrain",order:0,state:{callback:null},onAdd:function(t,n){var r=e.entities;r.hasPhysics(t)&&(r.getPhysicsBody(t).onCollide=function(n){var r=e.ents.getCollideTerrain(t).callback;r&&r(n,t)})},onRemove:function(t,n){var r=e.entities;r.hasPhysics(t)&&(r.getPhysicsBody(t).onCollide=null)}}}},function(e,t,n){"use strict";n.r(t),t.default=function(e){return{name:"fadeOnZoom",order:99,state:{cutoff:1.5,_showing:!0},onAdd:null,onRemove:null,system:function(t,n){var r=e.camera.currentZoom,o=e.entities;n.forEach(e=>{!function(e,t,n,r){if(!r.hasMesh(t))return;if(e._showing&&n<e.cutoff||!e._showing&&n>e.cutoff){r.getMeshData(t).mesh.visibility=e._showing=n>e.cutoff}}(e,e.__id,r,o)})}}}},function(e,t,n){"use strict";n.r(t);var r=n(78);t.default=function(e){return{name:"followsEntity",order:50,state:{entity:0,offset:null,onTargetMissing:null},onAdd:function(e,o){var i=r.create();o.offset=o.offset?r.copy(i,o.offset):i,t(o),n(o)},onRemove:null,system:function(e,n){n.forEach(e=>t(e))},renderSystem:function(e,t){t.forEach(e=>n(e))}};function t(t){var n=t.__id,o=e.ents.getPositionData(n),i=e.ents.getPositionData(t.entity);i?r.add(o._localPosition,i._localPosition,t.offset):(t.onTargetMissing&&t.onTargetMissing(n),e.ents.removeComponent(n,e.ents.names.followsEntity))}function n(t){var n=t.__id,o=e.ents.getPositionData(n),i=e.ents.getPositionData(t.entity);i&&r.add(o._renderPosition,i._renderPosition,t.offset)}}},function(e,t,n){"use strict";n.r(t);var r=n(78);t.default=function(e){return{name:"mesh",order:100,state:{mesh:null,offset:null},onAdd:function(t,n){var o=e.ents.getPositionData(t);if(!n.mesh)throw new Error("Mesh component added without a mesh - probably a bug!");e.rendering.addMeshToScene(n.mesh,!1,o.position),n.offset||(n.offset=new r.create);var i=o._renderPosition;n.mesh.position.copyFromFloats(i[0]+n.offset[0],i[1]+n.offset[1],i[2]+n.offset[2])},onRemove:function(e,t){t.mesh.dispose()},renderSystem:function(t,n){n.forEach(t=>{var n=t.__id,r=e.ents.getPositionData(n)._renderPosition;t.mesh.position.copyFromFloats(r[0]+t.offset[0],r[1]+t.offset[1],r[2]+t.offset[2])})}}}},function(e,t,n){"use strict";n.r(t);var r=n(78);t.default=function(e){return{name:"movement",order:30,state:{heading:0,running:!1,jumping:!1,sprint:!1,crouch:!1,xMult:1,yMult:1,maxSpeed:10,moveForce:30,responsiveness:15,runningFriction:0,standingFriction:2,sprintMoveMult:1.2,crouchMoveMult:.8,airMoveMult:.5,jumpImpulse:10,jumpForce:12,jumpTime:500,airJumps:1,_jumpCount:0,_isJumping:0,_currjumptime:0},onAdd:null,onRemove:null,system:function(t,n){var a=e.entities;n.forEach(e=>{var n=a.getPhysicsBody(e.__id);!function(e,t,n){var a=n.atRestY()<0,c=a||t._jumpCount<t.airJumps;a&&(t._isJumping=!1,t._jumpCount=0);if(t.jumping)if(t._isJumping){if(t._currjumptime>0){var u=t.jumpForce;t._currjumptime<e&&(u*=t._currjumptime/e),n.applyForce([0,u,0]),t._currjumptime-=e}}else c&&(t._isJumping=!0,a||t._jumpCount++,t._currjumptime=t.jumpTime,n.applyImpulse([0,t.jumpImpulse,0]),!a&&n.velocity[1]<0&&(n.velocity[1]=0));else t._isJumping=!1;var l=o,f=i;if(t.running){var d=t.maxSpeed;t.sprint&&(d*=t.sprintMoveMult),t.crouch&&(d*=t.crouchMoveMult),r.set(l,0,0,d),r.rotateY(l,l,s,t.heading),r.subtract(f,l,n.velocity),f[1]=0;var p=r.length(f);if(r.normalize(f,f),p>0){var h=t.moveForce;a||(h*=t.airMoveMult);var m=t.responsiveness*p;h>m&&(h=m),r.scale(f,f,h),n.applyForce(f)}n.friction=t.runningFriction}else n.friction=t.standingFriction}(t,e,n)})}}};var o=r.create(),i=r.create(),s=r.create()},function(e,t,n){"use strict";n.r(t),t.default=function(e){return{name:"receivesInputs",order:20,state:{ignore:!1,x:1,y:1},onAdd:null,onRemove:null,system:function(t,n){var r=e.entities,o=e.inputs.state,i=e.camera.heading;n.forEach(e=>{!function(e,t,n,r,o,i){e.jumping=!r&&!!t.jump;e.xMulp=o,e.yMulp=i;var s=t.forward?t.backward?0:1:t.backward?-1:0,a=t.right?t.left?0:1:t.left?-1:0;0==(s|a)||r?e.running=!1:(e.running=!0,s?(-1==s&&(n+=Math.PI),a&&(n+=Math.PI/4*s*a)):n+=a*Math.PI/2,e.heading=n)}(r.getMovement(e.__id),o,i,e.ignore,e.x,e.y)})}}}},function(e,t,n){"use strict";n.r(t);var r=n(7),o=n(24),i=n(78);t.default=function(e,t){var n=t,c=e.rendering.getScene(),u=r.a.CreateDisc("shadow",.75,30,c);return u.rotation.x=Math.PI/2,u.material=e.rendering.makeStandardMaterial("shadowMat"),u.material.diffuseColor=o.e.Black(),u.material.ambientColor=o.e.Black(),u.material.alpha=.5,u.setEnabled(!1),c.removeMesh(u),{name:"shadow",order:80,state:{size:.5,_mesh:null},onAdd:function(t,n){var r=u.createInstance("shadow_instance");e.rendering.addMeshToScene(r),r.setEnabled(!1),n._mesh=r},onRemove:function(e,t){t._mesh.dispose()},system:function(t,r){var o=e.camera._localGetPosition(),c=n;r.forEach(t=>{var n=e.ents.getPositionData(t.__id),r=e.ents.getPhysics(t.__id);!function(e,t,n,r,o,c,u){var l;if(n&&n.body.resting[1]<0)l=t._localPosition[1];else{var f=e._localPick(t._localPosition,a,c);if(!f)return void r.setEnabled(!1);l=f.position[1]-e.worldOriginOffset[1]}l=Math.round(l),i.copy(s,t._localPosition),s[1]=l;var d=.01+i.squaredDistance(u,s)/1600*.1;d>.1&&(d=.1);r.position.y=l+d;var p=t._localPosition[1]-l,h=.7*o*(1-p/c);r.scaling.copyFromFloats(h,h,h),r.setEnabled(!0)}(e,n,r,t._mesh,t.size,c,o)})},renderSystem:function(t,n){n.forEach(t=>{var n=e.ents.getPositionData(t.__id)._renderPosition,r=t._mesh.position;r.x=n[0],r.z=n[2]})}}};var s=i.fromValues(0,0,0),a=i.fromValues(0,-1,0)},function(e,t,n){"use strict";n.r(t),t.default=function(e){return{name:"smooth-camera",order:99,state:{time:100.1},onAdd:null,onRemove:null,system:function(t,n){n.forEach(n=>{n.time-=t,n.time<0&&e.ents.removeComponent(n.__id,"smooth-camera")})}}}},function(e){e.exports=JSON.parse('{"_from":"github:VoxelSrv/noa-engine","_id":"noa-engine@0.29.0","_inBundle":false,"_integrity":"","_location":"/noa-engine","_phantomChildren":{},"_requested":{"type":"git","raw":"github:VoxelSrv/noa-engine","rawSpec":"github:VoxelSrv/noa-engine","saveSpec":"github:VoxelSrv/noa-engine","fetchSpec":null,"gitCommittish":null},"_requiredBy":["#USER","/"],"_resolved":"github:VoxelSrv/noa-engine#2f4ce00412288cd5eb080955be38da11f04d41c5","_spec":"github:VoxelSrv/noa-engine","_where":"/home/patbox/Pulpit/voxelsrv/client","author":{"name":"Andy Hall"},"bugs":{"url":"https://github.com/andyhall/noa/issues"},"bundleDependencies":false,"dependencies":{"@babylonjs/core":"^4.2.0-beta.3","aabb-3d":"github:andyhall/aabb-3d","box-intersect":"^1.0.2","ent-comp":"^0.9.1","fast-voxel-raycast":"^0.1.1","game-inputs":"^0.4.0","game-shell":"github:andyhall/game-shell","gl-vec3":"^1.1.3","ndarray":"^1.0.19","voxel-aabb-sweep":"^0.5.0","voxel-physics-engine":"^0.10.0"},"deprecated":false,"description":"Experimental voxel game engine","devDependencies":{"jsdoc-to-markdown":"^5.0.3","typescript":"^3.9.7"},"files":["/src","/types"],"homepage":"https://github.com/andyhall/noa#readme","keywords":["voxel","game","engine"],"license":"MIT","main":"src/index.js","name":"noa-engine","repository":{"type":"git","url":"git+https://github.com/andyhall/noa.git"},"scripts":{"doc":"jsdoc2md -f src/* src/**/* -g table -p list --partial doc-templates/* > doc/API.md"},"typings":"types/index.d.ts","version":"0.29.0"}')},function(e,t,n){"use strict";var r=t;function o(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=n(269),r.BufferWriter=n(366),r.Reader=n(270),r.BufferReader=n(367),r.util=n(146),r.rpc=n(368),r.roots=n(370),r.configure=o,o()},function(e,t,n){"use strict";e.exports=function(e,t){var n=new Array(arguments.length-1),r=0,o=2,i=!0;for(;o<arguments.length;)n[r++]=arguments[o++];return new Promise((function(o,s){n[r]=function(e){if(i)if(i=!1,e)s(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];o.apply(null,t)}};try{e.apply(t||null,n)}catch(e){i&&(i=!1,s(e))}}))}},function(e,t,n){"use strict";var r=t;r.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var o=new Array(64),i=new Array(123),s=0;s<64;)i[o[s]=s<26?s+65:s<52?s+71:s<62?s-4:s-59|43]=s++;r.encode=function(e,t,n){for(var r,i=null,s=[],a=0,c=0;t<n;){var u=e[t++];switch(c){case 0:s[a++]=o[u>>2],r=(3&u)<<4,c=1;break;case 1:s[a++]=o[r|u>>4],r=(15&u)<<2,c=2;break;case 2:s[a++]=o[r|u>>6],s[a++]=o[63&u],c=0}a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),a=0)}return c&&(s[a++]=o[r],s[a++]=61,1===c&&(s[a++]=61)),i?(a&&i.push(String.fromCharCode.apply(String,s.slice(0,a))),i.join("")):String.fromCharCode.apply(String,s.slice(0,a))};r.decode=function(e,t,n){for(var r,o=n,s=0,a=0;a<e.length;){var c=e.charCodeAt(a++);if(61===c&&s>1)break;if(void 0===(c=i[c]))throw Error("invalid encoding");switch(s){case 0:r=c,s=1;break;case 1:t[n++]=r<<2|(48&c)>>4,r=c,s=2;break;case 2:t[n++]=(15&r)<<4|(60&c)>>2,r=c,s=3;break;case 3:t[n++]=(3&r)<<6|c,s=0}}if(1===s)throw Error("invalid encoding");return n-o},r.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},function(e,t,n){"use strict";function r(){this._listeners={}}e.exports=r,r.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},r.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},r.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this}},function(e,t,n){"use strict";function r(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function o(e,r,o){t[0]=e,r[o]=n[0],r[o+1]=n[1],r[o+2]=n[2],r[o+3]=n[3]}function i(e,r,o){t[0]=e,r[o]=n[3],r[o+1]=n[2],r[o+2]=n[1],r[o+3]=n[0]}function s(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function a(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?o:i,e.writeFloatBE=r?i:o,e.readFloatLE=r?s:a,e.readFloatBE=r?a:s}():function(){function t(e,t,n,r){var o=t<0?1:0;if(o&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>34028234663852886e22)e((o<<31|2139095040)>>>0,n,r);else if(t<11754943508222875e-54)e((o<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var i=Math.floor(Math.log(t)/Math.LN2);e((o<<31|i+127<<23|8388607&Math.round(t*Math.pow(2,-i)*8388608))>>>0,n,r)}}function n(e,t,n){var r=e(t,n),o=2*(r>>31)+1,i=r>>>23&255,s=8388607&r;return 255===i?s?NaN:o*(1/0):0===i?1401298464324817e-60*o*s:o*Math.pow(2,i-150)*(s+8388608)}e.writeFloatLE=t.bind(null,o),e.writeFloatBE=t.bind(null,i),e.readFloatLE=n.bind(null,s),e.readFloatBE=n.bind(null,a)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function o(e,r,o){t[0]=e,r[o]=n[0],r[o+1]=n[1],r[o+2]=n[2],r[o+3]=n[3],r[o+4]=n[4],r[o+5]=n[5],r[o+6]=n[6],r[o+7]=n[7]}function i(e,r,o){t[0]=e,r[o]=n[7],r[o+1]=n[6],r[o+2]=n[5],r[o+3]=n[4],r[o+4]=n[3],r[o+5]=n[2],r[o+6]=n[1],r[o+7]=n[0]}function s(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function a(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?o:i,e.writeDoubleBE=r?i:o,e.readDoubleLE=r?s:a,e.readDoubleBE=r?a:s}():function(){function t(e,t,n,r,o,i){var s=r<0?1:0;if(s&&(r=-r),0===r)e(0,o,i+t),e(1/r>0?0:2147483648,o,i+n);else if(isNaN(r))e(0,o,i+t),e(2146959360,o,i+n);else if(r>17976931348623157e292)e(0,o,i+t),e((s<<31|2146435072)>>>0,o,i+n);else{var a;if(r<22250738585072014e-324)e((a=r/5e-324)>>>0,o,i+t),e((s<<31|a/4294967296)>>>0,o,i+n);else{var c=Math.floor(Math.log(r)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(a=r*Math.pow(2,-c))>>>0,o,i+t),e((s<<31|c+1023<<20|1048576*a&1048575)>>>0,o,i+n)}}}function n(e,t,n,r,o){var i=e(r,o+t),s=e(r,o+n),a=2*(s>>31)+1,c=s>>>20&2047,u=4294967296*(1048575&s)+i;return 2047===c?u?NaN:a*(1/0):0===c?5e-324*a*u:a*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,o,0,4),e.writeDoubleBE=t.bind(null,i,4,0),e.readDoubleLE=n.bind(null,s,0,4),e.readDoubleBE=n.bind(null,a,4,0)}(),e}function o(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function i(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function s(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function a(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=r(r)},function(module,exports,__webpack_require__){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},function(e,t,n){"use strict";var r=t;r.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)(n=e.charCodeAt(r))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},r.read=function(e,t,n){if(n-t<1)return"";for(var r,o=null,i=[],s=0;t<n;)(r=e[t++])<128?i[s++]=r:r>191&&r<224?i[s++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,i[s++]=55296+(r>>10),i[s++]=56320+(1023&r)):i[s++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,i)),s=0);return o?(s&&o.push(String.fromCharCode.apply(String,i.slice(0,s))),o.join("")):String.fromCharCode.apply(String,i.slice(0,s))},r.write=function(e,t,n){for(var r,o,i=n,s=0;s<e.length;++s)(r=e.charCodeAt(s))<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&56320==(64512&(o=e.charCodeAt(s+1)))?(r=65536+((1023&r)<<10)+(1023&o),++s,t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128);return n-i}},function(e,t,n){"use strict";e.exports=function(e,t,n){var r=n||8192,o=r>>>1,i=null,s=r;return function(n){if(n<1||n>o)return e(n);s+n>r&&(i=e(r),s=0);var a=t.call(i,s,s+=n);return 7&s&&(s=1+(7|s)),a}}},function(e,t,n){"use strict";e.exports=o;var r=n(146);function o(e,t){this.lo=e>>>0,this.hi=t>>>0}var i=o.zero=new o(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var s=o.zeroHash="\0\0\0\0\0\0\0\0";o.fromNumber=function(e){if(0===e)return i;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new o(n,r)},o.from=function(e){if("number"==typeof e)return o.fromNumber(e);if(r.isString(e)){if(!r.Long)return o.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new o(e.low>>>0,e.high>>>0):i},o.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},o.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;o.fromHash=function(e){return e===s?i:new o((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},o.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},o.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},o.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},o.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},function(e,t,n){"use strict";e.exports=i;var r=n(269);(i.prototype=Object.create(r.prototype)).constructor=i;var o=n(146);function i(){r.call(this)}function s(e,t,n){e.length<40?o.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}i._configure=function(){i.alloc=o._Buffer_allocUnsafe,i.writeBytesBuffer=o.Buffer&&o.Buffer.prototype instanceof Uint8Array&&"set"===o.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}},i.prototype.bytes=function(e){o.isString(e)&&(e=o._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(i.writeBytesBuffer,t,e),this},i.prototype.string=function(e){var t=o.Buffer.byteLength(e);return this.uint32(t),t&&this._push(s,t,e),this},i._configure()},function(e,t,n){"use strict";e.exports=i;var r=n(270);(i.prototype=Object.create(r.prototype)).constructor=i;var o=n(146);function i(e){r.call(this,e)}i._configure=function(){o.Buffer&&(i.prototype._slice=o.Buffer.prototype.slice)},i.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},i._configure()},function(e,t,n){"use strict";t.Service=n(369)},function(e,t,n){"use strict";e.exports=o;var r=n(146);function o(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(o.prototype=Object.create(r.EventEmitter.prototype)).constructor=o,o.prototype.rpcCall=function e(t,n,o,i,s){if(!i)throw TypeError("request must be specified");var a=this;if(!s)return r.asPromise(e,a,t,n,o,i);if(a.rpcImpl)try{return a.rpcImpl(t,n[a.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function(e,n){if(e)return a.emit("error",e,t),s(e);if(null!==n){if(!(n instanceof o))try{n=o[a.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return a.emit("error",e,t),s(e)}return a.emit("data",n,t),s(null,n)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){s(e)}),0)}else setTimeout((function(){s(Error("already ended"))}),0)},o.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},function(e,t,n){"use strict";e.exports={}},function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=371},function(e,t,n){const r=n(373);let o=null;function i(e){const t=r(e);return["jpg","jpeg"].includes(t)?"image/jpeg":"image/png"}e.exports=function(e,t={}){const n=new Date,{filename:r=`Screen Shot ${n.toISOString().slice(0,10)} at ${n.toTimeString().slice(0,8).replace(/:/g,".")}.png`,quality:s=1,useBlob:a,download:c=!0}={...t};if(c&&(o=o||document.createElement("a"),o.download=r),a)return new Promise(t=>{e.toBlob(e=>{if(c){const t=URL.createObjectURL(e);o.href=t;const n=new MouseEvent("click");o.dispatchEvent(n),setTimeout(()=>{URL.revokeObjectURL(t)},1)}t(e)},i(r),s)});const u=e.toDataURL(i(r)+";base64",s);if(c){o.href=u;const e=new MouseEvent("click");o.dispatchEvent(e)}return u}},function(e,t,n){"use strict";
/*! file-extension v4.0.5 | (c) silverwind | BSD license */e.exports=function(e,t){if(t||(t={}),!e)return"";var n=(/[^./\\]*$/.exec(e)||[""])[0];return t.preserveCase?n:n.toLowerCase()}},function(e,t,n){e.exports=function(e){function t(e){let n;function i(...e){if(!i.enabled)return;const r=i,o=Number(new Date),s=o-(n||o);r.diff=s,r.prev=n,r.curr=o,n=o,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(n,o)=>{if("%%"===n)return n;a++;const i=t.formatters[o];if("function"==typeof i){const t=e[a];n=i.call(r,t),e.splice(a,1),a--}return n}),t.formatArgs.call(r,e);(r.log||t.log).apply(r,e)}return i.namespace=e,i.enabled=t.enabled(e),i.useColors=t.useColors(),i.color=t.selectColor(e),i.destroy=r,i.extend=o,"function"==typeof t.init&&t.init(i),t.instances.push(i),i}function r(){const e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}function o(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){const e=t.instances[n];e.enabled=t.enabled(e.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(375),Object.keys(e).forEach(n=>{t[n]=e[n]}),t.instances=[],t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},function(e,t){var n=1e3,r=6e4,o=60*r,i=24*o;function s(e,t,n,r){var o=t>=1.5*n;return Math.round(e/n)+" "+r+(o?"s":"")}e.exports=function(e,t){t=t||{};var a=typeof e;if("string"===a&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var s=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return 6048e5*s;case"days":case"day":case"d":return s*i;case"hours":case"hour":case"hrs":case"hr":case"h":return s*o;case"minutes":case"minute":case"mins":case"min":case"m":return s*r;case"seconds":case"second":case"secs":case"sec":case"s":return s*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(e);if("number"===a&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=i)return s(e,t,i,"day");if(t>=o)return s(e,t,o,"hour");if(t>=r)return s(e,t,r,"minute");if(t>=n)return s(e,t,n,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=i)return Math.round(e/i)+"d";if(t>=o)return Math.round(e/o)+"h";if(t>=r)return Math.round(e/r)+"m";if(t>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){"use strict";let r;function o(){return r||(r=function(){try{throw new Error}catch(e){const t=(""+e.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\/\/[^)\n]+/g);if(t)return(""+t[0]).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\/\/.+)?\/[^/]+(?:\?.*)?$/,"$1")+"/"}return"/"}()),r}n.d(t,"a",(function(){return u}));"undefined"!=typeof navigator&&navigator.hardwareConcurrency&&navigator.hardwareConcurrency;const i=e=>/^(file|https?:)?\/\//i.test(e);function s(e){const t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}let a;function c(){return a||(a=function(){if("undefined"==typeof Worker)return class{constructor(){throw Error("No web worker implementation available. You might have tried to spawn a worker within a worker in a browser that doesn't support workers in workers.")}};class e extends Worker{constructor(e,t){"string"==typeof e&&t&&t._baseURL?e=new URL(e,t._baseURL):"string"==typeof e&&!i(e)&&o().match(/^file:\/\//i)&&(e=new URL(e,o().replace(/\/[^\/]+$/,"/")),e=s(`importScripts(${JSON.stringify(e)});`)),"string"==typeof e&&i(e)&&(e=s(`importScripts(${JSON.stringify(e)});`)),super(e,t)}}class t extends e{constructor(e,t){super(window.URL.createObjectURL(e),t)}static fromText(e,n){const r=new window.Blob([e],{type:"text/javascript"});return new t(r,n)}}return{blob:t,default:e}}()),a}c().blob;const u=c().default}]);