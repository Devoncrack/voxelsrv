!function(e){function t(t){for(var r,a,s=t[0],u=t[1],c=t[2],h=0,d=[];h<s.length;h++)a=s[h],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&d.push(o[a][0]),o[a]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);for(l&&l(t);d.length;)d.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,s=1;s<n.length;s++){var u=n[s];0!==o[u]&&(r=!1)}r&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},o={1:0},i=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.e=function(e){var t=[],n=o[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,r){n=o[e]=[t,r]}));t.push(n[2]=r);var i,s=document.createElement("script");s.charset="utf-8",s.timeout=120,a.nc&&s.setAttribute("nonce",a.nc),s.src=function(e){return a.p+""+e+".bundle.js"}(e);var u=new Error;i=function(t){s.onerror=s.onload=null,clearTimeout(c);var n=o[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+r+": "+i+")",u.name="ChunkLoadError",u.type=r,u.request=i,n[1](u)}o[e]=void 0}};var c=setTimeout((function(){i({type:"timeout",target:s})}),12e4);s.onerror=s.onload=i,document.head.appendChild(s)}return Promise.all(t)},a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a.oe=function(e){throw console.error(e),e};var s=window.webpackJsonp=window.webpackJsonp||[],u=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var l=u;i.push([285,0]),n()}([,function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return c}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function o(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}function s(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function u(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function c(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){e.exports={EPSILON:n(256),create:n(257),clone:n(286),angle:n(287),fromValues:n(258),copy:n(288),set:n(289),equals:n(290),exactEquals:n(291),add:n(292),subtract:n(261),sub:n(293),multiply:n(262),mul:n(294),divide:n(263),div:n(295),min:n(296),max:n(297),floor:n(298),ceil:n(299),round:n(300),scale:n(301),scaleAndAdd:n(302),distance:n(264),dist:n(303),squaredDistance:n(265),sqrDist:n(304),length:n(266),len:n(305),squaredLength:n(267),sqrLen:n(306),negate:n(307),inverse:n(308),normalize:n(259),dot:n(260),cross:n(309),lerp:n(310),random:n(311),transformMat4:n(312),transformMat3:n(313),transformQuat:n(314),rotateX:n(315),rotateY:n(316),rotateZ:n(317),forEach:n(318)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r,o="object"==typeof Reflect?Reflect:null,i=o&&"function"==typeof o.apply?o.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=o&&"function"==typeof o.ownKeys?o.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var u=10;function c(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function h(e,t,n,r){var o,i,a,s;if(c(n),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),a=i[t]),void 0===a)a=i[t]=n,++e._eventsCount;else if("function"==typeof a?a=i[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(o=l(e))>0&&a.length>o&&!a.warned){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=a.length,s=u,console&&console.warn&&console.warn(s)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=d.bind(r);return o.listener=n,r.wrapFn=o,o}function p(e,t,n){var r=e._events;if(void 0===r)return[];var o=r[t];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(o):v(o,o.length)}function m(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function v(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");u=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var u=o[e];if(void 0===u)return!1;if("function"==typeof u)i(u,this,t);else{var c=u.length,l=v(u,c);for(n=0;n<c;++n)i(l[n],this,t)}return!0},s.prototype.addListener=function(e,t){return h(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return h(this,e,t,!0)},s.prototype.once=function(e,t){return c(t),this.on(e,f(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,f(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,r,o,i,a;if(c(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){a=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,o),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var o,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},s.prototype.listeners=function(e){return p(this,e,!0)},s.prototype.rawListeners=function(e){return p(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},s.prototype.listenerCount=m,s.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},,,,,,function(e,t,n){var r=n(268),o=n(319),i="undefined"!=typeof Float64Array;function a(e,t){return e[0]-t[0]}function s(){var e,t=this.stride,n=new Array(t.length);for(e=0;e<n.length;++e)n[e]=[Math.abs(t[e]),e];n.sort(a);var r=new Array(n.length);for(e=0;e<r.length;++e)r[e]=n[e][1];return r}function u(e,t){var n=["View",t,"d",e].join("");t<0&&(n="View_Nil"+e);var o="generic"===e;if(-1===t){var i="function "+n+"(a){this.data=a;};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+n+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+n+"(a){return new "+n+"(a);}";return new Function(i)()}if(0===t){i="function "+n+"(a,d) {this.data = a;this.offset = d};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+n+"_copy() {return new "+n+"(this.data,this.offset)};proto.pick=function "+n+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+n+"_get(){return "+(o?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+n+"_set(v){return "+(o?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}";return new Function("TrivialArray",i)(c[e][0])}i=["'use strict'"];var a=r(t),u=a.map((function(e){return"i"+e})),l="this.offset+"+a.map((function(e){return"this.stride["+e+"]*i"+e})).join("+"),h=a.map((function(e){return"b"+e})).join(","),d=a.map((function(e){return"c"+e})).join(",");i.push("function "+n+"(a,"+h+","+d+",d){this.data=a","this.shape=["+h+"]","this.stride=["+d+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+e+"'","proto.dimension="+t),i.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){return "+a.map((function(e){return"this.shape["+e+"]"})).join("*"),"}})"),1===t?i.push("proto.order=[0]"):(i.push("Object.defineProperty(proto,'order',{get:"),t<4?(i.push("function "+n+"_order(){"),2===t?i.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===t&&i.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):i.push("ORDER})")),i.push("proto.set=function "+n+"_set("+u.join(",")+",v){"),o?i.push("return this.data.set("+l+",v)}"):i.push("return this.data["+l+"]=v}"),i.push("proto.get=function "+n+"_get("+u.join(",")+"){"),o?i.push("return this.data.get("+l+")}"):i.push("return this.data["+l+"]}"),i.push("proto.index=function "+n+"_index(",u.join(),"){return "+l+"}"),i.push("proto.hi=function "+n+"_hi("+u.join(",")+"){return new "+n+"(this.data,"+a.map((function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")})).join(",")+","+a.map((function(e){return"this.stride["+e+"]"})).join(",")+",this.offset)}");var f=a.map((function(e){return"a"+e+"=this.shape["+e+"]"})),p=a.map((function(e){return"c"+e+"=this.stride["+e+"]"}));i.push("proto.lo=function "+n+"_lo("+u.join(",")+"){var b=this.offset,d=0,"+f.join(",")+","+p.join(","));for(var m=0;m<t;++m)i.push("if(typeof i"+m+"==='number'&&i"+m+">=0){d=i"+m+"|0;b+=c"+m+"*d;a"+m+"-=d}");i.push("return new "+n+"(this.data,"+a.map((function(e){return"a"+e})).join(",")+","+a.map((function(e){return"c"+e})).join(",")+",b)}"),i.push("proto.step=function "+n+"_step("+u.join(",")+"){var "+a.map((function(e){return"a"+e+"=this.shape["+e+"]"})).join(",")+","+a.map((function(e){return"b"+e+"=this.stride["+e+"]"})).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(m=0;m<t;++m)i.push("if(typeof i"+m+"==='number'){d=i"+m+"|0;if(d<0){c+=b"+m+"*(a"+m+"-1);a"+m+"=ceil(-a"+m+"/d)}else{a"+m+"=ceil(a"+m+"/d)}b"+m+"*=d}");i.push("return new "+n+"(this.data,"+a.map((function(e){return"a"+e})).join(",")+","+a.map((function(e){return"b"+e})).join(",")+",c)}");var v=new Array(t),_=new Array(t);for(m=0;m<t;++m)v[m]="a[i"+m+"]",_[m]="b[i"+m+"]";i.push("proto.transpose=function "+n+"_transpose("+u+"){"+u.map((function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"})).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+v.join(",")+","+_.join(",")+",this.offset)}"),i.push("proto.pick=function "+n+"_pick("+u+"){var a=[],b=[],c=this.offset");for(m=0;m<t;++m)i.push("if(typeof i"+m+"==='number'&&i"+m+">=0){c=(c+this.stride["+m+"]*i"+m+")|0}else{a.push(this.shape["+m+"]);b.push(this.stride["+m+"])}");return i.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),i.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+a.map((function(e){return"shape["+e+"]"})).join(",")+","+a.map((function(e){return"stride["+e+"]"})).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",i.join("\n"))(c[e],s)}var c={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};e.exports=function(e,t,n,r){if(void 0===e)return(0,c.array[0])([]);"number"==typeof e&&(e=[e]),void 0===t&&(t=[e.length]);var a=t.length;if(void 0===n){n=new Array(a);for(var s=a-1,l=1;s>=0;--s)n[s]=l,l*=t[s]}if(void 0===r){r=0;for(s=0;s<a;++s)n[s]<0&&(r-=(t[s]-1)*n[s])}for(var h=function(e){if(o(e))return"buffer";if(i)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(e)?"array":"generic"}(e),d=c[h];d.length<=a+1;)d.push(u(h,d.length-1));return(0,d[a+1])(e,t,n,r)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){e.exports=o;var r=n(82);function o(e,t){if(!(this instanceof o))return new o(e,t);var n=r.create();r.add(n,e,t),this.base=r.min(r.create(),e,n),this.vec=r.clone(t),this.max=r.max(r.create(),e,n),this.mag=r.length(this.vec)}var i=o.prototype;i.width=function(){return this.vec[0]},i.height=function(){return this.vec[1]},i.depth=function(){return this.vec[2]},i.x0=function(){return this.base[0]},i.y0=function(){return this.base[1]},i.z0=function(){return this.base[2]},i.x1=function(){return this.max[0]},i.y1=function(){return this.max[1]},i.z1=function(){return this.max[2]},i.translate=function(e){return r.add(this.max,this.max,e),r.add(this.base,this.base,e),this},i.setPosition=function(e){return r.add(this.max,e,this.vec),r.copy(this.base,e),this},i.expand=function(e){var t=r.create(),n=r.create();return r.max(t,e.max,this.max),r.min(n,e.base,this.base),r.subtract(t,t,n),new o(n,t)},i.intersects=function(e){return!(e.base[0]>this.max[0])&&(!(e.base[1]>this.max[1])&&(!(e.base[2]>this.max[2])&&(!(e.max[0]<this.base[0])&&(!(e.max[1]<this.base[1])&&!(e.max[2]<this.base[2])))))},i.touches=function(e){var t=this.union(e);return null!==t&&(0==t.width()||0==t.height()||0==t.depth())},i.union=function(e){if(!this.intersects(e))return null;var t=Math.max(e.base[0],this.base[0]),n=Math.max(e.base[1],this.base[1]),r=Math.max(e.base[2],this.base[2]);return new o([t,n,r],[Math.min(e.max[0],this.max[0])-t,Math.min(e.max[1],this.max[1])-n,Math.min(e.max[2],this.max[2])-r])}},function(e,t,n){"use strict";(function(e){var r=n(234),o=n(344),i=n(345).Buffer;e.__TYPEDARRAY_POOL||(e.__TYPEDARRAY_POOL={UINT8:o([32,0]),UINT16:o([32,0]),UINT32:o([32,0]),BIGUINT64:o([32,0]),INT8:o([32,0]),INT16:o([32,0]),INT32:o([32,0]),BIGINT64:o([32,0]),FLOAT:o([32,0]),DOUBLE:o([32,0]),DATA:o([32,0]),UINT8C:o([32,0]),BUFFER:o([32,0])});var a="undefined"!=typeof Uint8ClampedArray,s="undefined"!=typeof BigUint64Array,u="undefined"!=typeof BigInt64Array,c=e.__TYPEDARRAY_POOL;c.UINT8C||(c.UINT8C=o([32,0])),c.BIGUINT64||(c.BIGUINT64=o([32,0])),c.BIGINT64||(c.BIGINT64=o([32,0])),c.BUFFER||(c.BUFFER=o([32,0]));var l=c.DATA,h=c.BUFFER;function d(e){if(e){var t=e.length||e.byteLength,n=r.log2(t);l[n].push(e)}}function f(e){e=r.nextPow2(e);var t=r.log2(e),n=l[t];return n.length>0?n.pop():new ArrayBuffer(e)}function p(e){return new Uint8Array(f(e),0,e)}function m(e){return new Uint16Array(f(2*e),0,e)}function v(e){return new Uint32Array(f(4*e),0,e)}function _(e){return new Int8Array(f(e),0,e)}function g(e){return new Int16Array(f(2*e),0,e)}function y(e){return new Int32Array(f(4*e),0,e)}function b(e){return new Float32Array(f(4*e),0,e)}function w(e){return new Float64Array(f(8*e),0,e)}function k(e){return a?new Uint8ClampedArray(f(e),0,e):p(e)}function x(e){return s?new BigUint64Array(f(8*e),0,e):null}function A(e){return u?new BigInt64Array(f(8*e),0,e):null}function T(e){return new DataView(f(e),0,e)}function M(e){e=r.nextPow2(e);var t=r.log2(e),n=h[t];return n.length>0?n.pop():new i(e)}t.free=function(e){if(i.isBuffer(e))h[r.log2(e.length)].push(e);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(e)&&(e=e.buffer),!e)return;var t=e.length||e.byteLength,n=0|r.log2(t);l[n].push(e)}},t.freeUint8=t.freeUint16=t.freeUint32=t.freeBigUint64=t.freeInt8=t.freeInt16=t.freeInt32=t.freeBigInt64=t.freeFloat32=t.freeFloat=t.freeFloat64=t.freeDouble=t.freeUint8Clamped=t.freeDataView=function(e){d(e.buffer)},t.freeArrayBuffer=d,t.freeBuffer=function(e){h[r.log2(e.length)].push(e)},t.malloc=function(e,t){if(void 0===t||"arraybuffer"===t)return f(e);switch(t){case"uint8":return p(e);case"uint16":return m(e);case"uint32":return v(e);case"int8":return _(e);case"int16":return g(e);case"int32":return y(e);case"float":case"float32":return b(e);case"double":case"float64":return w(e);case"uint8_clamped":return k(e);case"bigint64":return A(e);case"biguint64":return x(e);case"buffer":return M(e);case"data":case"dataview":return T(e);default:return null}return null},t.mallocArrayBuffer=f,t.mallocUint8=p,t.mallocUint16=m,t.mallocUint32=v,t.mallocInt8=_,t.mallocInt16=g,t.mallocInt32=y,t.mallocFloat32=t.mallocFloat=b,t.mallocFloat64=t.mallocDouble=w,t.mallocUint8Clamped=k,t.mallocBigUint64=x,t.mallocBigInt64=A,t.mallocDataView=T,t.mallocBuffer=M,t.clearCache=function(){for(var e=0;e<32;++e)c.UINT8[e].length=0,c.UINT16[e].length=0,c.UINT32[e].length=0,c.INT8[e].length=0,c.INT16[e].length=0,c.INT32[e].length=0,c.FLOAT[e].length=0,c.DOUBLE[e].length=0,c.BIGUINT64[e].length=0,c.BIGINT64[e].length=0,c.UINT8C[e].length=0,l[e].length=0,h[e].length=0}}).call(this,n(110))},function(e,t,n){"use strict";function r(e){var t=32;return(e&=-e)&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t}t.INT_BITS=32,t.INT_MAX=2147483647,t.INT_MIN=-1<<31,t.sign=function(e){return(e>0)-(e<0)},t.abs=function(e){var t=e>>31;return(e^t)-t},t.min=function(e,t){return t^(e^t)&-(e<t)},t.max=function(e,t){return e^(e^t)&-(e<t)},t.isPow2=function(e){return!(e&e-1||!e)},t.log2=function(e){var t,n;return t=(e>65535)<<4,t|=n=((e>>>=t)>255)<<3,t|=n=((e>>>=n)>15)<<2,(t|=n=((e>>>=n)>3)<<1)|(e>>>=n)>>1},t.log10=function(e){return e>=1e9?9:e>=1e8?8:e>=1e7?7:e>=1e6?6:e>=1e5?5:e>=1e4?4:e>=1e3?3:e>=100?2:e>=10?1:0},t.popCount=function(e){return 16843009*((e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)>>>24},t.countTrailingZeros=r,t.nextPow2=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)+1},t.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)-(e>>>1)},t.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,27030>>>(e&=15)&1};var o=new Array(256);!function(e){for(var t=0;t<256;++t){var n=t,r=t,o=7;for(n>>>=1;n;n>>>=1)r<<=1,r|=1&n,--o;e[t]=r<<o&255}}(o),t.reverse=function(e){return o[255&e]<<24|o[e>>>8&255]<<16|o[e>>>16&255]<<8|o[e>>>24&255]},t.interleave2=function(e,t){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e&=65535)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))<<1},t.deinterleave2=function(e,t){return(e=65535&((e=16711935&((e=252645135&((e=858993459&((e=e>>>t&1431655765)|e>>>1))|e>>>2))|e>>>4))|e>>>16))<<16>>16},t.interleave3=function(e,t,n){return e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2),(e|=(t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2))<<1)|(n=1227133513&((n=3272356035&((n=251719695&((n=4278190335&((n&=1023)|n<<16))|n<<8))|n<<4))|n<<2))<<2},t.deinterleave3=function(e,t){return(e=1023&((e=4278190335&((e=251719695&((e=3272356035&((e=e>>>t&1227133513)|e>>>2))|e>>>4))|e>>>8))|e>>>16))<<22>>22},t.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>r(e)+1}},,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"updatePositionExtents",(function(){return o}));var r=n(82);function o(e){var t=e.width/2,n=e._localPosition,r=e._extents;r[0]=n[0]-t,r[1]=n[1],r[2]=n[2]-t,r[3]=n[0]+t,r[4]=n[1]+e.height,r[5]=n[2]+t}t.default=function(e){return{name:"position",order:60,state:{position:null,width:1,height:1,_localPosition:null,_renderPosition:null,_extents:null},onAdd:function(t,n){var i=[0,0,0];n.position&&r.copy(i,n.position),n.position=i,n._localPosition=r.create(),n._renderPosition=r.create(),n._extents=new Float32Array(6),e.globalToLocal(n.position,null,n._localPosition),r.copy(n._renderPosition,n._localPosition),o(n)},onRemove:null,system:function(t,n){var i=e.worldOriginOffset;n.forEach(e=>{r.add(e.position,e._localPosition,i),o(e)})}}}},function(e,t,n){"use strict";n.r(t),n.d(t,"setPhysicsFromPosition",(function(){return i}));var r=n(82);t.default=function(e){return{name:"physics",order:40,state:{body:null},onAdd:function(t,n){n.body=e.physics.addBody(),i(n,e.ents.getPositionData(n.__id))},onRemove:function(t,n){if(e.ents.hasPosition(n.__id)){var r=e.ents.getPositionData(n.__id);a(n,r),s(n,r,0,!1)}e.physics.removeBody(n.body)},system:function(t,n){n.forEach(t=>{a(t,e.ents.getPositionData(t.__id))})},renderSystem:function(t,n){var r=(e.positionInCurrentTick*e._tickRate-e._tickRate)/1e3;n.forEach(t=>{var n=t.__id,o=e.ents.getPositionData(n),i=e.ents.cameraSmoothed(n);s(t,o,r,i)})}}};var o=r.create();function i(e,t){var n=e.body.aabb,o=t._extents;r.copy(n.base,o),r.set(n.vec,t.width,t.height,t.width),r.add(n.max,n.base,n.vec)}function a(e,t){var n=e.body.aabb.base,o=t.width/2;r.set(t._localPosition,n[0]+o,n[1],n[2]+o)}function s(e,t,n,i){var a=e.body.velocity;r.scaleAndAdd(o,t._localPosition,a,n),i&&r.lerp(o,t._renderPosition,o,.3),r.copy(t._renderPosition,o)}},,,,,,,,,,,,,function(e,t){e.exports=1e-6},function(e,t){e.exports=function(){var e=new Float32Array(3);return e[0]=0,e[1]=0,e[2]=0,e}},function(e,t){e.exports=function(e,t,n){var r=new Float32Array(3);return r[0]=e,r[1]=t,r[2]=n,r}},function(e,t){e.exports=function(e,t){var n=t[0],r=t[1],o=t[2],i=n*n+r*r+o*o;i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i);return e}},function(e,t){e.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}},function(e,t){e.exports=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2];return Math.sqrt(n*n+r*r+o*o)}},function(e,t){e.exports=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2];return n*n+r*r+o*o}},function(e,t){e.exports=function(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)}},function(e,t){e.exports=function(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}},function(e,t,n){"use strict";e.exports=function(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=n;return t}},,,,,function(e,t,n){"use strict";var r=[],o=[],i=[],a=[],s=[],u=[],c=[],l=[],h=[],d=[],f=[],p=[];e.exports=function(e,t,n,m,v,_){for(var g=c,y=h,b=d,w=p,k=0;k<3;k++)g[k]=+n[k],b[k]=+t.max[k],y[k]=+t.base[k];_||(_=1e-10);var x=function(e,t,n,c,h,d){var p=r,m=o,v=i,_=a,g=s,y=u,b=l,w=Math.floor,k=0,x=0,A=0,T=0,M=0;if(E(),0===A)return 0;for(T=I();x<=A;){if(C(T))if(P())return k;T=I()}for(k+=A,M=0;M<3;M++)c[M]+=n[M],h[M]+=n[M];return k;function E(){if(x=0,0!==(A=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2])))for(var e=0;e<3;e++){var t=n[e]>=0;_[e]=t?1:-1;var r=t?h[e]:c[e];p[e]=t?c[e]:h[e],m[e]=S(r,_[e]),v[e]=B(p[e],_[e]),b[e]=n[e]/A,g[e]=Math.abs(1/b[e]);var o=t?m[e]+1-r:r-m[e];y[e]=g[e]<1/0?g[e]*o:1/0}}function C(t){for(var n=_[0],r=0===t?m[0]:v[0],o=m[0]+n,i=_[1],a=1===t?m[1]:v[1],s=m[1]+i,u=_[2],c=2===t?m[2]:v[2],l=m[2]+u,h=r;h!=o;h+=n)for(var d=a;d!=s;d+=i)for(var f=c;f!=l;f+=u)if(e(h,d,f))return!0;return!1}function P(){k+=x;var e=_[T],r=x/A,o=f;for(M=0;M<3;M++){var i=n[M]*r;c[M]+=i,h[M]+=i,o[M]=n[M]-i}if(e>0?h[T]=Math.round(h[T]):c[T]=Math.round(c[T]),t(k,T,e,o))return!0;for(M=0;M<3;M++)n[M]=o[M];return E(),0===A}function I(){var e=y[0]<y[1]?y[0]<y[2]?0:2:y[1]<y[2]?1:2,t=y[e]-x;for(x=y[e],m[e]+=_[e],y[e]+=g[e],M=0;M<3;M++)p[M]+=t*b[M],v[M]=B(p[M],_[M]);return e}function S(e,t){return w(e-t*d)}function B(e,t){return w(e+t*d)}}(e,m,g,y,b,_);if(!v){for(k=0;k<3;k++)w[k]=n[k]>0?b[k]-t.max[k]:y[k]-t.base[k];t.translate(w)}return x}},function(e,t,n){"use strict";e.exports={init:function(e){var t=o.nextPow2(e);a.length<t&&(r.free(a),a=r.mallocInt32(t));s.length<t&&(r.free(s),s=r.mallocInt32(t));u.length<t&&(r.free(u),u=r.mallocInt32(t));c.length<t&&(r.free(c),c=r.mallocInt32(t));l.length<t&&(r.free(l),l=r.mallocInt32(t));h.length<t&&(r.free(h),h=r.mallocInt32(t));var n=8*t;d.length<n&&(r.free(d),d=r.mallocDouble(n))},sweepBipartite:function(e,t,n,r,o,l,h,m,v,_){for(var g=0,y=2*e,b=e-1,w=y-1,k=n;k<r;++k){var x=l[k],A=y*k;d[g++]=o[A+b],d[g++]=-(x+1),d[g++]=o[A+w],d[g++]=x}for(k=h;k<m;++k){x=_[k]+(1<<28);var T=y*k;d[g++]=v[T+b],d[g++]=-x,d[g++]=v[T+w],d[g++]=x}var M=g>>>1;i(d,M);var E=0,C=0;for(k=0;k<M;++k){var P=0|d[2*k+1];if(P>=1<<28)f(u,c,C--,P=P-(1<<28)|0);else if(P>=0)f(a,s,E--,P);else if(P<=-(1<<28)){P=-P-(1<<28)|0;for(var I=0;I<E;++I){if(void 0!==(S=t(a[I],P)))return S}p(u,c,C++,P)}else{P=-P-1|0;for(I=0;I<C;++I){var S;if(void 0!==(S=t(P,u[I])))return S}p(a,s,E++,P)}}},sweepComplete:function(e,t,n,r,o,m,v,_,g,y){for(var b=0,w=2*e,k=e-1,x=w-1,A=n;A<r;++A){var T=m[A]+1<<1,M=w*A;d[b++]=o[M+k],d[b++]=-T,d[b++]=o[M+x],d[b++]=T}for(A=v;A<_;++A){T=y[A]+1<<1;var E=w*A;d[b++]=g[E+k],d[b++]=1|-T,d[b++]=g[E+x],d[b++]=1|T}var C=b>>>1;i(d,C);var P=0,I=0,S=0;for(A=0;A<C;++A){var B=0|d[2*A+1],D=1&B;if(A<C-1&&B>>1==d[2*A+3]>>1&&(D=2,A+=1),B<0){for(var O=-(B>>1)-1,L=0;L<S;++L){if(void 0!==(j=t(l[L],O)))return j}if(0!==D)for(L=0;L<P;++L){if(void 0!==(j=t(a[L],O)))return j}if(1!==D)for(L=0;L<I;++L){var j;if(void 0!==(j=t(u[L],O)))return j}0===D?p(a,s,P++,O):1===D?p(u,c,I++,O):2===D&&p(l,h,S++,O)}else{O=(B>>1)-1;0===D?f(a,s,P--,O):1===D?f(u,c,I--,O):2===D&&f(l,h,S--,O)}}},scanBipartite:function(e,t,n,r,o,u,c,l,h,m,v,_){var g=0,y=2*e,b=t,w=t+e,k=1,x=1;r?x=1<<28:k=1<<28;for(var A=o;A<u;++A){var T=A+k,M=y*A;d[g++]=c[M+b],d[g++]=-T,d[g++]=c[M+w],d[g++]=T}for(A=h;A<m;++A){T=A+x;var E=y*A;d[g++]=v[E+b],d[g++]=-T}var C=g>>>1;i(d,C);var P=0;for(A=0;A<C;++A){var I=0|d[2*A+1];if(I<0){var S=!1;if((T=-I)>=1<<28?(S=!r,T-=1<<28):(S=!!r,T-=1),S)p(a,s,P++,T);else{var B=_[T],D=y*T,O=v[D+t+1],L=v[D+t+1+e];e:for(var j=0;j<P;++j){var F=a[j],R=y*F;if(!(L<c[R+t+1]||c[R+t+1+e]<O)){for(var z=t+2;z<e;++z)if(v[D+z+e]<c[R+z]||c[R+z+e]<v[D+z])continue e;var U,N=l[F];if(void 0!==(U=r?n(B,N):n(N,B)))return U}}}}else f(a,s,P--,I-k)}},scanComplete:function(e,t,n,r,o,s,u,c,l,h,f){for(var p=0,m=2*e,v=t,_=t+e,g=r;g<o;++g){var y=g+(1<<28),b=m*g;d[p++]=s[b+v],d[p++]=-y,d[p++]=s[b+_],d[p++]=y}for(g=c;g<l;++g){y=g+1;var w=m*g;d[p++]=h[w+v],d[p++]=-y}var k=p>>>1;i(d,k);var x=0;for(g=0;g<k;++g){var A=0|d[2*g+1];if(A<0){if((y=-A)>=1<<28)a[x++]=y-(1<<28);else{var T=f[y-=1],M=m*y,E=h[M+t+1],C=h[M+t+1+e];e:for(var P=0;P<x;++P){var I=a[P],S=u[I];if(S===T)break;var B=m*I;if(!(C<s[B+t+1]||s[B+t+1+e]<E)){for(var D=t+2;D<e;++D)if(h[M+D+e]<s[B+D]||s[B+D+e]<h[M+D])continue e;var O=n(S,T);if(void 0!==O)return O}}}}else{for(y=A-(1<<28),P=x-1;P>=0;--P)if(a[P]===y){for(D=P+1;D<x;++D)a[D-1]=a[D];break}--x}}}};var r=n(233),o=n(234),i=n(349),a=r.mallocInt32(1024),s=r.mallocInt32(1024),u=r.mallocInt32(1024),c=r.mallocInt32(1024),l=r.mallocInt32(1024),h=r.mallocInt32(1024),d=r.mallocDouble(8192);function f(e,t,n,r){var o=t[r],i=e[n-1];e[o]=i,t[i]=o}function p(e,t,n,r){e[n]=r,t[r]=n}},function(e,t,n){"use strict";e.exports=function(e,t){var n="abcdef".split("").concat(t),r=[];e.indexOf("lo")>=0&&r.push("lo=e[k+n]");e.indexOf("hi")>=0&&r.push("hi=e[k+o]");return n.push("for(var j=2*a,k=j*c,l=k,m=c,n=b,o=a+b,p=c;d>p;++p,k+=j){var _;if($)if(m===p)m+=1,l+=j;else{for(var s=0;j>s;++s){var t=e[k+s];e[k+s]=e[l],e[l++]=t}var u=f[p];f[p]=f[m],f[m++]=u}}return m".replace("_",r.join()).replace("$",e)),Function.apply(void 0,n)}},,,,,,function(e,t,n){e.exports=function(){return new Worker(n.p+"ea82568fadd1ee8ec91d.worker.js")}},function(e,t,n){"use strict";(function(e){function r(e){e.on("tick",(function(){worldTime++}))}n.d(t,"a",(function(){return r})),e.worldTime=0}).call(this,n(110))},function(e,t,n){(function(n){var r;
/*!
 *  howler.js v2.1.3
 *  howlerjs.com
 *
 *  (c) 2013-2019, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */!function(){"use strict";var o=function(){this.init()};o.prototype={init:function(){var e=this||i;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var t=this||i;if(e=parseFloat(e),t.ctx||f(),void 0!==e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,i.ctx.currentTime);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var r=t._howls[n]._getSoundIds(),o=0;o<r.length;o++){var a=t._howls[n]._soundById(r[o]);a&&a._node&&(a._node.volume=a._volume*e)}return t}return t._volume},mute:function(e){var t=this||i;t.ctx||f(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,i.ctx.currentTime);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var r=t._howls[n]._getSoundIds(),o=0;o<r.length;o++){var a=t._howls[n]._soundById(r[o]);a&&a._node&&(a._node.muted=!!e||a._muted)}return t},unload:function(){for(var e=this||i,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,f()),e},codecs:function(e){return(this||i)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||i;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||i,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!t||"function"!=typeof t.canPlayType)return e;var n=t.canPlayType("audio/mpeg;").replace(/^no$/,""),r=e._navigator&&e._navigator.userAgent.match(/OPR\/([0-6].)/g),o=r&&parseInt(r[0].split("/")[1],10)<33;return e._codecs={mp3:!(o||!n&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||i;if(!e._audioUnlocked&&e.ctx){e._audioUnlocked=!1,e.autoUnlock=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var t=function(n){for(var r=0;r<e.html5PoolSize;r++)try{var o=new Audio;o._unlocked=!0,e._releaseHtml5Audio(o)}catch(n){e.noAudio=!0}for(r=0;r<e._howls.length;r++)if(!e._howls[r]._webAudio)for(var i=e._howls[r]._getSoundIds(),a=0;a<i.length;a++){var s=e._howls[r]._soundById(i[a]);s&&s._node&&!s._node._unlocked&&(s._node._unlocked=!0,s._node.load())}e._autoResume();var u=e.ctx.createBufferSource();u.buffer=e._scratchBuffer,u.connect(e.ctx.destination),void 0===u.start?u.noteOn(0):u.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),u.onended=function(){u.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",t,!0),document.removeEventListener("touchend",t,!0),document.removeEventListener("click",t,!0);for(var n=0;n<e._howls.length;n++)e._howls[n]._emit("unlock")}};return document.addEventListener("touchstart",t,!0),document.addEventListener("touchend",t,!0),document.addEventListener("click",t,!0),e}},_obtainHtml5Audio:function(){var e=this||i;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var t=(new Audio).play();return t&&"undefined"!=typeof Promise&&(t instanceof Promise||"function"==typeof t.then)&&t.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(e){var t=this||i;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&i.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var n=0;n<e._howls[t]._sounds.length;n++)if(!e._howls[t]._sounds[n]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout((function(){e.autoSuspend&&(e._suspendTimer=null,e.state="suspending",e.ctx.suspend().then((function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())})))}),3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&i.usingWebAudio)return"running"===e.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state?(e.ctx.resume().then((function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")})),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var i=new o,a=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};a.prototype={init:function(e){var t=this;return i.ctx||f(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhrWithCredentials=e.xhrWithCredentials||!1,t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=i.usingWebAudio&&!t._html5,void 0!==i.ctx&&i.ctx&&i.autoUnlock&&i._unlockAudio(),i._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&t.load(),t},load:function(){var e=null;if(i.noAudio)this._emit("loaderror",null,"No audio support.");else{"string"==typeof this._src&&(this._src=[this._src]);for(var t=0;t<this._src.length;t++){var n,r;if(this._format&&this._format[t])n=this._format[t];else{if("string"!=typeof(r=this._src[t])){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(n=/^data:audio\/([^;,]+);/i.exec(r))||(n=/\.([^.]+)$/.exec(r.split("?",1)[0])),n&&(n=n[1].toLowerCase())}if(n||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),n&&i.codecs(n)){e=this._src[t];break}}if(e)return this._src=e,this._state="loading","https:"===window.location.protocol&&"http:"===e.slice(0,5)&&(this._html5=!0,this._webAudio=!1),new s(this),this._webAudio&&c(this),this;this._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(e,t){var n=this,r=null;if("number"==typeof e)r=e,e=null;else{if("string"==typeof e&&"loaded"===n._state&&!n._sprite[e])return null;if(void 0===e&&(e="__default",!n._playLock)){for(var o=0,a=0;a<n._sounds.length;a++)n._sounds[a]._paused&&!n._sounds[a]._ended&&(o++,r=n._sounds[a]._id);1===o?e=null:r=null}}var s=r?n._soundById(r):n._inactiveSound();if(!s)return null;if(r&&!e&&(e=s._sprite||"__default"),"loaded"!==n._state){s._sprite=e,s._ended=!1;var u=s._id;return n._queue.push({event:"play",action:function(){n.play(u)}}),u}if(r&&!s._paused)return t||n._loadQueue("play"),s._id;n._webAudio&&i._autoResume();var c=Math.max(0,s._seek>0?s._seek:n._sprite[e][0]/1e3),l=Math.max(0,(n._sprite[e][0]+n._sprite[e][1])/1e3-c),h=1e3*l/Math.abs(s._rate),d=n._sprite[e][0]/1e3,f=(n._sprite[e][0]+n._sprite[e][1])/1e3;s._sprite=e,s._ended=!1;var p=function(){s._paused=!1,s._seek=c,s._start=d,s._stop=f,s._loop=!(!s._loop&&!n._sprite[e][2])};if(!(c>=f)){var m=s._node;if(n._webAudio){var v=function(){n._playLock=!1,p(),n._refreshBuffer(s);var e=s._muted||n._muted?0:s._volume;m.gain.setValueAtTime(e,i.ctx.currentTime),s._playStart=i.ctx.currentTime,void 0===m.bufferSource.start?s._loop?m.bufferSource.noteGrainOn(0,c,86400):m.bufferSource.noteGrainOn(0,c,l):s._loop?m.bufferSource.start(0,c,86400):m.bufferSource.start(0,c,l),h!==1/0&&(n._endTimers[s._id]=setTimeout(n._ended.bind(n,s),h)),t||setTimeout((function(){n._emit("play",s._id),n._loadQueue()}),0)};"running"===i.state?v():(n._playLock=!0,n.once("resume",v),n._clearTimer(s._id))}else{var _=function(){m.currentTime=c,m.muted=s._muted||n._muted||i._muted||m.muted,m.volume=s._volume*i.volume(),m.playbackRate=s._rate;try{var r=m.play();if(r&&"undefined"!=typeof Promise&&(r instanceof Promise||"function"==typeof r.then)?(n._playLock=!0,p(),r.then((function(){n._playLock=!1,m._unlocked=!0,t||(n._emit("play",s._id),n._loadQueue())})).catch((function(){n._playLock=!1,n._emit("playerror",s._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),s._ended=!0,s._paused=!0}))):t||(n._playLock=!1,p(),n._emit("play",s._id),n._loadQueue()),m.playbackRate=s._rate,m.paused)return void n._emit("playerror",s._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==e||s._loop?n._endTimers[s._id]=setTimeout(n._ended.bind(n,s),h):(n._endTimers[s._id]=function(){n._ended(s),m.removeEventListener("ended",n._endTimers[s._id],!1)},m.addEventListener("ended",n._endTimers[s._id],!1))}catch(e){n._emit("playerror",s._id,e)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===m.src&&(m.src=n._src,m.load());var g=window&&window.ejecta||!m.readyState&&i._navigator.isCocoonJS;if(m.readyState>=3||g)_();else{n._playLock=!0;var y=function(){_(),m.removeEventListener(i._canPlayEvent,y,!1)};m.addEventListener(i._canPlayEvent,y,!1),n._clearTimer(s._id)}}return s._id}n._ended(s)},pause:function(e){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var n=t._getSoundIds(e),r=0;r<n.length;r++){t._clearTimer(n[r]);var o=t._soundById(n[r]);if(o&&!o._paused&&(o._seek=t.seek(n[r]),o._rateSeek=0,o._paused=!0,t._stopFade(n[r]),o._node))if(t._webAudio){if(!o._node.bufferSource)continue;void 0===o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),t._cleanBuffer(o._node)}else isNaN(o._node.duration)&&o._node.duration!==1/0||o._node.pause();arguments[1]||t._emit("pause",o?o._id:null)}return t},stop:function(e,t){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(e)}}),n;for(var r=n._getSoundIds(e),o=0;o<r.length;o++){n._clearTimer(r[o]);var i=n._soundById(r[o]);i&&(i._seek=i._start||0,i._rateSeek=0,i._paused=!0,i._ended=!0,n._stopFade(r[o]),i._node&&(n._webAudio?i._node.bufferSource&&(void 0===i._node.bufferSource.stop?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),n._cleanBuffer(i._node)):isNaN(i._node.duration)&&i._node.duration!==1/0||(i._node.currentTime=i._start||0,i._node.pause(),i._node.duration===1/0&&n._clearSound(i._node))),t||n._emit("stop",i._id))}return n},mute:function(e,t){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(e,t)}}),n;if(void 0===t){if("boolean"!=typeof e)return n._muted;n._muted=e}for(var r=n._getSoundIds(t),o=0;o<r.length;o++){var a=n._soundById(r[o]);a&&(a._muted=e,a._interval&&n._stopFade(a._id),n._webAudio&&a._node?a._node.gain.setValueAtTime(e?0:a._volume,i.ctx.currentTime):a._node&&(a._node.muted=!!i._muted||e),n._emit("mute",a._id))}return n},volume:function(){var e,t,n,r=this,o=arguments;if(0===o.length)return r._volume;if(1===o.length||2===o.length&&void 0===o[1]){var a=r._getSoundIds(),s=a.indexOf(o[0]);s>=0?t=parseInt(o[0],10):e=parseFloat(o[0])}else o.length>=2&&(e=parseFloat(o[0]),t=parseInt(o[1],10));if(!(void 0!==e&&e>=0&&e<=1))return(n=t?r._soundById(t):r._sounds[0])?n._volume:0;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"volume",action:function(){r.volume.apply(r,o)}}),r;void 0===t&&(r._volume=e),t=r._getSoundIds(t);for(var u=0;u<t.length;u++)(n=r._soundById(t[u]))&&(n._volume=e,o[2]||r._stopFade(t[u]),r._webAudio&&n._node&&!n._muted?n._node.gain.setValueAtTime(e,i.ctx.currentTime):n._node&&!n._muted&&(n._node.volume=e*i.volume()),r._emit("volume",n._id));return r},fade:function(e,t,n,r){var o=this;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"fade",action:function(){o.fade(e,t,n,r)}}),o;e=parseFloat(e),t=parseFloat(t),n=parseFloat(n),o.volume(e,r);for(var a=o._getSoundIds(r),s=0;s<a.length;s++){var u=o._soundById(a[s]);if(u){if(r||o._stopFade(a[s]),o._webAudio&&!u._muted){var c=i.ctx.currentTime,l=c+n/1e3;u._volume=e,u._node.gain.setValueAtTime(e,c),u._node.gain.linearRampToValueAtTime(t,l)}o._startFadeInterval(u,e,t,n,a[s],void 0===r)}}return o},_startFadeInterval:function(e,t,n,r,o,i){var a=this,s=t,u=n-t,c=Math.abs(u/.01),l=Math.max(4,c>0?r/c:r),h=Date.now();e._fadeTo=n,e._interval=setInterval((function(){var o=(Date.now()-h)/r;h=Date.now(),s+=u*o,s=Math.max(0,s),s=Math.min(1,s),s=Math.round(100*s)/100,a._webAudio?e._volume=s:a.volume(s,e._id,!0),i&&(a._volume=s),(n<t&&s<=n||n>t&&s>=n)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,a.volume(n,e._id),a._emit("fade",e._id))}),l)},_stopFade:function(e){var t=this._soundById(e);return t&&t._interval&&(this._webAudio&&t._node.gain.cancelScheduledValues(i.ctx.currentTime),clearInterval(t._interval),t._interval=null,this.volume(t._fadeTo,e),t._fadeTo=null,this._emit("fade",e)),this},loop:function(){var e,t,n,r=this,o=arguments;if(0===o.length)return r._loop;if(1===o.length){if("boolean"!=typeof o[0])return!!(n=r._soundById(parseInt(o[0],10)))&&n._loop;e=o[0],r._loop=e}else 2===o.length&&(e=o[0],t=parseInt(o[1],10));for(var i=r._getSoundIds(t),a=0;a<i.length;a++)(n=r._soundById(i[a]))&&(n._loop=e,r._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=e,e&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop)));return r},rate:function(){var e,t,n,r=this,o=arguments;if(0===o.length)t=r._sounds[0]._id;else if(1===o.length){var a=r._getSoundIds(),s=a.indexOf(o[0]);s>=0?t=parseInt(o[0],10):e=parseFloat(o[0])}else 2===o.length&&(e=parseFloat(o[0]),t=parseInt(o[1],10));if("number"!=typeof e)return(n=r._soundById(t))?n._rate:r._rate;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"rate",action:function(){r.rate.apply(r,o)}}),r;void 0===t&&(r._rate=e),t=r._getSoundIds(t);for(var u=0;u<t.length;u++)if(n=r._soundById(t[u])){r.playing(t[u])&&(n._rateSeek=r.seek(t[u]),n._playStart=r._webAudio?i.ctx.currentTime:n._playStart),n._rate=e,r._webAudio&&n._node&&n._node.bufferSource?n._node.bufferSource.playbackRate.setValueAtTime(e,i.ctx.currentTime):n._node&&(n._node.playbackRate=e);var c=r.seek(t[u]),l=(r._sprite[n._sprite][0]+r._sprite[n._sprite][1])/1e3-c,h=1e3*l/Math.abs(n._rate);!r._endTimers[t[u]]&&n._paused||(r._clearTimer(t[u]),r._endTimers[t[u]]=setTimeout(r._ended.bind(r,n),h)),r._emit("rate",n._id)}return r},seek:function(){var e,t,n=this,r=arguments;if(0===r.length)t=n._sounds[0]._id;else if(1===r.length){var o=n._getSoundIds(),a=o.indexOf(r[0]);a>=0?t=parseInt(r[0],10):n._sounds.length&&(t=n._sounds[0]._id,e=parseFloat(r[0]))}else 2===r.length&&(e=parseFloat(r[0]),t=parseInt(r[1],10));if(void 0===t)return n;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"seek",action:function(){n.seek.apply(n,r)}}),n;var s=n._soundById(t);if(s){if(!("number"==typeof e&&e>=0)){if(n._webAudio){var u=n.playing(t)?i.ctx.currentTime-s._playStart:0,c=s._rateSeek?s._rateSeek-s._seek:0;return s._seek+(c+u*Math.abs(s._rate))}return s._node.currentTime}var l=n.playing(t);l&&n.pause(t,!0),s._seek=e,s._ended=!1,n._clearTimer(t),n._webAudio||!s._node||isNaN(s._node.duration)||(s._node.currentTime=e);var h=function(){n._emit("seek",t),l&&n.play(t,!0)};if(l&&!n._webAudio){var d=function(){n._playLock?setTimeout(d,0):h()};setTimeout(d,0)}else h()}return n},playing:function(e){if("number"==typeof e){var t=this._soundById(e);return!!t&&!t._paused}for(var n=0;n<this._sounds.length;n++)if(!this._sounds[n]._paused)return!0;return!1},duration:function(e){var t=this._duration,n=this._soundById(e);return n&&(t=this._sprite[n._sprite][1]/1e3),t},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,n=0;n<t.length;n++)t[n]._paused||e.stop(t[n]._id),e._webAudio||(e._clearSound(t[n]._node),t[n]._node.removeEventListener("error",t[n]._errorFn,!1),t[n]._node.removeEventListener(i._canPlayEvent,t[n]._loadFn,!1),i._releaseHtml5Audio(t[n]._node)),delete t[n]._node,e._clearTimer(t[n]._id);var r=i._howls.indexOf(e);r>=0&&i._howls.splice(r,1);var o=!0;for(n=0;n<i._howls.length;n++)if(i._howls[n]._src===e._src||e._src.indexOf(i._howls[n]._src)>=0){o=!1;break}return u&&o&&delete u[e._src],i.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,n,r){var o=this["_on"+e];return"function"==typeof t&&o.push(r?{id:n,fn:t,once:r}:{id:n,fn:t}),this},off:function(e,t,n){var r=this["_on"+e],o=0;if("number"==typeof t&&(n=t,t=null),t||n)for(o=0;o<r.length;o++){var i=n===r[o].id;if(t===r[o].fn&&i||!t&&i){r.splice(o,1);break}}else if(e)this["_on"+e]=[];else{var a=Object.keys(this);for(o=0;o<a.length;o++)0===a[o].indexOf("_on")&&Array.isArray(this[a[o]])&&(this[a[o]]=[])}return this},once:function(e,t,n){return this.on(e,t,n,1),this},_emit:function(e,t,n){for(var r=this["_on"+e],o=r.length-1;o>=0;o--)r[o].id&&r[o].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,n)}.bind(this,r[o].fn),0),r[o].once&&this.off(e,r[o].fn,r[o].id));return this._loadQueue(e),this},_loadQueue:function(e){if(this._queue.length>0){var t=this._queue[0];t.event===e&&(this._queue.shift(),this._loadQueue()),e||t.action()}return this},_ended:function(e){var t=e._sprite;if(!this._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(this._ended.bind(this,e),100),this;var n=!(!e._loop&&!this._sprite[t][2]);if(this._emit("end",e._id),!this._webAudio&&n&&this.stop(e._id,!0).play(e._id),this._webAudio&&n){this._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=i.ctx.currentTime;var r=1e3*(e._stop-e._start)/Math.abs(e._rate);this._endTimers[e._id]=setTimeout(this._ended.bind(this,e),r)}return this._webAudio&&!n&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,this._clearTimer(e._id),this._cleanBuffer(e._node),i._autoSuspend()),this._webAudio||n||this.stop(e._id,!0),this},_clearTimer:function(e){if(this._endTimers[e]){if("function"!=typeof this._endTimers[e])clearTimeout(this._endTimers[e]);else{var t=this._soundById(e);t&&t._node&&t._node.removeEventListener("ended",this._endTimers[e],!1)}delete this._endTimers[e]}return this},_soundById:function(e){for(var t=0;t<this._sounds.length;t++)if(e===this._sounds[t]._id)return this._sounds[t];return null},_inactiveSound:function(){this._drain();for(var e=0;e<this._sounds.length;e++)if(this._sounds[e]._ended)return this._sounds[e].reset();return new s(this)},_drain:function(){var e=this._pool,t=0,n=0;if(!(this._sounds.length<e)){for(n=0;n<this._sounds.length;n++)this._sounds[n]._ended&&t++;for(n=this._sounds.length-1;n>=0;n--){if(t<=e)return;this._sounds[n]._ended&&(this._webAudio&&this._sounds[n]._node&&this._sounds[n]._node.disconnect(0),this._sounds.splice(n,1),t--)}}},_getSoundIds:function(e){if(void 0===e){for(var t=[],n=0;n<this._sounds.length;n++)t.push(this._sounds[n]._id);return t}return[e]},_refreshBuffer:function(e){return e._node.bufferSource=i.ctx.createBufferSource(),e._node.bufferSource.buffer=u[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,i.ctx.currentTime),this},_cleanBuffer:function(e){var t=i._navigator&&i._navigator.vendor.indexOf("Apple")>=0;if(i._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),t))try{e.bufferSource.buffer=i._scratchBuffer}catch(e){}return e.bufferSource=null,this},_clearSound:function(e){/MSIE |Trident\//.test(i._navigator&&i._navigator.userAgent)||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var s=function(e){this._parent=e,this.init()};s.prototype={init:function(){var e=this._parent;return this._muted=e._muted,this._loop=e._loop,this._volume=e._volume,this._rate=e._rate,this._seek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++i._counter,e._sounds.push(this),this.create(),this},create:function(){var e=this._parent,t=i._muted||this._muted||this._parent._muted?0:this._volume;return e._webAudio?(this._node=void 0===i.ctx.createGain?i.ctx.createGainNode():i.ctx.createGain(),this._node.gain.setValueAtTime(t,i.ctx.currentTime),this._node.paused=!0,this._node.connect(i.masterGain)):i.noAudio||(this._node=i._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(i._canPlayEvent,this._loadFn,!1),this._node.src=e._src,this._node.preload="auto",this._node.volume=t*i.volume(),this._node.load()),this},reset:function(){var e=this._parent;return this._muted=e._muted,this._loop=e._loop,this._volume=e._volume,this._rate=e._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++i._counter,this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0),this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var e=this._parent;e._duration=Math.ceil(10*this._node.duration)/10,0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue()),this._node.removeEventListener(i._canPlayEvent,this._loadFn,!1)}};var u={},c=function(e){var t=e._src;if(u[t])return e._duration=u[t].duration,void d(e);if(/^data:[^;]+;base64,/.test(t)){for(var n=atob(t.split(",")[1]),r=new Uint8Array(n.length),o=0;o<n.length;++o)r[o]=n.charCodeAt(o);h(r.buffer,e)}else{var i=new XMLHttpRequest;i.open("GET",t,!0),i.withCredentials=e._xhrWithCredentials,i.responseType="arraybuffer",i.onload=function(){var t=(i.status+"")[0];"0"===t||"2"===t||"3"===t?h(i.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+i.status+".")},i.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete u[t],e.load())},l(i)}},l=function(e){try{e.send()}catch(t){e.onerror()}},h=function(e,t){var n=function(){t._emit("loaderror",null,"Decoding audio data failed.")},r=function(e){e&&t._sounds.length>0?(u[t._src]=e,d(t,e)):n()};"undefined"!=typeof Promise&&1===i.ctx.decodeAudioData.length?i.ctx.decodeAudioData(e).then(r).catch(n):i.ctx.decodeAudioData(e,r,n)},d=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},f=function(){if(i.usingWebAudio){try{"undefined"!=typeof AudioContext?i.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?i.ctx=new webkitAudioContext:i.usingWebAudio=!1}catch(e){i.usingWebAudio=!1}i.ctx||(i.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(i._navigator&&i._navigator.platform),t=i._navigator&&i._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=t?parseInt(t[1],10):null;if(e&&n&&n<9){var r=/safari/.test(i._navigator&&i._navigator.userAgent.toLowerCase());(i._navigator&&i._navigator.standalone&&!r||i._navigator&&!i._navigator.standalone&&!r)&&(i.usingWebAudio=!1)}i.usingWebAudio&&(i.masterGain=void 0===i.ctx.createGain?i.ctx.createGainNode():i.ctx.createGain(),i.masterGain.gain.setValueAtTime(i._muted?0:i._volume,i.ctx.currentTime),i.masterGain.connect(i.ctx.destination)),i._setup()}};void 0===(r=function(){return{Howler:i,Howl:a}}.apply(t,[]))||(e.exports=r),t.Howler=i,t.Howl=a,"undefined"!=typeof window?(window.HowlerGlobal=o,window.Howler=i,window.Howl=a,window.Sound=s):void 0!==n&&(n.HowlerGlobal=o,n.Howler=i,n.Howl=a,n.Sound=s)}(),
/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.1.3
 *  howlerjs.com
 *
 *  (c) 2013-2019, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
function(){"use strict";var e;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){if(!this.ctx||!this.ctx.listener)return this;for(var t=this._howls.length-1;t>=0;t--)this._howls[t].stereo(e);return this},HowlerGlobal.prototype.pos=function(e,t,n){return this.ctx&&this.ctx.listener?(t="number"!=typeof t?this._pos[1]:t,n="number"!=typeof n?this._pos[2]:n,"number"!=typeof e?this._pos:(this._pos=[e,t,n],void 0!==this.ctx.listener.positionX?(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this)):this},HowlerGlobal.prototype.orientation=function(e,t,n,r,o,i){if(!this.ctx||!this.ctx.listener)return this;var a=this._orientation;return t="number"!=typeof t?a[1]:t,n="number"!=typeof n?a[2]:n,r="number"!=typeof r?a[3]:r,o="number"!=typeof o?a[4]:o,i="number"!=typeof i?a[5]:i,"number"!=typeof e?a:(this._orientation=[e,t,n,r,o,i],void 0!==this.ctx.listener.forwardX?(this.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(r,Howler.ctx.currentTime,.1),this.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(i,Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(e,t,n,r,o,i),this)},Howl.prototype.init=(e=Howl.prototype.init,function(t){return this._orientation=t.orientation||[1,0,0],this._stereo=t.stereo||null,this._pos=t.pos||null,this._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},this._onstereo=t.onstereo?[{fn:t.onstereo}]:[],this._onpos=t.onpos?[{fn:t.onpos}]:[],this._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}),Howl.prototype.stereo=function(e,n){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"stereo",action:function(){r.stereo(e,n)}}),r;var o=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===n){if("number"!=typeof e)return r._stereo;r._stereo=e,r._pos=[e,0,0]}for(var i=r._getSoundIds(n),a=0;a<i.length;a++){var s=r._soundById(i[a]);if(s){if("number"!=typeof e)return s._stereo;s._stereo=e,s._pos=[e,0,0],s._node&&(s._pannerAttr.panningModel="equalpower",s._panner&&s._panner.pan||t(s,o),"spatial"===o?void 0!==s._panner.positionX?(s._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),s._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),s._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):s._panner.setPosition(e,0,0):s._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),r._emit("stereo",s._id)}}return r},Howl.prototype.pos=function(e,n,r,o){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"pos",action:function(){i.pos(e,n,r,o)}}),i;if(n="number"!=typeof n?0:n,r="number"!=typeof r?-.5:r,void 0===o){if("number"!=typeof e)return i._pos;i._pos=[e,n,r]}for(var a=i._getSoundIds(o),s=0;s<a.length;s++){var u=i._soundById(a[s]);if(u){if("number"!=typeof e)return u._pos;u._pos=[e,n,r],u._node&&(u._panner&&!u._panner.pan||t(u,"spatial"),void 0!==u._panner.positionX?(u._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),u._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),u._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):u._panner.setPosition(e,n,r)),i._emit("pos",u._id)}}return i},Howl.prototype.orientation=function(e,n,r,o){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"orientation",action:function(){i.orientation(e,n,r,o)}}),i;if(n="number"!=typeof n?i._orientation[1]:n,r="number"!=typeof r?i._orientation[2]:r,void 0===o){if("number"!=typeof e)return i._orientation;i._orientation=[e,n,r]}for(var a=i._getSoundIds(o),s=0;s<a.length;s++){var u=i._soundById(a[s]);if(u){if("number"!=typeof e)return u._orientation;u._orientation=[e,n,r],u._node&&(u._panner||(u._pos||(u._pos=i._pos||[0,0,-.5]),t(u,"spatial")),void 0!==u._panner.orientationX?(u._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),u._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),u._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):u._panner.setOrientation(e,n,r)),i._emit("orientation",u._id)}}return i},Howl.prototype.pannerAttr=function(){var e,n,r,o=this,i=arguments;if(!o._webAudio)return o;if(0===i.length)return o._pannerAttr;if(1===i.length){if("object"!=typeof i[0])return(r=o._soundById(parseInt(i[0],10)))?r._pannerAttr:o._pannerAttr;e=i[0],void 0===n&&(e.pannerAttr||(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),o._pannerAttr={coneInnerAngle:void 0!==e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:o._coneInnerAngle,coneOuterAngle:void 0!==e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:o._coneOuterAngle,coneOuterGain:void 0!==e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:o._coneOuterGain,distanceModel:void 0!==e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:o._distanceModel,maxDistance:void 0!==e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:o._maxDistance,refDistance:void 0!==e.pannerAttr.refDistance?e.pannerAttr.refDistance:o._refDistance,rolloffFactor:void 0!==e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:o._rolloffFactor,panningModel:void 0!==e.pannerAttr.panningModel?e.pannerAttr.panningModel:o._panningModel})}else 2===i.length&&(e=i[0],n=parseInt(i[1],10));for(var a=o._getSoundIds(n),s=0;s<a.length;s++)if(r=o._soundById(a[s])){var u=r._pannerAttr;u={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:u.coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:u.coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:u.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:u.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:u.maxDistance,refDistance:void 0!==e.refDistance?e.refDistance:u.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:u.rolloffFactor,panningModel:void 0!==e.panningModel?e.panningModel:u.panningModel};var c=r._panner;c?(c.coneInnerAngle=u.coneInnerAngle,c.coneOuterAngle=u.coneOuterAngle,c.coneOuterGain=u.coneOuterGain,c.distanceModel=u.distanceModel,c.maxDistance=u.maxDistance,c.refDistance=u.refDistance,c.rolloffFactor=u.rolloffFactor,c.panningModel=u.panningModel):(r._pos||(r._pos=o._pos||[0,0,-.5]),t(r,"spatial"))}return o},Sound.prototype.init=function(e){return function(){var t=this._parent;this._orientation=t._orientation,this._stereo=t._stereo,this._pos=t._pos,this._pannerAttr=t._pannerAttr,e.call(this),this._stereo?t.stereo(this._stereo):this._pos&&t.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this._parent;return this._orientation=t._orientation,this._stereo=t._stereo,this._pos=t._pos,this._pannerAttr=t._pannerAttr,this._stereo?t.stereo(this._stereo):this._pos?t.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,t._refreshBuffer(this)),e.call(this)}}(Sound.prototype.reset);var t=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}()}).call(this,n(110))},function(e,t,n){"use strict";n.d(t,"a",(function(){return Ht}));var r=n(321),o=n(166).EventEmitter;function i(e,t){t=t||{},this._noa=e,this.element=t.domElement||function(){var e=document.createElement("div");return e.tabindex=1,e.style.position="fixed",e.style.left="0px",e.style.right="0px",e.style.top="0px",e.style.bottom="0px",e.style.height="100%",e.style.overflow="hidden",document.body.appendChild(e),document.body.style.overflow="hidden",document.body.style.height="100%",e.id="noa-container",e}(),this.canvas=function(e){var t=e.querySelector("canvas");t||((t=document.createElement("canvas")).style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.height="100%",t.style.width="100%",t.id="noa-canvas",e.insertBefore(t,e.firstChild));return t}(this.element),this._shell=function(e,t){(t=Object.assign({pointerLock:!0,preventDefaults:!1},t)).element=e;var n=r(t);return n.preventDefaults=t.preventDefaults,n}(this.canvas,t),this.hasPointerLock=!1,this.supportsPointerLock=!1,this.pointerInGame=!1,this.isFocused=document.hasFocus();var n=this,o=function(e){!function(e,t){var n=document.pointerLockElement||document.mozPointerLockElement||document.webkitPointerLockElement;n?(e.hasPointerLock=!0,e.emit("gainedPointerLock")):(e.hasPointerLock=!1,e.emit("lostPointerLock"));n&&(e.pointerInGame=!0)}(n)};document.addEventListener("pointerlockchange",o,!1),document.addEventListener("mozpointerlockchange",o,!1),document.addEventListener("webkitpointerlockchange",o,!1),function(e){if("pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document){e.supportsPointerLock=!0;var t=function(n){e.supportsPointerLock=!1,document.removeEventListener(n.type,t)};document.addEventListener("touchmove",t)}}(n),n.element.addEventListener("mouseenter",(function(){n.pointerInGame=!0})),n.element.addEventListener("mouseleave",(function(){n.pointerInGame=!1})),window.addEventListener("focus",(function(){n.isFocused=!0})),window.addEventListener("blur",(function(){n.isFocused=!1})),this._shell.on("init",a.bind(null,this))}function a(e){var t=e._noa,n=e._shell;n.on("tick",(function(e){t.tick(e)})),n.on("render",(function(e){t.render(e)})),n.on("resize",t.rendering.resize.bind(t.rendering)),e.emit("DOMready")}function s(e,t){var n=e.indexOf(t);n<0||(n===e.length-1?e.pop():e[n]=e.pop())}function u(e,t,n){for(var r=(n||performance.now())+e,o=0;o<1e3;o++){if(t()||performance.now()>r)return}}i.prototype=Object.create(o.prototype),i.prototype.appendTo=function(e){this.element.appendChild(e)},i.prototype.setPointerLock=function(e){this._shell.pointerLock=!!e};var c=0,l=0;function h(e,t,n,r,o){e?function(e,t,n,r,o,i,a,s,u,c,l){for(var h=0;h<i;h++)for(var d=0;d<a;d++)for(var f=e.index(n+h,r+d,o),p=t.index(u+h,c+d,l),m=0;m<s;m++)t.data[p]=e.data[f],f+=e.stride[2],p+=t.stride[2]}(e,t,n[0],n[1],n[2],r[0],r[1],r[2],o[0],o[1],o[2]):function(e,t,n,r,o,i,a){for(var s=0;s<o;s++)for(var u=0;u<i;u++)for(var c=e.index(t+s,n+u,r),l=0;l<a;l++)e.data[c]=0,c+=e.stride[2]}(t,o[0],o[1],o[2],r[0],r[1],r[2])}function d(){this.arr=[],this.hash={}}d.prototype.includes=function(e){return this.hash[e]},d.prototype.add=function(e){this.hash[e]||(this.arr.push(e),this.hash[e]=!0)},d.prototype.remove=function(e){this.hash[e]&&(this.arr.splice(this.arr.indexOf(e),1),delete this.hash[e])},d.prototype.count=function(){return this.arr.length},d.prototype.forEach=function(e,t){return this.arr.forEach(e,t)},d.prototype.slice=function(e,t){return this.arr.slice(e,t)},d.prototype.isEmpty=function(){return 0===this.arr.length},d.prototype.empty=function(){this.arr.length=0,this.hash={}},d.prototype.pop=function(){var e=this.arr.pop();return delete this.hash[e],e},d.prototype.sort=function(e){var t={};this.arr.forEach(n=>{t[n]=e(n)}),this.arr.sort((e,n)=>t[n]-t[e])},d.prototype.copyFrom=function(e){this.arr=e.arr.slice(),this.hash=Object.assign({},e.hash)};var f=n(17),p=n(57),m=n(117),v=n(152),_=n(10),g=n(92),y=n(33),b=n(30),w=n(4),k=n(226),x=(n(190),n(82)),A={showFPS:!1,antiAlias:!0,clearColor:[.8,.9,1],ambientColor:[1,1,1],lightDiffuse:[1,1,1],lightSpecular:[1,1,1],groundLightColor:[.5,.5,.5],useAO:!0,AOmultipliers:[.93,.8,.5],reverseAOmultiplier:1,preserveDrawingBuffer:!0};function T(e,t,n){this.noa=e,t=Object.assign({},A,t),this.useAO=!!t.useAO,this.aoVals=t.AOmultipliers,this.revAoVal=t.reverseAOmultiplier,this.meshingCutoffTime=6,this._resizeDebounce=250,function(e,t,n){e._engine=new _.a(t,n.antiAlias,{preserveDrawingBuffer:n.preserveDrawingBuffer}),e._scene=new f.a(e._engine);var r=e._scene;r.detachControl(),r._addComponent(new k.c(r)),e._octree=new m.a(e=>{}),e._octree.blocks=[],r._selectionOctree=e._octree,e._cameraHolder=new w.a("camHolder",r),e._camera=new p.a("camera",new b.y(0,0,0),r),e._camera.parent=e._cameraHolder,e._camera.minZ=.01,e._cameraHolder.visibility=!1,e._camScreen=w.a.CreatePlane("camScreen",10,r),e.addMeshToScene(e._camScreen),e._camScreen.position.z=.1,e._camScreen.parent=e._camera,e._camScreenMat=e.makeStandardMaterial("camscreenmat"),e._camScreen.material=e._camScreenMat,e._camScreen.setEnabled(!1),e._camLocBlock=0;var o=new b.y(.1,1,.3);function i(e){return new b.e(e[0],e[1],e[2])}e._light=new g.a("light",o,r),r.clearColor=i(n.clearColor),r.ambientColor=i(n.ambientColor),e._light.diffuse=i(n.lightDiffuse),e._light.specular=i(n.lightSpecular),e._light.groundColor=i(n.groundLightColor),e.flatMaterial=e.makeStandardMaterial("flatmat")}(this,n,t),t.showFPS&&function(){var e=document.createElement("div");e.id="noa_fps";"color:white; background-color:rgba(0,0,0,0.5);","font:14px monospace; text-align:center;","min-width:2em; margin:4px;",e.style="position:absolute; top:0; right:0; z-index:0;color:white; background-color:rgba(0,0,0,0.5);font:14px monospace; text-align:center;min-width:2em; margin:4px;",document.body.appendChild(e);var t=0,n=0,r=performance.now(),o=r;P=function(){t++;var i=performance.now();if(i-o>n&&(n=i-o),o=i,!(i-r<1e3)){var a=Math.round(t/(i-r)*1e3),s=Math.round(1/n*1e3);e.innerHTML=a+"<br>"+s,t=0,n=0,r=i}}}()}T.prototype.getScene=function(){return this._scene},T.prototype.tick=function(e){},T.prototype.render=function(e){C("start"),function(e){var t=e.noa.camera,n=t._localGetTargetPosition();e._cameraHolder.position.copyFromFloats(n[0],n[1],n[2]),e._cameraHolder.rotation.x=t.pitch,e._cameraHolder.rotation.y=t.heading,e._camera.position.z=-t.currentZoom;var r=t._localGetPosition(),o=e.noa.worldOriginOffset,i=Math.floor(r[0]+o[0]),a=Math.floor(r[1]+o[1]),s=Math.floor(r[2]+o[2]),u=e.noa.getBlock(i,a,s);!function(e,t){if(t===e._camLocBlock)return;if(0===t)e._camScreen.setEnabled(!1);else{var n=e.noa.registry.getBlockFaceMaterial(t,0);if(n){var r=e.noa.registry.getMaterialData(n),o=r.color,i=r.alpha;o&&i&&i<1&&(e._camScreenMat.diffuseColor.set(0,0,0),e._camScreenMat.ambientColor.set(o[0],o[1],o[2]),e._camScreenMat.alpha=i,e._camScreen.setEnabled(!0))}}e._camLocBlock=t}(e,u)}(this),C("updateCamera"),this._engine.beginFrame(),C("beginFrame"),this._scene.render(),C("render"),P(),this._engine.endFrame(),C("endFrame"),C("end")},T.prototype.resize=function(e){M||(M=!0,setTimeout(()=>{this._engine.resize(),M=!1},this._resizeDebounce))};var M=!1;T.prototype.highlightBlockFace=function(e,t,n){var r=function(e){var t=e._highlightMesh;if(!t){t=w.a.CreatePlane("highlight",1,e._scene);var n=e.makeStandardMaterial("highlightMat");n.backFaceCulling=!1,n.emissiveColor=new b.e(1,1,1),n.alpha=.2,t.material=n;var r=.5,o=w.a.CreateLines("hightlightLines",[new b.y(r,r,0),new b.y(r,-r,0),new b.y(-r,-r,0),new b.y(-r,r,0),new b.y(r,r,0)],e._scene);o.color=new b.e(1,1,1),o.parent=t,e.addMeshToScene(t),e.addMeshToScene(o),e._highlightMesh=t}return t}(this);if(e){this.noa.globalToLocal(t,null,E);for(var o=.001+.001*x.dist(this.noa.camera._localGetPosition(),E),i=0;i<3;i++)0===n[i]?E[i]+=.5:E[i]+=n[i]>0?1+o:-o;r.position.copyFromFloats(E[0],E[1],E[2]),r.rotation.x=n[1]?Math.PI/2:0,r.rotation.y=n[0]?Math.PI/2:0}r.setEnabled(e)};var E=[];T.prototype.addMeshToScene=function(e,t,n,r){if(!e._noaContainingChunk&&!this._octree.dynamicContent.includes(e)){if(!e.parent){n||(n=[e.position.x,e.position.y,e.position.z]);var o=[];this.noa.globalToLocal(n,null,o),e.position.copyFromFloats(o[0],o[1],o[2])}var i=!1;if(t){var a=r||this.noa.world._getChunkByCoords(n[0],n[1],n[2]);i=!(!a||!a.octreeBlock)}i?(a.octreeBlock.entries.push(e),e._noaContainingChunk=a):this._octree.dynamicContent.push(e),t&&(e.freezeWorldMatrix(),e.freezeNormals());var s=this.removeMeshFromScene.bind(this,e);e.onDisposeObservable.add(s)}},T.prototype.removeMeshFromScene=function(e){e._noaContainingChunk&&e._noaContainingChunk.octreeBlock&&s(e._noaContainingChunk.octreeBlock.entries,e),e._noaContainingChunk=null,s(this._octree.dynamicContent,e)},T.prototype.makeStandardMaterial=function(e){var t=new y.a(e,this._scene);return t.specularColor.copyFromFloats(0,0,0),t.ambientColor.copyFromFloats(1,1,1),t.diffuseColor.copyFromFloats(1,1,1),t},T.prototype.prepareChunkForRendering=function(e){var t=e.size,n=[];this.noa.globalToLocal([e.x,e.y,e.z],null,n);var r=new b.y(n[0],n[1],n[2]),o=new b.y(n[0]+t,n[1]+t,n[2]+t);e.octreeBlock=new v.a(r,o,void 0,void 0,void 0,e=>{}),this._octree.blocks.push(e.octreeBlock)},T.prototype.disposeChunkForRendering=function(e){e.octreeBlock&&(s(this._octree.blocks,e.octreeBlock),e.octreeBlock.entries.length=0,e.octreeBlock=null)},T.prototype._rebaseOrigin=function(e){var t=new b.y(e[0],e[1],e[2]);this._scene.meshes.forEach(e=>{e.parent||(e.position.subtractInPlace(t),e._isWorldMatrixFrozen&&e.markAsDirty())}),this._octree.blocks.forEach(e=>{e.minPoint.subtractInPlace(t),e.maxPoint.subtractInPlace(t),e._boundingVectors.forEach(e=>{e.subtractInPlace(t)})})},T.prototype.debug_SceneCheck=function(){var e=this._scene.meshes,t=this._octree.dynamicContent,n=[],r=0,o=this._scene.materials,i=[];o.forEach(e=>{e.subMaterials?e.subMaterials.forEach(e=>i.push(e)):i.push(e)}),this._octree.blocks.forEach((function(e){r++,e.entries.forEach(e=>n.push(e))})),e.forEach((function(e){(e._isDisposed&&u(e,"disposed mesh in scene"),0!==e.getIndices().length)&&(c(e,t,n)&&u(e,"non-empty mesh missing from octree"),e.material?(e.material.subMaterials||[e.material]).forEach((function(e){c(e,o)&&u(e,"mesh material not in scene")})):u(e,"non-empty scene mesh with no material"))}));var a=[];i.forEach(t=>{var n=!1;e.forEach(e=>{e.material===t&&(n=!0),e.material&&e.material.subMaterials&&e.material.subMaterials.includes(t)&&(n=!0)}),n||a.push(t.name)}),a.length&&console.warn("Materials unused by any mesh: ",a.join(", ")),t.forEach((function(t){c(t,e)&&u(t,"octree/dynamic mesh not in scene")})),n.forEach((function(t){c(t,e)&&u(t,"octree block mesh not in scene")}));var s=Math.round(10*n.length/r)/10;function u(e,t){console.warn(e.name+" --- "+t)}function c(e,t,n){return!!e&&(!t.includes(e)&&(!n||!n.includes(e)))}return console.log("meshes - octree:",n.length,"  dynamic:",t.length,"   avg meshes/octreeBlock:",s),"done."},T.prototype.debug_MeshCount=function(){var e={};for(var t in this._scene.meshes.forEach(t=>{var n=t.name||"";n=(n=(n=(n=n.replace(/-\d+.*/,"#")).replace(/\d+.*/,"#")).replace(/(rotHolder|camHolder|camScreen)/,"rendering use")).replace(/atlas sprite .*/,"atlas sprites"),e[n]=e[n]||0,e[n]++}),e)console.log("   "+(e[t]+"       ").substr(0,7)+t)};var C=()=>{},P=function(){};var I=n(172),S=n.n(I),B=n(60),D=n(15),O=n(78),L=n(8),j=13,F=1<<j++,R=1<<j++,z=1<<j++,U={ID_MASK:511,VAR_MASK:7680};U.SOLID_BIT=F,U.OPAQUE_BIT=R,U.OBJECT_BIT=z;var N=new function(){var e=new X,t=new V;this.meshChunk=function(n,r,o,i,a,s,u){W("start");var c=n.noa,l=r||c.registry.getBlockFaceMaterial,d=o||c.registry._getMaterialVertexColor,f=void 0===a?c.rendering.useAO:a,p=s||c.rendering.aoVals,m=isNaN(u)?c.rendering.revAoVal:u,v=function(e){var t=e.voxels.shape[0],n=H;if(t+2!==n.shape[0]){var r=t+2;n=new S.a(new Uint16Array(r*r*r),[r,r,r]),H=n}var o=G[0],i=G[1],a=G[2],s=G[3],u=G[4],c=G[5],l=G[6];t!==Y&&(Y=t,function(e,t,n,r){for(var o=0;o<3;o++)t[o]=[e-1,0,0][o],n[o]=[1,e,1][o],r[o]=[0,1,e+1][o]}(t,u,c,l));for(var d=0;d<3;d++){o[0]=d;for(var f=0;f<3;f++){o[1]=f;for(var p=0;p<3;p++){o[2]=p,o.forEach((e,t)=>{i[t]=u[e],a[t]=c[e],s[t]=l[e]});var m=e._neighbors.get(d-1,f-1,p-1);h(m?m.voxels:null,n,i,a,s)}}}return n}(n);W("copy");var _,g=n.isFull||n.isEmpty,y=e.mesh(v,l,d,f,p,m,g);return Object.keys(y).length&&(_=t.build(n,y,i),W("terrain")),W("end"),_||null}};var Y,H=new S.a(new Uint16Array(27),[3,3,3]),G=Array.from(Array(10)).map(e=>[0,0,0]);function q(e){this.id=0|e,this.positions=[],this.indices=[],this.normals=[],this.colors=[],this.uvs=[]}function V(){var e;function t(e,t){for(var n,r=[],o=[],i=[],a=Object.keys(e),s=null,u=0;u<a.length;++u){var c=e[a[u]];if(t(c))if(r.push(c.positions.length),o.push(c.indices.length),i.push(c.id),s){var l=s.positions.length/3;s.positions=s.positions.concat(c.positions),s.normals=s.normals.concat(c.normals),s.colors=s.colors.concat(c.colors),s.uvs=s.uvs.concat(c.uvs);for(var h=0,d=c.indices.length;h<d;++h)s.indices.push(c.indices[h]+l);c.dispose(),delete e[a[u]]}else s=c,n=a[u]}return{mergedID:n,vertices:r,indices:o,matIDs:i}}this.build=function(r,o,i){e=r.noa;t(o,(function(t){if(i)return!0;if(t.renderMat)return!1;var n=e.registry.getMaterialTexture(t.id),r=e.registry.getMaterialData(t.id).alpha;return!(n||r<1)&&void 0}));var a=t(o,()=>!0);return function(t,n,r,o,i){var a=e.rendering.getScene(),s=new w.a(n,a),u=new D.a;if(u.positions=t.positions,u.indices=t.indices,u.normals=t.normals,u.colors=t.colors,u.uvs=t.uvs,u.applyToMesh(s),t.dispose(),1===r.length)s.material=r[0];else{var c=new O.a("multimat "+n,a);s.subMeshes=[];for(var l=0,h=0,d=0;d<r.length;d++){c.subMaterials[d]=r[d];var f=new B.b(d,l,o[d],h,i[d],s);s.subMeshes[d]=f,l+=o[d],h+=i[d]}s.material=c}return s}(o[a.mergedID],"chunk_"+r.id,a.matIDs.map(t=>function(t,r){if(r)return e.rendering.flatMaterial;var o="terrain mat "+t;n[o]||(n[o]=function(t){var n=e.registry.getMaterialData(t);if(n.renderMat)return n.renderMat;var r=e.registry.getMaterialTexture(t),o=n.alpha;if(!r&&1==o)return e.rendering.flatMaterial;var i=e.rendering.flatMaterial.clone("terrain"+t);if(r){var a=e.rendering.getScene(),s=new L.a(r,a,!0,!1,L.a.NEAREST_SAMPLINGMODE);n.textureAlpha&&(s.hasAlpha=!0),i.diffuseTexture=s}n.alpha<1&&(i.alpha=n.alpha);return i}(t));return n[o]}(t,i)),a.vertices,a.indices)};var n={}}function X(){var e=U.ID_MASK,t=U.SOLID_BIT,n=U.OPAQUE_BIT,r=U.OBJECT_BIT,o=new Int16Array(16),i=new Uint16Array(16);function a(t,n,r,a,u){for(var c=r.shape[1],l=o,h=i,d=0,f=r.data,p=r.index(t-1,0,0),m=r.stride[0],v=r.stride[1],_=r.stride[2],g=0;g<c;++g){var y=p;p+=_;for(var b=0;b<c;b++,d++,y+=v){var w=f[y],k=f[y+m],x=s(w,k);if(x&&(l[d]=x>0?a(w&e,2*n):-a(k&e,2*n+1),u)){var A=x>0?t:t-1,T=x>0?t-1:t;h[d]=u(r,A,T,b,g)}}}}function s(e,t){if(e===t)return 0;var o=e&n,i=t&n;return o&&i?0:o?1:i?-1:0===t||t&r?1:0===e||e&r?-1:0}function u(e,t,n,r,a,s,u,f,p,m,v){for(var _=0,g=o,y=i,b=u?c:l,w=u?d:h,k=0;k<s;++k)for(var x=1,A=1,T=0;T<a;T+=x,_+=x){var M=0|g[_];if(M){var E=0|y[_];for(x=1;x<a-T&&b(_+x,g,M,y,E);++x);e:for(A=1;A<s-k;++A)for(var C=0;C<x;++C){if(!b(_+C+A*a,g,M,y,E))break e}var P=Math.abs(M);f[P]||(f[P]=new q(P));var I=f[P],S=w(I.colors,p(P),E,m,v),B=[0,0,0];B[t]=e,B[n]=T,B[r]=k;var D=[0,0,0],O=[0,0,0];D[n]=x,O[r]=A;var L=I.positions;L.push(B[0],B[1],B[2],B[0]+D[0],B[1]+D[1],B[2]+D[2],B[0]+D[0]+O[0],B[1]+D[1]+O[1],B[2]+D[2]+O[2],B[0]+O[0],B[1]+O[1],B[2]+O[2]);var j=M>0?1:-1;2===t?I.uvs.push(0,A,-j*x,A,-j*x,0,0,0):I.uvs.push(0,x,0,0,j*A,0,j*A,x);var F=L.length/3-4;M<0?S?I.indices.push(F,F+1,F+2,F,F+2,F+3):I.indices.push(F+1,F+2,F+3,F,F+1,F+3):S?I.indices.push(F,F+2,F+1,F,F+3,F+2):I.indices.push(F+3,F+1,F,F+3,F+2,F+1);var R=0===t?j:0,z=1===t?j:0,U=2===t?j:0;I.normals.push(R,z,U,R,z,U,R,z,U,R,z,U);for(var N=0;N<A;++N)for(var Y=0;Y<x;++Y)g[_+Y+N*a]=0}else x=1}}function c(e,t,n,r,o){return n===t[e]&&o===r[e]}function l(e,t,n,r,o){return n===t[e]}function h(e,t,n,r,o){return e.push(t[0],t[1],t[2],1),e.push(t[0],t[1],t[2],1),e.push(t[0],t[1],t[2],1),e.push(t[0],t[1],t[2],1),!0}function d(e,t,n,r,o){var i=m(n,0,0),a=m(n,1,0),s=m(n,1,1),u=m(n,0,1);v(e,t,i,r,o),v(e,t,a,r,o),v(e,t,s,r,o),v(e,t,u,r,o);return i===s?u!==a||2==u:u!==a&&i+s>u+a}function f(e,n,r,o,i){var a=1,s=1,u=1,c=1,l=t,h=l&e.get(n,o,i);return e.get(n,o+1,i)&l&&(++u,++c),e.get(n,o-1,i)&l&&(++a,++s),e.get(n,o,i+1)&l&&(++s,++c),e.get(n,o,i-1)&l&&(++a,++u),h?(c=3==c||e.get(n,o+1,i+1)&l?3:2,s=3==s||e.get(n,o-1,i+1)&l?3:2,u=3==u||e.get(n,o+1,i-1)&l?3:2,a=3==a||e.get(n,o-1,i-1)&l?3:2):(1===c&&e.get(n,o+1,i+1)&l&&(c=2),1===s&&e.get(n,o-1,i+1)&l&&(s=2),1===u&&e.get(n,o+1,i-1)&l&&(u=2),1===a&&e.get(n,o-1,i-1)&l&&(a=2)),c<<6|u<<4|s<<2|a}function p(e,n,r,o,i){var a=1,s=1,u=1,c=1,l=t,h=l&e.get(n,o,i);return e.get(n,o+1,i)&l&&(++u,++c),e.get(n,o-1,i)&l&&(++a,++s),e.get(n,o,i+1)&l&&(++s,++c),e.get(n,o,i-1)&l&&(++a,++u),h?(c=3==c||e.get(n,o+1,i+1)&l?3:2,s=3==s||e.get(n,o-1,i+1)&l?3:2,u=3==u||e.get(n,o+1,i-1)&l?3:2,a=3==a||e.get(n,o-1,i-1)&l?3:2):(1===c&&(e.get(n,o+1,i+1)&l?c=2:e.get(r,o,i+1)&l&&e.get(r,o+1,i)&l&&e.get(r,o+1,i+1)&l||(c=0)),1===u&&(e.get(n,o+1,i-1)&l?u=2:e.get(r,o,i-1)&l&&e.get(r,o+1,i)&l&&e.get(r,o+1,i-1)&l||(u=0)),1===s&&(e.get(n,o-1,i+1)&l?s=2:e.get(r,o,i+1)&l&&e.get(r,o-1,i)&l&&e.get(r,o-1,i+1)&l||(s=0)),1===a&&(e.get(n,o-1,i-1)&l?a=2:e.get(r,o,i-1)&l&&e.get(r,o-1,i)&l&&e.get(r,o-1,i-1)&l||(a=0))),c<<6|u<<4|s<<2|a}function m(e,t,n){return e>>(t?n?6:4:n?2:0)&3}function v(e,t,n,r,o){var i=0===n?o:r[n-1];e.push(t[0]*i,t[1]*i,t[2]*i,1)}this.mesh=function(e,t,n,r,s,c,l){var h,d={},m=r&&c===s[0];r&&(h=m?f:p);for(var v=0;v<3;++v){var _=(v+1)%3,g=(v+2)%3,y=e.shape,b=e.transpose(v,_,g).lo(1,1,1).hi(y[v]-2,y[_]-2,y[g]-2),w=b.shape[0]-1,k=b.shape[1],x=b.shape[2];o.length<k*x&&(o=new Int16Array(k*x),i=new Uint16Array(k*x));for(var A=0;A<=w;++A)a(A,v,b,t,h),W("masks"),u(A,v,_,g,k,x,r,d,n,s,c),l&&(A+=w-1),W("submeshes")}return d}}q.prototype.dispose=function(){this.positions=null,this.indices=null,this.normals=null,this.colors=null,this.uvs=null};var W=()=>{},Z=n(216),$=new function(){function e(e,t,n,r,o,i){var a=e._objectBlocks,s=new Z.a("object_sps_"+e.id,t,{updatable:!1}),u=e.noa.registry._blockHandlerLookup,c=e.noa.registry._blockMeshLookup;for(var l in n){var h,d=c[l],f=n[l],p=f.length,m=u[l];m&&(h=m.onCustomMeshCreate);s.addShape(d,p,{positionFunction:function(e,t,n){var s=f[n],u=a[s];e.position.set(u.x+.5,u.y,u.z+.5),h&&h(e,r+u.x,o+u.y,i+u.z)}}),f.length=0}return s}this.initChunk=function(e){e._objectBlocks={},e._objectSystems=[]},this.disposeChunk=function(e){this.removeObjectMeshes(e),e._objectBlocks=null},this.addObjectBlock=function(e,t,n,r,o){var i=n+"|"+r+"|"+o;e._objectBlocks[i]=new K(t,n,r,o,null)},this.removeObjectBlock=function(e,t,n,r){var o=t+"|"+n+"|"+r;e._objectBlocks[o]&&delete e._objectBlocks[o]},this.removeObjectMeshes=function(e){for(var t=e._objectSystems||[];t.length;){var n=t.pop();n.mesh&&n.mesh.dispose(),n.dispose()}},this.buildObjectMeshes=function(t){ne("start");var n=t.noa.rendering.getScene(),r=t.noa.registry._blockMeshLookup,o={};for(var i in t._objectBlocks){var a=t._objectBlocks[i].id,s=r[a].material,u=s?n.materials.indexOf(s):-1;o[u]||(o[u]={}),o[u][a]||(o[u][a]=[]),o[u][a].push(i)}ne("preprocess");var c=t.i*t.size,l=t.j*t.size,h=t.k*t.size,d=[];for(var f in o){var p=e(t,n,o[f],c,l,h);ne("made SPS");var m=p.buildMesh();ne("built mesh"),m.material=f>-1?n.materials[f]:null,d.push(m),t._objectSystems.push(p)}return ne("end"),d}};function K(e,t,n,r){this.id=0|e,this.x=0|t,this.y=0|n,this.z=0|r}var Q,J,ee,te,ne=()=>{},re=n(172),oe=ce,ie=U.ID_MASK,ae=U.SOLID_BIT,se=U.OPAQUE_BIT,ue=U.OBJECT_BIT;function ce(e,t,n,r,o,i,a){this.id=t,this.requestID="",this.noa=e,this.isDisposed=!1,this.octreeBlock=null,this.voxels=a,this.i=n,this.j=r,this.k=o,this.size=i,this.x=n*i,this.y=r*i,this.z=o*i,this._terrainDirty=!1,this._objectsDirty=!1,function(e){Q=e.registry._solidityLookup,J=e.registry._opacityLookup,ee=e.registry._blockMeshLookup,te=e.registry._blockHandlerLookup}(e),this._terrainMesh=null,this._objectBlocks=null,this._objectSystems=null,$.initChunk(this),this.isFull=!1,this.isEmpty=!1;var s=Array.from(Array(27)).map(()=>null);this._neighbors=new re(s,[3,3,3]).lo(1,1,1),this._neighbors.set(0,0,0,this),this._neighborCount=0,this._maxMeshedNeighbors=0,this._timesMeshed=0,fe(this)}function le(e,t,n,r,o,i){var a=te[t];if(a){var s=a[n];s&&s(e.x+r,e.y+o,e.z+i)}}function he(e){return 0!==e&&(!!(e&ae)||0==(e&ue))}function de(e){var t=e;return Q[e]&&(t|=ae),J[e]&&(t|=se),ee[e]&&(t|=ue),t}function fe(e){for(var t=se,n=!0,r=!1,o=e.voxels,i=o.shape[0],a=0;a<i;++a)for(var s=0;s<i;++s)for(var u=o.index(a,s,0),c=0;c<i;++c,++u){var l=o.data[u]&ie;if(0!==l){var h=0|de(l);o.data[u]=h,t&=h,n=!1,ue&h&&(pe(e,l,a,s,c),r=!0),le(e,l,"onLoad",a,s,c)}else t=0}e.isFull=!!(t&se),e.isEmpty=!!n,e._terrainDirty=!e.isEmpty,e._objectsDirty=r}function pe(e,t,n,r,o){$.addObjectBlock(e,t,n,r,o),e._objectsDirty=!0}function me(e,t){for(var n=e.voxels,r=n.shape[0],o=0;o<r;++o)for(var i=0;i<r;++i)for(var a=0;a<r;++a){var s=ie&n.get(o,i,a);s>0&&le(e,s,t,o,i,a)}}ce._createVoxelArray=function(e){var t=new Uint16Array(e*e*e);return new re(t,[e,e,e])},ce.prototype._updateVoxelArray=function(e){me(this,"onUnload"),$.disposeChunk(this),this.voxels=e,this._terrainDirty=!1,this._objectsDirty=!1,$.initChunk(this),fe(this)},ce.prototype.get=function(e,t,n){return ie&this.voxels.get(e,t,n)},ce.prototype.getSolidityAt=function(e,t,n){return!!(ae&this.voxels.get(e,t,n))},ce.prototype.set=function(e,t,n,r){var o=this.voxels.get(e,t,n),i=o&ie;if(r!==i){var a=de(r);if(this.voxels.set(e,t,n,a),o&ue&&function(e,t,n,r){$.removeObjectBlock(e,t,n,r),e._objectsDirty=!0}(this,e,t,n),a&ue&&pe(this,r,e,t,n),le(this,i,"onUnset",e,t,n),le(this,r,"onSet",e,t,n),0==(a&se)&&(this.isFull=!1),0!==a&&(this.isEmpty=!1),(he(a)||he(o))&&(this._terrainDirty=!0),(this._terrainDirty||this._objectsDirty)&&this.noa.world._queueChunkForRemesh(this),(a&(ae|se))!==(o&(ae|se))){var s=this.size-1,u=0===e?-1:e<s?0:1,c=0===t?-1:t<s?0:1,l=0===n?-1:n<s?0:1;if(u|c|l){var h=c?[0,c]:[0],d=l?[0,l]:[0];(u?[0,u]:[0]).forEach(e=>{h.forEach(t=>{d.forEach(n=>{if(0!=(e|t|n)){var r=this._neighbors.get(e,t,n);r&&(r._terrainDirty=!0,this.noa.world._queueChunkForRemesh(r))}})})})}}}},ce.prototype.mesh=function(e,t,n,r,o){return N.meshChunk(this,e,t,n,r,o)},ce.prototype.updateMeshes=function(){var e=this.noa.rendering;if(this._terrainDirty){this._terrainMesh&&this._terrainMesh.dispose();var t=this.mesh();if(t&&t.getIndices().length>0){var n=[this.x,this.y,this.z];e.addMeshToScene(t,!0,n,this)}this._terrainMesh=t||null,this._terrainDirty=!1,this._timesMeshed++,this._maxMeshedNeighbors=Math.max(this._maxMeshedNeighbors,this._neighborCount)}if(this._objectsDirty){$.removeObjectMeshes(this);var r=$.buildObjectMeshes(this),o=[this.x,this.y,this.z];r.forEach(t=>e.addMeshToScene(t,!0,o,this)),this._objectsDirty=!1}},ce.prototype.dispose=function(){me(this,"onUnload"),$.disposeChunk(this),this._terrainMesh&&this._terrainMesh.dispose(),this.voxels.data=null,this.voxels=null,this._neighbors.data=null,this._neighbors=null,this.isDisposed=!0};var ve=n(166).EventEmitter,_e={chunkSize:24,chunkAddDistance:3,chunkRemoveDistance:4,worldGenWhilePaused:!1};function ge(e,t){var n;this.noa=e,t=Object.assign({},_e,t),this.playerChunkLoaded=!1,this.Chunk=oe,this.chunkSize=t.chunkSize,this.chunkAddDistance=t.chunkAddDistance,this.chunkRemoveDistance=t.chunkRemoveDistance,this.chunkRemoveDistance<this.chunkAddDistance&&(this.chunkRemoveDistance=this.chunkAddDistance),this.minNeighborsToMesh=6,this.maxChunksPendingCreation=10,this.maxChunksPendingMeshing=10,this.maxProcessingPerTick=9,this.maxProcessingPerRender=5,this.worldGenWhilePaused=t.worldGenWhilePaused,this._cachedWorldName="",this._lastPlayerChunkID="",this._chunkStorage={},(n=this)._chunkIDsKnown=new d,n._chunkIDsToRequest=new d,n._chunkIDsPending=new d,n._chunkIDsToMesh=new d,n._chunkIDsToMeshFirst=new d,n._chunkIDsToRemove=new d,n._queueChunkForRemesh=e=>{Ae(n,e)},function(e){e._getChunk=(t,n,r)=>{var o=ye(t,n,r);return e._chunkStorage[o]||null},e._setChunk=(t,n,r,o)=>{var i=ye(t,n,r);o?e._chunkStorage[i]=o:delete e._chunkStorage[i]},e._getChunkByCoords=function(t,n,r){var o=e._worldCoordToChunkCoord(t),i=e._worldCoordToChunkCoord(n),a=e._worldCoordToChunkCoord(r);return e._getChunk(o,i,a)}}(this);var r=this.chunkSize;if(0==(r&r-1)){var o=0|Math.log2(r),i=r-1|0;this._worldCoordToChunkCoord=e=>e>>o|0,this._worldCoordToChunkIndex=e=>e&i|0}else this._worldCoordToChunkCoord=e=>0|Math.floor(e/r),this._worldCoordToChunkIndex=e=>(e%r+r)%r|0}function ye(e,t,n){return e+"|"+t+"|"+n}function be(e){return e.split("|").map(e=>parseInt(e))}function we(e){var t=e.noa.entities.getPosition(e.noa.playerEntity);return[e._worldCoordToChunkCoord(t[0]),e._worldCoordToChunkCoord(t[1]),e._worldCoordToChunkCoord(t[2])]}ge.prototype=Object.create(ve.prototype),ge.prototype.getBlockID=function(e,t,n){var r=this._getChunkByCoords(e,t,n);return r?r.get(this._worldCoordToChunkIndex(e),this._worldCoordToChunkIndex(t),this._worldCoordToChunkIndex(n)):0},ge.prototype.getBlockSolidity=function(e,t,n){var r=this._getChunkByCoords(e,t,n);return!!r&&!!r.getSolidityAt(this._worldCoordToChunkIndex(e),this._worldCoordToChunkIndex(t),this._worldCoordToChunkIndex(n))},ge.prototype.getBlockOpacity=function(e,t,n){var r=this.getBlockID(e,t,n);return this.noa.registry.getBlockOpacity(r)},ge.prototype.getBlockFluidity=function(e,t,n){var r=this.getBlockID(e,t,n);return this.noa.registry.getBlockFluidity(r)},ge.prototype.getBlockProperties=function(e,t,n){var r=this.getBlockID(e,t,n);return this.noa.registry.getBlockProps(r)},ge.prototype.getBlockObjectMesh=function(e,t,n){var r=this._getChunkByCoords(e,t,n);return r?r.getObjectMeshAt(this._worldCoordToChunkIndex(e),this._worldCoordToChunkIndex(t),this._worldCoordToChunkIndex(n)):0},ge.prototype.setBlockID=function(e,t,n,r){var o=this._worldCoordToChunkCoord(t),i=this._worldCoordToChunkCoord(n),a=this._worldCoordToChunkCoord(r),s=this._worldCoordToChunkIndex(t),u=this._worldCoordToChunkIndex(n),c=this._worldCoordToChunkIndex(r),l=this._getChunk(o,i,a);l&&l.set(s,u,c,e)},ge.prototype.isBoxUnobstructed=function(e){for(var t=e.base,n=e.max,r=Math.floor(t[0]);r<n[0]+1;r++)for(var o=Math.floor(t[1]);o<n[1]+1;o++)for(var i=Math.floor(t[2]);i<n[2]+1;i++)if(this.getBlockSolidity(r,o,i))return!1;return!0},ge.prototype.setChunkData=function(e,t,n){!function(e,t,n,r){var o=t.split("|"),i=parseInt(o.shift()),a=parseInt(o.shift()),s=parseInt(o.shift()),u=o.join("|"),c=ye(i,a,s);if(e._chunkIDsPending.remove(c),u!==e.noa.worldName)return;if(!e._chunkIDsKnown.includes(c))return;if(e._chunkIDsToRemove.includes(c))return;var l=e._chunkStorage[c];if(l){l._updateVoxelArray(n),l._neighbors.data.forEach(t=>{t&&t!==l&&t._neighborCount>20&&Ae(e,t)})}else{var h=e.chunkSize;l=new oe(e.noa,c,i,a,s,h,n),e._setChunk(i,a,s,l),l.requestID=t,l.userData=r,Me(e,i,a,s,l),e.noa.rendering.prepareChunkForRendering(l),e.emit("chunkAdded",l)}Ae(e,l),Pe("receive")}(this,e,t,n)},ge.prototype.invalidateVoxelsInAABB=function(e){!function(e,t){var n=t.base.map(t=>Math.floor(e._worldCoordToChunkCoord(t))),r=t.max.map(t=>Math.floor(e._worldCoordToChunkCoord(t)));e._chunkIDsKnown.forEach(t=>{for(var o=be(t),i=0;i<3;i++)if(o[i]<n[i]||o[i]>r[i])return;e._chunkIDsToRemove.includes(t)||e._chunkIDsToRequest.add(t)})}(this,e)},ge.prototype.tick=function(){var e=performance.now();this._cachedWorldName!==this.noa.worldName&&(!function(e){e._chunkIDsToRemove.copyFrom(e._chunkIDsKnown),e._chunkIDsToRequest.empty(),e._chunkIDsToMesh.empty(),e._chunkIDsToMeshFirst.empty();var t=we(e);Te(e._chunkIDsToRemove,t[0],t[1],t[2])}(this),this._cachedWorldName=this.noa.worldName);var t,n,r,o,i,a,s=we(this),h=ye(s[0],s[1],s[2]),d=h!=this._lastPlayerChunkID;d&&(this.emit("playerEnteredChunk",s[0],s[1],s[2]),this._lastPlayerChunkID=h),Ce("start"),Pe("start"),d&&(t=this,n=s[0],r=s[1],o=s[2],i=t.chunkRemoveDistance*t.chunkRemoveDistance,a=t._chunkIDsToRemove,t._chunkIDsKnown.forEach(e=>{if(!a.includes(e)){var s=be(e),u=s[0]-n,c=s[1]-r,l=s[2]-o;u*u+c*c+l*l<i||(t._chunkIDsToRemove.add(e),t._chunkIDsToRequest.remove(e),t._chunkIDsToMesh.remove(e),t._chunkIDsToMeshFirst.remove(e))}}),Te(a,n,r,o),Ce("remQueue"));var f=function(e){if(e===c)return l;for(var t=Math.ceil(e),n=0,r=e*e,o=-t;o<=t;++o)for(var i=-t;i<=t;++i)for(var a=-t;a<=t;++a){o*o+i*i+a*a<r&&n++}return c=e,l=n,n}(this.chunkAddDistance);(d||this._chunkIDsKnown.count()<f)&&(!function(e,t,n,r){for(var o=Math.ceil(e.chunkAddDistance),i=e.chunkAddDistance*e.chunkAddDistance,a=e._chunkIDsKnown,s=e._chunkIDsToRequest,u=t-o;u<=t+o;++u)for(var c=n-o;c<=n+o;++c)for(var l=r-o;l<=r+o;++l){var h=ye(u,c,l);if(!a.includes(h)){var d=u-t,f=c-n,p=l-r;d*d+f*f+p*p>i||(a.add(h),s.add(h))}}Te(s,t,n,r)}(this,s[0],s[1],s[2]),Ce("addQueue")),u(this.maxProcessingPerTick,()=>{var e=function(e){var t=e._chunkIDsToRequest;if(t.isEmpty())return!0;var n=e._chunkIDsPending.count(),r=e._chunkIDsToMesh.count();if(n>=e.maxChunksPendingCreation)return!0;if(r>=e.maxChunksPendingMeshing)return!0;var o=t.pop();return function(e,t){var n=be(t),r=n[0],o=n[1],i=n[2],a=e.chunkSize,s=oe._createVoxelArray(e.chunkSize),u=e.noa.worldName,c=[r,o,i,u].join("|"),l=r*a,h=o*a,d=i*a;e._chunkIDsPending.add(t),e.emit("worldDataNeeded",c,s,l,h,d,u),Pe("request")}(e,o),t.isEmpty()}(this);return Ce("requests"),e=e&&function(e){var t=e._chunkIDsToRemove;return!!t.isEmpty()||(function(e,t){var n=be(t),r=e._getChunk(n[0],n[1],n[2]);r&&(e.emit("chunkBeingRemoved",r.requestID,r.voxels,r.userData),e.noa.rendering.disposeChunkForRendering(r),r.dispose(),Pe("dispose"),Me(e,n[0],n[1],n[2],null));e._setChunk(n[0],n[1],n[2],null),e._chunkIDsKnown.remove(t),e._chunkIDsToMesh.remove(t),e._chunkIDsToMeshFirst.remove(t)}(e,t.pop()),t.isEmpty())}(this),Ce("removes"),e=e&&xe(this,!1),Ce("meshes"),e},e),performance.now()-e+2<this.maxProcessingPerTick&&(!function(e){for(var t=e._chunkIDsKnown.arr,n=Math.min(50,t.length),r=e._chunkIDsToMesh.count()+e._chunkIDsToMeshFirst.count(),o=0;o<n;o++){ke=(ke+1)%t.length;var i=t[ke],a=e._chunkStorage[i];if(a){var s=a._neighborCount;if(!(s<e.minNeighborsToMesh)&&!(s<=a._maxMeshedNeighbors)&&(Ae(e,a),++r>10))return}}}(this),Ce("looking"),u(this.maxProcessingPerTick,()=>{var e=xe(this,!1);return Ce("meshes"),e},e));var p=this._getChunk(s[0],s[1],s[2]);this.playerChunkLoaded=!!p,Pe("end",this),Ce("end")},ge.prototype.render=function(){u(this.maxProcessingPerRender,()=>xe(this,!0))};var ke=-1;function xe(e,t){var n=e._chunkIDsToMeshFirst;if(n.isEmpty()&&!t&&(n=e._chunkIDsToMesh),n.isEmpty())return!0;var r=n.pop();if(!e._chunkIDsToRemove.includes(r)){var o=e._chunkStorage[r];o&&function(e,t){e._chunkIDsToMesh.remove(t.id),e._chunkIDsToMeshFirst.remove(t.id),t.updateMeshes(),Pe("mesh")}(e,o)}}function Ae(e,t){var n=t._neighborCount;n<Math.min(e.minNeighborsToMesh,26)||(t._terrainDirty=!0,(26===n?e._chunkIDsToMeshFirst:e._chunkIDsToMesh).add(t.id))}function Te(e,t,n,r){e.sort(e=>{var o=be(e),i=o[0]-t,a=o[1]-n,s=o[2]-r;return i*i+s*s+Math.abs(a)})}function Me(e,t,n,r,o){for(var i=-1;i<=1;i++)for(var a=-1;a<=1;a++)for(var s=-1;s<=1;s++)if(0!=(i|a|s)){var u=ye(t+i,n+a,r+s),c=e._chunkStorage[u];c&&(o?(o._neighborCount++,o._neighbors.set(i,a,s,c),c._neighborCount++,c._neighbors.set(-i,-a,-s,o),26===c._neighborCount&&Ae(e,c)):(c._neighborCount--,c._neighbors.set(-i,-a,-s,null)))}}function Ee(e,t,n,r){var o=0,i=0,a=0,s=0,u=[];n.forEach(t=>{var n=e._chunkStorage[t];n&&(a++,u.push(n._timesMeshed),n.isFull&&o++,n.isEmpty&&i++,26===n._neighborCount&&s++)});var c=n.length.toString().padEnd(8);if(c+=("exist: "+a).padEnd(12),c+=("full: "+o).padEnd(12),c+=("empty: "+i).padEnd(12),c+=("surr: "+s).padEnd(12),r){var l=u.reduce((e,t)=>e+t,0),h=u.reduce((e,t)=>Math.max(e,t),0),d=u.reduce((e,t)=>Math.min(e,t),0);c+="times meshed: avg "+(l/a).toFixed(2),c+="  max "+h,c+="  min "+d}console.log(t,c)}ge.prototype.report=function(){console.log("World report - playerChunkLoaded: ",this.playerChunkLoaded),Ee(this,"  known:     ",this._chunkIDsKnown.arr,!0),Ee(this,"  to request:",this._chunkIDsToRequest.arr),Ee(this,"  to remove: ",this._chunkIDsToRemove.arr),Ee(this,"  creating:  ",this._chunkIDsPending.arr),Ee(this,"  to mesh:   ",this._chunkIDsToMesh.arr.concat(this._chunkIDsToMeshFirst.arr))};var Ce=()=>{},Pe=()=>{};var Ie=n(334),Se=function(e,t,n){return function(e,t,n){t=Object.assign({},Be,t);var r=Ie(n,t),o=t.bindings;for(var i in o){var a=Array.isArray(o[i])?o[i]:[o[i]];a.unshift(i),r.bind.apply(r,a)}return r}(0,t,n)},Be={bindings:{forward:["W","<up>"],left:["A","<left>"],backward:["S","<down>"],right:["D","<right>"],fire:"<mouse 1>","mid-fire":["<mouse 2>","Q"],"alt-fire":["<mouse 3>","E"],jump:"<space>",sprint:"<shift>",crouch:"<control>"}};var De=n(337),Oe=function(e,t){return function(e,t){t=Object.assign({},Le,t);var n=e.world,r=e.worldOriginOffset;return De(t,(e,t,o)=>n.getBlockSolidity(e+r[0],t+r[1],o+r[2]),(e,t,o)=>n.getBlockFluidity(e+r[0],t+r[1],o+r[2]))}(e,t)},Le={gravity:[0,-10,0],airDrag:.1};var je=n(82),Fe=n(232),Re=n(273),ze={inverseX:!1,inverseY:!1,sensitivityX:10,sensitivityY:10,initialZoom:0,zoomSpeed:.2};function Ue(e,t){this.noa=e,t=Object.assign({},ze,t),this.sensitivityX=t.sensitivityX,this.sensitivityY=t.sensitivityY,this.inverseX=t.inverseX,this.inverseY=t.inverseY,this.heading=0,this.pitch=0,this.cameraTarget=this.noa.ents.createEntity(["position"]);var n=.9*e.ents.getPositionData(e.playerEntity).height;e.ents.addComponent(this.cameraTarget,"followsEntity",{entity:e.playerEntity,offset:[0,n,0]}),this.zoomDistance=t.initialZoom,this.zoomSpeed=t.zoomSpeed,this.currentZoom=t.initialZoom,this._dirVector=je.fromValues(0,1,0)}Ue.prototype._localGetTargetPosition=function(){var e=this.noa.ents.getPositionData(this.cameraTarget);return je.copy(Ne,e._renderPosition)},Ue.prototype._localGetPosition=function(){var e=this._localGetTargetPosition();return 0===this.currentZoom?e:je.scaleAndAdd(e,e,this._dirVector,-this.currentZoom)};var Ne=je.create();Ue.prototype.getTargetPosition=function(){var e=this._localGetTargetPosition();return this.noa.localToGlobal(e,Ye)};var Ye=[];Ue.prototype.getPosition=function(){var e=this._localGetPosition();return this.noa.localToGlobal(e,Ye)},Ue.prototype.getDirection=function(){return this._dirVector},Ue.prototype.applyInputsToCamera=function(){var e=this.noa.inputs.state;!function(e){var t=e.dx,n=e.dy,r=document.body.clientWidth/6,o=document.body.clientHeight/6,i=Math.abs(t)>r&&t/Ze<-1,a=Math.abs(n)>o&&n/$e<-1;i||a?(e.dx=Ze,e.dy=$e,Ze=t>0?1:-1,$e=n>0?1:-1):(t&&(Ze=t),n&&($e=n))}(e);var t=.0066*Math.PI/180,n=e.dy*this.sensitivityY*t,r=e.dx*this.sensitivityX*t;this.inverseY&&(n=-n),this.inverseX&&(r=-r);var o=2*Math.PI;this.heading+=r<0?r+o:r,this.heading>o&&(this.heading-=o);var i=Math.PI/2-.001;this.pitch=Math.max(-i,Math.min(i,this.pitch+n)),je.set(this._dirVector,0,0,1),je.rotateX(this._dirVector,this._dirVector,He,this.pitch),je.rotateY(this._dirVector,this._dirVector,He,this.heading)};var He=je.create();Ue.prototype.updateBeforeEntityRenderSystems=function(){this.currentZoom+=(this.zoomDistance-this.currentZoom)*this.zoomSpeed},Ue.prototype.updateAfterEntityRenderSystems=function(){var e=function(e){if(!Ge){var t=e.noa.worldOriginOffset;Ge=new Fe([0,0,0],je.clone(Ve)),qe=(n,r,o)=>e.noa.world.getBlockSolidity(n+t[0],r+t[1],o+t[2]),je.scale(Ve,Ve,-.5)}Ge.setPosition(e._localGetTargetPosition()),Ge.translate(Ve);var n=Math.max(e.zoomDistance,e.currentZoom)+.1;return je.scale(Xe,e.getDirection(),-n),Re(qe,Ge,Xe,We,!0)}(this);this.currentZoom>e&&(this.currentZoom=e)};var Ge,qe,Ve=je.fromValues(.2,.2,.2),Xe=je.create(),We=()=>!0;var Ze=0,$e=0,Ke={texturePath:""},Qe={solid:!0,opaque:!0,fluidDensity:1,viscosity:.5},Je=4294967295&U.ID_MASK;function et(e,t){this.noa=e,t=Object.assign({},Ke,t);var n=[!1],r=[!1],o=[!1],i=[0,0,0,0,0,0],a=[null],s=[null],u=[null],c={},l=[null],h=t.texturePath;this.registerBlock=function(e,t){t=t||{},Qe.solid=!t.fluid,Qe.opaque=!t.fluid;var l=Object.assign({},Qe,t);if(e<1||e>Je)throw"Block id out of range: "+e;for(;e>n.length;)this.registerBlock(n.length,{});n[e]=!!l.solid,r[e]=!!l.opaque,o[e]=!!l.fluid,s[e]=l.blockMesh||null,s[e]&&(l.material=null);var h,d=l.material||null;if(d)if("string"==typeof d)h=[d,d,d,d,d,d];else if(d.length&&2==d.length)h=[d[1],d[1],d[0],d[0],d[1],d[1]];else if(d.length&&3==d.length)h=[d[2],d[2],d[0],d[1],d[2],d[2]];else{if(!d.length||6!=d.length)throw"Invalid material parameter: "+d;h=d}else h=[null,null,null,null,null,null];for(var f=0;f<6;++f)i[6*e+f]=tt(this,c,h[f],!0);a[e]={},o[e]&&(a[e].fluidDensity=l.fluidDensity,a[e].viscosity=l.viscosity);var p=l.onLoad||l.onUnload||l.onSet||l.onUnset||l.onCustomMeshCreate;return u[e]=p?new nt(l):null,e},this.registerMaterial=function(e,t,n,r,o){var i=c[e]||l.length;c[e]=i;var a=1;return t&&4==t.length&&(a=t.pop()),l[i]={color:t||[1,1,1],alpha:a,texture:n?h+n:"",textureAlpha:!!r,renderMat:o||null},i},this.getBlockSolidity=function(e){return n[e]},this.getBlockOpacity=function(e){return r[e]},this.getBlockFluidity=function(e){return o[e]},this.getBlockProps=function(e){return a[e]},this.getBlockFaceMaterial=function(e,t){return i[6*e+t]},this.getMaterialColor=function(e){return l[e].color},this.getMaterialTexture=function(e){return l[e].texture},this.getMaterialData=function(e){return l[e]},this._solidityLookup=n,this._opacityLookup=r,this._blockMeshLookup=s,this._blockHandlerLookup=u,this._getMaterialVertexColor=function(e){return l[e].texture?d:l[e].color};var d=[1,1,1];this.registerMaterial("dirt",[.4,.3,0],null),this.registerBlock(1,{material:"dirt"})}function tt(e,t,n,r){if(!n)return 0;var o=t[n];return void 0===o&&r&&(o=e.registerMaterial(n)),o}function nt(e){this.onLoad=e.onLoad||null,this.onUnload=e.onUnload||null,this.onSet=e.onSet||null,this.onUnset=e.onUnset||null,this.onCustomMeshCreate=e.onCustomMeshCreate||null}var rt=n(242),ot=n(243),it=n(82),at=n(339),st={shadowDistance:10};function ut(e,t){at.call(this),this.noa=e,t=Object.assign({},st,t),this.names={};var r={shadow:t.shadowDistance},o=n(341);o.keys().forEach(t=>{var n=/\.\/(.*)\.js/.exec(t)[1],i=r[n]||void 0,a=o(t);a.default&&(a=a.default);var s=a(e,i),u=this.createComponent(s);this.names[n]=u}),this.isPlayer=function(t){return t===e.playerEntity},this.hasPhysics=this.getComponentAccessor(this.names.physics),this.cameraSmoothed=this.getComponentAccessor(this.names.smoothCamera),this.hasMesh=this.getComponentAccessor(this.names.mesh),this.hasPosition=this.getComponentAccessor(this.names.position);var i=this.getStateAccessor(this.names.position);function a(t,n){it.copy(n._renderPosition,n._localPosition),it.add(n.position,n._localPosition,e.worldOriginOffset),Object(rt.updatePositionExtents)(n);var r=s(t);r&&Object(ot.setPhysicsFromPosition)(r,n)}this.getPositionData=i,this._localGetPosition=function(e){return i(e)._localPosition},this.getPosition=function(e){return i(e).position},this._localSetPosition=function(e,t){var n=i(e);it.copy(n._localPosition,t),a(e,n)},this.setPosition=(t,n,r,o)=>{"number"==typeof n&&(n=[n,r,o]);var i=e.globalToLocal(n,null,[]);this._localSetPosition(t,i)},this.setEntitySize=function(e,t,n,r){var o=i(e);o.width=(t+r)/2,o.height=n,a(e,o)},this._rebaseOrigin=function(e){this.getStatesList(this.names.position).forEach(t=>{it.subtract(t._localPosition,t._localPosition,e),a(t.__id,t)})};var s=this.getStateAccessor(this.names.physics);this.getPhysics=s,this.getPhysicsBody=function(e){return s(e).body},this.getMeshData=this.getStateAccessor(this.names.mesh),this.getMovement=this.getStateAccessor(this.names.movement),this.getCollideTerrain=this.getStateAccessor(this.names.collideTerrain),this.getCollideEntities=this.getStateAccessor(this.names.collideEntities),this.onPairwiseEntityCollision=function(e,t){}}function ct(e,t){return!(e[0]>t[3])&&(!(e[1]>t[4])&&(!(e[2]>t[5])&&(!(e[3]<t[0])&&(!(e[4]<t[1])&&!(e[5]<t[2])))))}ut.prototype=Object.create(at.prototype),ut.prototype.constructor=ut,ut.prototype.addComponentAgain=function(e,t,n){this.hasComponent(e,t)&&this.removeComponent(e,t,!0),this.addComponent(e,t,n)},ut.prototype.isTerrainBlocked=function(e,t,n){for(var r=this.noa.worldOriginOffset,o=Math.floor(e-r[0]),i=Math.floor(t-r[1]),a=Math.floor(n-r[2]),s=[o+.001,i+.001,a+.001,o+.999,i+.999,a+.999],u=this.getStatesList(this.names.collideTerrain),c=0;c<u.length;c++){var l=u[c].__id;if(ct(s,this.getPositionData(l)._extents))return!0}return!1},ut.prototype.getEntitiesInAABB=function(e,t){var n=this.noa.worldOriginOffset,r=[e.base[0]+n[0],e.base[1]+n[1],e.base[2]+n[2],e.max[0]+n[0],e.max[1]+n[1],e.max[2]+n[2]],o=t?this.getStatesList(t).map(e=>this.getPositionData(e.__id)):this.getStatesList(this.names.position),i=[];return o.forEach(e=>{ct(r,e._extents)&&i.push(e.__id)}),i},ut.prototype.add=function(e,t,n,r,o,i,a){var s=this,u=this.createEntity();if(this.addComponent(u,this.names.position,{position:e||[0,0,0],width:t,height:n}),i){this.addComponent(u,this.names.physics);var c=this.getPhysicsBody(u),l=this.names.smoothCamera;c.onStep=function(){s.addComponentAgain(u,l)}}return r&&(o||(o=it.create()),this.addComponent(u,this.names.mesh,{mesh:r,offset:o})),a&&this.addComponent(u,this.names.shadow,{size:t}),u}
/*!
 * noa: an experimental voxel game engine.
 * @url      github.com/andyhall/noa
 * @author   Andy Hall <andy@fenomas.com>
 * @license  MIT
 */;var lt=n(82),ht=n(172),dt=n(320),ft=n(166).EventEmitter,pt=vt,mt={debug:!1,silent:!1,playerHeight:1.8,playerWidth:.6,playerStart:[0,10,0],playerAutoStep:!1,tickRate:33,blockTestDistance:10,stickyPointerLock:!0,dragCameraOutsidePointerLock:!0,skipDefaultHighlighting:!1,originRebaseDistance:25};function vt(e){if(!(this instanceof vt))return new vt(e);this.version=n(361).version,e=Object.assign({},mt,e),this._tickRate=e.tickRate,this._lastRenderTime=0,this._paused=!1,this._dragOutsideLock=e.dragCameraOutsidePointerLock;var t=this;if(!e.silent){var r=e.debug?" (debug)":"";console.log(`noa-engine v${this.version}${r}`)}this.worldOriginOffset=[0,0,0],this._originRebaseDistance=e.originRebaseDistance,this.vec3=lt,this.positionInCurrentTick=0,this.worldName="default",this.container=function(e,t){return new i(e,t)}(this,e),this.inputs=Se(0,e,this.container.element),this.registry=function(e,t){return new et(e,t)}(this,e),this.world=function(e,t){return new ge(e,t)}(this,e),this.rendering=function(e,t,n){return new T(e,t,n)}(this,e,this.container.canvas),this.physics=Oe(this,e),this.entities=function(e,t){return new ut(e,t)}(this,e),this.ents=this.entities;var o=this.ents;this.playerEntity=o.add(e.playerStart,e.playerWidth,e.playerHeight,null,null,!0,!0),o.addComponent(this.playerEntity,o.names.collideTerrain),o.addComponent(this.playerEntity,o.names.collideEntities);var a=o.getPhysicsBody(this.playerEntity);a.gravityMultiplier=2,a.autoStep=e.playerAutoStep,o.addComponent(this.playerEntity,o.names.receivesInputs),o.addComponent(this.playerEntity,o.names.fadeOnZoom);o.addComponent(this.playerEntity,o.names.movement,{airJumps:1}),this.camera=function(e,t){return new Ue(e,t)}(this,e),this.blockTestDistance=e.blockTestDistance,this.blockTargetIdCheck=this.registry.getBlockSolidity,this.targetedBlock=null,e.skipDefaultHighlighting||(this.defaultBlockHighlightFunction=function(e){e?t.rendering.highlightBlockFace(!0,e.position,e.normal):t.rendering.highlightBlockFace(!1)},this.on("targetBlockChanged",this.defaultBlockHighlightFunction)),this._constants=U,e.debug&&(window.noa=this,window.scene=this.rendering._scene,window.ndarray=ht,window.vec3=lt,o.getMovement(1).airJumps=999,this.setViewDistance=function(e){var t=this.world.chunkSize;this.world.chunkAddDistance=e/t,this.world.chunkRemoveDistance=e/t+1,this.world._lastPlayerChunkID=""}),function(e){var t="0.27",n=(e,n,r)=>{var o=()=>{throw`This property changed in ${t} - ${r}`};Object.defineProperty(e,n,{get:o,set:o})};n(e,"getPlayerEyePosition","to get the camera/player offset see API docs for `noa.camera.cameraTarget`"),n(e,"setPlayerEyePosition","to set the camera/player offset see API docs for `noa.camera.cameraTarget`"),n(e,"getPlayerPosition","use `noa.ents.getPosition(noa.playerEntity)` or similar"),n(e,"getCameraVector","use `noa.camera.getDirection`"),n(e,"getPlayerMesh","use `noa.ents.getMeshData(noa.playerEntity).mesh` or similar"),n(e,"playerBody","use `noa.ents.getPhysicsBody(noa.playerEntity)`"),n(e.rendering,"zoomDistance","use `noa.camera.zoomDistance`"),n(e.rendering,"_currentZoom","use `noa.camera.currentZoom`"),n(e.rendering,"_cameraZoomSpeed","use `noa.camera.zoomSpeed`"),n(e.rendering,"getCameraVector","use `noa.camera.getDirection`"),n(e.rendering,"getCameraPosition","use `noa.camera.getLocalPosition`"),n(e.rendering,"getCameraRotation","use `noa.camera.heading` and `noa.camera.pitch`"),n(e.rendering,"setCameraRotation","to customize camera behavior see API docs for `noa.camera`"),t="0.28",n(e.rendering,"makeMeshInstance","removed, use Babylon's `mesh.createInstance`"),n(e.world,"_maxChunksPendingCreation",'use `maxChunksPendingCreation` (no "_")'),n(e.world,"_maxChunksPendingMeshing",'use `maxChunksPendingMeshing` (no "_")'),n(e.world,"_maxProcessingPerTick",'use `maxProcessingPerTick` (no "_")'),n(e.world,"_maxProcessingPerRender",'use `maxProcessingPerRender` (no "_")')}(this)}vt.prototype=Object.create(ft.prototype),vt.prototype.tick=function(){if(this._paused)this.world.worldGenWhilePaused&&this.world.tick(e);else{wt("start"),function(e){var t=e.ents.getPositionData(e.playerEntity)._localPosition,n=e._originRebaseDistance;if(lt.sqrLen(t)<n*n)return;for(var r=[],o=0;o<3;o++){var i=Math.floor(t[o]);r[o]=i,e.worldOriginOffset[o]+=i}e.rendering._rebaseOrigin(r),e.entities._rebaseOrigin(r)}(this);var e=this._tickRate;if(this.world.tick(e),wt("world"),this.world.playerChunkLoaded){this.physics.tick(e),wt("physics"),this.rendering.tick(e),wt("rendering"),function(e){var t="",n=e.blockTargetIdCheck||e.registry.getBlockSolidity,r=e._localPick(null,null,null,n);if(r){var o=yt;lt.floor(o.adjacent,r.position),lt.copy(o.normal,r.normal),lt.sub(o.position,o.adjacent,o.normal),o.blockID=e.world.getBlockID(o.position[0],o.position[1],o.position[2]),e.targetedBlock=o,t=o.position.join("|")+o.normal.join("|")+"|"+o.blockID}else e.targetedBlock=null;t!=bt&&(e.emit("targetBlockChanged",e.targetedBlock),bt=t)}(this),wt("targets"),this.entities.tick(e),wt("entities"),this.emit("tick",e),wt("tick event"),wt("end");var t=this.inputs.state;t.scrollx=t.scrolly=t.scrollz=0}else this.rendering.tick(e)}},vt.prototype.render=function(e){this.positionInCurrentTick=e;var t=performance.now(),n=t-(this._lastRenderTime||t-16);this._lastRenderTime=t,this._paused?this.world.worldGenWhilePaused&&this.world.render():(kt("start"),(this.container.hasPointerLock||!this.container.supportsPointerLock||this._dragOutsideLock&&this.inputs.state.fire)&&this.camera.applyInputsToCamera(),kt("init"),this.world.render(n),kt("meshing"),this.camera.updateBeforeEntityRenderSystems(),this.entities.render(n),this.camera.updateAfterEntityRenderSystems(),kt("entities"),this.emit("beforeRender",n),kt("before render"),this.rendering.render(n),kt("render"),this.emit("afterRender",n),kt("after render"),kt("end"),this.inputs.state.dx=this.inputs.state.dy=0)},vt.prototype.globalToLocal=function(e,t,n){var r=this.worldOriginOffset;if(t){for(var o=0;o<3;o++){var i=e[o]-r[o];i+=t[o],n[o]=i}return n}return lt.sub(n,e,r)},vt.prototype.localToGlobal=function(e,t,n){var r=this.worldOriginOffset;if(n){for(var o=0;o<3;o++){var i=Math.floor(e[o]);t[o]=i+r[o],n[o]=e[o]-i}return t}return lt.add(t,e,r)},vt.prototype.setPaused=function(e){this._paused=!!e,e||(this.inputs.state.dx=this.inputs.state.dy=0)},vt.prototype.getBlock=function(e,t,n){return e.length?this.world.getBlockID(e[0],e[1],e[2]):this.world.getBlockID(e,t,n)},vt.prototype.setBlock=function(e,t,n,r){return t.length?this.world.setBlockID(e,t[0],t[1],t[2]):this.world.setBlockID(e,t,n,r)},vt.prototype.addBlock=function(e,t,n,r){if(t.length){if(this.entities.isTerrainBlocked(t[0],t[1],t[2]))return;return this.world.setBlockID(e,t[0],t[1],t[2]),e}if(!this.entities.isTerrainBlocked(t,n,r))return this.world.setBlockID(e,t,n,r),e},vt.prototype.pick=function(e,t,n,r){return 0===n?null:(e&&(this.globalToLocal(e,null,_t),e=_t),this._localPick(e,t,n,r))};var _t=lt.create();vt.prototype._localPick=function(e,t,n,r){if(0===n)return null;var o=r||this.registry.getBlockSolidity,i=this.world,a=this.worldOriginOffset;e||(e=this.camera._localGetTargetPosition()),t=t||this.camera.getDirection(),n=n||this.blockTestDistance;var s=gt._localPosition,u=gt.normal;return dt((function(e,t,n){var r=i.getBlockID(e+a[0],t+a[1],n+a[2]);return o(r)}),e,t,n,s,u)?(lt.scaleAndAdd(s,s,u,.01),this.localToGlobal(s,gt.position),gt):null};var gt={_localPosition:lt.create(),position:[0,0,0],normal:[0,0,0]};var yt={blockID:0,position:[],normal:[],adjacent:[]},bt="";var wt=()=>{},kt=()=>{};n(362),n(363),n(150),n(230);function xt(e){var t=e.rendering.getScene(),n=game.items,r={},o=1;return r.stone=i(o++,"stone",0,["block/stone"],{},{drop:n.cobblestone}),r.dirt=i(o++,"dirt",0,["block/dirt"],{},{drop:n.dirt}),r.grass=i(o++,"grass",0,["block/grass_top","block/dirt","block/grass_side"],{},{drop:n.dirt}),r.grass_snow=i(o++,"grass_snow",0,["block/snow","block/dirt","block/grass_snow"],{},{drop:n.dirt}),r.cobblestone=i(o++,"cobblestone",0,["block/cobblestone"],{},{drop:n.cobblestone}),r.log=i(o++,"log",0,["block/log_top","block/log"],{},{drop:n.log}),r.sand=i(o++,"sand",0,["block/sand"],{},{drop:n.sand}),r.leaves=i(o++,"leaves",0,["block/leaves"],{opaque:!1},{drop:n.leaves}),e.registry.registerMaterial("water",[.5,.5,.8,.7],null,!0),r.water=i(o++,"water",0,["block/water"],{material:"water",fluid:!0,fluidDensity:20,viscosity:20.5},{}),r.red_flower=i(o++,"red_flower",1,["block/red_flower"],{solid:!1,opaque:!1},{drop:n.red_flower}),r.grass_plant=i(o++,"grass_plant",1,["block/grass_plant"],{solid:!1,opaque:!1},{drop:n.grass_plant}),r.yellow_flower=i(o++,"yellow_flower",1,["block/yellow_flower"],{solid:!1,opaque:!1},{drop:n.yellow_flower}),r.bricks=i(o++,"bricks",0,["block/bricks"],{},{drop:n.bricks}),r.planks=i(o++,"planks",0,["block/planks"],{},{drop:n.planks}),r.glass=i(o++,"glass",0,["block/glass"],{opaque:!1},{drop:n.glass}),r.bookshelf=i(o++,"bookshelf",0,["block/planks","block/bookshelf"],{},{drop:n.bookshelf}),e.registry.registerMaterial("barrier",[0,0,0,.2],null,!0),r.barrier=i(o++,"barrier",0,[],{material:"barrier"},{illegal:!0,unbreakable:!0}),r.snow=i(o++,"snow",0,["block/snow"],{},{drop:n.snow}),r.coal_ore=i(o++,"coa_ore",0,["block/coal_ore"],{},{drop:n.coal}),r.iron_ore=i(o++,"iron_ore",0,["block/iron_ore"],{},{drop:n.iron_ore}),r;function i(n,r,o,i,a,s){if(0==o){var u=[];if(1==i.length&&null==a.material)e.registry.registerMaterial(r,[0,0,0],i[0]+".png",!0),u=r;else if(null==a.material)for(var c=0;c<i.length;c++)e.registry.registerMaterial(r+c,[0,0,0],i[c]+".png",!0),u.push(r+c);else u=a.material;game.blockdata[n]={name:r,mesh:h,options:a,textures:i,data:s,type:0},(l=a).material=u,e.registry.registerBlock(n,l)}else if(1==o){e.registry.registerMaterial(r,[0,0,0],i[0]);var l,h=function(e,t,n){var r=n||"sprite-mat",o=new BABYLON.Texture(t,e,!0,!0,BABYLON.Texture.NEAREST_SAMPLINGMODE);o.hasAlpha=!0;var i=BABYLON.Mesh.CreatePlane("sprite-"+r,1,e),a=new BABYLON.StandardMaterial("sprite-mat-"+r,e);a.specularColor=new BABYLON.Color3(0,0,0),a.emissiveColor=new BABYLON.Color3(1,1,1),a.backFaceCulling=!1,a.diffuseTexture=o,i.material=a,i.rotation.y+=.81;var s=BABYLON.Matrix.Translation(0,.5,0);i.bakeTransformIntoVertices(s);var u=i.clone();return u.rotation.y+=1.62,BABYLON.Mesh.MergeMeshes([i,u],!0)}(t,"textures/"+i[0]+".png",r);game.blockdata[n]={name:r,mesh:h,options:a,textures:i,data:s,type:1},(l=a).blockMesh=h,e.registry.registerBlock(n,l)}return n}}var At=n(281),Tt=n.n(At);function Mt(e){var t=e.playerEntity,n=e.entities.getPositionData(t);n.width,n.height,e.ents.getPositionData(e.playerEntity).height;BABYLON.SceneLoader.ImportMesh(["player"],"./models/","player.gltf",scene,(function(n,r,o){var i=n[0];e.ents.getPositionData(e.playerEntity).height;i.scaling=new BABYLON.Vector3(.06,.06,.06);e.entities.addComponent(t,e.entities.names.mesh,{mesh:i,offset:[0,0,0]});var a=n.slice(1);a.forEach((function(t){e.rendering.addMeshToScene(t)}));var s={};s.idle=scene.getAnimationGroupByName("idle"),s.walk=scene.getAnimationGroupByName("walking"),e.on("tick",(function(){a.forEach((function(t){t.visibility=e.camera.zoomDistance/5,t.rotation.y=e.camera.heading})),e.entities.getState(t,"movement").running?(s.idle.stop(),s.walk.play(!0),s.walk):(s.idle.play(!0),s.walk.stop())})),console.log()}));var r=e.entities.getMovement(t);r.maxSpeed=10,r.jumpForce=8;for(var o={},i=0;i<36;i++)o[i]={};e.ents.createComponent({name:"inventory",state:{main:{},selected:0,tempslot:{}}}),e.ents.addComponent(t,"inventory",{main:o}),0==game.mode?r.airJumps=0:executeCommand("giveall")}function Et(e,t,n,r){if(null==game.items[t])return!1;var o=noa.ents.getState(e,"inventory"),i=Object.entries(o.main);for(var[a,r]of i)if(r.id==t&&r.count+n<game.itemdata[t].data.stack+1)return o.main[a]={id:t,count:n+r.count,data:r},!0;for(var[a,r]of i)if(null==r.id)return o.main[a]={id:t,count:n,data:r},!0;return!1}function Ct(e,t,n){var r=noa.ents.getState(e,"inventory"),o=Object.entries(r.main),i=r.selected;if(r.main[i].id==t){var a=r.main[i].count-n;if(n-=r.main[i].count,r.main[i]=a>0?{id:t,count:a,data:r.main[i].data}:{},n<=0)return!0}for(var[s,u]of o){if(n<=0)return!0;if(u.id==t){a=u.count-n;n-=u.count,r.main[s]=a>0?{id:t,count:a,data:u.data}:{}}}return!0}function Pt(e){var t=noa.ents.getState(1,"inventory");if(e>=0){var n={...t.tempslot},r={...t.main[e]};if(n.id==r.id&&null!=n.id){if(r.count+n.count<=game.itemdata[r.id].data.stack)(o={...r}).count=r.count+n.count,t.main[e]=o,t.tempslot={};else if(r.count+n.count>game.itemdata[r.id].data.stack){var o={...r},i={...n};o.count=game.itemdata[r.id].data.stack,i.count=r.count+n.count-game.itemdata[r.id].data.stack,t.main[e]=o,t.tempslot=i}}else t.main[e]=n,t.tempslot=r}else if(-1==e){var a={...t.tempslot},s={...t.bin};null==a.id?(t.bin={},t.tempslot=s):(t.bin=a,t.tempslot={})}}function It(e){var t=noa.ents.getState(1,"inventory");if(e>=0){var n={...t.tempslot},r={...t.main[e]};if(null==n.id){var o={...r},i={...r};o.count=Math.ceil(o.count/2),i.count=Math.floor(i.count/2),i.count<=0&&(i={}),t.main[e]={...o},t.tempslot={...i}}else if(null==r.id){o={...n},i={...n};o.count=1,i.count=i.count-1,i.count<=0&&(i={}),t.main[e]={...o},t.tempslot={...i}}else if(r.id==n.id&&r.count+1<=game.itemdata[r.id].data.stack){o={...r},i={...n};o.count=o.count+1,i.count=i.count-1,i.count<=0&&(i={}),t.main[e]={...o},t.tempslot={...i}}}}function St(e){return noa.ents.getState(e,"inventory")}window.executeCommand=function(e){var t,n,r,o=e.split(" ");return o.shift(),e.startsWith("setblock ")?(n=[parseInt(o[0],10),parseInt(o[1],10),parseInt(o[2],10)],r=parseInt(o[3],10),noa.setBlock(r,n[0],n[1],n[2]),"Block "+n[0]+" "+n[1]+" "+n[2]+" has been set to "+game.blockNames[r]):e.startsWith("tp ")?(t=[parseInt(o[0],10),parseInt(o[1],10),parseInt(o[2],10)],noa.entities.setPosition(1,[t[0],t[1],t[2]]),"Teleported player to "+t[0]+" "+t[1]+" "+t[2]):e.startsWith("getInventory")?St(1):e.startsWith("giveall")?(Object.values(game.items).forEach((function(e){Et(1,e,999)})),"Gived items to player!"):e.startsWith("clearinv")?(Object.values(game.items).forEach((function(e){Ct(1,e,9999)})),"Cleared player's inventory"):e.startsWith("give ")?Et(1,o[0],parseInt(o[1]),o[2])?"Item added to player's inventory!":"Can't add item to player":"This command doesn't exist!"};var Bt=n(282),Dt=new(n(283).Howl)({volume:.15,loop:!0,src:["audio/drops.mp3"]});function Ot(e){Dt.volume(e)}function Lt(e){var t;jt(),Ft(),zt(),function(){var e=document.createElement("div");e.id="game_cross";"transform: translate(-50% -50%); border-radius:50%; background-color: white;","filter: opacity(0.5);height:6px; width:6px; backdrop-filter: invert(1);",e.style="position:absolute; top:50%; left:50%; z-index:0;transform: translate(-50% -50%); border-radius:50%; background-color: white;filter: opacity(0.5);height:6px; width:6px; backdrop-filter: invert(1);",document.body.appendChild(e)}(),(t=document.createElement("div")).id="game_chatbox",t.classList.add("col-3"),document.body.appendChild(t),e.on("tick",(function(){Rt()}))}function jt(){noa.playerEntity;var e=St(1);game.hotbarsize=9;var t=document.createElement("table");t.id="game_hotbar";t.style="position:fixed; bottom:5px; left:50%; z-index:0;color:white; height:auto; width:auto;font-size:40px; text-align:center; padding:3px;min-width:2em; transform: translateX(-50%);",document.body.appendChild(t);for(var n=document.createElement("tr"),r={},o=0;o<game.hotbarsize;o++)r[o]=document.createElement("th"),r[o].id=o,r[o].addEventListener("click",(function(){St(1).selected=parseInt(this.id)})),r[o].classList.add("align-bottom"),r[o].classList.add("hotbar_item"),n.appendChild(r[o]);t.appendChild(n),noa.on("tick",(async function(){for(var t=e.main,n=e.selected,o=0;o<game.hotbarsize;o++)o!=n||r[o].classList.contains("hotbar_selected")?o!=n&&r[o].classList.contains("hotbar_selected")&&r[o].classList.remove("hotbar_selected"):r[o].classList.add("hotbar_selected"),r[o].innerHTML=Nt(t[o])}))}function Ft(){var e=document.createElement("div");e.id="game_version";e.style="position:absolute; top:5; left:5; z-index:0;color:white; text-shadow: 1px 1px black;font-size:20px; margin:4px;",e.innerHTML=game.name+" "+game.version+"<br>Noa: "+noa.version+"<br>World: "+noa.worldName+'<br><span id="player_pos"></span>',document.body.appendChild(e)}function Rt(){var e=noa.playerEntity,t=noa.entities.getPositionData(e);document.getElementById("player_pos").innerHTML="X: "+Math.round(t.position[0])+" Y: "+Math.round(t.position[1])+" Z: "+Math.round(t.position[2])}function zt(){var e=noa.rendering.getScene(),t=BABYLON.MeshBuilder.CreateBox("skybox",{size:1e3},e),n=new BABYLON.StandardMaterial("skybox",e);n.backFaceCulling=!1,n.reflectionTexture=new BABYLON.CubeTexture("textures/skybox/skybox",e),n.reflectionTexture.coordinatesMode=BABYLON.Texture.SKYBOX_MODE,n.diffuseColor=new BABYLON.Color3(0,0,0),n.specularColor=new BABYLON.Color3(0,0,0),t.material=n,noa.rendering.addMeshToScene(t,!1),noa.on("beforeRender",(function(){var e=noa.playerEntity,n=noa.entities.getPositionData(e)._renderPosition;t.setPositionWithLocalVector(new BABYLON.Vector3(n[0],n[1],n[2]))}))}function Ut(){var e=noa.ents.getState(1,"inventory"),t=Object.entries(e.main),n=e.main;e.bin={};var r=document.createElement("div");r.id="game_screen";var o="position: absolute; top: 0; right: 0; bottom: 0; left: 0; z-index:1;";o+="color:white; height:auto; width:auto; background-color: #00000055;",o+="font-size:40px; text-align:center; padding:3px;",o+="min-width:2em;",r.style=o,document.body.appendChild(r);var i=document.createElement("table");i.id="game_inventory";o="position:fixed; bottom:50%; left:50%; z-index:2;";o+="color:white; height:auto; width:auto;",o+="font-size:40px; text-align:center; padding:3px;",o+="min-width:2em; transform: translate(-50%, 50%);",i.style=o,r.appendChild(i);var a={},s=9,u=document.createElement("th");u.id=-1,u.classList.add("align-bottom"),u.classList.add("inventory_item_bin"),u.addEventListener("click",(function(){Pt(parseInt(-1)),p()})),u.addEventListener("contextmenu",(function(){return It(parseInt(-1)),p(),!1})),u.innerHTML=Nt(e.bin),i.appendChild(u);var c=document.createElement("div");c.id="tempslot",c.classList.add("align-bottom"),c.classList.add("inventory_temp"),c.innerHTML=Nt(e.tempslot),r.appendChild(c);for(var l=0;l<t.length/9-1;l++){var h=document.createElement("tr");i.appendChild(h);for(var d=0;d<9;d++)a[s]=document.createElement("th"),a[s].id=s,a[s].addEventListener("click",(function(){Pt(parseInt(this.id)),p()})),a[s].addEventListener("contextmenu",(function(){return It(parseInt(this.id)),p(),!1})),a[s].classList.add("align-bottom"),a[s].classList.add("inventory_item"),a[s].innerHTML=Nt(n[s]),h.appendChild(a[s]),s+=1}var f=document.createElement("tr");i.appendChild(f);for(l=0;l<9;l++)a[l]=document.createElement("th"),a[l].id=l,a[l].classList.add("align-bottom"),a[l].classList.add("inventory_item_hotbar"),a[l].addEventListener("click",(function(){Pt(parseInt(this.id)),p()})),a[l].addEventListener("contextmenu",(function(){return It(parseInt(this.id)),p(),!1})),a[l].innerHTML=Nt(n[l]),f.appendChild(a[l]);function p(){for(var r=0;r<t.length;r++)a[r].innerHTML=Nt(n[r]);u.innerHTML=Nt(e.bin),c.innerHTML=Nt(e.tempslot)}window.addEventListener("mousemove",(function(e){c.style.left=e.x+"px",c.style.top=e.y+"px"}))}function Nt(e){if(null==e.id)return"";var t="";e.count==1/0?t="Inf":1!=e.count&&(t=e.count);try{var n=game.itemdata[e.id].texture}catch{n="error"}return'<img draggable="false" class="img-fluid item_icon" src="textures/'+n+'.png"><div class="item_count float-right">'+t+"</div>"}n(237),n(365);function Yt(e){e.inputs.down.on("fire",(function(){if(e.targetedBlock&&!game.blockdata[e.targetedBlock.blockID].data.unbreakable){var t=e.targetedBlock.blockID,n=game.blockdata[t].data.drop;e.setBlock(0,e.targetedBlock.position),Et(1,n,1,{})}})),e.inputs.down.on("alt-fire",(function(){var t=St(1),n=t.main[t.selected].id;if(null!=n&&0==game.itemdata[n].type){var r=game.blocks[n];if(e.targetedBlock&&null!=r&&!game.blockdata[r].data.illegal){var o=e.targetedBlock.adjacent;e.addBlock(r,o)==r&&Ct(1,n,1)}}})),e.inputs.down.on("mid-fire",(function(){})),e.inputs.bind("pause","P"),e.inputs.down.on("pause",(function(){t=!t,e.setPaused(t)}));var t=!1;e.inputs.bind("muteMusic","O"),e.inputs.down.on("muteMusic",(function(){0!=Dt.volume()?Ot(0):Ot(.15)})),e.inputs.bind("thirdprsn","M"),e.inputs.down.on("thirdprsn",(function(){15==e.camera.zoomDistance?e.camera.zoomDistance=0:0==e.camera.zoomDistance&&(e.camera.zoomDistance=15)})),e.inputs.bind("inventory","I"),e.inputs.down.on("inventory",(function(){var t=document.getElementById("game_screen");null!=t?(e.container.canvas.requestPointerLock(),document.body.removeChild(t),e.setPaused(!1)):(document.exitPointerLock(),e.setPaused(!0),Ut())})),e.inputs.bind("cmd","T"),e.inputs.down.on("cmd",(function(){!function(){var e=prompt("Send command"),t=executeCommand(e),n=document.createElement("cmdout");n.id="game_commandout",n.style="position:block; z-index:10;",n.classList.add("chat_text"),n.innerHTML=t+"<br>";var r=document.getElementById("game_chatbox");r.appendChild(n),setTimeout((function(){r.removeChild(document.getElementsByClassName("chat_text")[0])}),1e4)}()})),e.on("tick",(async function(t){var n=e.inputs.state.scrolly;if(0!==n){var r=St(1).selected;(r+=n>0?1:-1)>=game.hotbarsize?r=0:r<0&&(r=game.hotbarsize-1),St(1).selected=r}}));var r=!1,o=e.rendering.getScene();e.inputs.bind("debug","Z"),e.inputs.down.on("debug",()=>{n.e(2).then(n.t.bind(null,370,7)).then(e=>{(r=!r)?o.debugLayer.show():o.debugLayer.hide()})})}n(82);function Ht(){var e=new pt({debug:!0,showFPS:!0,inverseY:!1,inverseX:!1,sensitivityX:15,sensitivityY:15,chunkSize:24,chunkAddDistance:5.5,chunkRemoveDistance:5,blockTestDistance:10,tickRate:60,texturePath:"textures/",playerStart:[.5,100,.5],playerHeight:1.85,playerWidth:.5,playerAutoStep:!1,clearColor:[.8,.9,1],ambientColor:[1,1,1],lightDiffuse:[1,1,1],lightSpecular:[1,1,1],groundLightColor:[.5,.5,.5],useAO:!0,AOmultipliers:[.93,.8,.5],reverseAOmultiplier:1,preserveDrawingBuffer:!0,gravity:[0,-16,0]});e.setMaxListeners(100);e.rendering.getScene();game.itemdata={},game.items=function(e){e.rendering.getScene(),game.blocks;var t={};return t.stone=n("stone","Stone",0,"block/stone",{stack:64}),t.dirt=n("dirt","Dirt",0,"block/dirt",{stack:64}),t.grass=n("grass","Grass block",0,"block/grass_side",{stack:64}),t.grass_snow=n("grass_snow","Snowy grass block",0,"block/grass_snow",{stack:64}),t.cobblestone=n("cobblestone","Cobblestone",0,"block/cobblestone",{stack:64}),t.log=n("log","Log",0,"block/log",{stack:64}),t.sand=n("sand","Sand",0,"block/sand",{stack:64}),t.leaves=n("leaves","Leaves",0,"block/leaves",{stack:64}),t.red_flower=n("red_flower","Poppy",0,"block/red_flower",{stack:64}),t.grass_plant=n("grass_plant","Grass",0,"block/grass_plant",{stack:64}),t.yellow_flower=n("yellow_flower","Dandelion",0,"block/yellow_flower",{stack:64}),t.bricks=n("bricks","Bricks",0,"block/bricks",{stack:64}),t.planks=n("planks","Planks",0,"block/planks",{stack:64}),t.glass=n("glass","Glass",0,"block/glass",{stack:64}),t.bookshelf=n("bookshelf","Bookshelf",0,"block/bookshelf",{stack:64}),t.snow=n("snow","Snow block",0,"block/snow",{stack:64}),t.coal_ore=n("coal_ore","Coal ore",0,"block/coal_ore",{stack:64}),t.iron_ore=n("iron_ore","Iron ore",0,"block/iron_ore",{stack:64}),t.iron_pickaxe=n("iron_pickaxe","Iron pickaxe",1,"item/iron_pickaxe",{stack:1}),t.coal=n("coal","Coal",1,"item/coal",{stack:64}),t;function n(e,t,n,r,o){return game.itemdata[e]={name:t,type:n,texture:r,data:o},e}}(e),game.blockdata={},game.blocks=xt(e);game.blocks;game.blockNames=function(e){var t={};for(let[n,r]of Object.entries(e))t[r]=n;return t}(game.blocks),function(e){e.worldName=game.world;var t=new Tt.a;t.postMessage({msg:"init",blocks:game.blocks,seed:game.seed}),e.world.on("worldDataNeeded",(function(e,n,r,o,i){t.postMessage({msg:"generate",data:n.data,shape:n.shape,id:e,x:r,y:o,z:i})})),e.world.on("chunkBeingRemoved",(function(e,n,r){t.postMessage({msg:"savechunk",data:n.data,shape:n.shape,id:e})})),t.addEventListener("message",(function(t){if("generated"==t.data.msg){var n=t.data.id,r=new ndarray(t.data.data,t.data.shape);e.world.setChunkData(n,r)}}))}(e),Mt(e),Yt(e),Object(Bt.a)(e),Lt(e),Dt.play(),window.onbeforeunload=function(){return"Are you sure you want to leave (or you just tried to spint)? "}}},function(e,t,n){"use strict";n.r(t),function(e){var t=n(284);e.game={},game.name="VoxelSrv",game.version="0.0.5",game.world="temp",game.seed=(new Date).getTime()/1e3,game.mode=1,Object(t.a)()}.call(this,n(110))},function(e,t){e.exports=function(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}},function(e,t,n){e.exports=function(e,t){var n=r(e[0],e[1],e[2]),a=r(t[0],t[1],t[2]);o(n,n),o(a,a);var s=i(n,a);return s>1?0:Math.acos(s)};var r=n(258),o=n(259),i=n(260)},function(e,t){e.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}},function(e,t){e.exports=function(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}},function(e,t,n){e.exports=function(e,t){var n=e[0],o=e[1],i=e[2],a=t[0],s=t[1],u=t[2];return Math.abs(n-a)<=r*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(o-s)<=r*Math.max(1,Math.abs(o),Math.abs(s))&&Math.abs(i-u)<=r*Math.max(1,Math.abs(i),Math.abs(u))};var r=n(256)},function(e,t){e.exports=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}},function(e,t,n){e.exports=n(261)},function(e,t,n){e.exports=n(262)},function(e,t,n){e.exports=n(263)},function(e,t){e.exports=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}},function(e,t){e.exports=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}},function(e,t){e.exports=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}},function(e,t){e.exports=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}},function(e,t){e.exports=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}},function(e,t){e.exports=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}},function(e,t,n){e.exports=n(264)},function(e,t,n){e.exports=n(265)},function(e,t,n){e.exports=n(266)},function(e,t,n){e.exports=n(267)},function(e,t){e.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}},function(e,t){e.exports=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}},function(e,t){e.exports=function(e,t,n){var r=t[0],o=t[1],i=t[2],a=n[0],s=n[1],u=n[2];return e[0]=o*u-i*s,e[1]=i*a-r*u,e[2]=r*s-o*a,e}},function(e,t){e.exports=function(e,t,n,r){var o=t[0],i=t[1],a=t[2];return e[0]=o+r*(n[0]-o),e[1]=i+r*(n[1]-i),e[2]=a+r*(n[2]-a),e}},function(e,t){e.exports=function(e,t){t=t||1;var n=2*Math.random()*Math.PI,r=2*Math.random()-1,o=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*o,e[1]=Math.sin(n)*o,e[2]=r*t,e}},function(e,t){e.exports=function(e,t,n){var r=t[0],o=t[1],i=t[2],a=n[3]*r+n[7]*o+n[11]*i+n[15];return a=a||1,e[0]=(n[0]*r+n[4]*o+n[8]*i+n[12])/a,e[1]=(n[1]*r+n[5]*o+n[9]*i+n[13])/a,e[2]=(n[2]*r+n[6]*o+n[10]*i+n[14])/a,e}},function(e,t){e.exports=function(e,t,n){var r=t[0],o=t[1],i=t[2];return e[0]=r*n[0]+o*n[3]+i*n[6],e[1]=r*n[1]+o*n[4]+i*n[7],e[2]=r*n[2]+o*n[5]+i*n[8],e}},function(e,t){e.exports=function(e,t,n){var r=t[0],o=t[1],i=t[2],a=n[0],s=n[1],u=n[2],c=n[3],l=c*r+s*i-u*o,h=c*o+u*r-a*i,d=c*i+a*o-s*r,f=-a*r-s*o-u*i;return e[0]=l*c+f*-a+h*-u-d*-s,e[1]=h*c+f*-s+d*-a-l*-u,e[2]=d*c+f*-u+l*-s-h*-a,e}},function(e,t){e.exports=function(e,t,n,r){var o=n[1],i=n[2],a=t[1]-o,s=t[2]-i,u=Math.sin(r),c=Math.cos(r);return e[0]=t[0],e[1]=o+a*c-s*u,e[2]=i+a*u+s*c,e}},function(e,t){e.exports=function(e,t,n,r){var o=n[0],i=n[2],a=t[0]-o,s=t[2]-i,u=Math.sin(r),c=Math.cos(r);return e[0]=o+s*u+a*c,e[1]=t[1],e[2]=i+s*c-a*u,e}},function(e,t){e.exports=function(e,t,n,r){var o=n[0],i=n[1],a=t[0]-o,s=t[1]-i,u=Math.sin(r),c=Math.cos(r);return e[0]=o+a*c-s*u,e[1]=i+a*u+s*c,e[2]=t[2],e}},function(e,t,n){e.exports=function(e,t,n,o,i,a){var s,u;t||(t=3);n||(n=0);u=o?Math.min(o*t+n,e.length):e.length;for(s=n;s<u;s+=t)r[0]=e[s],r[1]=e[s+1],r[2]=e[s+2],i(r,r,a),e[s]=r[0],e[s+1]=r[1],e[s+2]=r[2];return e};var r=n(257)()},function(e,t){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(n(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,o,i){var a=+t[0],s=+t[1],u=+t[2],c=+n[0],l=+n[1],h=+n[2],d=Math.sqrt(c*c+l*l+h*h);if(0===d)throw new Error("Can't raycast along a zero vector");return function(e,t,n,r,o,i,a,s,u,c){for(var l=0,h=Math.floor,d=0|h(t),f=0|h(n),p=0|h(r),m=o>0?1:-1,v=i>0?1:-1,_=a>0?1:-1,g=Math.abs(1/o),y=Math.abs(1/i),b=Math.abs(1/a),w=g<1/0?g*(m>0?d+1-t:t-d):1/0,k=y<1/0?y*(v>0?f+1-n:n-f):1/0,x=b<1/0?b*(_>0?p+1-r:r-p):1/0,A=-1;l<=s;){var T=e(d,f,p);if(T)return u&&(u[0]=t+l*o,u[1]=n+l*i,u[2]=r+l*a),c&&(c[0]=c[1]=c[2]=0,0===A&&(c[0]=-m),1===A&&(c[1]=-v),2===A&&(c[2]=-_)),T;w<k?w<x?(d+=m,l=w,w+=g,A=0):(p+=_,l=x,x+=b,A=2):k<x?(f+=v,l=k,k+=y,A=1):(p+=_,l=x,x+=b,A=2)}return u&&(u[0]=t+l*o,u[1]=n+l*i,u[2]=r+l*a),c&&(c[0]=c[1]=c[2]=0),0}(e,a,s,u,c/=d,l/=d,h/=d,r=void 0===r?64:+r,o,i)}},function(e,t,n){"use strict";var r=n(166).EventEmitter,o=n(322),i=n(326),a=n(327),s=n(328),u=n(329),c=n(330),l=n(268),h=Math.min;n(331);var d=n(332),f=n(333),p=function(){var e,t,n=new Array(256);for(e=0;e<256;++e)n[e]="UNK";for(e in a)"<"===(t=a[e]).charAt(0)&&">"===t.charAt(t.length-1)&&(t=t.substring(1,t.length-1)),t=t.replace(/\s/g,"-"),n[parseInt(e)]=t;return n}(),m=u(Object.keys(s(p)));function v(e){return c.eq(m,e)}function _(e){return v(p[e])}function g(){r.call(this),this._curKeyState=new Array(m.length),this._pressCount=new Array(m.length),this._releaseCount=new Array(m.length),this._tickInterval=null,this._rafHandle=null,this._tickRate=0,this._lastTick=f(),this._frameTime=0,this._paused=!0,this._width=0,this._height=0,this._wantFullscreen=!1,this._wantPointerLock=!1,this._fullscreenActive=!1,this._pointerLockActive=!1,this._rafFunction=E.bind(void 0,this,!0),this.preventDefaults=!0,this.stopPropagation=!1;for(var e=0;e<m.length;++e)this._curKeyState[e]=!1,this._pressCount[e]=this._releaseCount[e]=0;this.element=null,this.bindings={},this.frameSkip=100,this.tickCount=0,this.frameCount=0,this.startTime=f(),this.tickTime=this._tickRate,this.frameTime=10,this.stickyFullscreen=!1,this.stickyPointerLock=!1,this.scroll=[0,0,0],this.mouseX=0,this.mouseY=0,this.prevMouseX=0,this.prevMouseY=0}o.inherits(g,r);var y=g.prototype;function b(e,t,n){if(n in t){for(var r=t[n],o=0,i=0,a=r.length;i<a;++i)o+=e[v(r[i])];return o}var s=v(n);return s>=0?e[s]:0}function w(e){var t=e.element;e._wantFullscreen&&!e._fullscreenActive&&(t.requestFullscreen||t.requestFullScreen||t.webkitRequestFullscreen||t.webkitRequestFullScreen||t.mozRequestFullscreen||t.mozRequestFullScreen||function(){}).call(t);e._wantPointerLock&&!e._pointerLockActive&&(t.requestPointerLock||t.webkitRequestPointerLock||t.mozRequestPointerLock||t.msRequestPointerLock||t.oRequestPointerLock||function(){}).call(t)}y.keyNames=m,y.bind=function(e){var t,n;t=e in this.bindings?this.bindings[e]:[];for(var r=1,o=arguments.length;r<o;++r)if(v(n=arguments[r])>=0)t.push(n);else if(n in this.bindings)for(var i=this.bindings[n],a=0;a<i.length;++a)t.push(i[a]);(t=u(t)).length>0&&(this.bindings[e]=t),this.emit("bind",e,t)},y.unbind=function(e){e in this.bindings&&delete this.bindings[e],this.emit("unbind",e)},y.down=function(e){return function(e,t,n){if(n in t){for(var r=t[n],o=0,i=r.length;o<i;++o)if(e[v(r[o])])return!0;return!1}var a=v(n);return a>=0&&e[a]}(this._curKeyState,this.bindings,e)},y.wasDown=function(e){return this.down(e)||!!this.press(e)},y.up=function(e){return!this.down(e)},y.wasUp=function(e){return this.up(e)||!!this.release(e)},y.press=function(e){return b(this._pressCount,this.bindings,e)},y.release=function(e){return b(this._releaseCount,this.bindings,e)},Object.defineProperty(y,"paused",{get:function(){return this._paused},set:function(e){!!e!==this._paused&&(this._paused?(this._paused=!1,this._lastTick=f()-Math.floor(this._frameTime*this._tickRate),this._tickInterval=setInterval(E,this._tickRate,this,!1),this._rafHandle=requestAnimationFrame(this._rafFunction)):(this._paused=!0,this._frameTime=h(1,(f()-this._lastTick)/this._tickRate),clearInterval(this._tickInterval)))}});var k=document.exitFullscreen||document.cancelFullscreen||document.cancelFullScreen||document.webkitCancelFullscreen||document.webkitCancelFullScreen||document.mozCancelFullscreen||document.mozCancelFullScreen||function(){};function x(e){e._fullscreenActive=document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||!1,!e.stickyFullscreen&&e._fullscreenActive&&(e._wantFullscreen=!1)}Object.defineProperty(y,"fullscreen",{get:function(){return this._fullscreenActive},set:function(e){!e?(this._wantFullscreen=!1,(document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||!1)&&k.call(document)):(this._wantFullscreen=!0,w(this));return this._fullscreenActive}});var A=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock||function(){};function T(e,t){e._pointerLockActive=e.element===(document.pointerLockElement||document.mozPointerLockElement||document.webkitPointerLockElement||null),!e.stickyPointerLock&&e._pointerLockActive&&(e._wantPointerLock=!1)}function M(e,t,n){e._curKeyState[t]!==n&&(n?e._pressCount[t]++:e._releaseCount[t]++,e._curKeyState[t]=n)}function E(e,t){!function(e){var t,n,r,o=f()+e.frameSkip,i=e._pressCount,a=e._releaseCount,s=e._tickRate,u=m.length;for(;!e._paused&&f()>=e._lastTick+s;){if(f()>o)return void(e._lastTick=f()+s);for(n=f(),e.emit("tick"),r=f(),e.tickTime=r-n,++e.tickCount,e._lastTick+=s,t=0;t<u;++t)i[t]=a[t]=0;e._pointerLockActive?(e.prevMouseX=e.mouseX=e.width>>1,e.prevMouseY=e.mouseY=e.height>>1):(e.prevMouseX=e.mouseX,e.prevMouseY=e.mouseY),e.scroll[0]=e.scroll[1]=e.scroll[2]=0}}(e),t&&function(e){var t;e._rafHandle=requestAnimationFrame(e._rafFunction),t=e._paused?e._frameTime:h(1,(f()-e._lastTick)/e._tickRate);++e.frameCount;var n=f();e.emit("render",t);var r=f();e.frameTime=r-n}(e)}function C(e,t){e.preventDefaults&&t.preventDefault(),e.stopPropagation&&t.stopPropagation()}function P(e,t){C(e,t);var n=_(t.keyCode||t.char||t.which||t.charCode);n>=0&&M(e,n,!1)}function I(e,t){if(function(e){return document.activeElement===document.body||document.activeElement===e.element}(e))if(C(e,t),t.metaKey)z(e,t);else{var n=_(t.keyCode||t.char||t.which||t.charCode);n>=0&&M(e,n,!0)}}Object.defineProperty(y,"pointerLock",{get:function(){return this._pointerLockActive},set:function(e){return!!e?(this._wantPointerLock=!0,w(this)):(this._wantPointerLock=!1,A.call(document)),this._pointerLockActive}}),Object.defineProperty(y,"width",{get:function(){return this.element.clientWidth}}),Object.defineProperty(y,"height",{get:function(){return this.element.clientHeight}});var S=l(32).map((function(e){return v("mouse-"+(e+1))}));function B(e,t){if(C(e,t),e._pointerLockActive){var n=t.movementX||t.mozMovementX||t.webkitMovementX||0,r=t.movementY||t.mozMovementY||t.webkitMovementY||0;e.mouseX+=n,e.mouseY+=r}else e.mouseX=t.clientX-e.element.offsetLeft,e.mouseY=t.clientY-e.element.offsetTop;return!1}function D(e,t){return C(e,t),M(e,S[t.button],!0),!1}function O(e,t){return C(e,t),M(e,S[t.button],!1),!1}function L(e,t){return C(e,t),e._pointerLockActive?(e.prevMouseX=e.mouseX=e.width>>1,e.prevMouseY=e.mouseY=e.height>>1):(e.prevMouseX=e.mouseX=t.clientX-e.element.offsetLeft,e.prevMouseY=e.mouseY=t.clientY-e.element.offsetTop),!1}function j(e,t){return C(e,t),function(e,t){for(var n=0;n<32;++n)M(e,S[n],!!(t&1<<n))}(e,0),!1}function F(e,t){C(e,t);var n=1;switch(t.deltaMode){case 0:n=1;break;case 1:n=12;break;case 2:n=e.height}return e.scroll[0]+=t.deltaX*n,e.scroll[1]+=t.deltaY*n,e.scroll[2]+=t.deltaZ*n||0,!1}function R(e,t){return C(e,t),!1}function z(e,t){var n,r=m.length,o=e._curKeyState,i=e._releaseCount;for(n=0;n<r;++n)o[n]&&++i[n],o[n]=!1;return!1}function U(e,t){var n=0|e.element.clientWidth,r=0|e.element.clientHeight;n===e._width&&r===e._height||(e._width=n,e._height=r,e.emit("resize",n,r))}function N(){var e=document.createElement("div");return e.tabindex=1,e.style.position="absolute",e.style.left="0px",e.style.right="0px",e.style.top="0px",e.style.bottom="0px",e.style.height="100%",e.style.overflow="hidden",document.body.appendChild(e),document.body.style.overflow="hidden",document.body.style.height="100%",e}e.exports=function(e){var t=!!(e=e||{}).fullscreen,n=t;void 0!==typeof e.pointerLock&&(n=!!e.pointerLock);var r=new g;return r._tickRate=e.tickRate||30,r.frameSkip=e.frameSkip||5*(r._tickRate+5),r.stickyFullscreen=!!e.stickyFullscreen||!!e.sticky,r.stickyPointerLock=!!e.stickyPointerLock||!!e.sticky,e.bindings&&(r.bindings=e.bindings),setTimeout((function(){i((function(){var o=e.element;if("string"==typeof o){var i=document.querySelector(o);i||(i=document.getElementById(o)),i||(i=document.getElementByClass(o)[0]),i||(i=N()),r.element=i}else r.element="object"==typeof o&&o?o:"function"==typeof o?o():N();r.element.style&&(r.element.style["-webkit-touch-callout"]="none",r.element.style["-webkit-user-select"]="none",r.element.style["-khtml-user-select"]="none",r.element.style["-moz-user-select"]="none",r.element.style["-ms-user-select"]="none",r.element.style["user-select"]="none"),r._width=r.element.clientWidth,r._height=r.element.clientHeight;var a=U.bind(void 0,r);"undefined"!=typeof MutationObserver?new MutationObserver(a).observe(r.element,{attributes:!0,subtree:!0}):r.element.addEventListener("DOMSubtreeModified",a,!1);window.addEventListener("resize",a,!1),window.addEventListener("keydown",I.bind(void 0,r),!1),window.addEventListener("keyup",P.bind(void 0,r),!1),r.element.oncontextmenu=R.bind(void 0,r),r.element.addEventListener("mousedown",D.bind(void 0,r),!1),r.element.addEventListener("mouseup",O.bind(void 0,r),!1),r.element.addEventListener("mousemove",B.bind(void 0,r),!1),r.element.addEventListener("mouseenter",L.bind(void 0,r),!1);var s=j.bind(void 0,r);r.element.addEventListener("mouseleave",s,!1),r.element.addEventListener("mouseout",s,!1),window.addEventListener("mouseleave",s,!1),window.addEventListener("mouseout",s,!1);var u=z.bind(void 0,r);r.element.addEventListener("blur",u,!1),r.element.addEventListener("focusout",u,!1),r.element.addEventListener("focus",u,!1),window.addEventListener("blur",u,!1),window.addEventListener("focusout",u,!1),window.addEventListener("focus",u,!1),d(r.element,F.bind(void 0,r),!1);var c=x.bind(void 0,r);document.addEventListener("fullscreenchange",c,!1),document.addEventListener("mozfullscreenchange",c,!1),document.addEventListener("webkitfullscreenchange",c,!1),r.element.addEventListener("click",w.bind(void 0,r),!1);var l=T.bind(void 0,r);document.addEventListener("pointerlockchange",l,!1),document.addEventListener("mozpointerlockchange",l,!1),document.addEventListener("webkitpointerlockchange",l,!1),document.addEventListener("pointerlocklost",l,!1),document.addEventListener("webkitpointerlocklost",l,!1),document.addEventListener("mozpointerlocklost",l,!1),r.fullscreen=t,r.pointerLock=n,r.bind("mouse-left","mouse-1"),r.bind("mouse-right","mouse-3"),r.bind("mouse-middle","mouse-2"),r._lastTick=f(),r.startTime=f(),r.paused=!1,r.emit("init")}))}),0),r}},function(e,t,n){(function(e){var r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},o=/%[sdj%]/g;t.format=function(e){if(!_(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(s(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,i=r.length,a=String(e).replace(o,(function(e){if("%%"===e)return"%";if(n>=i)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),u=r[n];n<i;u=r[++n])m(u)||!b(u)?a+=" "+u:a+=" "+s(u);return a},t.deprecate=function(n,r){if(void 0!==e&&!0===e.noDeprecation)return n;if(void 0===e)return function(){return t.deprecate(n,r).apply(this,arguments)};var o=!1;return function(){if(!o){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),o=!0}return n.apply(this,arguments)}};var i,a={};function s(e,n){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),p(n)?r.showHidden=n:n&&t._extend(r,n),g(r.showHidden)&&(r.showHidden=!1),g(r.depth)&&(r.depth=2),g(r.colors)&&(r.colors=!1),g(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=u),l(r,e,r.depth)}function u(e,t){var n=s.styles[t];return n?"["+s.colors[n][0]+"m"+e+"["+s.colors[n][1]+"m":e}function c(e,t){return e}function l(e,n,r){if(e.customInspect&&n&&x(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,e);return _(o)||(o=l(e,o,r)),o}var i=function(e,t){if(g(t))return e.stylize("undefined","undefined");if(_(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(v(t))return e.stylize(""+t,"number");if(p(t))return e.stylize(""+t,"boolean");if(m(t))return e.stylize("null","null")}(e,n);if(i)return i;var a=Object.keys(n),s=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(n)),k(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return h(n);if(0===a.length){if(x(n)){var u=n.name?": "+n.name:"";return e.stylize("[Function"+u+"]","special")}if(y(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return e.stylize(Date.prototype.toString.call(n),"date");if(k(n))return h(n)}var c,b="",A=!1,T=["{","}"];(f(n)&&(A=!0,T=["[","]"]),x(n))&&(b=" [Function"+(n.name?": "+n.name:"")+"]");return y(n)&&(b=" "+RegExp.prototype.toString.call(n)),w(n)&&(b=" "+Date.prototype.toUTCString.call(n)),k(n)&&(b=" "+h(n)),0!==a.length||A&&0!=n.length?r<0?y(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),c=A?function(e,t,n,r,o){for(var i=[],a=0,s=t.length;a<s;++a)C(t,String(a))?i.push(d(e,t,n,r,String(a),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(d(e,t,n,r,o,!0))})),i}(e,n,r,s,a):a.map((function(t){return d(e,n,r,s,t,A)})),e.seen.pop(),function(e,t,n){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(c,b,T)):T[0]+b+T[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,n,r,o,i){var a,s,u;if((u=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),C(r,o)||(a="["+o+"]"),s||(e.seen.indexOf(u.value)<0?(s=m(n)?l(e,u.value,null):l(e,u.value,n-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),g(a)){if(i&&o.match(/^\d+$/))return s;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function f(e){return Array.isArray(e)}function p(e){return"boolean"==typeof e}function m(e){return null===e}function v(e){return"number"==typeof e}function _(e){return"string"==typeof e}function g(e){return void 0===e}function y(e){return b(e)&&"[object RegExp]"===A(e)}function b(e){return"object"==typeof e&&null!==e}function w(e){return b(e)&&"[object Date]"===A(e)}function k(e){return b(e)&&("[object Error]"===A(e)||e instanceof Error)}function x(e){return"function"==typeof e}function A(e){return Object.prototype.toString.call(e)}function T(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(n){if(g(i)&&(i=e.env.NODE_DEBUG||""),n=n.toUpperCase(),!a[n])if(new RegExp("\\b"+n+"\\b","i").test(i)){var r=e.pid;a[n]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",n,r,e)}}else a[n]=function(){};return a[n]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=f,t.isBoolean=p,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=v,t.isString=_,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=g,t.isRegExp=y,t.isObject=b,t.isDate=w,t.isError=k,t.isFunction=x,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(324);var M=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function E(){var e=new Date,t=[T(e.getHours()),T(e.getMinutes()),T(e.getSeconds())].join(":");return[e.getDate(),M[e.getMonth()],t].join(" ")}function C(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",E(),t.format.apply(t,arguments))},t.inherits=n(325),t._extend=function(e,t){if(!t||!b(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var P="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function I(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(P&&e[P]){var t;if("function"!=typeof(t=e[P]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,P,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,r=new Promise((function(e,r){t=e,n=r})),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push((function(e,r){e?n(e):t(r)}));try{e.apply(this,o)}catch(e){n(e)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),P&&Object.defineProperty(t,P,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},t.promisify.custom=P,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var o=n.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var i=this,a=function(){return o.apply(i,arguments)};t.apply(this,n).then((function(t){e.nextTick(a,null,t)}),(function(t){e.nextTick(I,t,a)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.defineProperties(n,r(t)),n}}).call(this,n(323))},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var u,c=[],l=!1,h=-1;function d(){l&&u&&(l=!1,u.length?c=u.concat(c):h=-1,c.length&&f())}function f(){if(!l){var e=s(d);l=!0;for(var t=c.length;t;){for(u=c,c=[];++h<t;)u&&u[h].run();h=-1,t=c.length}u=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),1!==c.length||l||s(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){var r,o,i,a,s;e.exports=(o=[],i=document,a=i.documentElement.doScroll,(s=(a?/^loaded|^c/:/^loaded|^i|^c/).test(i.readyState))||i.addEventListener("DOMContentLoaded",r=function(){for(i.removeEventListener("DOMContentLoaded",r),s=1;r=o.shift();)r()}),function(e){s?setTimeout(e,0):o.push(e)})},function(e,t){var n,r="undefined"!=typeof window?window.navigator.userAgent:"",o=/OS X/.test(r),i=/Opera/.test(r),a=!/like Gecko/.test(r)&&!i,s=e.exports={0:o?"<menu>":"<UNK>",1:"<mouse 1>",2:"<mouse 2>",3:"<break>",4:"<mouse 3>",5:"<mouse 4>",6:"<mouse 5>",8:"<backspace>",9:"<tab>",12:"<clear>",13:"<enter>",16:"<shift>",17:"<control>",18:"<alt>",19:"<pause>",20:"<caps-lock>",21:"<ime-hangul>",23:"<ime-junja>",24:"<ime-final>",25:"<ime-kanji>",27:"<escape>",28:"<ime-convert>",29:"<ime-nonconvert>",30:"<ime-accept>",31:"<ime-mode-change>",27:"<escape>",32:"<space>",33:"<page-up>",34:"<page-down>",35:"<end>",36:"<home>",37:"<left>",38:"<up>",39:"<right>",40:"<down>",41:"<select>",42:"<print>",43:"<execute>",44:"<snapshot>",45:"<insert>",46:"<delete>",47:"<help>",91:"<meta>",92:"<meta>",93:o?"<meta>":"<menu>",95:"<sleep>",106:"<num-*>",107:"<num-+>",108:"<num-enter>",109:"<num--\x3e",110:"<num-.>",111:"<num-/>",144:"<num-lock>",145:"<scroll-lock>",160:"<shift-left>",161:"<shift-right>",162:"<control-left>",163:"<control-right>",164:"<alt-left>",165:"<alt-right>",166:"<browser-back>",167:"<browser-forward>",168:"<browser-refresh>",169:"<browser-stop>",170:"<browser-search>",171:"<browser-favorites>",172:"<browser-home>",173:o&&a?"-":"<volume-mute>",174:"<volume-down>",175:"<volume-up>",176:"<next-track>",177:"<prev-track>",178:"<stop>",179:"<play-pause>",180:"<launch-mail>",181:"<launch-media-select>",182:"<launch-app 1>",183:"<launch-app 2>",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"<meta>",224:"<meta>",226:"<alt-gr>",229:"<ime-process>",231:i?"`":"<unicode>",246:"<attention>",247:"<crsel>",248:"<exsel>",249:"<erase-eof>",250:"<play>",251:"<zoom>",252:"<no-name>",253:"<pa-1>",254:"<clear>"};for(n=58;n<65;++n)s[n]=String.fromCharCode(n);for(n=48;n<58;++n)s[n]=n-48+"";for(n=65;n<91;++n)s[n]=String.fromCharCode(n);for(n=96;n<106;++n)s[n]="<num-"+(n-96)+">";for(n=112;n<136;++n)s[n]="F"+(n-111)},function(e,t,n){"use strict";e.exports=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}},function(e,t,n){"use strict";e.exports=function(e,t,n){return 0===e.length?e:t?(n||e.sort(t),function(e,t){for(var n=1,r=e.length,o=e[0],i=e[0],a=1;a<r;++a)if(i=o,t(o=e[a],i)){if(a===n){n++;continue}e[n++]=o}return e.length=n,e}(e,t)):(n||e.sort(),function(e){for(var t=1,n=e.length,r=e[0],o=e[0],i=1;i<n;++i,o=r)if(o=r,(r=e[i])!==o){if(i===t){t++;continue}e[t++]=r}return e.length=t,e}(e))}},function(e,t,n){"use strict";function r(e,t,n,r,o,i){var a=["function ",e,"(a,l,h,",r.join(","),"){",i?"":"var i=",n?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",o?".get(m)":"[m]"];return i?t.indexOf("c")<0?a.push(";if(x===y){return m}else if(x<=y){"):a.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):a.push(";if(",t,"){i=m;"),n?a.push("l=m+1}else{h=m-1}"):a.push("h=m-1}else{l=m+1}"),a.push("}"),i?a.push("return -1};"):a.push("return i};"),a.join("")}function o(e,t,n,o){return new Function([r("A","x"+e+"y",t,["y"],!1,o),r("B","x"+e+"y",t,["y"],!0,o),r("P","c(x,y)"+e+"0",t,["y","c"],!1,o),r("Q","c(x,y)"+e+"0",t,["y","c"],!0,o),"function dispatchBsearch",n,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",n].join(""))()}e.exports={ge:o(">=",!1,"GE"),gt:o(">",!1,"GT"),lt:o("<",!0,"LT"),le:o("<=",!0,"LE"),eq:o("-",!0,"EQ",!0)}},function(e,t){for(var n=0,r=["ms","moz","webkit","o"],o=0;o<r.length&&!window.requestAnimationFrame;++o)window.requestAnimationFrame=window[r[o]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[r[o]+"CancelAnimationFrame"]||window[r[o]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,t){var r=(new Date).getTime(),o=Math.max(0,16-(r-n)),i=window.setTimeout((function(){e(r+o)}),o);return n=r+o,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})},function(e,t){var n,r,o="";function i(e,t,i,a){e[n](o+t,"wheel"==r?i:function(e){!e&&(e=window.event);var t={originalEvent:e,target:e.target||e.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==e.type?0:1,deltaX:0,delatZ:0,preventDefault:function(){e.preventDefault?e.preventDefault():e.returnValue=!1}};return"mousewheel"==r?(t.deltaY=-1/40*e.wheelDelta,e.wheelDeltaX&&(t.deltaX=-1/40*e.wheelDeltaX)):t.deltaY=e.detail,i(t)},a||!1)}window.addEventListener?n="addEventListener":(n="attachEvent",o="on"),r="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",e.exports=function(e,t,n){i(e,r,t,n),"DOMMouseScroll"==r&&i(e,"MozMousePixelScroll",t,n)}},function(e,t){"object"==typeof window.performance?window.performance.now?e.exports=function(){return window.performance.now()}:window.performance.webkitNow&&(e.exports=function(){return window.performance.webkitNow()}):Date.now?e.exports=Date.now:e.exports=function(){return(new Date).getTime()}},function(e,t,n){var r=n(335),o=n(166).EventEmitter,i=n(336);function a(e,t){this.element=e||document,t=t||{},this.preventDefaults=!!t.preventDefaults,this.stopPropagation=!!t.stopPropagation,this.allowContextMenu=!!t.allowContextMenu,this.disabled=!!t.disabled,this.down=new o,this.up=new o,this.state={dx:0,dy:0,scrollx:0,scrolly:0,scrollz:0},this._keybindmap={},this._keyStates={},this._bindPressCounts={},this._ignoreMousemoveOnce=!1,this.initEvents()}function s(e,t,n){_(n.keyCode,r[n.keyCode],t,e,n)}function u(e,t,n){return _(-1-n.button,"<mouse "+(n.button+1)+">",t,e,n),!1}function c(e){if(!e.allowContextMenu)return!1}function l(e,t){if(e._ignoreMousemoveOnce)e._ignoreMousemoveOnce=!1;else{var n=t.movementX||t.mozMovementX||0,r=t.movementY||t.mozMovementY||0;if(t.touches&&0==(n|r)){var o=function(e){for(var t,n=e.changedTouches,r=0;r<n.length;++r)n[r].identifier==f&&(t=n[r]);if(!t)return[0,0];var o=[t.clientX-h,t.clientY-d];return h=t.clientX,d=t.clientY,o}(t);n=o[0],r=o[1]}e.state.dx+=n,e.state.dy+=r}}e.exports=function(e,t){return new a(e,t)},a.prototype.initEvents=function(){window.addEventListener("keydown",s.bind(void 0,this,!0),!1),window.addEventListener("keyup",s.bind(void 0,this,!1),!1),this.element.addEventListener("mousedown",u.bind(void 0,this,!0),!1),this.element.addEventListener("mouseup",u.bind(void 0,this,!1),!1),this.element.oncontextmenu=c.bind(void 0,this),this.element.addEventListener("dragstart",u.bind(void 0,this,!1),!1),this.element.addEventListener("mousemove",l.bind(void 0,this),!1),this.element.addEventListener("touchmove",l.bind(void 0,this),!1),this.element.addEventListener("touchstart",p.bind(void 0,this),!1),i(this.element,m.bind(void 0,this),!1),document.addEventListener("pointerlockchange",v.bind(void 0,this),!1),document.addEventListener("mozpointerlockchange",v.bind(void 0,this),!1)},a.prototype.bind=function(e){for(var t=1;t<arguments.length;++t){var n=arguments[t],r=this._keybindmap[n]||[];-1==r.indexOf(e)&&r.push(e),this._keybindmap[n]=r}this.state[e]=!!this.state[e]},a.prototype.unbind=function(e){for(var t in this._keybindmap){var n=this._keybindmap[t],r=n.indexOf(e);r>-1&&n.splice(r,1)}},a.prototype.tick=function(){this.state.dx=this.state.dy=0,this.state.scrollx=this.state.scrolly=this.state.scrollz=0},a.prototype.getBoundKeys=function(){var e=[];for(var t in this._keybindmap)e.push(t);return e};var h=0,d=0,f=null;function p(e,t){var n=t.changedTouches[0];h=n.clientX,d=n.clientY,f=n.identifier}function m(e,t){var n=1;switch(t.deltaMode){case 0:n=1;break;case 1:n=12;break;case 2:n=e.element.clientHeight||window.innerHeight}return e.state.scrollx+=t.deltaX*n,e.state.scrolly+=t.deltaY*n,e.state.scrollz+=t.deltaZ*n||0,!1}function v(e,t){(document.pointerLockElement||document.mozPointerLockElement||null)&&(e._ignoreMousemoveOnce=!0)}function _(e,t,n,r,o){var i=r._keybindmap[t];if(i){if(r.preventDefaults&&o.preventDefault(),r.stopPropagation&&o.stopPropagation(),y(r._keyStates[e],n))for(var a=0;a<i.length;++a)g(i[a],n,r,o);r._keyStates[e]=n}}function g(e,t,n,r){var o=n._bindPressCounts[e]||0;if((o+=t?1:-1)<0&&(o=0),n._bindPressCounts[e]=o,y(n.state[e],o)){var i=t?n.down:n.up;n.disabled||i.emit(e,r)}n.state[e]=!!o}function y(e,t){return e?!t:t}},function(e,t,n){"use strict";var r,o="undefined"!=typeof window?window.navigator.userAgent:"",i=/OS X/.test(o),a=/Opera/.test(o),s=!/like Gecko/.test(o)&&!a,u=e.exports={0:i?"<menu>":"<UNK>",1:"<mouse 1>",2:"<mouse 2>",3:"<break>",4:"<mouse 3>",5:"<mouse 4>",6:"<mouse 5>",8:"<backspace>",9:"<tab>",12:"<clear>",13:"<enter>",16:"<shift>",17:"<control>",18:"<alt>",19:"<pause>",20:"<caps-lock>",21:"<ime-hangul>",23:"<ime-junja>",24:"<ime-final>",25:"<ime-kanji>",27:"<escape>",28:"<ime-convert>",29:"<ime-nonconvert>",30:"<ime-accept>",31:"<ime-mode-change>",32:"<space>",33:"<page-up>",34:"<page-down>",35:"<end>",36:"<home>",37:"<left>",38:"<up>",39:"<right>",40:"<down>",41:"<select>",42:"<print>",43:"<execute>",44:"<snapshot>",45:"<insert>",46:"<delete>",47:"<help>",91:"<meta>",92:"<meta>",93:i?"<meta>":"<menu>",95:"<sleep>",106:"<num-*>",107:"<num-+>",108:"<num-enter>",109:"<num--\x3e",110:"<num-.>",111:"<num-/>",144:"<num-lock>",145:"<scroll-lock>",160:"<shift-left>",161:"<shift-right>",162:"<control-left>",163:"<control-right>",164:"<alt-left>",165:"<alt-right>",166:"<browser-back>",167:"<browser-forward>",168:"<browser-refresh>",169:"<browser-stop>",170:"<browser-search>",171:"<browser-favorites>",172:"<browser-home>",173:i&&s?"-":"<volume-mute>",174:"<volume-down>",175:"<volume-up>",176:"<next-track>",177:"<prev-track>",178:"<stop>",179:"<play-pause>",180:"<launch-mail>",181:"<launch-media-select>",182:"<launch-app 1>",183:"<launch-app 2>",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"<meta>",224:"<meta>",226:"<alt-gr>",229:"<ime-process>",231:a?"`":"<unicode>",246:"<attention>",247:"<crsel>",248:"<exsel>",249:"<erase-eof>",250:"<play>",251:"<zoom>",252:"<no-name>",253:"<pa-1>",254:"<clear>"};for(r=58;r<65;++r)u[r]=String.fromCharCode(r);for(r=48;r<58;++r)u[r]=r-48+"";for(r=65;r<91;++r)u[r]=String.fromCharCode(r);for(r=96;r<106;++r)u[r]="<num-"+(r-96)+">";for(r=112;r<136;++r)u[r]="F"+(r-111)},function(e,t){var n,r,o="";function i(e,t,i,a){e[n](o+t,"wheel"==r?i:function(e){!e&&(e=window.event);var t={originalEvent:e,target:e.target||e.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==e.type?0:1,deltaX:0,delatZ:0,preventDefault:function(){e.preventDefault?e.preventDefault():e.returnValue=!1}};return"mousewheel"==r?(t.deltaY=-1/40*e.wheelDelta,e.wheelDeltaX&&(t.deltaX=-1/40*e.wheelDeltaX)):t.deltaY=e.detail,i(t)},a||!1)}window.addEventListener?n="addEventListener":(n="attachEvent",o="on"),r="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",e.exports=function(e,t,n){i(e,r,t,n),"DOMMouseScroll"==r&&i(e,"MozMousePixelScroll",t,n)}},function(e,t,n){"use strict";var r=n(232),o=n(82),i=n(273),a=n(338);e.exports=function(e,t,n){return new u(e,t,n)};var s={gravity:[0,-10,0],minBounceImpulse:.5,airDrag:.1,fluidDrag:.4,fluidDensity:2};function u(e,t,n){e=Object.assign({},s,e),this.gravity=e.gravity,this.airDrag=e.airDrag,this.fluidDensity=e.fluidDensity,this.fluidDrag=e.fluidDrag,this.minBounceImpulse=e.minBounceImpulse,this.bodies=[],this.testSolid=t,this.testFluid=n}u.prototype.addBody=function(e,t,n,o,i,s){e=e||new r([0,0,0],[1,1,1]),void 0===t&&(t=1),void 0===n&&(n=1),void 0===o&&(o=0),void 0===i&&(i=1);var u=new a(e,t,n,o,i,s);return this.bodies.push(u),u},u.prototype.removeBody=function(e){var t=this.bodies.indexOf(e);t<0||(this.bodies.splice(t,1),e.aabb=e.onCollide=null)};var c=o.create(),l=o.create(),h=o.create(),d=o.create(),f=o.create();u.prototype.tick=function(e){e/=1e3;var t=A(0,o.squaredLength(this.gravity));this.bodies.forEach(n=>function(e,t,n,r){if(o.copy(f,t.resting),t.mass<=0)return o.set(t.velocity,0,0,0),o.set(t._forces,0,0,0),void o.set(t._impulses,0,0,0);var a=r||0===t.gravityMultiplier;if(function(e,t,n,r){if(t._sleepFrameCount>0)return!1;if(r)return!0;var a=!1,s=.5*n*n*t.gravityMultiplier;return o.scale(x,e.gravity,s),i(e.testSolid,t.aabb,x,(function(){return a=!0,!0}),!0),a}(e,t,n,a))return;t._sleepFrameCount--,function(e,t){var n=t.aabb,r=Math.floor(n.base[0]),i=Math.floor(n.base[2]),a=Math.floor(n.base[1]),s=Math.floor(n.max[1]);if(!e.testFluid(r,a,i))return t.inFluid=!1,void(t.ratioInFluid=0);var u=1,c=a+1;for(;c<=s&&e.testFluid(r,c,i);)u++,c++;var l=(a+u-n.base[1])/n.vec[1];l>1&&(l=1);var h=n.vec[0]*n.vec[1]*n.vec[2]*l,d=p;o.scale(d,e.gravity,-e.fluidDensity*h),t.applyForce(d),t.inFluid=!0,t.ratioInFluid=l}(e,t),M(t._forces),M(t._impulses),M(t.velocity),M(t.resting),o.scale(c,t._forces,1/t.mass),o.scaleAndAdd(c,c,e.gravity,t.gravityMultiplier),o.scale(l,t._impulses,1/t.mass),o.scaleAndAdd(l,l,c,n),o.add(t.velocity,t.velocity,l),t.friction&&(m(0,t,l),m(1,t,l),m(2,t,l));var s=t.airDrag>=0?t.airDrag:e.airDrag;t.inFluid&&(s=t.fluidDrag>=0?t.fluidDrag:e.fluidDrag,s*=1-(1-t.ratioInFluid)**2);var u=Math.max(1-s*n/t.mass,0);o.scale(t.velocity,t.velocity,u),o.scale(h,t.velocity,n),o.set(t._forces,0,0,0),o.set(t._impulses,0,0,0),t.autoStep&&T(g,t.aabb);_(e,t.aabb,h,t.resting),t.autoStep&&function(e,t,n,r){if(t.resting[1]>=0&&!t.inFluid)return;var a=0!==t.resting[0],s=0!==t.resting[2];if(!a&&!s)return;var u=Math.abs(r[0]/r[2]);if(!a&&u>4)return;if(!s&&u<1/4)return;o.add(b,n.base,r);var c=e.testSolid;i(c,n,r,(function(e,t,n,r){if(1!==t)return!0;r[t]=0}));var l=t.aabb.base[1],h=Math.floor(l+1.001)-l;o.set(w,0,h,0);var d=!1;if(i(c,n,w,(function(e,t,n,r){return d=!0,!0})),d)return;if(o.subtract(k,b,n.base),k[1]=0,_(e,n,k,y),a&&!A(n.base[0],b[0]))return;if(s&&!A(n.base[2],b[2]))return;T(t.aabb,n),t.resting[0]=y[0],t.resting[2]=y[2],t.onStep&&t.onStep()}(e,t,g,h);for(var v=0;v<3;++v)d[v]=0,t.resting[v]&&(f[v]||(d[v]=-t.velocity[v]),t.velocity[v]=0);var E=o.length(d);E>.001&&(o.scale(d,d,t.mass),t.onCollide&&t.onCollide(d),t.restitution>0&&E>e.minBounceImpulse&&(o.scale(d,d,t.restitution),t.applyImpulse(d)));o.squaredLength(t.velocity)>1e-5&&t._markActive()}(this,n,e,t))};var p=o.create();function m(e,t,n){var r=t.resting[e],i=n[e];if(0!==r&&!(r*i<=0)){o.copy(v,t.velocity),v[e]=0;var a=o.length(v);if(!A(a,0)){var s=Math.abs(t.friction*i),u=a>s?(a-s)/a:0;t.velocity[(e+1)%3]*=u,t.velocity[(e+2)%3]*=u}}}var v=o.create();function _(e,t,n,r){return o.set(r,0,0,0),i(e.testSolid,t,n,(function(e,t,n,o){r[t]=n,o[t]=0}))}var g=new r([],[]),y=o.create(),b=o.create(),w=o.create(),k=o.create();var x=o.create();function A(e,t){return Math.abs(e-t)<1e-5}function T(e,t){for(var n=0;n<3;n++)e.base[n]=t.base[n],e.max[n]=t.max[n],e.vec[n]=t.vec[n]}var M=function(){}},function(e,t,n){"use strict";var r=n(232),o=n(82);function i(e,t,n,i,a,s,u){this.aabb=new r(e.base,e.vec),this.mass=t,this.friction=n,this.restitution=i,this.gravityMultiplier=a,this.onCollide=s,this.autoStep=!!u,this.airDrag=-1,this.fluidDrag=-1,this.onStep=null,this.velocity=o.create(),this.resting=[0,0,0],this.inFluid=!1,this._ratioInFluid=0,this._forces=o.create(),this._impulses=o.create(),this._sleepFrameCount=10}e.exports=i,i.prototype.setPosition=function(e){a(e),o.subtract(e,e,this.aabb.base),this.aabb.translate(e),this._markActive()},i.prototype.getPosition=function(){return o.clone(this.aabb.base)},i.prototype.applyForce=function(e){a(e),o.add(this._forces,this._forces,e),this._markActive()},i.prototype.applyImpulse=function(e){a(e),o.add(this._impulses,this._impulses,e),this._markActive()},i.prototype._markActive=function(){this._sleepFrameCount=10},i.prototype.atRestX=function(){return this.resting[0]},i.prototype.atRestY=function(){return this.resting[1]},i.prototype.atRestZ=function(){return this.resting[2]};var a=function(){}},function(e,t,n){"use strict";e.exports=
/*!
 * ent-comp: a light, *fast* Entity Component System in JS
 * @url      github.com/andyhall/ent-comp
 * @author   Andy Hall <andy@fenomas.com>
 * @license  MIT
*/
function e(){var t=this;this.components={},this.comps=this.components;var n=this.components,o=1,i={},a=[],s=[],u=[],c=[],l=[];function h(e){Object.keys(i).forEach(t=>{i[t].hash[e]&&d(e,t)})}function d(e,t){var o=n[t],a=i[t];a&&a.hash[e]&&(o.onRemove&&(o.multi?a.hash[e].forEach(t=>{o.onRemove(e,t)}):o.onRemove(e,a.hash[e])),o.multi&&(a.hash[e].length=0),r.remove(a,e))}function f(e,t,r){var o=n[t],a=i[t].hash[e];if(a){var s=a.indexOf(r);s<0||(o.onRemove&&o.onRemove(e,r),a.splice(s,1),0===a.length&&d(e,t))}}function p(){m||(m=!0,setTimeout((function(){m=!1,v()}),1))}this._storage=i,this._systems=a,this._renderSystems=s,this.createEntity=function(e){var n=o++;return e&&e.length&&e.forEach(e=>t.addComponent(n,e)),n},this.deleteEntity=function(e,n){return n?h(e):(u.push(e),p()),t},this.createComponent=function(e){if(!e)throw"Missing component definition";var t=e.name;if(!t)throw"Component definition must have a name property.";if("string"!=typeof t)throw"Component name must be a string.";if(""===t)throw"Component name must be a non-empty string.";if(i[t])throw`Component ${t} already exists.`;var o={};return o.name=t,o.order=isNaN(e.order)?99:e.order,o.state=e.state||{},o.onAdd=e.onAdd||null,o.onRemove=e.onRemove||null,o.system=e.system||null,o.renderSystem=e.renderSystem||null,o.multi=!!e.multi,n[t]=o,i[t]=r.create(),o.system&&(a.push(t),a.sort((e,t)=>n[e].order-n[t].order)),o.renderSystem&&(s.push(t),s.sort((e,t)=>n[e].order-n[t].order)),t},this.deleteComponent=function(e){var r=i[e];if(!r)throw"Unknown component: "+e;r.list.forEach(n=>{var r=n.__id||n[0].__id;t.removeComponent(r,e,!0)});var o=a.indexOf(e),u=s.indexOf(e);return o>-1&&a.splice(o,1),u>-1&&s.splice(u,1),delete n[e],delete i[e],t},this.addComponent=function(e,t,o){var a=n[t],s=i[t];if(!s)throw`Unknown component: ${t}.`;var u=!1;if(c.forEach(n=>{n.id===e&&n.compName===t&&(u=!0)}),u&&_(),s.hash[e]&&!a.multi)throw`Entity ${e} already has component: ${t}.`;var l=Object.assign({},{__id:e},a.state,o);if(l.__id=e,a.multi){var h=s.hash[e];h||(h=[],r.add(s,e,h)),h.push(l)}else r.add(s,e,l);return a.onAdd&&a.onAdd(e,l),this},this.hasComponent=function(e,t){var n=i[t];if(!n)throw`Unknown component: ${t}.`;return void 0!==n.hash[e]},this.removeComponent=function(e,r,o){var a=n[r],s=i[r];if(!s)throw`Unknown component: ${r}.`;if(!s.hash[e]){if(a.multi)return t;throw`Entity ${e} does not have component: ${r} to remove.`}return o?d(e,r):(c.push({id:e,compName:r}),p()),t},this.getState=function(e,t){var n=i[t];if(!n)throw`Unknown component: ${t}.`;return n.hash[e]},e.prototype.getStatesList=function(e){var t=i[e];if(!t)throw`Unknown component: ${e}.`;return t.list},this.getStateAccessor=function(e){if(!i[e])throw`Unknown component: ${e}.`;var t=i[e].hash;return function(e){return t[e]}},this.getComponentAccessor=function(e){if(!i[e])throw`Unknown component: ${e}.`;var t=i[e].hash;return function(e){return void 0!==t[e]}},this.tick=function(e){return v(),a.forEach(t=>{var r=i[t].list;n[t].system(e,r)}),v(),t},this.render=function(e){return v(),s.forEach(t=>{var r=i[t].list;n[t].renderSystem(e,r)}),v(),t},this.removeMultiComponent=function(e,r,o,a){var s=n[r],u=i[r];if(!u)throw`Unknown component: ${r}.`;if(!s.multi)throw"removeMultiComponent called on non-multi component";var c=u.hash[e];if(!c||!c[o])throw`Multicomponent ${r} instance not found at index ${o}`;var h=c[o];return a?f(e,r,h):l.push({id:e,compName:r,state:h}),t};var m=!1;function v(){_(),function(e){for(;l.length;){var t=l.pop();f(t.id,t.compName,t.state),t.state=null}}(),function(){for(;u.length;){h(u.pop())}}()}function _(){for(;c.length;){var e=c.pop();d(e.id,e.compName)}}};var r=n(340)},function(e,t,n){"use strict";e.exports={create:function(){return{list:[],hash:{},_map:{}}},add:function(e,t,n){e.list.push(n),e.hash[t]=n,e._map[t]=e.list.length-1},remove:function(e,t){var n=e._map[t];if(n===e.list.length-1)e.list.pop();else{var r=e.list.pop();e.list[n]=r;var o=r.__id||r[0].__id;e._map[o]=n}delete e.hash[t],delete e._map[t]}}},function(e,t,n){var r={"./collideEntities.js":342,"./collideTerrain.js":353,"./fadeOnZoom.js":354,"./followsEntity.js":355,"./mesh.js":356,"./movement.js":357,"./physics.js":243,"./position.js":242,"./receivesInputs.js":358,"./shadow.js":359,"./smoothCamera.js":360};function o(e){var t=i(e);return n(t)}function i(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=i,e.exports=o,o.id=341},function(e,t,n){"use strict";n.r(t);var r=n(343);t.default=function(e){var t=[];return{name:"collideEntities",order:70,state:{cylinder:!1,collideBits:1,collideMask:1,callback:null},onAdd:null,onRemove:null,system:function(o,i){for(var a=e.ents,s=0;s<i.length;s++){var u=i[s].__id,c=a.getPositionData(u);t[s]=c._extents}t.length=i.length,r(t,(function(r,o){var a=i[r],s=i[o];(function(e,t,r,o){if(e.cylinder)return t.cylinder?function(e,t){var n=(e[3]-e[0])/2,r=(t[3]-t[0])/2,o=e[0]+n-(t[0]+r),i=e[2]+n-(t[2]+r),a=n+r;return o*o+i*i<=a*a}(r,o):n(r,o);if(t.cylinder)return n(o,r);return!0})(a,s,t[r],t[o])&&function(e,t,n){var r=t.__id,o=n.__id;t.collideMask&n.collideBits&&t.callback&&t.callback(o);n.collideMask&t.collideBits&&n.callback&&n.callback(r);e.ents.onPairwiseEntityCollision(r,o)}(e,a,s)}))}};function n(e,t){var n=(e[3]-e[0])/2,r=e[0]+n,i=e[2]+n,a=o(r,t[0],t[3])-r,s=o(i,t[2],t[5])-i;return a*a+s*s<=n*n}function o(e,t,n){return e<t?t:e>n?n:e}}},function(e,t,n){"use strict";e.exports=function(e,t,n){switch(arguments.length){case 1:return h(e);case 2:return"function"==typeof t?c(e,e,t,!0):d(e,t);case 3:return c(e,t,n,!1);default:throw new Error("box-intersect: Invalid arguments")}};var r,o=n(233),i=n(274),a=n(350);function s(e,t){for(var n=0;n<e;++n)if(!(t[n]<=t[n+e]))return!0;return!1}function u(e,t,n,r){for(var o=0,i=0,a=0,u=e.length;a<u;++a){var c=e[a];if(!s(t,c)){for(var l=0;l<2*t;++l)n[o++]=c[l];r[i++]=a}}return i}function c(e,t,n,r){var s=e.length,c=t.length;if(!(s<=0||c<=0)){var l=e[0].length>>>1;if(!(l<=0)){var h,d=o.mallocDouble(2*l*s),f=o.mallocInt32(s);if((s=u(e,l,d,f))>0){if(1===l&&r)i.init(s),h=i.sweepComplete(l,n,0,s,d,f,0,s,d,f);else{var p=o.mallocDouble(2*l*c),m=o.mallocInt32(c);(c=u(t,l,p,m))>0&&(i.init(s+c),h=1===l?i.sweepBipartite(l,n,0,s,d,f,0,c,p,m):a(l,n,r,s,d,f,c,p,m),o.free(p),o.free(m))}o.free(d),o.free(f)}return h}}}function l(e,t){r.push([e,t])}function h(e){return r=[],c(e,e,l,!0),r}function d(e,t){return r=[],c(e,t,l,!1),r}},function(e,t,n){"use strict";e.exports=function(e,t){switch(void 0===t&&(t=0),typeof e){case"number":if(e>0)return function(e,t){var n,r;for(n=new Array(e),r=0;r<e;++r)n[r]=t;return n}(0|e,t);break;case"object":if("number"==typeof e.length)return function e(t,n,r){var o=0|t[r];if(o<=0)return[];var i,a=new Array(o);if(r===t.length-1)for(i=0;i<o;++i)a[i]=n;else for(i=0;i<o;++i)a[i]=e(t,n,r+1);return a}(e,t,0)}return[]}},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n(346),o=n(347),i=n(348);function a(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return c(this,e,t,n)}function c(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=d(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n),o=(e=s(e,r)).write(t,n);o!==r&&(e=e.slice(0,o));return e}(e,t,n):function(e,t){if(u.isBuffer(t)){var n=0|f(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?s(e,0):d(e,t);if("Buffer"===t.type&&i(t.data))return d(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(l(t),e=s(e,t<0?0:0|f(t)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function d(e,t){var n=t.length<0?0:0|f(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function f(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function p(e,t){if(u.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return N(e).length;default:if(r)return U(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,n);case"utf8":case"utf-8":return M(this,t,n);case"ascii":return E(this,t,n);case"latin1":case"binary":return C(this,t,n);case"base64":return T(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function v(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function _(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=u.from(t,r)),u.isBuffer(t))return 0===t.length?-1:g(e,t,n,r,o);if("number"==typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):g(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function g(e,t,n,r,o){var i,a=1,s=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(o){var l=-1;for(i=n;i<s;i++)if(c(e,i)===c(t,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===u)return l*a}else-1!==l&&(i-=i-l),l=-1}else for(n+u>s&&(n=s-u),i=n;i>=0;i--){for(var h=!0,d=0;d<u;d++)if(c(e,i+d)!==c(t,d)){h=!1;break}if(h)return i}return-1}function y(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function b(e,t,n,r){return Y(U(t,e.length-n),e,n,r)}function w(e,t,n,r){return Y(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function k(e,t,n,r){return w(e,t,n,r)}function x(e,t,n,r){return Y(N(t),e,n,r)}function A(e,t,n,r){return Y(function(e,t){for(var n,r,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(t,e.length-n),e,n,r)}function T(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function M(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i,a,s,u,c=e[o],l=null,h=c>239?4:c>223?3:c>191?2:1;if(o+h<=n)switch(h){case 1:c<128&&(l=c);break;case 2:128==(192&(i=e[o+1]))&&(u=(31&c)<<6|63&i)>127&&(l=u);break;case 3:i=e[o+1],a=e[o+2],128==(192&i)&&128==(192&a)&&(u=(15&c)<<12|(63&i)<<6|63&a)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:i=e[o+1],a=e[o+2],s=e[o+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&(u=(15&c)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,h=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),o+=h}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}t.Buffer=u,t.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},t.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,n){return c(null,e,t,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,n){return function(e,t,n,r){return l(t),t<=0?s(e,t):void 0!==n?"string"==typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},u.allocUnsafe=function(e){return h(null,e)},u.allocUnsafeSlow=function(e){return h(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=u.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var a=e[n];if(!u.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,o),o+=a.length}return r},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?M(this,0,e):m.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,n,r,o){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(i,a),c=this.slice(r,o),l=e.slice(t,n),h=0;h<s;++h)if(c[h]!==l[h]){i=c[h],a=l[h];break}return i<a?-1:a<i?1:0},u.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},u.prototype.indexOf=function(e,t,n){return _(this,e,t,n,!0)},u.prototype.lastIndexOf=function(e,t,n){return _(this,e,t,n,!1)},u.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return b(this,e,t,n);case"ascii":return w(this,e,t,n);case"latin1":case"binary":return k(this,e,t,n);case"base64":return x(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function E(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function C(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function P(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=z(e[i]);return o}function I(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function S(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function B(e,t,n,r,o,i){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function D(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function O(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function L(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function j(e,t,n,r,i){return i||L(e,0,n,4),o.write(e,t,n,r,23,4),n+4}function F(e,t,n,r,i){return i||L(e,0,n,8),o.write(e,t,n,r,52,8),n+8}u.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=u.prototype;else{var o=t-e;n=new u(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+e]}return n},u.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||S(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},u.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||S(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},u.prototype.readUInt8=function(e,t){return t||S(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||S(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||S(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||S(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||S(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||S(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},u.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||S(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},u.prototype.readInt8=function(e,t){return t||S(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||S(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(e,t){t||S(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(e,t){return t||S(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||S(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||S(e,4,this.length),o.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||S(e,4,this.length),o.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||S(e,8,this.length),o.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||S(e,8,this.length),o.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||B(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},u.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||B(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},u.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):D(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):D(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):O(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):O(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);B(this,e,t,n,o-1,-o)}var i=0,a=1,s=0;for(this[t]=255&e;++i<n&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+n},u.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);B(this,e,t,n,o-1,-o)}var i=n-1,a=1,s=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+n},u.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):D(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):D(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):O(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):O(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,n){return j(this,e,t,!0,n)},u.prototype.writeFloatBE=function(e,t,n){return j(this,e,t,!1,n)},u.prototype.writeDoubleLE=function(e,t,n){return F(this,e,t,!0,n)},u.prototype.writeDoubleBE=function(e,t,n){return F(this,e,t,!1,n)},u.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,i=r-n;if(this===e&&n<t&&t<r)for(o=i-1;o>=0;--o)e[o+t]=this[o+n];else if(i<1e3||!u.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},u.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var a=u.isBuffer(e)?e:U(new u(e,r).toString()),s=a.length;for(i=0;i<n-t;++i)this[i+t]=a[i%s]}return this};var R=/[^+\/0-9A-Za-z-_]/g;function z(e){return e<16?"0"+e.toString(16):e.toString(16)}function U(e,t){var n;t=t||1/0;for(var r=e.length,o=null,i=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function N(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(R,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function Y(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}}).call(this,n(110))},function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=c(e),a=r[0],s=r[1],u=new i(function(e,t,n){return 3*(t+n)/4-n}(0,a,s)),l=0,h=s>0?a-4:a;for(n=0;n<h;n+=4)t=o[e.charCodeAt(n)]<<18|o[e.charCodeAt(n+1)]<<12|o[e.charCodeAt(n+2)]<<6|o[e.charCodeAt(n+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;2===s&&(t=o[e.charCodeAt(n)]<<2|o[e.charCodeAt(n+1)]>>4,u[l++]=255&t);1===s&&(t=o[e.charCodeAt(n)]<<10|o[e.charCodeAt(n+1)]<<4|o[e.charCodeAt(n+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t);return u},t.fromByteArray=function(e){for(var t,n=e.length,o=n%3,i=[],a=0,s=n-o;a<s;a+=16383)i.push(l(e,a,a+16383>s?s:a+16383));1===o?(t=e[n-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===o&&(t=(e[n-2]<<8)+e[n-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return i.join("")};for(var r=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=a.length;s<u;++s)r[s]=a[s],o[a.charCodeAt(s)]=s;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var o,i,a=[],s=t;s<n;s+=3)o=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return a.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,o){var i,a,s=8*o-r-1,u=(1<<s)-1,c=u>>1,l=-7,h=n?o-1:0,d=n?-1:1,f=e[t+h];for(h+=d,i=f&(1<<-l)-1,f>>=-l,l+=s;l>0;i=256*i+e[t+h],h+=d,l-=8);for(a=i&(1<<-l)-1,i>>=-l,l+=r;l>0;a=256*a+e[t+h],h+=d,l-=8);if(0===i)i=1-c;else{if(i===u)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,r),i-=c}return(f?-1:1)*a*Math.pow(2,i-r)},t.write=function(e,t,n,r,o,i){var a,s,u,c=8*i-o-1,l=(1<<c)-1,h=l>>1,d=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:i-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+h>=1?d/u:d*Math.pow(2,1-h))*u>=2&&(a++,u/=2),a+h>=l?(s=0,a=l):a+h>=1?(s=(t*u-1)*Math.pow(2,o),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,o),a=0));o>=8;e[n+f]=255&s,f+=p,s/=256,o-=8);for(a=a<<o|s,c+=o;c>0;e[n+f]=255&a,f+=p,a/=256,c-=8);e[n+f-p]|=128*m}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";e.exports=function(e,t){t<=128?r(0,t-1,e):function e(t,n,l){var h=(n-t+1)/6|0,d=t+h,f=n-h,p=t+n>>1,m=p-h,v=p+h,_=d,g=m,y=p,b=v,w=f,k=t+1,x=n-1,A=0;u(_,g,l)&&(A=_,_=g,g=A);u(b,w,l)&&(A=b,b=w,w=A);u(_,y,l)&&(A=_,_=y,y=A);u(g,y,l)&&(A=g,g=y,y=A);u(_,b,l)&&(A=_,_=b,b=A);u(y,b,l)&&(A=y,y=b,b=A);u(g,w,l)&&(A=g,g=w,w=A);u(g,y,l)&&(A=g,g=y,y=A);u(b,w,l)&&(A=b,b=w,w=A);for(var T=l[2*g],M=l[2*g+1],E=l[2*b],C=l[2*b+1],P=2*_,I=2*y,S=2*w,B=2*d,D=2*p,O=2*f,L=0;L<2;++L){var j=l[P+L],F=l[I+L],R=l[S+L];l[B+L]=j,l[D+L]=F,l[O+L]=R}i(m,t,l),i(v,n,l);for(var z=k;z<=x;++z)if(c(z,T,M,l))z!==k&&o(z,k,l),++k;else if(!c(z,E,C,l))for(;;){if(c(x,E,C,l)){c(x,T,M,l)?(a(z,k,x,l),++k,--x):(o(z,x,l),--x);break}if(--x<z)break}s(t,k-1,T,M,l),s(n,x+1,E,C,l),k-2-t<=32?r(t,k-2,l):e(t,k-2,l);n-(x+2)<=32?r(x+2,n,l):e(x+2,n,l);x-k<=32?r(k,x,l):e(k,x,l)}(0,t-1,e)};function r(e,t,n){for(var r=2*(e+1),o=e+1;o<=t;++o){for(var i=n[r++],a=n[r++],s=o,u=r-2;s-- >e;){var c=n[u-2],l=n[u-1];if(c<i)break;if(c===i&&l<a)break;n[u]=c,n[u+1]=l,u-=2}n[u]=i,n[u+1]=a}}function o(e,t,n){t*=2;var r=n[e*=2],o=n[e+1];n[e]=n[t],n[e+1]=n[t+1],n[t]=r,n[t+1]=o}function i(e,t,n){t*=2,n[e*=2]=n[t],n[e+1]=n[t+1]}function a(e,t,n,r){t*=2,n*=2;var o=r[e*=2],i=r[e+1];r[e]=r[t],r[e+1]=r[t+1],r[t]=r[n],r[t+1]=r[n+1],r[n]=o,r[n+1]=i}function s(e,t,n,r,o){t*=2,o[e*=2]=o[t],o[t]=n,o[e+1]=o[t+1],o[t+1]=r}function u(e,t,n){t*=2;var r=n[e*=2],o=n[t];return!(r<o)&&(r!==o||n[e+1]>n[t+1])}function c(e,t,n,r){var o=r[e*=2];return o<t||o===t&&r[e+1]<n}},function(e,t,n){"use strict";e.exports=function(e,t,n,i,l,k,x,A,T){!function(e,t){var n=8*o.log2(t+1)*(e+1)|0,i=o.nextPow2(6*n);_.length<i&&(r.free(_),_=r.mallocInt32(i));var a=o.nextPow2(2*n);g.length<a&&(r.free(g),g=r.mallocDouble(a))}(e,i+x);var M,E=0,C=2*e;y(E++,0,0,i,0,x,n?16:0,-1/0,1/0),n||y(E++,0,0,x,0,i,1,-1/0,1/0);for(;E>0;){var P=6*(E-=1),I=_[P],S=_[P+1],B=_[P+2],D=_[P+3],O=_[P+4],L=_[P+5],j=2*E,F=g[j],R=g[j+1],z=1&L,U=!!(16&L),N=l,Y=k,H=A,G=T;if(z&&(N=A,Y=T,H=l,G=k),!(2&L&&(B=f(e,I,S,B,N,Y,R),S>=B)||4&L&&(S=p(e,I,S,B,N,Y,F))>=B)){var q=B-S,V=O-D;if(U){if(e*q*(q+V)<1<<22){if(void 0!==(M=u.scanComplete(e,I,t,S,B,N,Y,D,O,H,G)))return M;continue}}else{if(e*Math.min(q,V)<128){if(void 0!==(M=a(e,I,t,z,S,B,N,Y,D,O,H,G)))return M;continue}if(e*q*V<1<<22){if(void 0!==(M=u.scanBipartite(e,I,t,z,S,B,N,Y,D,O,H,G)))return M;continue}}var X=h(e,I,S,B,N,Y,F,R);if(S<X)if(e*(X-S)<128){if(void 0!==(M=s(e,I+1,t,S,X,N,Y,D,O,H,G)))return M}else if(I===e-2){if(void 0!==(M=z?u.sweepBipartite(e,t,D,O,H,G,S,X,N,Y):u.sweepBipartite(e,t,S,X,N,Y,D,O,H,G)))return M}else y(E++,I+1,S,X,D,O,z,-1/0,1/0),y(E++,I+1,D,O,S,X,1^z,-1/0,1/0);if(X<B){var W=c(e,I,D,O,H,G),Z=H[C*W+I],$=d(e,I,W,O,H,G,Z);if($<O&&y(E++,I,X,B,$,O,(4|z)+(U?16:0),Z,R),D<W&&y(E++,I,X,B,D,W,(2|z)+(U?16:0),F,Z),W+1===$){if(void 0!==(M=U?w(e,I,t,X,B,N,Y,W,H,G[W]):b(e,I,t,z,X,B,N,Y,W,H,G[W])))return M}else if(W<$){var K;if(U){if(K=m(e,I,X,B,N,Y,Z),X<K){var Q=d(e,I,X,K,N,Y,Z);if(I===e-2){if(X<Q&&void 0!==(M=u.sweepComplete(e,t,X,Q,N,Y,W,$,H,G)))return M;if(Q<K&&void 0!==(M=u.sweepBipartite(e,t,Q,K,N,Y,W,$,H,G)))return M}else X<Q&&y(E++,I+1,X,Q,W,$,16,-1/0,1/0),Q<K&&(y(E++,I+1,Q,K,W,$,0,-1/0,1/0),y(E++,I+1,W,$,Q,K,1,-1/0,1/0))}}else K=z?v(e,I,X,B,N,Y,Z):m(e,I,X,B,N,Y,Z),X<K&&(I===e-2?M=z?u.sweepBipartite(e,t,W,$,H,G,X,K,N,Y):u.sweepBipartite(e,t,X,K,N,Y,W,$,H,G):(y(E++,I+1,X,K,W,$,z,-1/0,1/0),y(E++,I+1,W,$,X,K,1^z,-1/0,1/0)))}}}}};var r=n(233),o=n(234),i=n(351),a=i.partial,s=i.full,u=n(274),c=n(352),l=n(275),h=l("!(lo>=p0)&&!(p1>=hi)",["p0","p1"]),d=l("lo===p0",["p0"]),f=l("lo<p0",["p0"]),p=l("hi<=p0",["p0"]),m=l("lo<=p0&&p0<=hi",["p0"]),v=l("lo<p0&&p0<=hi",["p0"]),_=r.mallocInt32(1024),g=r.mallocDouble(1024);function y(e,t,n,r,o,i,a,s,u){var c=6*e;_[c]=t,_[c+1]=n,_[c+2]=r,_[c+3]=o,_[c+4]=i,_[c+5]=a;var l=2*e;g[l]=s,g[l+1]=u}function b(e,t,n,r,o,i,a,s,u,c,l){var h=2*e,d=u*h,f=c[d+t];e:for(var p=o,m=o*h;p<i;++p,m+=h){var v=a[m+t],_=a[m+t+e];if(!(f<v||_<f)&&(!r||f!==v)){for(var g,y=s[p],b=t+1;b<e;++b){v=a[m+b],_=a[m+b+e];var w=c[d+b],k=c[d+b+e];if(_<w||k<v)continue e}if(void 0!==(g=r?n(l,y):n(y,l)))return g}}}function w(e,t,n,r,o,i,a,s,u,c){var l=2*e,h=s*l,d=u[h+t];e:for(var f=r,p=r*l;f<o;++f,p+=l){var m=a[f];if(m!==c){var v=i[p+t],_=i[p+t+e];if(!(d<v||_<d)){for(var g=t+1;g<e;++g){v=i[p+g],_=i[p+g+e];var y=u[h+g],b=u[h+g+e];if(_<y||b<v)continue e}var w=n(m,c);if(void 0!==w)return w}}}}},function(e,t,n){"use strict";var r=["d","ax","vv","rs","re","rb","ri","bs","be","bb","bi"];function o(e){var t="bruteForce"+(e?"Full":"Partial"),n=[],o=r.slice();e||o.splice(3,0,"fp");var i=["function "+t+"("+o.join()+"){"];function a(t,o){var a=function(e,t,n){var o="bruteForce"+(e?"Red":"Blue")+(t?"Flip":"")+(n?"Full":""),i=["function ",o,"(",r.join(),"){","var ","es","=2*","d",";"],a="for(var i=rs,rp=es*rs;i<re;++i,rp+=es){var x0=rb[ax+rp],x1=rb[ax+rp+d],xi=ri[i];",s="for(var j=bs,bp=es*bs;j<be;++j,bp+=es){var y0=bb[ax+bp],"+(n?"y1=bb[ax+bp+d],":"")+"yi=bi[j];";return e?i.push(a,"Q",":",s):i.push(s,"Q",":",a),n?i.push("if(y1<x0||x1<y0)continue;"):t?i.push("if(y0<=x0||x1<y0)continue;"):i.push("if(y0<x0||x1<y0)continue;"),i.push("for(var k=ax+1;k<d;++k){var r0=rb[k+rp],r1=rb[k+d+rp],b0=bb[k+bp],b1=bb[k+d+bp];if(r1<b0||b1<r0)continue Q;}var rv=vv("),t?i.push("yi,xi"):i.push("xi,yi"),i.push(");if(rv!==void 0)return rv;}}}"),{name:o,code:i.join("")}}(t,o,e);n.push(a.code),i.push("return "+a.name+"("+r.join()+");")}i.push("if(re-rs>be-bs){"),e?(a(!0,!1),i.push("}else{"),a(!1,!1)):(i.push("if(fp){"),a(!0,!0),i.push("}else{"),a(!0,!1),i.push("}}else{if(fp){"),a(!1,!0),i.push("}else{"),a(!1,!1),i.push("}")),i.push("}}return "+t);var s=n.join("")+i.join("");return new Function(s)()}t.partial=o(!1),t.full=o(!0)},function(e,t,n){"use strict";e.exports=function(e,t,n,i,a,s){if(i<=n+1)return n;var u=n,c=i,l=i+n>>>1,h=2*e,d=l,f=a[h*l+t];for(;u<c;){if(c-u<8){o(e,t,u,c,a,s),f=a[h*l+t];break}var p=c-u,m=Math.random()*p+u|0,v=a[h*m+t],_=Math.random()*p+u|0,g=a[h*_+t],y=Math.random()*p+u|0,b=a[h*y+t];v<=g?b>=g?(d=_,f=g):v>=b?(d=m,f=v):(d=y,f=b):g>=b?(d=_,f=g):b>=v?(d=m,f=v):(d=y,f=b);for(var w=h*(c-1),k=h*d,x=0;x<h;++x,++w,++k){var A=a[w];a[w]=a[k],a[k]=A}var T=s[c-1];s[c-1]=s[d],s[d]=T,d=r(e,t,u,c-1,a,s,f);for(w=h*(c-1),k=h*d,x=0;x<h;++x,++w,++k){A=a[w];a[w]=a[k],a[k]=A}T=s[c-1];if(s[c-1]=s[d],s[d]=T,l<d){for(c=d-1;u<c&&a[h*(c-1)+t]===f;)c-=1;c+=1}else{if(!(d<l))break;for(u=d+1;u<c&&a[h*u+t]===f;)u+=1}}return r(e,t,n,l,a,s,a[h*l+t])};var r=n(275)("lo<p0",["p0"]);function o(e,t,n,r,o,i){for(var a=2*e,s=a*(n+1)+t,u=n+1;u<r;++u,s+=a)for(var c=o[s],l=u,h=a*(u-1);l>n&&o[h+t]>c;--l,h-=a){for(var d=h,f=h+a,p=0;p<a;++p,++d,++f){var m=o[d];o[d]=o[f],o[f]=m}var v=i[l];i[l]=i[l-1],i[l-1]=v}}},function(e,t,n){"use strict";n.r(t),t.default=function(e){return{name:"collideTerrain",order:0,state:{callback:null},onAdd:function(t,n){var r=e.entities;r.hasPhysics(t)&&(r.getPhysicsBody(t).onCollide=function(n){var r=e.ents.getCollideTerrain(t).callback;r&&r(n,t)})},onRemove:function(t,n){var r=e.entities;r.hasPhysics(t)&&(r.getPhysicsBody(t).onCollide=null)}}}},function(e,t,n){"use strict";n.r(t),t.default=function(e){return{name:"fadeOnZoom",order:99,state:{cutoff:1.5,_showing:!0},onAdd:null,onRemove:null,system:function(t,n){var r=e.camera.currentZoom,o=e.entities;n.forEach(e=>{!function(e,t,n,r){if(!r.hasMesh(t))return;if(e._showing&&n<e.cutoff||!e._showing&&n>e.cutoff){r.getMeshData(t).mesh.visibility=e._showing=n>e.cutoff}}(e,e.__id,r,o)})}}}},function(e,t,n){"use strict";n.r(t);var r=n(82);t.default=function(e){return{name:"followsEntity",order:50,state:{entity:0,offset:null},onAdd:function(e,o){var i=r.create();o.offset=o.offset?r.copy(i,o.offset):i,t(o),n(o)},onRemove:null,system:function(e,n){n.forEach(e=>t(e))},renderSystem:function(e,t){t.forEach(e=>n(e))}};function t(t){var n=t.__id,o=e.ents.getPositionData(n),i=e.ents.getPositionData(t.entity);if(!i)return e.ents.removeComponent(n,e.ents.names.followsEntity);r.add(o._localPosition,i._localPosition,t.offset)}function n(t){var n=t.__id,o=e.ents.getPositionData(n),i=e.ents.getPositionData(t.entity);if(!i)return e.ents.removeComponent(n,e.ents.names.followsEntity);r.add(o._renderPosition,i._renderPosition,t.offset)}}},function(e,t,n){"use strict";n.r(t);var r=n(82);t.default=function(e){return{name:"mesh",order:100,state:{mesh:null,offset:null},onAdd:function(t,n){var o=e.ents.getPositionData(t);if(!n.mesh)throw new Error("Mesh component added without a mesh - probably a bug!");e.rendering.addMeshToScene(n.mesh,!1,o.position),n.offset||(n.offset=new r.create);var i=o._renderPosition;n.mesh.position.copyFromFloats(i[0]+n.offset[0],i[1]+n.offset[1],i[2]+n.offset[2])},onRemove:function(e,t){t.mesh.dispose()},renderSystem:function(t,n){n.forEach(t=>{var n=t.__id,r=e.ents.getPositionData(n)._renderPosition;t.mesh.position.copyFromFloats(r[0]+t.offset[0],r[1]+t.offset[1],r[2]+t.offset[2])})}}}},function(e,t,n){"use strict";n.r(t);var r=n(82);t.default=function(e){return{name:"movement",order:30,state:{heading:0,running:!1,jumping:!1,maxSpeed:10,moveForce:30,responsiveness:15,runningFriction:0,standingFriction:2,airMoveMult:.5,jumpImpulse:10,jumpForce:12,jumpTime:500,airJumps:1,_jumpCount:0,_isJumping:0,_currjumptime:0},onAdd:null,onRemove:null,system:function(t,n){var s=e.entities;n.forEach(e=>{var n=s.getPhysicsBody(e.__id);!function(e,t,n){var s=n.atRestY()<0,u=s||t._jumpCount<t.airJumps;s&&(t._isJumping=!1,t._jumpCount=0);if(t.jumping)if(t._isJumping){if(t._currjumptime>0){var c=t.jumpForce;t._currjumptime<e&&(c*=t._currjumptime/e),n.applyForce([0,c,0]),t._currjumptime-=e}}else u&&(t._isJumping=!0,s||t._jumpCount++,t._currjumptime=t.jumpTime,n.applyImpulse([0,t.jumpImpulse,0]),!s&&n.velocity[1]<0&&(n.velocity[1]=0));else t._isJumping=!1;var l=o,h=i;if(t.running){var d=t.maxSpeed;r.set(l,0,0,d),r.rotateY(l,l,a,t.heading),r.subtract(h,l,n.velocity),h[1]=0;var f=r.length(h);if(r.normalize(h,h),f>0){var p=t.moveForce;s||(p*=t.airMoveMult);var m=t.responsiveness*f;p>m&&(p=m),r.scale(h,h,p),n.applyForce(h)}n.friction=t.runningFriction}else n.friction=t.standingFriction}(t,e,n)})}}};var o=r.create(),i=r.create(),a=r.create()},function(e,t,n){"use strict";n.r(t),t.default=function(e){return{name:"receivesInputs",order:20,state:{},onAdd:null,onRemove:null,system:function(t,n){var r=e.entities,o=e.inputs.state,i=e.camera.heading;n.forEach(e=>{!function(e,t,n){e.jumping=!!t.jump;var r=t.forward?t.backward?0:1:t.backward?-1:0,o=t.right?t.left?0:1:t.left?-1:0;0==(r|o)?e.running=!1:(e.running=!0,r?(-1==r&&(n+=Math.PI),o&&(n+=Math.PI/4*r*o)):n+=o*Math.PI/2,e.heading=n)}(r.getMovement(e.__id),o,i)})}}}},function(e,t,n){"use strict";n.r(t);var r=n(4),o=n(30),i=n(82);t.default=function(e,t){var n=t,u=e.rendering.getScene(),c=r.a.CreateDisc("shadow",.75,30,u);return c.rotation.x=Math.PI/2,c.material=e.rendering.makeStandardMaterial("shadowMat"),c.material.diffuseColor=o.e.Black(),c.material.ambientColor=o.e.Black(),c.material.alpha=.5,c.setEnabled(!1),u.removeMesh(c),{name:"shadow",order:80,state:{size:.5,_mesh:null},onAdd:function(t,n){var r=c.createInstance("shadow_instance");e.rendering.addMeshToScene(r),r.setEnabled(!1),n._mesh=r},onRemove:function(e,t){t._mesh.dispose()},system:function(t,r){var o=e.camera._localGetPosition(),u=n;r.forEach(t=>{var n=e.ents.getPositionData(t.__id),r=e.ents.getPhysics(t.__id);!function(e,t,n,r,o,u,c){var l;if(n&&n.body.resting[1]<0)l=t._localPosition[1];else{var h=e._localPick(t._localPosition,s,u);if(!h)return void r.setEnabled(!1);l=h.position[1]-e.worldOriginOffset[1]}l=Math.round(l),i.copy(a,t._localPosition),a[1]=l;var d=.01+i.squaredDistance(c,a)/1600*.1;d>.1&&(d=.1);r.position.y=l+d;var f=t._localPosition[1]-l,p=.7*o*(1-f/u);r.scaling.copyFromFloats(p,p,p),r.setEnabled(!0)}(e,n,r,t._mesh,t.size,u,o)})},renderSystem:function(t,n){n.forEach(t=>{var n=e.ents.getPositionData(t.__id)._renderPosition,r=t._mesh.position;r.x=n[0],r.z=n[2]})}}};var a=i.fromValues(0,0,0),s=i.fromValues(0,-1,0)},function(e,t,n){"use strict";n.r(t),t.default=function(e){return{name:"smooth-camera",order:99,state:{time:100.1},onAdd:null,onRemove:null,system:function(t,n){n.forEach(n=>{n.time-=t,n.time<0&&e.ents.removeComponent(n.__id,"smooth-camera")})}}}},function(e){e.exports=JSON.parse('{"_from":"github:andyhall/noa#develop","_id":"noa-engine@0.28.0","_inBundle":false,"_integrity":"","_location":"/noa-engine","_phantomChildren":{},"_requested":{"type":"git","raw":"github:andyhall/noa#develop","rawSpec":"github:andyhall/noa#develop","saveSpec":"github:andyhall/noa#develop","fetchSpec":null,"gitCommittish":"develop"},"_requiredBy":["#USER","/"],"_resolved":"github:andyhall/noa#b717bfacebd2e47abc7fa4b4aceb5603a99ea736","_spec":"github:andyhall/noa#develop","_where":"/home/patbox/Pulpit/repozytoria/voxelsrv","author":{"name":"Andy Hall"},"bugs":{"url":"https://github.com/andyhall/noa/issues"},"bundleDependencies":false,"dependencies":{"aabb-3d":"github:andyhall/aabb-3d","box-intersect":"^1.0.2","ent-comp":"^0.9.1","fast-voxel-raycast":"^0.1.1","game-inputs":"^0.4.0","game-shell":"github:andyhall/game-shell","gl-vec3":"^1.1.3","ndarray":"^1.0.16","voxel-aabb-sweep":"^0.5.0","voxel-physics-engine":"^0.10.0"},"deprecated":false,"description":"Experimental voxel game engine","devDependencies":{"eslint":"^6.8.0","js-beautify":"^1.10.2","jsdoc-to-markdown":"^5.0.3"},"files":["/src"],"homepage":"https://github.com/andyhall/noa#readme","keywords":["voxel","game","engine"],"license":"MIT","main":"src/index.js","name":"noa-engine","peerDependencies":{"@babylonjs/core":"^4.0.0"},"repository":{"type":"git","url":"git+https://github.com/andyhall/noa.git"},"scripts":{"doc":"jsdoc2md -f src/* src/**/* -g table -p list --partial doc-templates/* > doc/API.md"},"version":"0.28.0"}')},,,,function(e,t){e.exports=a;var n=BABYLON.Vector3,r=BABYLON.Color3;function o(){this.position=n.Zero(),this.velocity=n.Zero(),this.size=1,this.age=0,this.lifetime=1}function i(e){e.position.copyFromFloats(0,0,0),e.velocity.x=5*(Math.random()-.5),e.velocity.y=.5*Math.random()*5+2,e.velocity.z=5*(Math.random()-.5),e.size=1*Math.random(),e.age=0,e.lifetime=2}function a(e,t,r,a,s,c){if(e||(e=100),isNaN(t)&&(t=0),!r)throw"Invalid scene passed to mesh-particle-system";a=a||{r:1,g:1,b:1,a:1},s=s||[0,1],c=c||[0,1],this.capacity=e,this.rate=t,this.mesh=new BABYLON.Mesh("MPS-mesh",r),this.material=null,this.texture=null,this.gravity=-1,this.friction=1,this.fps=60,this.disposeOnEmpty=!1,this.stopOnEmpty=!1,this.parent=null,this.onDispose=null,this._scene=r,this._alive=0,this._data=new Float32Array(e*u),this._dummyParticle=new o,this._color0=new BABYLON.Color4(a.r,a.g,a.b,a.a),this._color1=new BABYLON.Color4(a.r,a.g,a.b,a.a),this._updateColors=!1,this._size0=1,this._size1=1,this._positions=[],this._colors=[],this._playing=!1,this._disposed=!1,this._lastPos=n.Zero(),this._startingThisFrame=!1,this._toEmit=0,this._createdOwnMaterial=!1,this._needsColorUpdate=!0;for(var l=this._positions,h=this._colors,d=[],f=[],p=[s[0],c[1],s[1],c[1],s[1],c[0],s[0],c[0]],m=0;m<e;m++){l.push(0,0,0,0,0,0,0,0,0,0,0,0),d.push(4*m,4*m+1,4*m+2),d.push(4*m,4*m+2,4*m+3);for(var v=0;v<8;v++)f.push(p[v]);for(var _=0;_<4;_++)h.push(a.r,a.g,a.b,a.a)}var g=new BABYLON.VertexData;g.positions=l,g.indices=d,g.uvs=f,g.colors=h,g.applyToMesh(this.mesh,!0),this.initParticle=i;var y=this;this.curriedAnimate=function(){y.animate(1/y.fps)}}var s=a;s.prototype.start=function(){if(!this._playing){if(this._disposed)throw new Error("Already disposed");this._scene.registerBeforeRender(this.curriedAnimate),function(e){for(var t=e._dummyParticle,r=0,o=new n(1/0,1/0,1/0),i=new n(-1/0,-1/0,-1/0),a=e.gravity/2,s=0;s<30;++s){e.initParticle(t),l(o,i,t.position.x,t.position.y,t.position.z);var u=t.lifetime,c=t.position.x+u*t.velocity.x,h=t.position.y+u*t.velocity.y+u*u*a,d=t.position.z+u*t.velocity.z;l(o,i,c,h,d),r=Math.max(r,t.size)}o.subtractFromFloatsToRef(r,r,r,o),i.subtractFromFloatsToRef(-r,-r,-r,i),e.mesh._boundingInfo=new BABYLON.BoundingInfo(o,i)}(this),this._playing=!0,this._startingThisFrame=!0}},s.prototype.stop=function(){this._playing&&(this._scene.unregisterBeforeRender(this.curriedAnimate),this._playing=!1)},s.prototype.setTexture=function(e,t){t?(this.material&&this._createdOwnMaterial&&this.material.dispose(!1,!1),this.material=t,this._createdOwnMaterial=!1):this.material||(this.material=new BABYLON.StandardMaterial("MPS-mat",this._scene),this.material.specularColor=r.Black(),this.material.checkReadyOnlyOnce=!0,this._createdOwnMaterial=!0),this.mesh.material=this.material,this.texture=e,this._needsColorUpdate=!0},s.prototype.setAlphaRange=function(e,t){this._color0.a=e,this._color1.a=t,this._needsColorUpdate=!0},s.prototype.setColorRange=function(e,t){this._color0.r=e.r,this._color0.g=e.g,this._color0.b=e.b,this._color1.r=t.r,this._color1.g=t.g,this._color1.b=t.b,this._needsColorUpdate=!0},s.prototype.setSizeRange=function(e,t){this._size0=e,this._size1=t},s.prototype.emit=function(e){this.start(),this._toEmit+=e},s.prototype.dispose=function(){this.onDispose&&this.onDispose(),function(e){e.stop(),e._createdOwnMaterial&&(e.material.ambientTexture=null,e.material.opacityTexture=null,e.material.diffuseTexture=null,e.material.dispose(!1,!1));e.material=null,e.mesh.geometry.dispose(),e.mesh.dispose(),e.mesh=null,e.texture=null,e.curriedAnimate=null,e.initParticle=null,e._scene=null,e._dummyParticle=null,e._color0=null,e._color1=null,e._data=null,e._positions.length=0,e._colors.length=0,e._positions=null,e._colors=null,e.parent=null,e._disposed=!0}(this)};var u=9;function c(e,t){return Math.abs(e-t)<1e-5}function l(e,t,n,r,o){n<e.x?e.x=n:n>t.x&&(t.x=n),r<e.y?e.y=r:r>t.y&&(t.y=r),o<e.z?e.z=o:o>t.z&&(t.z=o)}function h(e){var t=e._dummyParticle;e.initParticle(t);var n=e._data,r=e._alive*u;n[r]=t.position.x,n[r+1]=t.position.y,n[r+2]=t.position.z,n[r+3]=t.velocity.x,n[r+4]=t.velocity.y,n[r+5]=t.velocity.z,n[r+6]=t.size,n[r+7]=t.age,n[r+8]=t.lifetime,e._alive+=1}function d(e,t){for(var n=e._data,r=(e._alive-1)*u,o=t*u,i=0;i<u;++i)n[o+i]=n[r+i];e._alive-=1}s.prototype.animate=function(e){this._needsColorUpdate&&function(e){this._needsColorUpdate=!1;var t=e._color0,n=e._color1,o=!(c(t.a,1)&&c(t.a,n.a)),i=!(c(t.r,n.r)&&c(t.g,n.g)&&c(t.b,n.b));e._updateColors=o||i,e.mesh.hasVertexAlpha=o,e.material&&(i||o?(e.material.diffuseTexture=null,e.material.ambientTexture=e.texture,e.material.opacityTexture=e.texture,e.material.diffuseColor=r.White(),e.material.useAlphaFromDiffuseTexture=!0,e.texture&&(e.texture.hasAlpha=!1)):(e.material.diffuseTexture=e.texture,e.material.ambientTexture=null,e.material.opacityTexture=null,e.material.diffuseColor=new r(t.r,t.g,t.b),e.material.useAlphaFromDiffuseTexture=!1,e.texture&&(e.texture.hasAlpha=!0)))}(this),e>.1&&(e=.1),function(e){if(e.parent){var t=e.parent.absolutePosition;e._startingThisFrame&&(t=e.parent.getAbsolutePosition(),e._startingThisFrame=!1),e.mesh.position.copyFrom(t)}var n=e.mesh.position.x-e._lastPos.x,r=e.mesh.position.y-e._lastPos.y,o=e.mesh.position.z-e._lastPos.z;if(e._lastPos.copyFrom(e.mesh.position),Math.abs(n)+Math.abs(r)+Math.abs(o)<.001)return;for(var i=e._alive,a=e._data,s=0;s<i;s++){var c=s*u;a[c]-=n,a[c+1]-=r,a[c+2]-=o}}(this),function(e,t){e._toEmit+=t;var n=Math.floor(e._toEmit);e._toEmit-=n;var r=e._alive+n;r>e.capacity&&(r=e.capacity);for(;e._alive<r;)h(e)}(this,this.rate*e),function(e,t){for(var n=e.gravity*t,r=e._data,o=e.friction,i=0,a=0;a<e._alive;++a){r[i+4]+=n,r[i+3]*=o,r[i+4]*=o,r[i+5]*=o,r[i]+=r[i+3]*t,r[i+1]+=r[i+4]*t,r[i+2]+=r[i+5]*t;var s=r[i+7]+t;s>r[i+8]?(d(e,a),a--):(r[i+7]=s,i+=u)}}(this,e),function(e){var t=e._positions,r=e._data,o=e._scene.activeCamera,i=BABYLON.Matrix.Identity();BABYLON.Matrix.LookAtLHToRef(o.globalPosition,e.mesh.position,n.Up(),i),i.m[12]=i.m[13]=i.m[14]=0,i.invert();for(var a=i.m,s=e._alive,c=e._size0,l=e._size1-c,h=0;h<s;h++)for(var d=h*u,f=r[d+7]/r[d+8],p=r[d+6]*(c+l*f)/2,m=12*h,v=0;v<4;v++){var _=1===v||2===v?p:-p,g=v>1?p:-p,y=_*a[3]+g*a[7]+a[15];t[m]=r[d]+(_*a[0]+g*a[4])/y,t[m+1]=r[d+1]+(_*a[1]+g*a[5])/y,t[m+2]=r[d+2]+(_*a[2]+g*a[6])/y,m+=3}e.mesh.updateVerticesData(BABYLON.VertexBuffer.PositionKind,t,!1,!1)}(this),this._updateColors&&function(e){for(var t=e._alive,n=e._data,r=e._colors,o=e._color0.r,i=e._color0.g,a=e._color0.b,s=e._color0.a,c=e._color1.r-o,l=e._color1.g-i,h=e._color1.b-a,d=e._color1.a-s,f=0;f<t;f++)for(var p=f*u,m=n[p+7]/n[p+8],v=o+c*m,_=i+l*m,g=a+h*m,y=s+d*m,b=16*f,w=0;w<4;w++)r[b]=v,r[b+1]=_,r[b+2]=g,r[b+3]=y,b+=4;e.mesh.updateVerticesData(BABYLON.VertexBuffer.ColorKind,r,!1,!1)}(this),this.mesh.subMeshes[0].indexCount=6*this._alive,0===this._alive&&0===this.rate&&(this.disposeOnEmpty?this.dispose():this.stopOnEmpty&&this.stop())}}]);