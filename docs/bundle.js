!function(e){function t(t){for(var r,s,a=t[0],u=t[1],l=t[2],h=0,f=[];h<a.length;h++)s=a[h],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&f.push(i[s][0]),i[s]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);for(c&&c(t);f.length;)f.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,a=1;a<n.length;a++){var u=n[a];0!==i[u]&&(r=!1)}r&&(o.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},i={1:0},o=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var a=window.webpackJsonp=window.webpackJsonp||[],u=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var c=u;o.push([256,0]),n()}([,function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return u}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function i(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function s(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}function a(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))}function u(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){e.exports={EPSILON:n(217),create:n(218),clone:n(257),angle:n(258),fromValues:n(219),copy:n(259),set:n(260),equals:n(261),exactEquals:n(262),add:n(263),subtract:n(222),sub:n(264),multiply:n(223),mul:n(265),divide:n(224),div:n(266),min:n(267),max:n(268),floor:n(269),ceil:n(270),round:n(271),scale:n(272),scaleAndAdd:n(273),distance:n(225),dist:n(274),squaredDistance:n(226),sqrDist:n(275),length:n(227),len:n(276),squaredLength:n(228),sqrLen:n(277),negate:n(278),inverse:n(279),normalize:n(220),dot:n(221),cross:n(280),lerp:n(281),random:n(282),transformMat4:n(283),transformMat3:n(284),transformQuat:n(285),rotateX:n(286),rotateY:n(287),rotateZ:n(288),forEach:n(289)}},,,,,function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getScreen=t.getUI=t.getLayer=t.constructScreen=t.getEngine=t.setScale=t.maxScale=t.scale=t.engine=t.event=void 0;const s=o(n(139)),a=o(n(97)),u=n(135);t.event=new u.EventEmitter;let l,c,h,f,d,p=!1;function m(e){t.maxScale=e;let n=y();setTimeout(()=>{t.event.emit("scale-change",n)},100)}function y(){const e=window.innerWidth;let n;return n=e>=2e3?5:e>=1500?4:e>=900?3:2,n>t.maxScale?t.scale=t.maxScale:t.scale=n,n>t.maxScale?t.maxScale:n}t.scale=3,t.maxScale=3,t.setScale=m,t.getEngine=function(){return t.engine},window.scale=m,t.constructScreen=function(e){t.engine=e.rendering.getEngine();const n=e.rendering.getScene();l=new s.Scene(t.engine),c=a.AdvancedDynamicTexture.CreateFullscreenUI("UI",!0,n,s.Texture.NEAREST_SAMPLINGMODE),h=a.AdvancedDynamicTexture.CreateFullscreenUI("UI",!1,l,s.Texture.NEAREST_SAMPLINGMODE),f=new a.Rectangle,f.isPointerBlocker=!1,f.zIndex=1e3,c.addControl(f),d=new a.Rectangle,d.isPointerBlocker=!1,d.zIndex=1e3,h.addControl(d),t.engine.onResizeObservable.add(e=>{c.getContext().imageSmoothingEnabled=!1,h.getContext().imageSmoothingEnabled=!1,t.event.emit("resize",e),y(),setTimeout(()=>{t.event.emit("scale-change",t.scale)},50)}),c.getContext().imageSmoothingEnabled=!1,h.getContext().imageSmoothingEnabled=!1,l.autoClear=!1,new s.ArcRotateCamera("Camera",-Math.PI/2,7*Math.PI/16,10,s.Vector3.Zero(),l),p=!0,e.rendering._multiscenes.push(l),y()},t.getLayer=function(e){if(!p)throw"Scenes aren't initialized yet!";if(0==e)return l;throw"Invalid number"},t.getUI=function(e){if(!p)throw"UIs aren't initialized yet!";if(0==e)return c;if(1==e)return h;throw"Invalid number"},t.getScreen=function(e){if(!p)throw"UIs aren't initialized yet!";if(0==e)return f;if(1==e)return d;throw"Invalid number"}},,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setNoa=t.noa=t.defaultFonts=t.noaOpts=t.updateServerSettings=t.serverSettings=t.defaultServerSettings=t.updateSettings=t.gameSettings=t.defaultSettings=t.gameProtocol=t.gameVersion=void 0;const r=n(241),i=n(134),o=n(81);t.gameVersion="0.2.0-alpha",t.gameProtocol=2,t.defaultSettings={version:"0.0.0",nickname:"Player"+Math.round(1e5*Math.random()),autostep:i.isMobile,gamepad:!1,singleplayer:!1,allowcustom:!1,mouse:i.isMobile?50:15,hotbarsize:9,scale:3},t.gameSettings={...t.defaultSettings,version:t.gameVersion},t.updateSettings=function(e){t.gameSettings={...t.defaultSettings,...e},o.setScale(t.gameSettings.scale),r.saveSettings(t.gameSettings)},t.defaultServerSettings={cheats:!1,control:!1,ingame:!1},t.serverSettings={...t.defaultServerSettings},t.updateServerSettings=function(e){t.serverSettings={...t.serverSettings,...e}},t.noaOpts=function(){return{debug:!0,showFPS:!0,inverseY:!1,inverseX:!1,sensitivityX:t.gameSettings.mouse,sensitivityY:t.gameSettings.mouse,chunkSize:32,chunkAddDistance:10,chunkRemoveDistance:1/0,blockTestDistance:7,tickRate:i.isMobile?65:50,texturePath:"",playerStart:[0,100,0],playerHeight:1.85,playerWidth:.5,playerAutoStep:t.gameSettings.autostep?1:0,clearColor:[.8,.9,1],ambientColor:[1,1,1],lightDiffuse:[1,1,1],lightSpecular:[1,1,1],groundLightColor:[.5,.5,.5],useAO:!0,AOmultipliers:[.93,.8,.5],reverseAOmultiplier:1,preserveDrawingBuffer:!0,adaptToDeviceRatio:!1,gravity:[0,-14,0],bindings:{forward:["W"],left:["A"],backward:["S"],right:["D"],fire:"<mouse 1>","mid-fire":["<mouse 2>"],"alt-fire":["<mouse 3>"],jump:"<space>",inventory:["E"],muteMusic:["O"],thirdprsn:["M"],chatenter:["<enter>"],chat:["T"],cmd:["/"],tab:["<tab>"],menu:["<escape>"],screenshot:["P"]}}},t.defaultFonts=["silkscreen","Lato","Lato-Italic","Lato-Black","Lato-BlackItalic","Lato-Bold","Lato-BoldItalic","Lato-Light","Lato-LightItalic","Lato-Thin","Lato-ThinItalic"],t.noa=null,t.setNoa=function(e){t.noa=e}},,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)i(n,r)&&(e[r]=n[r])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var o={arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),i);else for(var o=0;o<r;o++)e[i+o]=t[n+o]},flattenChunks:function(e){var t,n,r,i,o,s;for(r=0,t=0,n=e.length;t<n;t++)r+=e[t].length;for(s=new Uint8Array(r),i=0,t=0,n=e.length;t<n;t++)o=e[t],s.set(o,i),i+=o.length;return s}},s={arraySet:function(e,t,n,r,i){for(var o=0;o<r;o++)e[i+o]=t[n+o]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,o)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,s))},t.setTyped(r)},,,,,,,,,function(e,t,n){"use strict";(function(e){var r=t;function i(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;++i)void 0!==e[r[i]]&&n||(e[r[i]]=t[r[i]]);return e}function o(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&i(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}r.asPromise=n(338),r.base64=n(339),r.EventEmitter=n(340),r.float=n(341),r.inquire=n(342),r.utf8=n(343),r.pool=n(344),r.LongBits=n(345),r.isNode=Boolean(void 0!==e&&e&&e.process&&e.process.versions&&e.process.versions.node),r.global=r.isNode&&e||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"==typeof e||e instanceof String},r.isObject=function(e){return e&&"object"==typeof e},r.isset=r.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"==typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var n=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},r.merge=i,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=o,r.ProtocolError=o("ProtocolError"),r.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},r.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}}).call(this,n(150))},function(e,t,n){var r=n(229),i=n(290),o="undefined"!=typeof Float64Array;function s(e,t){return e[0]-t[0]}function a(){var e,t=this.stride,n=new Array(t.length);for(e=0;e<n.length;++e)n[e]=[Math.abs(t[e]),e];n.sort(s);var r=new Array(n.length);for(e=0;e<r.length;++e)r[e]=n[e][1];return r}function u(e,t){var n=["View",t,"d",e].join("");t<0&&(n="View_Nil"+e);var i="generic"===e;if(-1===t){var o="function "+n+"(a){this.data=a;};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+n+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+n+"(a){return new "+n+"(a);}";return new Function(o)()}if(0===t){o="function "+n+"(a,d) {this.data = a;this.offset = d};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+n+"_copy() {return new "+n+"(this.data,this.offset)};proto.pick=function "+n+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+n+"_get(){return "+(i?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+n+"_set(v){return "+(i?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}";return new Function("TrivialArray",o)(l[e][0])}o=["'use strict'"];var s=r(t),u=s.map((function(e){return"i"+e})),c="this.offset+"+s.map((function(e){return"this.stride["+e+"]*i"+e})).join("+"),h=s.map((function(e){return"b"+e})).join(","),f=s.map((function(e){return"c"+e})).join(",");o.push("function "+n+"(a,"+h+","+f+",d){this.data=a","this.shape=["+h+"]","this.stride=["+f+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+e+"'","proto.dimension="+t),o.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){return "+s.map((function(e){return"this.shape["+e+"]"})).join("*"),"}})"),1===t?o.push("proto.order=[0]"):(o.push("Object.defineProperty(proto,'order',{get:"),t<4?(o.push("function "+n+"_order(){"),2===t?o.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===t&&o.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):o.push("ORDER})")),o.push("proto.set=function "+n+"_set("+u.join(",")+",v){"),i?o.push("return this.data.set("+c+",v)}"):o.push("return this.data["+c+"]=v}"),o.push("proto.get=function "+n+"_get("+u.join(",")+"){"),i?o.push("return this.data.get("+c+")}"):o.push("return this.data["+c+"]}"),o.push("proto.index=function "+n+"_index(",u.join(),"){return "+c+"}"),o.push("proto.hi=function "+n+"_hi("+u.join(",")+"){return new "+n+"(this.data,"+s.map((function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")})).join(",")+","+s.map((function(e){return"this.stride["+e+"]"})).join(",")+",this.offset)}");var d=s.map((function(e){return"a"+e+"=this.shape["+e+"]"})),p=s.map((function(e){return"c"+e+"=this.stride["+e+"]"}));o.push("proto.lo=function "+n+"_lo("+u.join(",")+"){var b=this.offset,d=0,"+d.join(",")+","+p.join(","));for(var m=0;m<t;++m)o.push("if(typeof i"+m+"==='number'&&i"+m+">=0){d=i"+m+"|0;b+=c"+m+"*d;a"+m+"-=d}");o.push("return new "+n+"(this.data,"+s.map((function(e){return"a"+e})).join(",")+","+s.map((function(e){return"c"+e})).join(",")+",b)}"),o.push("proto.step=function "+n+"_step("+u.join(",")+"){var "+s.map((function(e){return"a"+e+"=this.shape["+e+"]"})).join(",")+","+s.map((function(e){return"b"+e+"=this.stride["+e+"]"})).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(m=0;m<t;++m)o.push("if(typeof i"+m+"==='number'){d=i"+m+"|0;if(d<0){c+=b"+m+"*(a"+m+"-1);a"+m+"=ceil(-a"+m+"/d)}else{a"+m+"=ceil(a"+m+"/d)}b"+m+"*=d}");o.push("return new "+n+"(this.data,"+s.map((function(e){return"a"+e})).join(",")+","+s.map((function(e){return"b"+e})).join(",")+",c)}");var y=new Array(t),g=new Array(t);for(m=0;m<t;++m)y[m]="a[i"+m+"]",g[m]="b[i"+m+"]";o.push("proto.transpose=function "+n+"_transpose("+u+"){"+u.map((function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"})).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+y.join(",")+","+g.join(",")+",this.offset)}"),o.push("proto.pick=function "+n+"_pick("+u+"){var a=[],b=[],c=this.offset");for(m=0;m<t;++m)o.push("if(typeof i"+m+"==='number'&&i"+m+">=0){c=(c+this.stride["+m+"]*i"+m+")|0}else{a.push(this.shape["+m+"]);b.push(this.stride["+m+"])}");return o.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),o.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+s.map((function(e){return"shape["+e+"]"})).join(",")+","+s.map((function(e){return"stride["+e+"]"})).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",o.join("\n"))(l[e],a)}var l={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};e.exports=function(e,t,n,r){if(void 0===e)return(0,l.array[0])([]);"number"==typeof e&&(e=[e]),void 0===t&&(t=[e.length]);var s=t.length;if(void 0===n){n=new Array(s);for(var a=s-1,c=1;a>=0;--a)n[a]=c,c*=t[a]}if(void 0===r){r=0;for(a=0;a<s;++a)n[a]<0&&(r-=(t[a]-1)*n[a])}for(var h=function(e){if(i(e))return"buffer";if(o)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(e)?"array":"generic"}(e),f=l[h];f.length<=s+1;)f.push(u(h,f.length-1));return(0,f[s+1])(e,t,n,r)}},,,,,,function(e,t){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";var r={MOBILE:"mobile",TABLET:"tablet",SMART_TV:"smarttv",CONSOLE:"console",WEARABLE:"wearable",BROWSER:void 0};e.exports={BROWSER_TYPES:{CHROME:"Chrome",FIREFOX:"Firefox",OPERA:"Opera",YANDEX:"Yandex",SAFARI:"Safari",INTERNET_EXPLORER:"Internet Explorer",EDGE:"Edge",CHROMIUM:"Chromium",IE:"IE",MOBILE_SAFARI:"Mobile Safari",EDGE_CHROMIUM:"Edge Chromium"},DEVICE_TYPES:r,OS_TYPES:{IOS:"iOS",ANDROID:"Android",WINDOWS_PHONE:"Windows Phone",WINDOWS:"Windows",MAC_OS:"Mac OS"},defaultData:{isMobile:!1,isTablet:!1,isBrowser:!1,isSmartTV:!1,isConsole:!1,isWearable:!1}}},function(e,t,n){"use strict";var r,i=n(2),o=n(0),s=o.BROWSER_TYPES,a=o.OS_TYPES,u=o.DEVICE_TYPES,l=n(4),c=l.checkType,h=l.broPayload,f=l.mobilePayload,d=l.wearPayload,p=l.consolePayload,m=l.stvPayload,y=l.getNavigatorInstance,g=l.isIOS13Check,v=new i,b=v.getBrowser(),w=v.getDevice(),_=v.getEngine(),x=v.getOS(),k=v.getUA(),O=s.CHROME,P=s.CHROMIUM,S=s.IE,C=s.INTERNET_EXPLORER,j=s.OPERA,E=s.FIREFOX,A=s.SAFARI,M=s.EDGE,T=s.YANDEX,I=s.MOBILE_SAFARI,D=u.MOBILE,z=u.TABLET,B=u.SMART_TV,L=u.BROWSER,R=u.WEARABLE,N=u.CONSOLE,F=a.ANDROID,U=a.WINDOWS_PHONE,V=a.IOS,q=a.WINDOWS,K=a.MAC_OS,W=function(){return x.name===a.WINDOWS&&"10"===x.version&&("string"==typeof k&&-1!==k.indexOf("Edg/"))},Y=function(){return b.name===M},H=function(){return g("iPad")},G=w.type===B,J=w.type===N,Z=w.type===R,X=b.name===I||H(),$=b.name===P,Q=function(){switch(w.type){case D:case z:return!0;default:return!1}}()||H(),ee=w.type===D,te=w.type===z||H(),ne=w.type===L,re=x.name===F,ie=x.name===U,oe=x.name===V||H(),se=b.name===O,ae=b.name===E,ue=b.name===A||b.name===I,le=b.name===j,ce=b.name===C||b.name===S,he=x.version?x.version:"none",fe=x.name?x.name:"none",de=b.major,pe=b.version,me=b.name,ye=w.vendor?w.vendor:"none",ge=w.model?w.model:"none",ve=_.name,be=_.version,we=k,_e=Y()||W(),xe=b.name===T,ke=w.type,Oe=(r=y())&&(/iPad|iPhone|iPod/.test(r.platform)||"MacIntel"===r.platform&&r.maxTouchPoints>1)&&!window.MSStream,Pe=H(),Se=g("iPhone"),Ce=g("iPod"),je=function(){var e=y(),t=e&&e.userAgent.toLowerCase();return"string"==typeof t&&/electron/.test(t)}(),Ee=W(),Ae=Y(),Me=x.name===q,Te=x.name===K,Ie=c(w.type);e.exports={deviceDetect:function(){var e=Ie.isBrowser,t=Ie.isMobile,n=Ie.isTablet,r=Ie.isSmartTV,i=Ie.isConsole,o=Ie.isWearable;return e?h(e,b,_,x,k):r?m(r,_,x,k):i?p(i,_,x,k):t||n?f(Ie,w,x,k):o?d(o,_,x,k):void 0},isSmartTV:G,isConsole:J,isWearable:Z,isMobileSafari:X,isChromium:$,isMobile:Q,isMobileOnly:ee,isTablet:te,isBrowser:ne,isAndroid:re,isWinPhone:ie,isIOS:oe,isChrome:se,isFirefox:ae,isSafari:ue,isOpera:le,isIE:ce,osVersion:he,osName:fe,fullBrowserVersion:de,browserVersion:pe,browserName:me,mobileVendor:ye,mobileModel:ge,engineName:ve,engineVersion:be,getUA:we,isEdge:_e,isYandex:xe,deviceType:ke,isIOS13:Oe,isIPad13:Pe,isIPhone13:Se,isIPod13:Ce,isElectron:je,isEdgeChromium:Ee,isLegacyEdge:Ae,isWindows:Me,isMacOs:Te}},function(e,t,n){var r;
/*!
 * UAParser.js v0.7.18
 * Lightweight JavaScript-based User-Agent string parser
 * https://github.com/faisalman/ua-parser-js
 *
 * Copyright © 2012-2016 Faisal Salman <fyzlman@gmail.com>
 * Dual licensed under GPLv2 or MIT
 */!function(i,o){"use strict";var s="model",a="name",u="type",l="vendor",c="version",h="mobile",f="tablet",d={extend:function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},p={rgx:function(e,t){for(var n,r,i,o,s,a,u=0;u<t.length&&!s;){var l=t[u],c=t[u+1];for(n=r=0;n<l.length&&!s;)if(s=l[n++].exec(e))for(i=0;i<c.length;i++)a=s[++r],"object"==typeof(o=c[i])&&o.length>0?2==o.length?"function"==typeof o[1]?this[o[0]]=o[1].call(this,a):this[o[0]]=o[1]:3==o.length?"function"!=typeof o[1]||o[1].exec&&o[1].test?this[o[0]]=a?a.replace(o[1],o[2]):void 0:this[o[0]]=a?o[1].call(this,a,o[2]):void 0:4==o.length&&(this[o[0]]=a?o[3].call(this,a.replace(o[1],o[2])):void 0):this[o]=a||void 0;u+=2}},str:function(e,t){for(var n in t)if("object"==typeof t[n]&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(d.has(t[n][r],e))return"?"===n?void 0:n}else if(d.has(t[n],e))return"?"===n?void 0:n;return e}},m={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},y={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[a,c],[/(opios)[\/\s]+([\w\.]+)/i],[[a,"Opera Mini"],c],[/\s(opr)\/([\w\.]+)/i],[[a,"Opera"],c],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark)\/([\w\.-]+)/i],[a,c],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[a,"IE"],c],[/(edge|edgios|edgea)\/((\d+)?[\w\.]+)/i],[[a,"Edge"],c],[/(yabrowser)\/([\w\.]+)/i],[[a,"Yandex"],c],[/(puffin)\/([\w\.]+)/i],[[a,"Puffin"],c],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[a,"UCBrowser"],c],[/(comodo_dragon)\/([\w\.]+)/i],[[a,/_/g," "],c],[/(micromessenger)\/([\w\.]+)/i],[[a,"WeChat"],c],[/(qqbrowserlite)\/([\w\.]+)/i],[a,c],[/(QQ)\/([\d\.]+)/i],[a,c],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[a,c],[/(BIDUBrowser)[\/\s]?([\w\.]+)/i],[a,c],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[a,c],[/(MetaSr)[\/\s]?([\w\.]+)/i],[a],[/(LBBROWSER)/i],[a],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[c,[a,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[c,[a,"Facebook"]],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[c,[a,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[a,/(.+)/,"$1 WebView"],c],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[a,/(.+(?:g|us))(.+)/,"$1 $2"],c],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[c,[a,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[a,c],[/(dolfin)\/([\w\.]+)/i],[[a,"Dolphin"],c],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[a,"Chrome"],c],[/(coast)\/([\w\.]+)/i],[[a,"Opera Coast"],c],[/fxios\/([\w\.-]+)/i],[c,[a,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[c,[a,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[c,a],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[a,"GSA"],c],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[a,[c,p.str,m.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[a,c],[/(navigator|netscape)\/([\w\.-]+)/i],[[a,"Netscape"],c],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[a,c]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",d.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",d.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",d.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[s,l,[u,f]],[/applecoremedia\/[\w\.]+ \((ipad)/],[s,[l,"Apple"],[u,f]],[/(apple\s{0,1}tv)/i],[[s,"Apple TV"],[l,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[l,s,[u,f]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[s,[l,"Amazon"],[u,f]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[s,p.str,m.device.amazon.model],[l,"Amazon"],[u,h]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[s,l,[u,h]],[/\((ip[honed|\s\w*]+);/i],[s,[l,"Apple"],[u,h]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[l,s,[u,h]],[/\(bb10;\s(\w+)/i],[s,[l,"BlackBerry"],[u,h]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[s,[l,"Asus"],[u,f]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[l,"Sony"],[s,"Xperia Tablet"],[u,f]],[/android.+\s([c-g]\d{4}|so[-l]\w+)\sbuild\//i],[s,[l,"Sony"],[u,h]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[l,s,[u,"console"]],[/android.+;\s(shield)\sbuild/i],[s,[l,"Nvidia"],[u,"console"]],[/(playstation\s[34portablevi]+)/i],[s,[l,"Sony"],[u,"console"]],[/(sprint\s(\w+))/i],[[l,p.str,m.device.sprint.vendor],[s,p.str,m.device.sprint.model],[u,h]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[l,s,[u,f]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[l,[s,/_/g," "],[u,h]],[/(nexus\s9)/i],[s,[l,"HTC"],[u,f]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[s,[l,"Huawei"],[u,h]],[/(microsoft);\s(lumia[\s\w]+)/i],[l,s,[u,h]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[s,[l,"Microsoft"],[u,"console"]],[/(kin\.[onetw]{3})/i],[[s,/\./g," "],[l,"Microsoft"],[u,h]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[s,[l,"Motorola"],[u,h]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[s,[l,"Motorola"],[u,f]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[l,d.trim],[s,d.trim],[u,"smarttv"]],[/hbbtv.+maple;(\d+)/i],[[s,/^/,"SmartTV"],[l,"Samsung"],[u,"smarttv"]],[/\(dtv[\);].+(aquos)/i],[s,[l,"Sharp"],[u,"smarttv"]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[l,"Samsung"],s,[u,f]],[/smart-tv.+(samsung)/i],[l,[u,"smarttv"],s],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[l,"Samsung"],s,[u,h]],[/sie-(\w*)/i],[s,[l,"Siemens"],[u,h]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[l,"Nokia"],s,[u,h]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[s,[l,"Acer"],[u,f]],[/android.+([vl]k\-?\d{3})\s+build/i],[s,[l,"LG"],[u,f]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[l,"LG"],s,[u,f]],[/(lg) netcast\.tv/i],[l,s,[u,"smarttv"]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[s,[l,"LG"],[u,h]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[s,[l,"Lenovo"],[u,f]],[/linux;.+((jolla));/i],[l,s,[u,h]],[/((pebble))app\/[\d\.]+\s/i],[l,s,[u,"wearable"]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[l,s,[u,h]],[/crkey/i],[[s,"Chromecast"],[l,"Google"]],[/android.+;\s(glass)\s\d/i],[s,[l,"Google"],[u,"wearable"]],[/android.+;\s(pixel c)\s/i],[s,[l,"Google"],[u,f]],[/android.+;\s(pixel xl|pixel)\s/i],[s,[l,"Google"],[u,h]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[s,/_/g," "],[l,"Xiaomi"],[u,h]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[s,/_/g," "],[l,"Xiaomi"],[u,f]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[s,[l,"Meizu"],[u,f]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})\s+build/i],[s,[l,"OnePlus"],[u,h]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[s,[l,"RCA"],[u,f]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[s,[l,"Dell"],[u,f]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[s,[l,"Verizon"],[u,f]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[l,"Barnes & Noble"],s,[u,f]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[s,[l,"NuVision"],[u,f]],[/android.+;\s(k88)\sbuild/i],[s,[l,"ZTE"],[u,f]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[s,[l,"Swiss"],[u,h]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[s,[l,"Swiss"],[u,f]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[s,[l,"Zeki"],[u,f]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[l,"Dragon Touch"],s,[u,f]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[s,[l,"Insignia"],[u,f]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[s,[l,"NextBook"],[u,f]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[l,"Voice"],s,[u,h]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[l,"LvTel"],s,[u,h]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[s,[l,"Envizen"],[u,f]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[l,s,[u,f]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[s,[l,"MachSpeed"],[u,f]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[l,s,[u,f]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[s,[l,"Rotor"],[u,f]],[/android.+(KS(.+))\s+build/i],[s,[l,"Amazon"],[u,f]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[l,s,[u,f]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[u,d.lowerize],l,s],[/(android[\w\.\s\-]{0,9});.+build/i],[s,[l,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[c,[a,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[a,c],[/rv\:([\w\.]{1,9}).+(gecko)/i],[c,a]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[a,c],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[a,[c,p.str,m.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[a,"Windows"],[c,p.str,m.os.windows.version]],[/\((bb)(10);/i],[[a,"BlackBerry"],c],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]*)/i,/linux;.+(sailfish);/i],[a,c],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[a,"Symbian"],c],[/\((series40);/i],[a],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[a,"Firefox OS"],c],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[a,c],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[a,"Chromium OS"],c],[/(sunos)\s?([\w\.\d]*)/i],[[a,"Solaris"],c],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[a,c],[/(haiku)\s(\w+)/i],[a,c],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[c,/_/g,"."],[a,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[a,"Mac OS"],[c,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]*)/i],[a,c]]},g=function(e,t){if("object"==typeof e&&(t=e,e=void 0),!(this instanceof g))return new g(e,t).getResult();var n=e||(i&&i.navigator&&i.navigator.userAgent?i.navigator.userAgent:""),r=t?d.extend(y,t):y;return this.getBrowser=function(){var e={name:void 0,version:void 0};return p.rgx.call(e,n,r.browser),e.major=d.major(e.version),e},this.getCPU=function(){var e={architecture:void 0};return p.rgx.call(e,n,r.cpu),e},this.getDevice=function(){var e={vendor:void 0,model:void 0,type:void 0};return p.rgx.call(e,n,r.device),e},this.getEngine=function(){var e={name:void 0,version:void 0};return p.rgx.call(e,n,r.engine),e},this.getOS=function(){var e={name:void 0,version:void 0};return p.rgx.call(e,n,r.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=e,this},this};g.VERSION="0.7.18",g.BROWSER={NAME:a,MAJOR:"major",VERSION:c},g.CPU={ARCHITECTURE:"architecture"},g.DEVICE={MODEL:s,VENDOR:l,TYPE:u,CONSOLE:"console",MOBILE:h,SMARTTV:"smarttv",TABLET:f,WEARABLE:"wearable",EMBEDDED:"embedded"},g.ENGINE={NAME:a,VERSION:c},g.OS={NAME:a,VERSION:c},void 0!==t?(void 0!==e&&e.exports&&(t=e.exports=g),t.UAParser=g):n(3)?void 0===(r=function(){return g}.call(t,n,t,e))||(e.exports=r):i&&(i.UAParser=g);var v=i&&(i.jQuery||i.Zepto);if(void 0!==v){var b=new g;v.ua=b.getResult(),v.ua.get=function(){return b.getUA()},v.ua.set=function(e){b.setUA(e);var t=b.getResult();for(var n in t)v.ua[n]=t[n]}}}("object"==typeof window?window:this)},function(e,t){(function(t){e.exports=t}).call(t,{})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(0),o=i.DEVICE_TYPES,s=i.defaultData,a=t.getNavigatorInstance=function(){return!("undefined"==typeof window||!window.navigator&&!navigator)&&(window.navigator||navigator)},u=t.isIOS13Check=function(e){var t=a();return t&&t.platform&&(-1!==t.platform.indexOf(e)||"MacIntel"===t.platform&&t.maxTouchPoints>1&&!window.MSStream)};e.exports={checkType:function(e){switch(e){case o.MOBILE:return{isMobile:!0};case o.TABLET:return{isTablet:!0};case o.SMART_TV:return{isSmartTV:!0};case o.CONSOLE:return{isConsole:!0};case o.WEARABLE:return{isWearable:!0};case o.BROWSER:return{isBrowser:!0};default:return s}},broPayload:function(e,t,n,r,i){return{isBrowser:e,browserMajorVersion:t.major,browserFullVersion:t.version,browserName:t.name,engineName:n.name||!1,engineVersion:n.version,osName:r.name,osVersion:r.version,userAgent:i}},mobilePayload:function(e,t,n,i){return r({},e,{vendor:t.vendor,model:t.model,os:n.name,osVersion:n.version,ua:i})},stvPayload:function(e,t,n,r){return{isSmartTV:e,engineName:t.name,engineVersion:t.version,osName:n.name,osVersion:n.version,userAgent:r}},consolePayload:function(e,t,n,r){return{isConsole:e,engineName:t.name,engineVersion:t.version,osName:n.name,osVersion:n.version,userAgent:r}},wearPayload:function(e,t,n,r){return{isWearable:e,engineName:t.name,engineVersion:t.version,osName:n.name,osVersion:n.version,userAgent:r}},getNavigatorInstance:a,isIOS13Check:u}}])},function(e,t,n){"use strict";var r,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(n,r){function i(){void 0!==o&&e.removeListener("error",o),n([].slice.call(arguments))}var o;"error"!==t&&(o=function(n){e.removeListener(t,i),r(n)},e.once("error",o)),e.once(t,i)}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var u=10;function l(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function h(e,t,n,r){var i,o,s,a;if(l(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),void 0===s)s=o[t]=n,++e._eventsCount;else if("function"==typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=c(e))>0&&s.length>i&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,a=u,console&&console.warn&&console.warn(a)}return e}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=f.bind(r);return i.listener=n,r.wrapFn=i,i}function p(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):y(i,i.length)}function m(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function y(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");u=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return c(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var u=i[e];if(void 0===u)return!1;if("function"==typeof u)o(u,this,t);else{var l=u.length,c=y(u,l);for(n=0;n<l;++n)o(c[n],this,t)}return!0},a.prototype.addListener=function(e,t){return h(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return h(this,e,t,!0)},a.prototype.once=function(e,t){return l(t),this.on(e,d(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return l(t),this.prependListener(e,d(this,e,t)),this},a.prototype.removeListener=function(e,t){var n,r,i,o,s;if(l(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},a.prototype.listeners=function(e){return p(this,e,!0)},a.prototype.rawListeners=function(e){return p(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},a.prototype.listenerCount=m,a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},,,,,,,,,,,,,,,function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormTextBlock=void 0;const r=n(4),i=n(34),o=n(21);class s extends o.Control{constructor(e,t=[]){super(e),this.name=e,this._text=[],this._textHorizontalAlignment=o.Control.HORIZONTAL_ALIGNMENT_CENTER,this._textVerticalAlignment=o.Control.VERTICAL_ALIGNMENT_CENTER,this._resizeToFit=!1,this._lineSpacing=new i.ValueAndUnit(0),this._outlineColor="white",this.shouldhide=!1,this.onTextChangedObservable=new r.Observable,this.onLinesReadyObservable=new r.Observable,this.text=t}get lines(){return this._lines}get resizeToFit(){return this._resizeToFit}set resizeToFit(e){this._resizeToFit!==e&&(this._resizeToFit=e,this._resizeToFit&&(this._width.ignoreAdaptiveScaling=!0,this._height.ignoreAdaptiveScaling=!0),this._markAsDirty())}get text(){return this._text}set text(e){this._text!==e&&(this._text=e,this._markAsDirty(),this.onTextChangedObservable.notifyObservers(this))}get textHorizontalAlignment(){return this._textHorizontalAlignment}set textHorizontalAlignment(e){this._textHorizontalAlignment!==e&&(this._textHorizontalAlignment=e,this._markAsDirty())}get textVerticalAlignment(){return this._textVerticalAlignment}set textVerticalAlignment(e){this._textVerticalAlignment!==e&&(this._textVerticalAlignment=e,this._markAsDirty())}set lineSpacing(e){this._lineSpacing.fromString(e)&&this._markAsDirty()}get lineSpacing(){return this._lineSpacing.toString(this._host)}_getTypeName(){return"FormTextBlock"}_processMeasures(e,t){this._fontOffset||(this._fontOffset=o.Control._GetFontOffset(t.font)),super._processMeasures(e,t),this._lines=this._breakLines(this._currentMeasure.width,t),this.onLinesReadyObservable.notifyObservers(this);let n=0;for(let e=0;e<this._lines.length;e++){const t=this._lines[e];t.width>n&&(n=t.width)}if(this._resizeToFit){let e=this.paddingTopInPixels+this.paddingBottomInPixels+this._fontOffset.height*this._lines.length|0;if(this._lines.length>0&&0!==this._lineSpacing.internalValue){let t=0;t=this._lineSpacing.isPixel?this._lineSpacing.getValue(this._host):this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height),e+=(this._lines.length-1)*t}e!==this._height.internalValue&&(this._height.updateInPlace(e,i.ValueAndUnit.UNITMODE_PIXEL),this._rebuildLayout=!0)}}_drawText(e,t,n,r){var i=this._currentMeasure.width,s=0;switch(this._textHorizontalAlignment){case o.Control.HORIZONTAL_ALIGNMENT_LEFT:s=0;break;case o.Control.HORIZONTAL_ALIGNMENT_RIGHT:s=i-t;break;case o.Control.HORIZONTAL_ALIGNMENT_CENTER:s=(i-t)/2}if((this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(r.shadowColor=this.shadowColor,r.shadowBlur=this.shadowBlur,r.shadowOffsetX=this.shadowOffsetX,r.shadowOffsetY=this.shadowOffsetY),null==e)return;const a=r.fillStyle,u=r.font,l=r.strokeStyle,c=r.lineWidth;e.forEach(e=>{if(null==e.text)return;null==e.font&&(e.font=u),r.font=`${this.fontSize} ${e.font}`,r.fillStyle=e.color||a;const t=r.measureText(e.text);r.lineWidth=Math.round(.05*this.fontSizeInPixels),r.lineCap="square",r.strokeStyle=r.fillStyle,e.underline&&(r.beginPath(),r.moveTo(this._currentMeasure.left+s,n+3),r.lineTo(this._currentMeasure.left+s+t.width,n+3),r.stroke(),r.closePath()),r.fillText(e.text,this._currentMeasure.left+s,n),e.linethrough&&(r.beginPath(),r.moveTo(this._currentMeasure.left+s,n-this.fontSizeInPixels/3),r.lineTo(this._currentMeasure.left+s+t.width,n-this.fontSizeInPixels/3),r.stroke(),r.closePath()),r.font=u,r.strokeStyle=l,r.lineWidth=c,s+=t.width}),r.fillStyle=a,r.font=u,r.strokeStyle=l,r.lineWidth=c}_draw(e,t){e.save(),this._applyStates(e),this._renderLines(e),e.restore()}_applyStates(e){super._applyStates(e)}_breakLines(e,t){var n=[];let r=[[]];for(var i of(this.text.forEach(e=>{let t=e.text.split("\n");if(t.length>1){r[r.length-1].push({text:t[0],color:e.color,font:e.font,underline:e.underline,linethrough:e.linethrough});for(let n=1;n<t.length;n++)r.push([{text:t[n],color:e.color,font:e.font,underline:e.underline,linethrough:e.linethrough}])}else r[r.length-1].push(e)}),r))n.push(...this._parseLineWordWrap(i,e,t));return n}_parseLine(e="",t){return{text:e,width:t.measureText(e).width}}_parseLineWordWrap(e=[],t,n){var r=[],i=[],o="";let s=this.fontFamily;e.forEach(e=>{null==e.font&&(e.font=s),e.text.split(" ").forEach(r=>{if(0==r.length)return;n.font=`${this.fontSize} ${e.font}`;let o=n.measureText(r);if(n.font=s,o.width<t)i.push({text:r+" ",font:e.font,color:e.color});else{const a=r.substring(0,Math.ceil(r.length/2)),u=r.substring(Math.floor(r.length/2));n.font=`${this.fontSize} ${e.font}`,o=n.measureText(a);let l=n.measureText(u);n.font=s,o.width<t?i.push({text:a+" ",font:e.font,color:e.color}):i.push({text:" [...] ",font:e.font,color:e.color}),l.width<t?i.push({text:u+" ",font:e.font,color:e.color}):i.push({text:" [...] ",font:e.font,color:e.color,underline:e.underline,linethrough:e.linethrough})}}),o+=e.text});n.font=`${this.fontSize} ${e[0].font}`;let a=n.measureText(o);if(n.font=s,a.width<t)return[{text:e,width:a.width}];let u="",l=0,c=[];for(var h=0;h<i.length;h++){let e=0==h?i[0].text:u+i[h].text;n.font=`${this.fontSize} ${i[h].font}`;let o=n.measureText(e);if(n.font=s,o.width>t){r.push({text:[...c],width:l}),c=[],e="",l=0;for(let e=0;e<h;e++)i.shift();h=-1}else u=e,l=o.width,c.push(i[h])}return r.push({text:[...c],width:l}),r}_renderLines(e){var t=this._currentMeasure.height,n=0;switch(this._textVerticalAlignment){case o.Control.VERTICAL_ALIGNMENT_TOP:n=this._fontOffset.ascent;break;case o.Control.VERTICAL_ALIGNMENT_BOTTOM:n=t-this._fontOffset.height*(this._lines.length-1)-this._fontOffset.descent;break;case o.Control.VERTICAL_ALIGNMENT_CENTER:n=this._fontOffset.ascent+(t-this._fontOffset.height*this._lines.length)/2}n+=this._currentMeasure.top;for(let t=0;t<this._lines.length;t++){const r=this._lines[t];0!==t&&0!==this._lineSpacing.internalValue&&(this._lineSpacing.isPixel?n+=this._lineSpacing.getValue(this._host):n+=this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height)),this._drawText(r.text,r.width,n,e),n+=this._fontOffset.height}}computeExpectedHeight(){if(this.text&&this.widthInPixels){const e=document.createElement("canvas").getContext("2d");if(e){this._applyStates(e),this._fontOffset||(this._fontOffset=o.Control._GetFontOffset(e.font));const t=this._lines?this._lines:this._breakLines(this.widthInPixels-this.paddingLeftInPixels-this.paddingRightInPixels,e);let n=this.paddingTopInPixels+this.paddingBottomInPixels+this._fontOffset.height*t.length;if(t.length>0&&0!==this._lineSpacing.internalValue){let e=0;e=this._lineSpacing.isPixel?this._lineSpacing.getValue(this._host):this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height),n+=(t.length-1)*e}return n}}return 0}dispose(){super.dispose(),this.onTextChangedObservable.clear()}}t.FormTextBlock=s},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.stopListening=t.connect=t.disconnect=t.socketSend=t.socket=void 0;const i=n(96),o=n(134),s=n(213),a=n(354),u=r(n(356)),l=n(212),c=n(239),h=n(249),f=n(211),d=n(357),p=n(367),m=n(255),y=(n(128),n(76));t.socket=null;let g,v=null,b=null,w=null;function _(e,n){g=e,g.worldName="World"+Math.round(1e3*Math.random()),t.socket=n,console.log("Username: "+i.gameSettings.nickname,"Server: "+t.socket.server);null!=s.holder&&s.holder.dispose(),t.socket.on("PlayerKick",(function(e){t.socket.close(),console.log("You has been kicked from server \nReason: "+e.reason),x(g),a.destroyGuis(),u.default(e.reason,g,_),i.updateServerSettings({ingame:!1})})),t.socket.on("LoginRequest",(function(e){i.updateServerSettings({ingame:!0}),g.camera.heading=0,g.camera.pitch=0,t.socket.send("LoginResponse",{username:i.gameSettings.nickname,protocol:i.gameProtocol,mobile:o.isMobile});let n=0;const r={};t.socket.on("PlayerEntity",(function(e){console.log("Ignoring player-entity: "+e.uuid),n=e.uuid,null!=r[e.uuid]&&null!=g&&g.ents.deleteEntity(r[e.uuid]),delete r[e.uuid]})),t.socket.on("LoginSuccess",(function(i){g.inputs.state;const o=[];f.registerBlocks(g,JSON.parse(i.blocksDef)),f.registerItems(g,JSON.parse(i.itemsDef)),c.setupPlayer(g,JSON.parse(i.inventory),JSON.parse(i.armor)),m.cloudMesh.dispose(),m.setupClouds(g),a.setupGuis(g,t.socket,i,e),d.setupAutoload(g,t.socket),g.ents.setPosition(g.playerEntity,i.xPos,i.yPos,i.zPos),t.socket.on("WorldChunkLoad",(function(e){o.push(e)})),t.socket.on("WorldChunkUnload",(function(e){if(e.type)for(let t=0;t<=8;t++)g.world.removeChunk(`${e.x}|${t}|${e.z}`);else g.world.removeChunk(`${e.x}|${e.y}|${e.z}`)})),t.socket.on("WorldBlockUpdate",(function(e){g.setBlock(e.id,e.x,e.y,e.z)})),t.socket.on("PlayerInventory",(function(e){const t=JSON.parse(e.inventory);"armor"==e.type?g.ents.getState(g.playerEntity,"inventory").armor=t:"hook"==e.type?g.ents.getState(g.playerEntity,"inventory").hook=t:(g.ents.getState(g.playerEntity,"inventory").items=t.items,g.ents.getState(g.playerEntity,"inventory").tempslot=t.tempslot)})),t.socket.on("PlayerSlotUpdate",(function(e){const t=JSON.parse(e.data),n=g.ents.getState(g.playerEntity,"inventory");"temp"==e.type?n.tempslot=t:"main"==e.type?n.items[e.slot]=t:"armor"==e.type?n.armor.items[e.slot]=t:"hook"==e.type&&(n.hook.items[e.slot]=t)})),t.socket.on("ChatMessage",(function(e){l.addMessage(e.message)})),t.socket.on("TabUpdate",(function(e){})),t.socket.on("PlayerTeleport",(function(e){g.ents.setPosition(g.playerEntity,e.x,e.y,e.z)})),t.socket.on("PlayerUpdateMovement",(function(e){g.ents.getMovement(g.playerEntity)[e.key]=e.value})),t.socket.on("PlayerUpdatePhysics",(function(e){g.ents.getPhysicsBody(g.playerEntity)[e.key]=e.value})),t.socket.on("PlayerApplyImpulse",(function(e){g.ents.getPhysicsBody(g.playerEntity).applyImpulse([e.x,e.y,e.z])})),t.socket.on("EntityCreate",(async function(e){if(n!=e.uuid){const t=JSON.parse(e.data);r[e.uuid]=g.ents.add(Object.values(t.position),1,2,null,null,!1,!0),h.applyModel(r[e.uuid],e.uuid,t.model,t.texture,t.offset,t.nametag,t.name,t.hitbox)}})),t.socket.on("EntityRemove",(function(e){null!=r[e.uuid]&&g.ents.deleteEntity(r[e.uuid]),delete r[e.uuid]})),t.socket.on("EntityMove",(function(e){if(null!=r[e.uuid]){var t=[e.x,e.y,e.z];g.ents.getState(r[e.uuid],"position").newPosition=t,g.ents.getState(r[e.uuid],"position").rotation=2*e.rotation,g.ents.getState(r[e.uuid],"position").pitch=2*e.pitch}})),t.socket.on("SoundPlay",(function(e){p.playSound(e.sound,e.volume,null!=e.x?[e.x,e.y,e.z]:null,g)}));const s=g.ents.getState(g.playerEntity,"position");setTimeout((function(){v=setInterval((async function(){0!=o.length&&(d.setChunk(o[0],g),o.shift())}),50)}),500);let u=[],_=0;w=()=>{const e=g.camera.heading,n=g.camera.pitch;JSON.stringify(u)==JSON.stringify(s.position)&&_==e&&0==n||(u=[...s.position],_=e,t.socket.send("ActionMove",{x:s.position[0],y:s.position[1],z:s.position[2],rotation:e,pitch:n}))},g.on("tick",w),b=async function(){Object.values(r).forEach((async function(e){const t=g.ents.getState(e,"position").position,n=g.ents.getState(e,"position").newPosition,r=g.ents.getState(e,g.entities.names.mesh),i=g.ents.getState(e,"model");if(null!=r&&null!=n&&null!=t){let o=y.create();y.lerp(o,t,n,.1);const s=g.ents.getState(e,"position").rotation,a=g.ents.getState(e,"position").pitch;g.ents.setPosition(e,o[0],o[1],o[2]);const u=[n[0],0,n[2]],l=[t[0],0,t[2]];null==i.x&&(i.x=0,i.y=0,i.z=!1);let c=Math.sin(i.x);if(y.distance(u,l)>.05)i.y=y.distance(u,l)/5,i.x=i.x+i.y,Math.abs(c)>.95?i.z=!0:Math.abs(c)<.05&&(i.z=!1);else{const e=parseFloat(c.toFixed(1));0==e||i.z||(i.x=i.x-.05),0!=e&&i.z&&(i.x=i.x+.05)}i.models.left_arm.rotation.x=-c,i.models.right_arm.rotation.x=c,i.models.right_leg.rotation.x=-c,i.models.left_leg.rotation.x=c;const h=r.mesh.rotation.y;r.mesh.rotation.y=s/2-h>5?s/2:(s/2+h)/2,i.models.head.rotation.x=a/2,null!=i.nametag&&(i.nametag.rotation.y=g.camera.heading-r.mesh.rotation.y,i.nametag.rotation.x=g.camera.pitch)}}))},g.on("beforeRender",b);let x=setInterval(()=>{g.world.playerChunkLoaded&&(g.ents.getPhysics(g.playerEntity).body.airDrag=-1,clearInterval(x))},1)}))}))}function x(e){null!=w&&e.off("tick",w),null!=w&&e.off("beforeRender",b),null!=v&&clearInterval(v)}t.socketSend=function(e,n){null!=t.socket&&t.socket.send(e,n)},t.disconnect=function(){t.socket.close(),x(g),a.destroyGuis(),i.updateServerSettings({ingame:!1}),s.buildMainMenu(g,_)},t.connect=_,t.stopListening=x},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.createCheckbox=t.createSlider=t.createInput=t.createItem=void 0;const s=n(81),a=n(169),u=o(n(97));t.createItem=function(){const e=new u.Rectangle;e.width=100*s.scale+"px",e.height=18*s.scale+"px",e.isPointerBlocker=!0,e.horizontalAlignment=2,e.thickness=0,e.paddingBottom="10px",e.zIndex=10;const t=new a.FormTextBlock;return t.text=[{text:"MenuItemText",color:"white",font:"Lato"}],t.fontSize=10*s.scale,t.textHorizontalAlignment=2,e.addControl(t),e.onPointerEnterObservable.add(e=>{t.text.forEach(e=>e.underline=!0),t._markAsDirty()}),e.onPointerOutObservable.add(e=>{t.text.forEach(e=>e.underline=!1),t._markAsDirty()}),{item:e,text:t}},t.createInput=function(){const e=new u.Rectangle;e.height=28*s.scale+"px",e.adaptWidthToChildren=!0,e.thickness=0;const t=new u.TextBlock;t.fontFamily="Lato",t.fontSize=9*s.scale,t.textVerticalAlignment=0,t.color="white",t.text="Input",t.top=s.scale,t.verticalAlignment=0,e.addControl(t);const n=new u.InputText;n.thickness=0,n.background="#ffffffaa",n.focusedBackground="#ffffffff",n.placeholderText="Placeholder",n.color="#666666",n.verticalAlignment=0,n.height=15*s.scale+"px",n.width=100*s.scale+"px",n.top=14*s.scale+"px",e.addControl(n);const r=r=>{e.height=28*s.scale+"px",t.fontSize=9*s.scale,n.height=15*s.scale+"px",n.width=100*s.scale+"px",n.top=14*s.scale+"px"};return s.event.on("scale-change",r),e.onDisposeObservable.add(()=>{s.event.off("scale-change",r)}),{main:e,name:t,input:n}},t.createSlider=function(){const e=new u.Rectangle;e.height=28*s.scale+"px",e.adaptWidthToChildren=!0,e.thickness=0;const t=new u.TextBlock;t.fontFamily="Lato",t.fontSize=9*s.scale,t.textVerticalAlignment=0,t.color="white",t.text="Slider",t.top=s.scale,t.verticalAlignment=0,e.addControl(t);const n=new u.Slider;n.minimum=0,n.maximum=100,n.value=0,n.height=13*s.scale+"px",n.width=100*s.scale+"px",n.top=14*s.scale+"px",n.verticalAlignment=0,n.color="#666666",n.thumbColor="#888888",n.background="#ffffffaa",n.borderColor="#00000000",n.barOffset=6,e.addControl(n);const r=r=>{e.height=28*s.scale+"px",t.fontSize=9*s.scale,n.height=10*s.scale+"px",n.width=100*s.scale+"px",n.top=14*s.scale+"px"};return s.event.on("scale-change",r),e.onDisposeObservable.add(()=>{s.event.off("scale-change",r)}),{main:e,name:t,slider:n}},t.createCheckbox=function(){const e=new u.Rectangle;e.height=28*s.scale+"px",e.adaptWidthToChildren=!0,e.isPointerBlocker=!0,e.thickness=0;const t=new u.TextBlock;t.fontFamily="Lato",t.fontSize=9*s.scale,t.textVerticalAlignment=0,t.color="white",t.text="Checkbox",t.top=s.scale,t.verticalAlignment=0,t.width=100*s.scale+"px",e.addControl(t);const n=n=>{e.height=28*s.scale+"px",t.fontSize=9*s.scale,t.width=100*s.scale+"px"};return s.event.on("scale-change",n),e.onDisposeObservable.add(()=>{s.event.off("scale-change",n)}),{main:e,name:t,isChecked:!1}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){e.exports=i;var r=n(76);function i(e,t){if(!(this instanceof i))return new i(e,t);var n=r.create();r.add(n,e,t),this.base=r.min(r.create(),e,n),this.vec=r.clone(t),this.max=r.max(r.create(),e,n),this.mag=r.length(this.vec)}var o=i.prototype;o.width=function(){return this.vec[0]},o.height=function(){return this.vec[1]},o.depth=function(){return this.vec[2]},o.x0=function(){return this.base[0]},o.y0=function(){return this.base[1]},o.z0=function(){return this.base[2]},o.x1=function(){return this.max[0]},o.y1=function(){return this.max[1]},o.z1=function(){return this.max[2]},o.translate=function(e){return r.add(this.max,this.max,e),r.add(this.base,this.base,e),this},o.setPosition=function(e){return r.add(this.max,e,this.vec),r.copy(this.base,e),this},o.expand=function(e){var t=r.create(),n=r.create();return r.max(t,e.max,this.max),r.min(n,e.base,this.base),r.subtract(t,t,n),new i(n,t)},o.intersects=function(e){return!(e.base[0]>this.max[0])&&(!(e.base[1]>this.max[1])&&(!(e.base[2]>this.max[2])&&(!(e.max[0]<this.base[0])&&(!(e.max[1]<this.base[1])&&!(e.max[2]<this.base[2])))))},o.touches=function(e){var t=this.union(e);return null!==t&&(0==t.width()||0==t.height()||0==t.depth())},o.union=function(e){if(!this.intersects(e))return null;var t=Math.max(e.base[0],this.base[0]),n=Math.max(e.base[1],this.base[1]),r=Math.max(e.base[2],this.base[2]);return new i([t,n,r],[Math.min(e.max[0],this.max[0])-t,Math.min(e.max[1],this.max[1])-n,Math.min(e.max[2],this.max[2])-r])}},function(e,t,n){"use strict";(function(e){var r=n(210),i=n(315),o=n(316).Buffer;e.__TYPEDARRAY_POOL||(e.__TYPEDARRAY_POOL={UINT8:i([32,0]),UINT16:i([32,0]),UINT32:i([32,0]),BIGUINT64:i([32,0]),INT8:i([32,0]),INT16:i([32,0]),INT32:i([32,0]),BIGINT64:i([32,0]),FLOAT:i([32,0]),DOUBLE:i([32,0]),DATA:i([32,0]),UINT8C:i([32,0]),BUFFER:i([32,0])});var s="undefined"!=typeof Uint8ClampedArray,a="undefined"!=typeof BigUint64Array,u="undefined"!=typeof BigInt64Array,l=e.__TYPEDARRAY_POOL;l.UINT8C||(l.UINT8C=i([32,0])),l.BIGUINT64||(l.BIGUINT64=i([32,0])),l.BIGINT64||(l.BIGINT64=i([32,0])),l.BUFFER||(l.BUFFER=i([32,0]));var c=l.DATA,h=l.BUFFER;function f(e){if(e){var t=e.length||e.byteLength,n=r.log2(t);c[n].push(e)}}function d(e){e=r.nextPow2(e);var t=r.log2(e),n=c[t];return n.length>0?n.pop():new ArrayBuffer(e)}function p(e){return new Uint8Array(d(e),0,e)}function m(e){return new Uint16Array(d(2*e),0,e)}function y(e){return new Uint32Array(d(4*e),0,e)}function g(e){return new Int8Array(d(e),0,e)}function v(e){return new Int16Array(d(2*e),0,e)}function b(e){return new Int32Array(d(4*e),0,e)}function w(e){return new Float32Array(d(4*e),0,e)}function _(e){return new Float64Array(d(8*e),0,e)}function x(e){return s?new Uint8ClampedArray(d(e),0,e):p(e)}function k(e){return a?new BigUint64Array(d(8*e),0,e):null}function O(e){return u?new BigInt64Array(d(8*e),0,e):null}function P(e){return new DataView(d(e),0,e)}function S(e){e=r.nextPow2(e);var t=r.log2(e),n=h[t];return n.length>0?n.pop():new o(e)}t.free=function(e){if(o.isBuffer(e))h[r.log2(e.length)].push(e);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(e)&&(e=e.buffer),!e)return;var t=e.length||e.byteLength,n=0|r.log2(t);c[n].push(e)}},t.freeUint8=t.freeUint16=t.freeUint32=t.freeBigUint64=t.freeInt8=t.freeInt16=t.freeInt32=t.freeBigInt64=t.freeFloat32=t.freeFloat=t.freeFloat64=t.freeDouble=t.freeUint8Clamped=t.freeDataView=function(e){f(e.buffer)},t.freeArrayBuffer=f,t.freeBuffer=function(e){h[r.log2(e.length)].push(e)},t.malloc=function(e,t){if(void 0===t||"arraybuffer"===t)return d(e);switch(t){case"uint8":return p(e);case"uint16":return m(e);case"uint32":return y(e);case"int8":return g(e);case"int16":return v(e);case"int32":return b(e);case"float":case"float32":return w(e);case"double":case"float64":return _(e);case"uint8_clamped":return x(e);case"bigint64":return O(e);case"biguint64":return k(e);case"buffer":return S(e);case"data":case"dataview":return P(e);default:return null}return null},t.mallocArrayBuffer=d,t.mallocUint8=p,t.mallocUint16=m,t.mallocUint32=y,t.mallocInt8=g,t.mallocInt16=v,t.mallocInt32=b,t.mallocFloat32=t.mallocFloat=w,t.mallocFloat64=t.mallocDouble=_,t.mallocUint8Clamped=x,t.mallocBigUint64=k,t.mallocBigInt64=O,t.mallocDataView=P,t.mallocBuffer=S,t.clearCache=function(){for(var e=0;e<32;++e)l.UINT8[e].length=0,l.UINT16[e].length=0,l.UINT32[e].length=0,l.INT8[e].length=0,l.INT16[e].length=0,l.INT32[e].length=0,l.FLOAT[e].length=0,l.DOUBLE[e].length=0,l.BIGUINT64[e].length=0,l.BIGINT64[e].length=0,l.UINT8C[e].length=0,c[e].length=0,h[e].length=0}}).call(this,n(150))},function(e,t,n){"use strict";function r(e){var t=32;return(e&=-e)&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t}t.INT_BITS=32,t.INT_MAX=2147483647,t.INT_MIN=-1<<31,t.sign=function(e){return(e>0)-(e<0)},t.abs=function(e){var t=e>>31;return(e^t)-t},t.min=function(e,t){return t^(e^t)&-(e<t)},t.max=function(e,t){return e^(e^t)&-(e<t)},t.isPow2=function(e){return!(e&e-1||!e)},t.log2=function(e){var t,n;return t=(e>65535)<<4,t|=n=((e>>>=t)>255)<<3,t|=n=((e>>>=n)>15)<<2,(t|=n=((e>>>=n)>3)<<1)|(e>>>=n)>>1},t.log10=function(e){return e>=1e9?9:e>=1e8?8:e>=1e7?7:e>=1e6?6:e>=1e5?5:e>=1e4?4:e>=1e3?3:e>=100?2:e>=10?1:0},t.popCount=function(e){return 16843009*((e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)>>>24},t.countTrailingZeros=r,t.nextPow2=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)+1},t.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)-(e>>>1)},t.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,27030>>>(e&=15)&1};var i=new Array(256);!function(e){for(var t=0;t<256;++t){var n=t,r=t,i=7;for(n>>>=1;n;n>>>=1)r<<=1,r|=1&n,--i;e[t]=r<<i&255}}(i),t.reverse=function(e){return i[255&e]<<24|i[e>>>8&255]<<16|i[e>>>16&255]<<8|i[e>>>24&255]},t.interleave2=function(e,t){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e&=65535)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))<<1},t.deinterleave2=function(e,t){return(e=65535&((e=16711935&((e=252645135&((e=858993459&((e=e>>>t&1431655765)|e>>>1))|e>>>2))|e>>>4))|e>>>16))<<16>>16},t.interleave3=function(e,t,n){return e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2),(e|=(t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2))<<1)|(n=1227133513&((n=3272356035&((n=251719695&((n=4278190335&((n&=1023)|n<<16))|n<<8))|n<<4))|n<<2))<<2},t.deinterleave3=function(e,t){return(e=1023&((e=4278190335&((e=251719695&((e=3272356035&((e=e>>>t&1227133513)|e>>>2))|e>>>4))|e>>>8))|e>>>16))<<22>>22},t.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>r(e)+1}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.registerItems=t.registerBlocks=t.blockIDmap=t.blockIDs=t.items=t.blocks=void 0;const s=n(96),a=o(n(139));t.blocks={},t.items={},t.blockIDs={},t.blockIDmap={},t.registerBlocks=function(e,n){const r=e.rendering.getScene();t.blocks=n,Object.values(n).forEach(e=>{t.blockIDs[e.id]=e.rawid,t.blockIDmap[e.rawid]=e.id}),e.registry.registerMaterial("water",[.5,.5,.8,.7],null,!0),e.registry.registerMaterial("barrier",[0,0,0,0],null,!0),console.log("Blocks: ",t.blockIDs),Object.values(n).forEach((function(t){!function(t,n,i,o,u,l,c,h){if(0==i){let r,i=!1;if(0==u.opaque&&(i=!0),1==o.length&&null==u.material)(o[0].startsWith("http://")||o[0].startsWith("https://"))&&1==s.gameSettings.allowcustom?e.registry.registerMaterial(n,[0,0,0],o[0],i):e.registry.registerMaterial(n,[0,0,0],"textures/"+o[0]+".png",i),r=n;else if(null==u.material){r=new Array;for(let t=0;t<o.length;t++)(o[t].startsWith("http://")||o[t].startsWith("https://"))&&1==s.gameSettings.allowcustom?e.registry.registerMaterial(n+t,[0,0,0],o[t],i):e.registry.registerMaterial(n+t,[0,0,0],"textures/"+o[t]+".png",i),r.push(n+t)}else r=u.material;const a=u;a.material=r,e.registry.registerBlock(t,a)}else if(1==i){const i=function(e,t,n,r){const i=r||"sprite-mat";let o;o=(n.startsWith("http://")||n.startsWith("https://"))&&1==s.gameSettings.allowcustom?new a.Texture(n,t,!0,!0,a.Texture.NEAREST_SAMPLINGMODE):new a.Texture("textures/"+n+".png",t,!0,!0,a.Texture.NEAREST_SAMPLINGMODE);o.hasAlpha=!0;const u=a.Mesh.CreatePlane("sprite-"+i,1,t),l=e.rendering.makeStandardMaterial(i);l.backFaceCulling=!1,l.diffuseTexture=o,l.diffuseTexture.vOffset=.99,u.material=l,u.rotation.y+=.81;const c=a.Matrix.Translation(0,.5,0);u.bakeTransformIntoVertices(c);const h=u.clone();return h.rotation.y+=1.62,a.Mesh.MergeMeshes([u,h],!0)}(e,r,o[0],n),l=u;l.blockMesh=i,e.registry.registerBlock(t,l)}else if(2==i){const i=function(e,t,n,r){const i={},o={};for(let u=0;u<6;u++){let l,c=r+"-"+u||"sprite-mat";switch(i[u]=a.Mesh.CreatePlane("sprite-"+c,1,t),o[u]=e.rendering.makeStandardMaterial(c+u),o[u].backFaceCulling=!1,((u<4?n[1]:n[0]).startsWith("http://")||(u<4?n[1]:n[0]).startsWith("https://"))&&1==s.gameSettings.allowcustom?o[u].diffuseTexture=new a.Texture(u<4?n[1]:n[0],t,!0,!0,a.Texture.NEAREST_SAMPLINGMODE):o[u].diffuseTexture=new a.Texture("textures/"+(u<4?n[1]:n[0])+".png",t,!0,!0,a.Texture.NEAREST_SAMPLINGMODE),o[u].diffuseTexture.hasAlpha=!0,i[u].material=o[u],u){case 0:l=a.Matrix.Translation(0,.5,.435),i[u].rotation.y=1.57;break;case 1:l=a.Matrix.Translation(0,.5,-.435),i[u].rotation.y=1.57;break;case 2:l=a.Matrix.Translation(0,.5,.435);break;case 3:l=a.Matrix.Translation(0,.5,-.435);break;case 4:l=a.Matrix.Translation(0,0,-1),i[u].rotation.x=1.57;break;case 5:l=a.Matrix.Translation(0,0,0),i[u].rotation.x=1.57}i[u].bakeTransformIntoVertices(l)}return a.Mesh.MergeMeshes(Object.values(i),!0,!0,void 0,!1,!1)}(e,r,[o[0],o[1]],n),l=u;l.blockMesh=i,e.registry.registerBlock(t,l)}else if(4==i){const i=e.rendering.makeStandardMaterial(n);let l;l=(o[0].startsWith("http://")||o[0].startsWith("https://"))&&1==s.gameSettings.allowcustom?new a.Texture(o[0],r,!0,!0,a.Texture.NEAREST_SAMPLINGMODE):new a.Texture("textures/"+o[0]+".png",r,!0,!0,a.Texture.NEAREST_SAMPLINGMODE),i.diffuseTexture=l,i.opacityTexture=i.diffuseTexture,i.backFaceCulling=!0;const c=a.MeshBuilder.CreateBox(n,{size:1},e.rendering.getScene());c.material=i,c.bakeTransformIntoVertices(a.Matrix.Scaling(1,1,1).setTranslation(new a.Vector3(0,.5,0))),c.opaque=!1,c.material.needDepthPrePass=!0;const h=u;h.blockMesh=c,e.registry.registerBlock(t,h)}}(t.rawid,t.id,t.type,t.texture,t.options,t.hardness,t.miningtime,t.tool)}))},t.registerItems=function(e,n){t.items=n,console.log("Items: ",n)}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.addMessage=t.setupChat=t.changeState=t.messages=t.chatContainer=t.input=void 0;const s=n(134),a=n(81),u=n(169),l=o(n(97));t.messages=[];let c=0,h=!1;function f(){c=0,t.messages.forEach(e=>{!h&&e.isVisible&&c>200*a.scale?(e.shouldhide=!0,e.isVisible=!1):e.isVisible&&(c+=e.heightInPixels)}),0!=c?(t.chatContainer.height=c+5+"px",t.chatContainer.isVisible=!0):t.chatContainer.isVisible&&(t.chatContainer.isVisible=!1)}t.changeState=function(e){h=e},t.setupChat=function(){const e=a.getScreen(1);t.input=new l.InputText,t.input.width=100,t.input.horizontalAlignment=0,t.input.verticalAlignment=1,t.input.zIndex=10,t.input.height="36px",t.input.color="white",t.input.background="#111111aa",t.input.focusedBackground="#111111bb",t.input.thickness=0,t.input.isVisible=!1,t.input.shadowColor="",t.input.fontSize="32",t.input.promptMessage="Enter chat message",e.addControl(t.input),t.chatContainer=new l.StackPanel,s.isMobile?(t.chatContainer.verticalAlignment=0,t.chatContainer.horizontalAlignment=1,t.chatContainer.width=140*a.scale+"px"):(t.chatContainer.verticalAlignment=1,t.chatContainer.horizontalAlignment=0,t.chatContainer.top=-26*a.scale+"px",t.chatContainer.width=176*a.scale+"px"),t.chatContainer.name="textContainer",t.chatContainer.useBitmapCache=!0,t.chatContainer.zIndex=10,t.chatContainer.background="#11111177",t.chatContainer.height=130*a.scale+"px",e.addControl(t.chatContainer);const n=e=>{s.isMobile?t.chatContainer.width=140*a.scale+"px":(t.chatContainer.top=-26*e+"px",t.chatContainer.width=176*e+"px"),t.messages.forEach(t=>{t.fontSize=8*e,t.paddingLeft=2*e+"px",s.isMobile?t.width=140*e+"px":t.width=176*e+"px",t.height=t.computeExpectedHeight()+"px"}),f()};a.event.on("scale-change",n);const r=setInterval(async()=>{if(h){let e=0;t.messages.forEach(t=>{t.shouldhide&&!t.isVisible&&(t.isVisible=!0,e+=1)}),0!=e&&f()}else{let e=0;t.messages.forEach(t=>{t.shouldhide&&t.isVisible&&(t.isVisible=!1),e+=1}),0!=e&&f()}},100);t.chatContainer.onDisposeObservable.add(()=>{clearInterval(r),t.messages.forEach(e=>e.dispose()),t.messages=[],c=0,a.event.off("scale-change",n)})},t.addMessage=async function(e){const n=Object.values(e);let r="";n.forEach(e=>{r+=e.text});const i=new u.FormTextBlock;for(i.fontSize=8*a.scale,i.paddingLeft=2*a.scale+"px",i.textVerticalAlignment=1,i.textHorizontalAlignment=0,i.fontFamily="Lato",s.isMobile?i.width=140*a.scale+"px":i.width=176*a.scale+"px",i.text=n,i.height=i.computeExpectedHeight()+"px",i.useBitmapCache=!0,t.messages.unshift(i),t.chatContainer.addControl(i);t.messages.length>50;)t.messages[t.messages.length-1].dispose(),t.messages.pop();setInterval(async()=>{i.shouldhide=!0,h||(i.isVisible=!1),f()},8e3),f(),console.log("Chat: "+r)}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.buildMainMenu=t.holder=void 0;const a=n(81),u=o(n(97)),l=s(n(334)),c=s(n(247)),h=n(96),f=n(171);t.buildMainMenu=function(e,n){const r=a.getScreen(1);let i,o;t.holder=new u.Rectangle,t.holder.thickness=0,t.holder.isPointerBlocker=!0,t.holder.zIndex=5,r.addControl(t.holder);const s=new u.TextBlock;function d(n){switch(i&&i.dispose(),n){case"multiplayer":i=l.default(e,d),o="multiplayer";break;case"settings":i=c.default(e,d),o="settings";break;default:i=function(){const e=new u.Rectangle;e.thickness=0,e.horizontalAlignment=2,e.zIndex=10,window.innerHeight>230*a.scale?e.height=230*a.scale+"px":e.height="100%";e.width=220*a.scale+"px",e.background="#11111166";const n=new u.Image("hotbar","./textures/mainlogo.png");n.width=210*a.scale+"px",n.height=64*a.scale+"px",n.verticalAlignment=0,n.horizontalAlignment=2,n.top="5px",t.holder.zIndex=15,e.addControl(n);const r=new u.StackPanel;r.zIndex=20,e.addControl(r);const i=f.createItem();i.text.text=[{text:"Multiplayer",color:"white",font:"Lato"}],i.item.onPointerClickObservable.add(e=>{d("multiplayer")}),r.addControl(i.item);const o=f.createItem();o.text.text=[{text:"Settings",color:"white",font:"Lato"}],o.item.onPointerClickObservable.add(e=>{d("settings")}),r.addControl(o.item);const s=f.createItem();s.text.text=[{text:"Discord",color:"white",font:"Lato"}],s.item.onPointerClickObservable.add(e=>{window.open("https://discord.com/invite/K9PdsDh","_blank")}),r.addControl(s.item);const l=f.createItem();l.text.text=[{text:"Github",color:"white",font:"Lato"}],l.item.onPointerClickObservable.add(e=>{window.open("https://github.com/VoxelSrv/voxelsrv","_blank")}),r.addControl(l.item);const c=t=>{window.innerHeight>230*a.scale?e.height=230*a.scale+"px":e.height="100%",e.width=220*a.scale+"px",n.width=210*a.scale+"px",n.height=64*a.scale+"px",r._children.forEach(e=>{e.width=100*a.scale+"px",e.height=18*a.scale+"px",e._children[0].fontSize=10*a.scale})};return a.event.on("scale-change",c),e.onDisposeObservable.add(()=>{a.event.off("scale-change",c)}),e}(),o="main"}t.holder.addControl(i)}s.text="VoxelSRV "+h.gameVersion,s.fontFamily="Lato",s.fontSize="26px",s.color="white",s.textHorizontalAlignment=0,s.textVerticalAlignment=1,s.left="5px",s.top="-5px",s.shadowColor="#111111",s.shadowOffsetX=1,s.shadowOffsetY=1,t.holder.addControl(s),d("main")}},function(e,t,n){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(e,t,n){"use strict";n.r(t),n.d(t,"updatePositionExtents",(function(){return i}));var r=n(76);function i(e){var t=e.width/2,n=e._localPosition,r=e._extents;r[0]=n[0]-t,r[1]=n[1],r[2]=n[2]-t,r[3]=n[0]+t,r[4]=n[1]+e.height,r[5]=n[2]+t}t.default=function(e){return{name:"position",order:60,state:{position:null,width:1,height:1,_localPosition:null,_renderPosition:null,_extents:null},onAdd:function(t,n){var o=[0,0,0];n.position&&r.copy(o,n.position),n.position=o,n._localPosition=r.create(),n._renderPosition=r.create(),n._extents=new Float32Array(6),e.globalToLocal(n.position,null,n._localPosition),r.copy(n._renderPosition,n._localPosition),i(n)},onRemove:null,system:function(t,n){var o=e.worldOriginOffset;n.forEach(e=>{r.add(e.position,e._localPosition,o),i(e)})}}}},function(e,t,n){"use strict";n.r(t),n.d(t,"setPhysicsFromPosition",(function(){return o}));var r=n(76);t.default=function(e){return{name:"physics",order:40,state:{body:null},onAdd:function(t,n){n.body=e.physics.addBody(),o(n,e.ents.getPositionData(n.__id))},onRemove:function(t,n){if(e.ents.hasPosition(n.__id)){var r=e.ents.getPositionData(n.__id);s(n,r),a(n,r,0,!1)}e.physics.removeBody(n.body)},system:function(t,n){n.forEach(t=>{s(t,e.ents.getPositionData(t.__id))})},renderSystem:function(t,n){var r=(e.positionInCurrentTick*e._tickRate-e._tickRate)/1e3;n.forEach(t=>{var n=t.__id,i=e.ents.getPositionData(n),o=e.ents.cameraSmoothed(n);a(t,i,r,o)})}}};var i=r.create();function o(e,t){var n=e.body.aabb,i=t._extents;r.copy(n.base,i),r.set(n.vec,t.width,t.height,t.width),r.add(n.max,n.base,n.vec)}function s(e,t){var n=e.body.aabb.base,i=t.width/2;r.set(t._localPosition,n[0]+i,n[1],n[2]+i)}function a(e,t,n,o){var s=e.body.velocity;r.scaleAndAdd(i,t._localPosition,s,n),o&&r.lerp(i,t._renderPosition,i,.3),r.copy(t._renderPosition,i)}},function(e,t){e.exports=1e-6},function(e,t){e.exports=function(){var e=new Float32Array(3);return e[0]=0,e[1]=0,e[2]=0,e}},function(e,t){e.exports=function(e,t,n){var r=new Float32Array(3);return r[0]=e,r[1]=t,r[2]=n,r}},function(e,t){e.exports=function(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o);return e}},function(e,t){e.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}},function(e,t){e.exports=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)}},function(e,t){e.exports=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i}},function(e,t){e.exports=function(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)}},function(e,t){e.exports=function(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}},function(e,t,n){"use strict";e.exports=function(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=n;return t}},,,,,,,function(e,t,n){"use strict";var r=[],i=[],o=[],s=[],a=[],u=[],l=[],c=[],h=[],f=[],d=[],p=[];e.exports=function(e,t,n,m,y,g){for(var v=l,b=h,w=f,_=p,x=0;x<3;x++)v[x]=+n[x],w[x]=+t.max[x],b[x]=+t.base[x];g||(g=1e-10);var k=function(e,t,n,l,h,f){var p=r,m=i,y=o,g=s,v=a,b=u,w=c,_=Math.floor,x=0,k=0,O=0,P=0,S=0;if(C(),0===O)return 0;for(P=A();k<=O;){if(j(P))if(E())return x;P=A()}for(x+=O,S=0;S<3;S++)l[S]+=n[S],h[S]+=n[S];return x;function C(){if(k=0,0!==(O=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2])))for(var e=0;e<3;e++){var t=n[e]>=0;g[e]=t?1:-1;var r=t?h[e]:l[e];p[e]=t?l[e]:h[e],m[e]=M(r,g[e]),y[e]=T(p[e],g[e]),w[e]=n[e]/O,v[e]=Math.abs(1/w[e]);var i=t?m[e]+1-r:r-m[e];b[e]=v[e]<1/0?v[e]*i:1/0}}function j(t){for(var n=g[0],r=0===t?m[0]:y[0],i=m[0]+n,o=g[1],s=1===t?m[1]:y[1],a=m[1]+o,u=g[2],l=2===t?m[2]:y[2],c=m[2]+u,h=r;h!=i;h+=n)for(var f=s;f!=a;f+=o)for(var d=l;d!=c;d+=u)if(e(h,f,d))return!0;return!1}function E(){x+=k;var e=g[P],r=k/O,i=d;for(S=0;S<3;S++){var o=n[S]*r;l[S]+=o,h[S]+=o,i[S]=n[S]-o}if(e>0?h[P]=Math.round(h[P]):l[P]=Math.round(l[P]),t(x,P,e,i))return!0;for(S=0;S<3;S++)n[S]=i[S];return C(),0===O}function A(){var e=b[0]<b[1]?b[0]<b[2]?0:2:b[1]<b[2]?1:2,t=b[e]-k;for(k=b[e],m[e]+=g[e],b[e]+=v[e],S=0;S<3;S++)p[S]+=t*w[S],y[S]=T(p[S],g[S]);return e}function M(e,t){return _(e-t*f)}function T(e,t){return _(e+t*f)}}(e,m,v,b,w,g);if(!y){for(x=0;x<3;x++)_[x]=n[x]>0?w[x]-t.max[x]:b[x]-t.base[x];t.translate(_)}return k}},function(e,t,n){"use strict";e.exports={init:function(e){var t=i.nextPow2(e);s.length<t&&(r.free(s),s=r.mallocInt32(t));a.length<t&&(r.free(a),a=r.mallocInt32(t));u.length<t&&(r.free(u),u=r.mallocInt32(t));l.length<t&&(r.free(l),l=r.mallocInt32(t));c.length<t&&(r.free(c),c=r.mallocInt32(t));h.length<t&&(r.free(h),h=r.mallocInt32(t));var n=8*t;f.length<n&&(r.free(f),f=r.mallocDouble(n))},sweepBipartite:function(e,t,n,r,i,c,h,m,y,g){for(var v=0,b=2*e,w=e-1,_=b-1,x=n;x<r;++x){var k=c[x],O=b*x;f[v++]=i[O+w],f[v++]=-(k+1),f[v++]=i[O+_],f[v++]=k}for(x=h;x<m;++x){k=g[x]+(1<<28);var P=b*x;f[v++]=y[P+w],f[v++]=-k,f[v++]=y[P+_],f[v++]=k}var S=v>>>1;o(f,S);var C=0,j=0;for(x=0;x<S;++x){var E=0|f[2*x+1];if(E>=1<<28)d(u,l,j--,E=E-(1<<28)|0);else if(E>=0)d(s,a,C--,E);else if(E<=-(1<<28)){E=-E-(1<<28)|0;for(var A=0;A<C;++A){if(void 0!==(M=t(s[A],E)))return M}p(u,l,j++,E)}else{E=-E-1|0;for(A=0;A<j;++A){var M;if(void 0!==(M=t(E,u[A])))return M}p(s,a,C++,E)}}},sweepComplete:function(e,t,n,r,i,m,y,g,v,b){for(var w=0,_=2*e,x=e-1,k=_-1,O=n;O<r;++O){var P=m[O]+1<<1,S=_*O;f[w++]=i[S+x],f[w++]=-P,f[w++]=i[S+k],f[w++]=P}for(O=y;O<g;++O){P=b[O]+1<<1;var C=_*O;f[w++]=v[C+x],f[w++]=1|-P,f[w++]=v[C+k],f[w++]=1|P}var j=w>>>1;o(f,j);var E=0,A=0,M=0;for(O=0;O<j;++O){var T=0|f[2*O+1],I=1&T;if(O<j-1&&T>>1==f[2*O+3]>>1&&(I=2,O+=1),T<0){for(var D=-(T>>1)-1,z=0;z<M;++z){if(void 0!==(B=t(c[z],D)))return B}if(0!==I)for(z=0;z<E;++z){if(void 0!==(B=t(s[z],D)))return B}if(1!==I)for(z=0;z<A;++z){var B;if(void 0!==(B=t(u[z],D)))return B}0===I?p(s,a,E++,D):1===I?p(u,l,A++,D):2===I&&p(c,h,M++,D)}else{D=(T>>1)-1;0===I?d(s,a,E--,D):1===I?d(u,l,A--,D):2===I&&d(c,h,M--,D)}}},scanBipartite:function(e,t,n,r,i,u,l,c,h,m,y,g){var v=0,b=2*e,w=t,_=t+e,x=1,k=1;r?k=1<<28:x=1<<28;for(var O=i;O<u;++O){var P=O+x,S=b*O;f[v++]=l[S+w],f[v++]=-P,f[v++]=l[S+_],f[v++]=P}for(O=h;O<m;++O){P=O+k;var C=b*O;f[v++]=y[C+w],f[v++]=-P}var j=v>>>1;o(f,j);var E=0;for(O=0;O<j;++O){var A=0|f[2*O+1];if(A<0){var M=!1;if((P=-A)>=1<<28?(M=!r,P-=1<<28):(M=!!r,P-=1),M)p(s,a,E++,P);else{var T=g[P],I=b*P,D=y[I+t+1],z=y[I+t+1+e];e:for(var B=0;B<E;++B){var L=s[B],R=b*L;if(!(z<l[R+t+1]||l[R+t+1+e]<D)){for(var N=t+2;N<e;++N)if(y[I+N+e]<l[R+N]||l[R+N+e]<y[I+N])continue e;var F,U=c[L];if(void 0!==(F=r?n(T,U):n(U,T)))return F}}}}else d(s,a,E--,A-x)}},scanComplete:function(e,t,n,r,i,a,u,l,c,h,d){for(var p=0,m=2*e,y=t,g=t+e,v=r;v<i;++v){var b=v+(1<<28),w=m*v;f[p++]=a[w+y],f[p++]=-b,f[p++]=a[w+g],f[p++]=b}for(v=l;v<c;++v){b=v+1;var _=m*v;f[p++]=h[_+y],f[p++]=-b}var x=p>>>1;o(f,x);var k=0;for(v=0;v<x;++v){var O=0|f[2*v+1];if(O<0){if((b=-O)>=1<<28)s[k++]=b-(1<<28);else{var P=d[b-=1],S=m*b,C=h[S+t+1],j=h[S+t+1+e];e:for(var E=0;E<k;++E){var A=s[E],M=u[A];if(M===P)break;var T=m*A;if(!(j<a[T+t+1]||a[T+t+1+e]<C)){for(var I=t+2;I<e;++I)if(h[S+I+e]<a[T+I]||a[T+I+e]<h[S+I])continue e;var D=n(M,P);if(void 0!==D)return D}}}}else{for(b=O-(1<<28),E=k-1;E>=0;--E)if(s[E]===b){for(I=E+1;I<k;++I)s[I-1]=s[I];break}--k}}}};var r=n(209),i=n(210),o=n(320),s=r.mallocInt32(1024),a=r.mallocInt32(1024),u=r.mallocInt32(1024),l=r.mallocInt32(1024),c=r.mallocInt32(1024),h=r.mallocInt32(1024),f=r.mallocDouble(8192);function d(e,t,n,r){var i=t[r],o=e[n-1];e[i]=o,t[o]=i}function p(e,t,n,r){e[n]=r,t[r]=n}},function(e,t,n){"use strict";e.exports=function(e,t){var n="abcdef".split("").concat(t),r=[];e.indexOf("lo")>=0&&r.push("lo=e[k+n]");e.indexOf("hi")>=0&&r.push("hi=e[k+o]");return n.push("for(var j=2*a,k=j*c,l=k,m=c,n=b,o=a+b,p=c;d>p;++p,k+=j){var _;if($)if(m===p)m+=1,l+=j;else{for(var s=0;j>s;++s){var t=e[k+s];e[k+s]=e[l],e[l++]=t}var u=f[p];f[p]=f[m],f[m++]=u}}return m".replace("_",r.join()).replace("$",e)),Function.apply(void 0,n)}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.setupPlayer=t.setupControls=void 0;const s=o(n(139)),a=n(134),u=n(96),l=n(211),c=n(242),h=n(212),f=n(170),d=n(81),p=n(248),m=n(368);t.setupControls=function(e){const t=e.playerEntity,n=e.rendering.getScene(),r=d.getUI(1);function i(){console.log("Casted");let t=n.createPickingRay(window.innerWidth/2,window.innerHeight/2,s.Matrix.Identity(),e.rendering.getScene().activeCameras[0]);const r=n.pickWithRay(t,e=>e.name.startsWith("hitbox-"),!0);return r.pickedMesh?[r.pickedMesh.name.substring(7),r.distance]:null}e.container.canvas.requestPointerLock(),e.container.canvas.addEventListener("click",()=>{u.serverSettings.ingame&&(c.inventory.isVisible||h.input.isVisible||p.pauseScreen.isVisible||(e.container.canvas.requestPointerLock(),h.input.isVisible=!1,h.input.text=""))}),e.blockTargetIdCheck=function(e){return null!=l.blockIDmap[e]&&0!=e&&1!=l.blocks[l.blockIDmap[e]].options.fluid},e.inputs.down.on("fire",(async function(){if(!u.serverSettings.ingame)return;if(e.targetedBlock){const t=e.targetedBlock.position;return f.socketSend("ActionClick",{type:"left",x:t[0],y:t[1],z:t[2],onBlock:!0}),void f.socketSend("ActionBlockBreak",{x:t[0],y:t[1],z:t[2]})}f.socketSend("ActionClick",{type:"left",x:0,y:0,z:0,onBlock:!1});const t=i();t&&f.socketSend("ActionClickEntity",{type:"left",uuid:t[0],distance:t[1]})})),e.inputs.up.on("fire",(function(){u.serverSettings.ingame})),e.inputs.down.on("alt-fire",(function(){if(!u.serverSettings.ingame)return;if(null!=e.targetedBlock){const t=e.targetedBlock.adjacent,n=e.targetedBlock.position;return f.socketSend("ActionClick",{type:"right",x:n[0],y:n[1],z:n[2],onBlock:!0}),void(0==e.ents.isTerrainBlocked(t[0],t[1],t[2])&&f.socketSend("ActionBlockPlace",{x:t[0],y:t[1],z:t[2],x2:n[0],y2:n[1],z2:n[2]}))}f.socketSend("ActionClick",{type:"right",x:0,y:0,z:0,onBlock:!1});const t=i();t&&f.socketSend("ActionClickEntity",{type:"right",uuid:t[0],distance:t[1]})})),e.inputs.down.on("mid-fire",(function(){if(u.serverSettings.ingame&&e.targetedBlock&&0!=e.targetedBlock.blockID){const n=function(n,r){const i=e.ents.getState(t,"inventory"),o=Object.entries(i.items);for(let e=0;e<o.length;e++)if(null!=o[e]&&o[e][1].id==n&&o[e][1].count>=r)return parseInt(o[e][0]);return-1}(l.blocks[l.blockIDmap[e.targetedBlock.blockID]].id,1),r=e.ents.getState(t,"inventory").selected;-1!=n&&n<9?(f.socketSend("ActionInventoryClick",{type:"select",slot:n}),e.ents.getState(t,"inventory").selected=n):-1!=n&&f.socketSend("ActionInventoryClick",{type:"switch",slot:n,slot2:r})}})),e.inputs.down.on("thirdprsn",(function(){u.serverSettings.ingame&&(document.pointerLockElement,e.container.canvas)})),e.inputs.down.on("inventory",(function(){u.serverSettings.ingame&&(h.input.isVisible||p.pauseScreen.isVisible||(c.inventory.isVisible?(c.inventory.isVisible=!1,e.container.canvas.requestPointerLock()):(c.inventory.isVisible=!0,document.exitPointerLock())))})),e.inputs.down.on("chat",(function(){u.serverSettings.ingame&&(c.inventory.isVisible||h.input.isVisible||p.pauseScreen.isVisible||(h.input.isVisible=!0,h.changeState(!0),document.exitPointerLock(),r.moveFocusToControl(h.input),h.input.text=""))})),e.inputs.down.on("cmd",(function(){u.serverSettings.ingame&&(c.inventory.isVisible||h.input.isVisible||p.pauseScreen.isVisible||(h.input.isVisible=!0,h.changeState(!0),document.exitPointerLock(),r.moveFocusToControl(h.input),h.input.text="/"))})),e.inputs.down.on("menu",e=>{if(u.serverSettings.ingame){if(h.input.isVisible)return h.input.isVisible=!1,h.input.text="",void h.changeState(!1);if(!c.inventory.isVisible)return p.pauseScreen.isVisible?void(p.pauseScreen.isVisible=!1):(document.exitPointerLock(),void(p.pauseScreen.isVisible=!0));c.inventory.isVisible=!1}}),e.inputs.down.on("chatenter",(function(){u.serverSettings.ingame&&(h.input.isVisible=!1,f.socketSend("ActionMessage",{message:h.input.text}),h.input.text="",h.changeState(!1))})),e.inputs.down.on("tab",(function(){})),e.inputs.up.on("tab",(function(){})),e.inputs.up.on("screenshot",(function(){h.input.isVisible||document.pointerLockElement==e.container.canvas&&m(e.container.canvas,{filename:"VoxelSRV-"+Date.now()+".png"})})),e.on("tick",(async function(){if(!u.serverSettings.ingame)return;const n=e.inputs.state.scrolly;if(0!==n){let r=e.ents.getState(t,"inventory").selected;r+=n>0?1:-1,r>=u.gameSettings.hotbarsize?r=0:r<0&&(r=8),f.socketSend("ActionInventoryClick",{slot:r,type:"select"}),e.ents.getState(e.playerEntity,"inventory").selected=r}})),e.inputs.bind("numberkey","1","2","3","4","5","6","7","8","9"),e.inputs.down.on("numberkey",n=>{if(u.serverSettings.ingame&&document.pointerLockElement==e.container.canvas){const r=parseInt(n.key);let i=e.ents.getState(t,"inventory").selected;i=r-1,f.socketSend("ActionInventoryClick",{slot:i,type:"select"}),e.ents.getState(e.playerEntity,"inventory").selected=i}}),e.on("tick",async()=>{u.serverSettings.ingame&&(document.pointerLockElement!=e.container.canvas&&!a.isMobile||h.input.isVisible||p.pauseScreen.isVisible||c.inventory.isVisible?e.ents.getState(e.playerEntity,"receivesInputs").ignore=!0:e.ents.getState(e.playerEntity,"receivesInputs").ignore=!1)})},t.setupPlayer=function(e,t,n){const r=e.playerEntity,i=e.entities.getPositionData(r),o=e.rendering.getScene(),a=(i.width,i.height),u=(e.ents.getPositionData(e.playerEntity).height,[0,a/2,0]);e.rendering.getScene().cameras[0].fov=1;const l=e.entities.getMovement(r);l.jumpForce=6,l.jumpImpulse=8.5,l.maxSpeed=7.5,null!=t&&e.ents.addComponentAgain(r,"inventory",t),null!=n&&(e.ents.getState(r,"inventory").armor=n),e.entities.addComponentAgain(r,e.entities.names.mesh,{mesh:new s.Mesh("main",o),offset:u})}},,function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.saveSettings=t.getSettings=t.getWorldList=t.db=void 0;const i=r(n(333));class o extends i.default{constructor(){super("voxelsrv-storage"),this.version(1).stores({main:"name, data",resources:"name, data, active",worlds:"name, data, settings, lastplay"})}}t.db=new o,t.getWorldList=async function(){return await t.db.worlds.orderBy("lastplay").toArray()},t.getSettings=async function(){const e=(await t.db.main.where("name").equals("settings").toArray())[0];return console.log(e),null!=e?e.data:{}},t.saveSettings=async function(e){t.db.main.put({name:"settings",data:e})}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.createSlot=t.buildInventory=t.inventory=t.buildHotbar=t.hotbar=void 0;const s=n(134),a=n(81),u=n(211),l=o(n(97));t.buildHotbar=function(e,n){const r=a.getScreen(1);t.hotbar=new l.Rectangle,t.hotbar.zIndex=5,t.hotbar.verticalAlignment=1,t.hotbar.width=184*a.scale+"px",t.hotbar.height=24*a.scale+"px",t.hotbar.thickness=0,r.addControl(t.hotbar);const i=new l.Image("hotbar","./textures/gui/hotbar.png");i.width=184*a.scale+"px",i.height=24*a.scale+"px",t.hotbar.addControl(i);const o=new l.Image("hotbar","./textures/gui/selected.png");o.zIndex=8,o.width=24*a.scale+"px",o.height=24*a.scale+"px",o.left=-19*a.scale*4+"px",t.hotbar.addControl(o);const c=new Array(9);for(let r=0;r<9;r++){c[r]=f(a.scale);const i=c[r].container;i.zIndex=20,i.isPointerBlocker=!0,i.left=-20*a.scale*4+20*a.scale*r+"px",i.onPointerClickObservable.add(t=>{e.ents.getState(e.playerEntity,"inventory").selected=r,n.send("ActionInventoryClick",{slot:r,type:"select"})}),t.hotbar.addControl(i)}const h=new l.Image("hotbar","./textures/gui/inventoryopen.png");s.isMobile&&(h.zIndex=8,h.verticalAlignment=1,h.width=24*a.scale+"px",h.height=24*a.scale+"px",h.left=19*a.scale*6+"px",h.onPointerClickObservable.add(()=>{t.inventory.isVisible=!0}),r.addControl(h));const d=async()=>{const t=e.ents.getState(e.playerEntity,"inventory");o.left=-20*a.scale*4+20*a.scale*t.selected+"px";for(let e=0;e<9;e++)if(null!=t.items[e]&&null!=t.items[e].id){const n=u.items[t.items[e].id];let r;r=null!=n.blockTexture?n.blockTexture:n.texture.startsWith("https://")&&n.texture.startsWith("http://")?n.texture:"./textures/"+n.texture+".png",c[e].item.source=r,1==t.items[e].count?c[e].count.text="":t.items[e].count<=10?c[e].count.text=" "+t.items[e].count.toString():c[e].count.text=t.items[e].count.toString()}else c[e].item.source="",c[e].count.text=""};e.on("tick",d);const p=e=>{t.hotbar.width=184*e+"px",t.hotbar.height=24*e+"px",i.width=184*e+"px",i.height=24*e+"px",o.width=24*e+"px",o.height=24*e+"px";for(let e=0;e<9;e++)c[e].container.height=16*a.scale+"px",c[e].container.width=16*a.scale+"px",c[e].container.left=-20*a.scale*4+20*a.scale*e+"px",c[e].item.width=16*a.scale+"px",c[e].item.height=16*a.scale+"px",c[e].count.fontSize=8*a.scale+"px",c[e].count.left=2*a.scale+"px",c[e].count.top=4*a.scale+"px",c[e].count.shadowOffsetX=a.scale,c[e].count.shadowOffsetY=a.scale;s.isMobile&&(h.width=24*a.scale+"px",h.height=24*a.scale+"px",h.left=19*a.scale*6+"px")};a.event.on("scale-change",p),t.hotbar.onDisposeObservable.add(()=>{a.event.off("scale-change",p),e.off("tick",d)})};let c=0;function h(e,n){function r(){return e.ents.getState(e.playerEntity,"inventory")}const i=a.getScreen(1);t.inventory=new l.Rectangle,t.inventory.zIndex=20,t.inventory.verticalAlignment=2,t.inventory.background="#00000077",t.inventory.thickness=0,t.inventory.isVisible=!1,i.addControl(t.inventory);const o=new l.Image("inventory","./textures/gui/container/inventory.png");o.width=180*a.scale+"px",o.height=176*a.scale+"px",o.zIndex=10,t.inventory.addControl(o);const s=new l.Rectangle;s.zIndex=20,s.verticalAlignment=2,s.top=67*a.scale+"px",s.height=20*a.scale+"px",s.width=164*a.scale+"px",s.thickness=0,t.inventory.addControl(s);const h=new Array(9),d=new Array(36),p=[];for(let e=1;e<4;e++){const r=new l.Rectangle;r.zIndex=20,r.verticalAlignment=2,r.height=20*a.scale+"px",r.width=164*a.scale+"px",r.top=9*a.scale+18*(e-1)*a.scale+"px",r.thickness=0,t.inventory.addControl(r),p[e]=r;for(let t=9*e;t<9*e+9;t++){d[t]=f(a.scale);const e=d[t].container;e.zIndex=20,e.left=-18*a.scale*4+18*a.scale*(t%9)+"px",e.onPointerClickObservable.add(e=>{let r="left";switch(e.buttonIndex){case 0:r="left";break;case 1:r="middle";break;case 2:r="right"}n.send("ActionInventoryClick",{slot:t+27*c,type:r,inventory:"main"})}),e.onPointerEnterObservable.add(t=>{e.background="#ffffff22"}),e.onPointerOutObservable.add(t=>{e.background="#00000000"}),e.isPointerBlocker=!0,r.addControl(e)}}const m=f(a.scale);m.container.zIndex=50,m.container.verticalAlignment=0,m.container.horizontalAlignment=0,t.inventory.addControl(m.container);for(let e=0;e<9;e++){h[e]=f(a.scale);const t=h[e].container;t.zIndex=20,t.left=-18*a.scale*4+18*a.scale*e+"px",t.onPointerClickObservable.add(t=>{let r="left";switch(t.buttonIndex){case 0:r="left";break;case 1:r="middle";break;case 2:r="right"}n.send("ActionInventoryClick",{slot:e,type:r,inventory:"main"})}),t.onPointerEnterObservable.add(e=>{t.background="#ffffff22"}),t.onPointerOutObservable.add(e=>{t.background="#00000000"}),t.isPointerBlocker=!0,s.addControl(t)}const y=new l.Rectangle;y.zIndex=30,y.verticalAlignment=2,y.top=-39*a.scale+"px",y.left=-72*a.scale+"px",y.height=72*a.scale+"px",y.width=18*a.scale+"px",y.thickness=0,t.inventory.addControl(y);const g=new Array(4);for(let e=0;e<4;e++){g[e]=f(a.scale);const t=g[e].container;t.zIndex=20,t.verticalAlignment=0,t.top=18*a.scale*e+"px",t.onPointerClickObservable.add(t=>{let r="left";switch(t.buttonIndex){case 0:r="left";break;case 1:r="middle";break;case 2:r="right"}n.send("ActionInventoryClick",{slot:e,type:r,inventory:"armor"})}),t.onPointerEnterObservable.add(e=>{t.background="#ffffff22"}),t.onPointerOutObservable.add(e=>{t.background="#00000000"}),t.isPointerBlocker=!0,y.addControl(t)}i.onPointerMoveObservable.add(e=>{m.container.left=e.x,m.container.top=e.y});const v={};if(r().size>36){const e=new l.Rectangle;v.box=e,e.height=15*a.scale+"px",e.width=22*a.scale+"px",e.zIndex=25,e.thickness=0,e.top=-6*a.scale+"px",e.left=71*a.scale+"px",t.inventory.addControl(e);const n=r(),i=new l.Image("button1","./textures/gui/button-right.png");v.button1=i,i.zIndex=25,i.horizontalAlignment=1,i.height=15*a.scale+"px",i.width=11*a.scale+"px",i.onPointerClickObservable.add(e=>{c+=1,9+27*c>n.size&&(c=0)}),i.isPointerBlocker=!0,e.addControl(i);const o=new l.Image("button2","./textures/gui/button-left.png");v.button2=o,o.zIndex=25,o.horizontalAlignment=0,o.height=15*a.scale+"px",o.width=11*a.scale+"px",o.onPointerClickObservable.add(e=>{c-=1,c<0&&(c=Math.round(27/((n.size-9)/27)/3-1))}),o.isPointerBlocker=!0,e.addControl(o)}const b=async()=>{const e=r();if(null!=e.tempslot&&null!=e.tempslot.id){m.item.alpha=1,m.count.alpha=1;let t=u.items[e.tempslot.id].texture+".png";t.startsWith("https://")&&t.startsWith("http://")||(t="./textures/"+t),m.item.source=t,1==e.tempslot.count?m.count.text="":e.tempslot.count<=10?m.count.text=" "+e.tempslot.count.toString():m.count.text=e.tempslot.count.toString()}else m.item.alpha=0,m.count.alpha=0,m.item.source="",m.count.text="";for(let t=0;t<9;t++)if(null!=e.items[t]&&null!=e.items[t].id){h[t].item.alpha=1,h[t].count.alpha=1;let n=u.items[e.items[t].id].texture+".png";n.startsWith("https://")&&n.startsWith("http://")||(n="./textures/"+n),h[t].item.source=n,1==e.items[t].count?h[t].count.text="":e.items[t].count<=10?h[t].count.text=" "+e.items[t].count.toString():h[t].count.text=e.items[t].count.toString()}else h[t].item.alpha=0,h[t].count.alpha=0,h[t].item.source="",h[t].count.text="";for(let t=9;t<36;t++){const n=27*c+t;if(null!=e.items[n]&&null!=e.items[n].id){d[t].item.alpha=1,d[t].count.alpha=1;let r=u.items[e.items[n].id].texture+".png";r.startsWith("https://")&&r.startsWith("http://")||(r="./textures/"+r),d[t].item.source=r,1==e.items[n].count?d[t].count.text="":e.items[n].count<=10?d[t].count.text=" "+e.items[n].count.toString():d[t].count.text=e.items[n].count.toString()}else n>e.size?(d[t].item.alpha=1,d[t].count.alpha=1,d[t].item.source="./textures/gui/noslot.png",d[t].count.text=""):(d[t].item.alpha=0,d[t].count.alpha=0,d[t].item.source="",d[t].count.text="")}for(let t=0;t<4;t++)if(null!=e.armor.items[t]&&null!=e.armor.items[t].id){g[t].count.alpha=1;let n=u.items[e.armor.items[t].id].texture+".png";n.startsWith("https://")&&n.startsWith("http://")||(n="./textures/"+n),g[t].item.source=n,1==e.armor.items[t].count?g[t].count.text="":e.armor.items[t].count<=10?g[t].count.text=" "+e.armor.items[t].count.toString():g[t].count.text=e.armor.items[t].count.toString()}else{let e;switch(g[t].count.alpha=0,t){case 0:e="./textures/item/empty_armor_slot_helmet.png";break;case 1:e="./textures/item/empty_armor_slot_chestplate.png";break;case 2:e="./textures/item/empty_armor_slot_leggings.png";break;case 3:e="./textures/item/empty_armor_slot_boots.png"}g[t].item.source=e,g[t].count.text=""}};e.on("tick",b);const w=e=>{o.width=180*e+"px",o.height=176*e+"px",s.top=67*e+"px",s.height=20*e+"px",s.width=164*e+"px",y.top=-39*e+"px",y.left=-72*e+"px",y.height=72*e+"px",y.width=18*e+"px",v.box.height=15*e+"px",v.box.width=22*e+"px",v.box.top=-6*e+"px",v.box.left=71*e+"px",v.button1.height=15*e+"px",v.button1.width=11*e+"px",v.button2.height=15*e+"px",v.button2.width=11*e+"px",m.container.height=16*e+"px",m.container.width=16*e+"px",m.item.width=16*e+"px",m.item.height=16*e+"px",m.count.fontSize=8*e+"px",m.count.left=2*e+"px",m.count.top=4*e+"px",m.count.shadowOffsetX=e,m.count.shadowOffsetY=e;for(let t=0;t<h.length;t++)h[t].container.height=16*e+"px",h[t].container.width=16*e+"px",h[t].container.left=-18*e*4+18*e*(t%9)+"px",h[t].item.width=16*e+"px",h[t].item.height=16*e+"px",h[t].count.fontSize=8*e+"px",h[t].count.left=2*e+"px",h[t].count.top=4*e+"px",h[t].count.shadowOffsetX=e,h[t].count.shadowOffsetY=e;for(let t=0;t<g.length;t++)g[t].container.height=16*e+"px",g[t].container.width=16*e+"px",g[t].item.width=16*e+"px",g[t].item.height=16*e+"px",g[t].count.fontSize=8*e+"px",g[t].count.left=2*e+"px",g[t].count.top=4*e+"px",g[t].count.shadowOffsetX=e,g[t].count.shadowOffsetY=e;for(let t=1;t<4;t++){p[t].height=20*e+"px",p[t].width=164*e+"px",p[t].top=9*e+18*(t-1)*e+"px";for(let n=9*t;n<9*t+9;n++)d[n].container.left=-18*e*4+18*e*(n%9)+"px",d[n].container.height=16*e+"px",d[n].container.width=16*e+"px",d[n].item.width=16*e+"px",d[n].item.height=16*e+"px",d[n].count.fontSize=8*e+"px",d[n].count.left=2*e+"px",d[n].count.top=4*e+"px",d[n].count.shadowOffsetX=e,d[n].count.shadowOffsetY=e}};a.event.on("scale-change",w),t.inventory.onDisposeObservable.add(()=>{a.event.off("scake-change",w),e.off("tick",b)})}function f(e){const t={item:new l.Image("hotbar",""),container:new l.Rectangle,count:new l.TextBlock},n=t.container;n.zIndex=20,n.height=16*e+"px",n.width=16*e+"px",n.thickness=0;const r=t.item;r.width=16*e+"px",r.height=16*e+"px",n.addControl(r);const i=t.count;return i.text="",i.fontFamily="silkscreen",i.color="#f0f0f0",i.fontSize=8*e+"px",i.left=2*e+"px",i.top=4*e+"px",i.shadowColor="#111111",i.shadowOffsetX=e,i.shadowOffsetY=e,n.addControl(i),t}t.buildInventory=h,t.createSlot=f,window.inv=h},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Socket=t.BaseSocket=void 0;const s=o(n(335));class a{constructor(){this.listeners={}}send(e,t){const n=s.parseToMessage("client",e,t);null!=n&&this.socket.send(n)}close(){this.listeners={}}emit(e,t){null!=this.listeners[e]&&this.listeners[e].forEach(e=>{e(t)})}on(e,t){null!=this.listeners[e]||(this.listeners[e]=new Array),this.listeners[e].push(t)}}t.BaseSocket=a;t.Socket=class extends a{constructor(e){super(),this.server=e,this.socket=new WebSocket(e),console.log(this.socket),this.socket.binaryType="arraybuffer",this.socket.onopen=()=>{setTimeout(()=>this.emit("connection",{}),100)},this.socket.onerror=()=>{setTimeout(()=>this.emit("PlayerKick",{reason:"Can't connect to "+e}),100)},this.socket.onclose=()=>{setTimeout(()=>this.emit("PlayerKick",{reason:"Connection closed!"}),100)},this.socket.onmessage=e=>{const t=s.parseToObject("server",new Uint8Array(e.data));null!=t&&this.emit(t.type,t.data)}}close(){this.listeners={},this.socket.close()}}},function(e,t,n){"use strict";e.exports=n(337)},function(e,t,n){"use strict";e.exports=h;var r,i=n(127),o=i.LongBits,s=i.base64,a=i.utf8;function u(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function l(){}function c(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function h(){this.len=0,this.head=new u(l,0,0),this.tail=this.head,this.states=null}var f=function(){return i.Buffer?function(){return(h.create=function(){return new r})()}:function(){return new h}};function d(e,t,n){t[n]=255&e}function p(e,t){this.len=e,this.next=void 0,this.val=t}function m(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function y(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}h.create=f(),h.alloc=function(e){return new i.Array(e)},i.Array!==Array&&(h.alloc=i.pool(h.alloc,i.Array.prototype.subarray)),h.prototype._push=function(e,t,n){return this.tail=this.tail.next=new u(e,t,n),this.len+=t,this},p.prototype=Object.create(u.prototype),p.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},h.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new p((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},h.prototype.int32=function(e){return e<0?this._push(m,10,o.fromNumber(e)):this.uint32(e)},h.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},h.prototype.uint64=function(e){var t=o.from(e);return this._push(m,t.length(),t)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this._push(m,t.length(),t)},h.prototype.bool=function(e){return this._push(d,1,e?1:0)},h.prototype.fixed32=function(e){return this._push(y,4,e>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(e){var t=o.from(e);return this._push(y,4,t.lo)._push(y,4,t.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(e){return this._push(i.float.writeFloatLE,4,e)},h.prototype.double=function(e){return this._push(i.float.writeDoubleLE,8,e)};var g=i.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};h.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(d,1,0);if(i.isString(e)){var n=h.alloc(t=s.length(e));s.decode(e,n,0),e=n}return this.uint32(t)._push(g,t,e)},h.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(d,1,0)},h.prototype.fork=function(){return this.states=new c(this),this.head=this.tail=new u(l,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new u(l,0,0),this.len=0),this},h.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},h.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},h._configure=function(e){r=e,h.create=f(),r._configure()}},function(e,t,n){"use strict";e.exports=u;var r,i=n(127),o=i.LongBits,s=i.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function u(e){this.buf=e,this.pos=0,this.len=e.length}var l,c="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new u(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new u(e);throw Error("illegal buffer")},h=function(){return i.Buffer?function(e){return(u.create=function(e){return i.Buffer.isBuffer(e)?new r(e):c(e)})(e)}:c};function f(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function d(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw a(this,8);return new o(d(this.buf,this.pos+=4),d(this.buf,this.pos+=4))}u.create=h(),u.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,u.prototype.uint32=(l=4294967295,function(){if(l=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return l;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return l}),u.prototype.int32=function(){return 0|this.uint32()},u.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},u.prototype.bool=function(){return 0!==this.uint32()},u.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return d(this.buf,this.pos+=4)},u.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|d(this.buf,this.pos+=4)},u.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},u.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},u.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},u.prototype.string=function(){var e=this.bytes();return s.read(e,0,e.length)},u.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},u.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},u._configure=function(e){r=e,u.create=h(),r._configure();var t=i.Long?"toLong":"toNumber";i.merge(u.prototype,{int64:function(){return f.call(this)[t](!1)},uint64:function(){return f.call(this)[t](!0)},sint64:function(){return f.call(this).zzDecode()[t](!1)},fixed64:function(){return p.call(this)[t](!0)},sfixed64:function(){return p.call(this)[t](!1)}})}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const s=n(81),a=o(n(97)),u=n(171),l=n(96);t.default=function(e,t){const n=new a.Rectangle;n.thickness=0,n.horizontalAlignment=2,n.zIndex=10,window.innerHeight>230*s.scale?n.height=230*s.scale+"px":n.height="100%",n.width=220*s.scale+"px",n.background="#11111166";const r=new a.TextBlock;r.fontFamily="Lato",r.fontSize=11*s.scale,r.textVerticalAlignment=0,r.color="white",r.text="Settings",r.top=s.scale,n.addControl(r);const i=new a.StackPanel;i.verticalAlignment=0,i.top=18*s.scale+"px",i.width=210*s.scale+"px",i.height="80%",n.addControl(i);const o=u.createInput();o.name.text="Nickname",o.input.placeholderText="Write your nickname",o.input.text=l.gameSettings.nickname,o.input.promptMessage="Enter your nickname",i.addControl(o.main);const c=u.createSlider();c.name.text="Mouse sensitivity: "+l.gameSettings.mouse,c.slider.value=l.gameSettings.mouse,c.slider.minimum=1,c.slider.maximum=80,c.slider.step=1,c.slider.onValueChangedObservable.add(e=>{c.name.text="Mouse sensitivity: "+e}),i.addControl(c.main);const h=u.createSlider();h.name.text="GUI scale: "+l.gameSettings.scale,h.slider.value=l.gameSettings.scale,h.slider.minimum=2,h.slider.maximum=5,h.slider.step=1,h.slider.onValueChangedObservable.add(e=>{h.name.text="GUI scale: "+e}),i.addControl(h.main);const f=u.createCheckbox();f.name.text="Enable gamepad: "+l.gameSettings.gamepad,f.isChecked=l.gameSettings.gamepad,f.main.onPointerClickObservable.add(()=>{f.isChecked=!f.isChecked,f.name.text="Enable gamepad: "+f.isChecked}),i.addControl(f.main);const d=u.createItem();d.item.verticalAlignment=1,d.text.text=[{text:"Back",color:"white",font:"Lato"}],d.item.onPointerClickObservable.add(()=>{l.updateSettings({nickname:o.input.text,mouse:c.slider.value,scale:h.slider.value,gamepad:f.isChecked}),e.camera.sensitivityX=c.slider.value,e.camera.sensitivityY=c.slider.value,n.dispose(),t("main")}),n.addControl(d.item);const p=e=>{window.innerHeight>230*s.scale?n.height=230*s.scale+"px":n.height="100%",n.width=220*s.scale+"px",r.fontSize=11*s.scale,i.top=18*s.scale+"px",i.width=210*s.scale+"px",d.item.width=100*s.scale+"px",d.item.height=18*s.scale+"px",d.text.fontSize=10*s.scale};return s.event.on("scale-change",p),n.onDisposeObservable.add(()=>{s.event.off("scale-change",p)}),n}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.pauseScreen=void 0;const a=n(81),u=o(n(97)),l=n(170),c=n(171),h=s(n(247));t.default=function(e){const n=a.getScreen(1);let r,i;t.pauseScreen=new u.Rectangle,t.pauseScreen.zIndex=20,t.pauseScreen.verticalAlignment=2,t.pauseScreen.background="#00000077",t.pauseScreen.thickness=0,t.pauseScreen.isVisible=!1,n.addControl(t.pauseScreen);const o=new u.Rectangle;o.thickness=0,o.horizontalAlignment=2,o.zIndex=10,o.height=200*a.scale+"px",o.width=160*a.scale+"px",o.background="#11111166",t.pauseScreen.addControl(o);const s=new u.TextBlock;function f(n){switch(n){case"settings":r=h.default(e,f),i="settings",t.pauseScreen.addControl(r);break;default:r.dispose(),r=null,o.isVisible=!0,i="main"}}s.fontFamily="Lato",s.fontSize=11*a.scale,s.textVerticalAlignment=0,s.color="white",s.text="Pause",s.top=a.scale,o.addControl(s);const d=new u.StackPanel;o.addControl(d);const p=c.createItem();p.item.verticalAlignment=1,p.text.text=[{text:"Back to game",color:"white",font:"Lato"}],p.item.onPointerClickObservable.add(()=>{t.pauseScreen.isVisible=!1,e.container.canvas.requestPointerLock()}),d.addControl(p.item);const m=c.createItem();m.item.verticalAlignment=1,m.text.text=[{text:"Settings",color:"white",font:"Lato"}],m.item.onPointerClickObservable.add(()=>{o.isVisible=!1,f("settings")}),d.addControl(m.item);const y=c.createItem();y.text.text=[{text:"Discord",color:"white",font:"Lato"}],y.item.onPointerClickObservable.add(e=>{window.open("https://discord.com/invite/K9PdsDh","_blank")}),d.addControl(y.item);const g=c.createItem();g.item.verticalAlignment=1,g.text.text=[{text:"Disconnect",color:"white",font:"Lato"}],g.item.onPointerClickObservable.add(()=>{t.pauseScreen.dispose(),l.disconnect()}),d.addControl(g.item);const v=e=>{o.height=200*a.scale+"px",o.width=160*a.scale+"px",s.fontSize=11*a.scale,d._children.forEach(e=>{e.width=100*a.scale+"px",e.height=18*a.scale+"px",e._children[0].fontSize=10*a.scale})};return a.event.on("scale-change",v),o.onDisposeObservable.add(()=>{a.event.off("scale-change",v)}),o}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.applyModel=t.defineModelComp=void 0;const s=o(n(139)),a=n(96),u={};let l;function c(e,t){console.log("Building model...");const n=l.rendering.getScene(),r=[e.geometry.texturewidth,e.geometry.textureheight],i=new s.Mesh("main",n),o=e.geometry.bones,u={};for(var c=0;c<o.length;c++){const e=o[c],f=e.cubes,d=new Array(f.length),p=e.pivot;for(let i=0;i<f.length;i++){let o=0;null!=f[i].inflate&&(o=f[i].inflate);const u=new Array(6),c=f[i].size,p=f[i].origin,m=f[i].uv;u[0]=new s.Vector4((m[0]+c[2])/r[0],(r[1]-c[1]-c[2]-m[1])/r[1],(c[2]+c[0]+m[0])/r[0],(r[1]-c[2]-m[1])/r[1]),u[1]=new s.Vector4((m[0]+2*c[2]+c[0])/r[0],(r[1]-c[1]-c[2]-m[1])/r[1],(2*c[2]+2*c[0]+m[0])/r[0],(r[1]-c[2]-m[1])/r[1]),u[2]=new s.Vector4(m[0]/r[0],(r[1]-c[1]-c[2]-m[1])/r[1],(m[0]+c[2])/r[0],(r[1]-c[2]-m[1])/r[1]),u[3]=new s.Vector4((m[0]+c[2]+c[0])/r[0],(r[1]-c[1]-c[2]-m[1])/r[1],(c[2]+2*c[0]+m[0])/r[0],(r[1]-c[2]-m[1])/r[1]),u[4]=new s.Vector4((c[0]+c[2]+m[0])/r[0],(r[1]-c[2]-m[1])/r[1],(m[0]+c[2])/r[0],(r[1]-m[1])/r[1]),u[5]=new s.Vector4((2*c[0]+c[2]+m[0])/r[0],(r[1]-c[2]-m[1])/r[1],(m[0]+c[2]+c[0])/r[0],(r[1]-m[1])/r[1]),d[i]=s.MeshBuilder.CreateBox("part-"+e.name+"-"+i,{height:.06*(c[1]+o),width:.06*(c[0]+o),depth:.06*(c[2]+o),faceUV:u,wrap:!0},n),d[i].position=new s.Vector3(.06*-(p[0]+(c[0]-o/2)/2),.06*(p[1]+(c[1]-o/2)/2),.06*(p[2]+(c[2]-o/2)/2));var h=l.rendering.makeStandardMaterial("modelmaterial-"+e.name+"-"+i);d[i].material=h,(t.startsWith("http://")||t.startsWith("https://"))&&1==a.gameSettings.allowcustom?h.diffuseTexture=new s.Texture(t,n,!0,!0,s.Texture.NEAREST_SAMPLINGMODE):h.diffuseTexture=new s.Texture("textures/"+t+".png",n,!0,!0,s.Texture.NEAREST_SAMPLINGMODE),d[i].opaque=!1,h.diffuseTexture.hasAlpha=!0}const m=s.Mesh.MergeMeshes(d,!0,!0,void 0,!0,!0);m.setParent(i),m.setPivotMatrix(s.Matrix.Translation(.06*-p[0],.06*-p[1],.06*-p[2])),console.log(e.name,m),u[e.name]=m,l.rendering.addMeshToScene(m)}return console.log(u),{main:i,models:u}}function h(e,t,n){const r=l.rendering.getScene(),i="bold 96px 'lato'",o=new s.DynamicTexture("DynamicTexture",64,r,!1).getContext();o.font=i;const a=o.measureText(t).width+8,u=a*(.3/144),c=new s.DynamicTexture("DynamicTexture",{width:a,height:144},r,!1),h=l.rendering.makeStandardMaterial("nametag");h.diffuseTexture=c,h.emissiveTexture=h.diffuseTexture,h.diffuseTexture.hasAlpha=!0,h.opacityTexture=h.diffuseTexture,c.drawText(t,null,null,i,"#eeeeee","#00000066",!0);const f=s.MeshBuilder.CreatePlane("plane",{width:u,height:.3},r);return f.material=h,f.setPositionWithLocalVector(new s.Vector3(0,n+.2,0)),f.opaque=!1,f.setParent(e),l.rendering.addMeshToScene(f),f}t.defineModelComp=function(e){l=e,l.ents.createComponent({name:"model",state:{models:{}}})},t.applyModel=function(e,t,n,r,i,o,a,f){const d=l.rendering.getScene();if(null==u[n])fetch("./models/"+n+".json").then(e=>e.json()).then((function(p){const m=c(p,r);u[n]=p,o&&(m.nametag=h(m.main,a,l.ents.getPositionData(e).height)),l.ents.addComponent(e,"model",m);const y=s.MeshBuilder.CreateBox("hitbox-"+t,{height:f[1],width:f[0],depth:f[2]},d);y.setParent(m.main),y.setPositionWithLocalVector(new s.Vector3(0,f[1]/2,0)),y.material=l.rendering.makeStandardMaterial(),y.material.wireframe=!0,l.rendering.addMeshToScene(y,!1),l.entities.addComponent(e,l.entities.names.mesh,{mesh:m.main,offset:i})}));else{const t=c(u[n],r);o&&(t.nametag=h(t.main,a,l.ents.getPositionData(e).height)),l.ents.addComponent(e,"model",t),l.entities.addComponent(e,l.entities.names.mesh,{mesh:t.main,offset:i})}}},function(e,t,n){"use strict";e.exports=function(e,t,n,r){for(var i=65535&e|0,o=e>>>16&65535|0,s=0;0!==n;){n-=s=n>2e3?2e3:n;do{o=o+(i=i+t[r++]|0)|0}while(--s);i%=65521,o%=65521}return i|o<<16|0}},function(e,t,n){"use strict";var r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();e.exports=function(e,t,n,i){var o=r,s=i+n;e^=-1;for(var a=i;a<s;a++)e=e>>>8^o[255&(e^t[a])];return-1^e}},function(e,t,n){"use strict";var r=n(118),i=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){o=!1}for(var s=new r.Buf8(256),a=0;a<256;a++)s[a]=a>=252?6:a>=248?5:a>=240?4:a>=224?3:a>=192?2:1;function u(e,t){if(t<65534&&(e.subarray&&o||!e.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var n="",s=0;s<t;s++)n+=String.fromCharCode(e[s]);return n}s[254]=s[254]=1,t.string2buf=function(e){var t,n,i,o,s,a=e.length,u=0;for(o=0;o<a;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<a&&56320==(64512&(i=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),u+=n<128?1:n<2048?2:n<65536?3:4;for(t=new r.Buf8(u),s=0,o=0;s<u;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<a&&56320==(64512&(i=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),n<128?t[s++]=n:n<2048?(t[s++]=192|n>>>6,t[s++]=128|63&n):n<65536?(t[s++]=224|n>>>12,t[s++]=128|n>>>6&63,t[s++]=128|63&n):(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63,t[s++]=128|n>>>6&63,t[s++]=128|63&n);return t},t.buf2binstring=function(e){return u(e,e.length)},t.binstring2buf=function(e){for(var t=new r.Buf8(e.length),n=0,i=t.length;n<i;n++)t[n]=e.charCodeAt(n);return t},t.buf2string=function(e,t){var n,r,i,o,a=t||e.length,l=new Array(2*a);for(r=0,n=0;n<a;)if((i=e[n++])<128)l[r++]=i;else if((o=s[i])>4)l[r++]=65533,n+=o-1;else{for(i&=2===o?31:3===o?15:7;o>1&&n<a;)i=i<<6|63&e[n++],o--;o>1?l[r++]=65533:i<65536?l[r++]=i:(i-=65536,l[r++]=55296|i>>10&1023,l[r++]=56320|1023&i)}return u(l,r)},t.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+s[e[n]]>t?n:t}},function(e,t,n){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(e,t,n){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.setupClouds=t.cloudMesh=t.setupSkybox=void 0;const s=o(n(139));t.setupSkybox=function(e){const t=e.rendering.getScene(),n=s.Mesh.CreateSphere("skyBox",32,1e3,t);e.rendering.addMeshToScene(n)},t.setupClouds=function(e){const n=e.rendering.getScene();t.cloudMesh=s.MeshBuilder.CreatePlane("cloudMesh",{height:1500,width:1500},n);const r=new s.StandardMaterial("cloud",n),i=new s.Texture("./textures/environment/clouds.png",n,!0,!0,s.Texture.NEAREST_SAMPLINGMODE);i.hasAlpha=!0,i.vScale=.75,i.uScale=.75,r.diffuseTexture=i,r.opacityTexture=i,r.backFaceCulling=!1,r.emissiveColor=new s.Color3(1,1,1),t.cloudMesh.rotation.x=-Math.PI/2,t.cloudMesh.material=r,e.rendering.addMeshToScene(t.cloudMesh,!1),t.cloudMesh.setPositionWithLocalVector(new s.Vector3(0,0,200));let o=[...e.camera.getPosition()];const a=()=>{null!=e.ents.getState(e.playerEntity,e.ents.names.mesh)&&t.cloudMesh.setParent(e.ents.getState(e.playerEntity,e.ents.names.mesh).mesh),i.vOffset+=1e-5+(o[2]-e.camera.getPosition()[2])/1e4,i.uOffset-=(o[0]-e.camera.getPosition()[0])/1e4,o=[...e.camera.getPosition()],t.cloudMesh.setPositionWithLocalVector(new s.Vector3(0,0,200-e.camera.getPosition()[1]))};e.on("beforeRender",a),t.cloudMesh.onDisposeObservable.add(()=>{e.off("beforeRender",a)})}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(134),o=r(n(372)),s=n(239),a=n(249),u=n(96),l=n(81),c=n(243),h=n(241),f=n(255),d=n(213),p=n(170),m=n(370),y=n(371);u.defaultFonts.forEach(e=>document.fonts.load(`10pt "${e}"`)),h.getSettings().then(e=>u.updateSettings(e));const g=new o.default(u.noaOpts());g.ents.createComponent({name:"inventory",state:{items:{},selected:0,tempslot:{},armor:{}}}),u.setNoa(g),g.ents.getPhysics(g.playerEntity).body.airDrag=9999,l.constructScreen(g),f.setupClouds(g),a.defineModelComp(g),s.setupControls(g),y.setupGamepad(g);let v=0;g.on("beforeRender",async()=>{u.serverSettings.ingame||(v++,g.camera.heading=v/2e3,g.camera.pitch=0)}),window.connect=e=>{p.connect(g,new c.Socket(e))},window.forceplay=()=>{u.updateServerSettings({ingame:!0})},window.onload=function(){if(i.isMobile){m.setupMobile(g);const e=document.createElement("link");e.rel="stylesheet",e.href="mobile.css",document.head.appendChild(e),document.documentElement.addEventListener("click",(function(){document.fullscreenElement||(document.documentElement.requestFullscreen(),screen.orientation.lock("landscape"))}))}const e=new URLSearchParams(window.location.search);if(e.get("server")){const t=new c.Socket("ws://"+e.get("server"));p.connect(g,t)}else setTimeout(()=>{d.buildMainMenu(g,p.connect)},50)}},function(e,t){e.exports=function(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}},function(e,t,n){e.exports=function(e,t){var n=r(e[0],e[1],e[2]),s=r(t[0],t[1],t[2]);i(n,n),i(s,s);var a=o(n,s);return a>1?0:Math.acos(a)};var r=n(219),i=n(220),o=n(221)},function(e,t){e.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}},function(e,t){e.exports=function(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}},function(e,t,n){e.exports=function(e,t){var n=e[0],i=e[1],o=e[2],s=t[0],a=t[1],u=t[2];return Math.abs(n-s)<=r*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-a)<=r*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(o-u)<=r*Math.max(1,Math.abs(o),Math.abs(u))};var r=n(217)},function(e,t){e.exports=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}},function(e,t,n){e.exports=n(222)},function(e,t,n){e.exports=n(223)},function(e,t,n){e.exports=n(224)},function(e,t){e.exports=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}},function(e,t){e.exports=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}},function(e,t){e.exports=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}},function(e,t){e.exports=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}},function(e,t){e.exports=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}},function(e,t){e.exports=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}},function(e,t){e.exports=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}},function(e,t,n){e.exports=n(225)},function(e,t,n){e.exports=n(226)},function(e,t,n){e.exports=n(227)},function(e,t,n){e.exports=n(228)},function(e,t){e.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}},function(e,t){e.exports=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}},function(e,t){e.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],s=n[0],a=n[1],u=n[2];return e[0]=i*u-o*a,e[1]=o*s-r*u,e[2]=r*a-i*s,e}},function(e,t){e.exports=function(e,t,n,r){var i=t[0],o=t[1],s=t[2];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=s+r*(n[2]-s),e}},function(e,t){e.exports=function(e,t){t=t||1;var n=2*Math.random()*Math.PI,r=2*Math.random()-1,i=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*i,e[1]=Math.sin(n)*i,e[2]=r*t,e}},function(e,t){e.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],s=n[3]*r+n[7]*i+n[11]*o+n[15];return s=s||1,e[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/s,e[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/s,e[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/s,e}},function(e,t){e.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2];return e[0]=r*n[0]+i*n[3]+o*n[6],e[1]=r*n[1]+i*n[4]+o*n[7],e[2]=r*n[2]+i*n[5]+o*n[8],e}},function(e,t){e.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],s=n[0],a=n[1],u=n[2],l=n[3],c=l*r+a*o-u*i,h=l*i+u*r-s*o,f=l*o+s*i-a*r,d=-s*r-a*i-u*o;return e[0]=c*l+d*-s+h*-u-f*-a,e[1]=h*l+d*-a+f*-s-c*-u,e[2]=f*l+d*-u+c*-a-h*-s,e}},function(e,t){e.exports=function(e,t,n,r){var i=n[1],o=n[2],s=t[1]-i,a=t[2]-o,u=Math.sin(r),l=Math.cos(r);return e[0]=t[0],e[1]=i+s*l-a*u,e[2]=o+s*u+a*l,e}},function(e,t){e.exports=function(e,t,n,r){var i=n[0],o=n[2],s=t[0]-i,a=t[2]-o,u=Math.sin(r),l=Math.cos(r);return e[0]=i+a*u+s*l,e[1]=t[1],e[2]=o+a*l-s*u,e}},function(e,t){e.exports=function(e,t,n,r){var i=n[0],o=n[1],s=t[0]-i,a=t[1]-o,u=Math.sin(r),l=Math.cos(r);return e[0]=i+s*l-a*u,e[1]=o+s*u+a*l,e[2]=t[2],e}},function(e,t,n){e.exports=function(e,t,n,i,o,s){var a,u;t||(t=3);n||(n=0);u=i?Math.min(i*t+n,e.length):e.length;for(a=n;a<u;a+=t)r[0]=e[a],r[1]=e[a+1],r[2]=e[a+2],o(r,r,s),e[a]=r[0],e[a+1]=r[1],e[a+2]=r[2];return e};var r=n(218)()},function(e,t){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(n(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,i,o){var s=+t[0],a=+t[1],u=+t[2],l=+n[0],c=+n[1],h=+n[2],f=Math.sqrt(l*l+c*c+h*h);if(0===f)throw new Error("Can't raycast along a zero vector");return function(e,t,n,r,i,o,s,a,u,l){for(var c=0,h=Math.floor,f=0|h(t),d=0|h(n),p=0|h(r),m=i>0?1:-1,y=o>0?1:-1,g=s>0?1:-1,v=Math.abs(1/i),b=Math.abs(1/o),w=Math.abs(1/s),_=v<1/0?v*(m>0?f+1-t:t-f):1/0,x=b<1/0?b*(y>0?d+1-n:n-d):1/0,k=w<1/0?w*(g>0?p+1-r:r-p):1/0,O=-1;c<=a;){var P=e(f,d,p);if(P)return u&&(u[0]=t+c*i,u[1]=n+c*o,u[2]=r+c*s),l&&(l[0]=l[1]=l[2]=0,0===O&&(l[0]=-m),1===O&&(l[1]=-y),2===O&&(l[2]=-g)),P;_<x?_<k?(f+=m,c=_,_+=v,O=0):(p+=g,c=k,k+=w,O=2):x<k?(d+=y,c=x,x+=b,O=1):(p+=g,c=k,k+=w,O=2)}return u&&(u[0]=t+c*i,u[1]=n+c*o,u[2]=r+c*s),l&&(l[0]=l[1]=l[2]=0),0}(e,s,a,u,l/=f,c/=f,h/=f,r=void 0===r?64:+r,i,o)}},function(e,t,n){"use strict";var r=n(135).EventEmitter,i=n(293),o=n(297),s=n(298),a=n(299),u=n(300),l=n(301),c=n(229),h=Math.min;n(302);var f=n(303),d=n(304),p=function(){var e,t,n=new Array(256);for(e=0;e<256;++e)n[e]="UNK";for(e in s)"<"===(t=s[e]).charAt(0)&&">"===t.charAt(t.length-1)&&(t=t.substring(1,t.length-1)),t=t.replace(/\s/g,"-"),n[parseInt(e)]=t;return n}(),m=u(Object.keys(a(p)));function y(e){return l.eq(m,e)}function g(e){return y(p[e])}function v(){r.call(this),this._curKeyState=new Array(m.length),this._pressCount=new Array(m.length),this._releaseCount=new Array(m.length),this._tickInterval=null,this._rafHandle=null,this._tickRate=0,this._lastTick=d(),this._frameTime=0,this._paused=!0,this._width=0,this._height=0,this._wantFullscreen=!1,this._wantPointerLock=!1,this._fullscreenActive=!1,this._pointerLockActive=!1,this._rafFunction=C.bind(void 0,this,!0),this.preventDefaults=!0,this.stopPropagation=!1;for(var e=0;e<m.length;++e)this._curKeyState[e]=!1,this._pressCount[e]=this._releaseCount[e]=0;this.element=null,this.bindings={},this.frameSkip=100,this.tickCount=0,this.frameCount=0,this.startTime=d(),this.tickTime=this._tickRate,this.frameTime=10,this.stickyFullscreen=!1,this.stickyPointerLock=!1,this.scroll=[0,0,0],this.mouseX=0,this.mouseY=0,this.prevMouseX=0,this.prevMouseY=0}i.inherits(v,r);var b=v.prototype;function w(e,t,n){if(n in t){for(var r=t[n],i=0,o=0,s=r.length;o<s;++o)i+=e[y(r[o])];return i}var a=y(n);return a>=0?e[a]:0}function _(e){var t=e.element;e._wantFullscreen&&!e._fullscreenActive&&(t.requestFullscreen||t.requestFullScreen||t.webkitRequestFullscreen||t.webkitRequestFullScreen||t.mozRequestFullscreen||t.mozRequestFullScreen||function(){}).call(t);e._wantPointerLock&&!e._pointerLockActive&&(t.requestPointerLock||t.webkitRequestPointerLock||t.mozRequestPointerLock||t.msRequestPointerLock||t.oRequestPointerLock||function(){}).call(t)}b.keyNames=m,b.bind=function(e){var t,n;t=e in this.bindings?this.bindings[e]:[];for(var r=1,i=arguments.length;r<i;++r)if(y(n=arguments[r])>=0)t.push(n);else if(n in this.bindings)for(var o=this.bindings[n],s=0;s<o.length;++s)t.push(o[s]);(t=u(t)).length>0&&(this.bindings[e]=t),this.emit("bind",e,t)},b.unbind=function(e){e in this.bindings&&delete this.bindings[e],this.emit("unbind",e)},b.down=function(e){return function(e,t,n){if(n in t){for(var r=t[n],i=0,o=r.length;i<o;++i)if(e[y(r[i])])return!0;return!1}var s=y(n);return s>=0&&e[s]}(this._curKeyState,this.bindings,e)},b.wasDown=function(e){return this.down(e)||!!this.press(e)},b.up=function(e){return!this.down(e)},b.wasUp=function(e){return this.up(e)||!!this.release(e)},b.press=function(e){return w(this._pressCount,this.bindings,e)},b.release=function(e){return w(this._releaseCount,this.bindings,e)},Object.defineProperty(b,"paused",{get:function(){return this._paused},set:function(e){!!e!==this._paused&&(this._paused?(this._paused=!1,this._lastTick=d()-Math.floor(this._frameTime*this._tickRate),this._tickInterval=setInterval(C,this._tickRate,this,!1),this._rafHandle=requestAnimationFrame(this._rafFunction)):(this._paused=!0,this._frameTime=h(1,(d()-this._lastTick)/this._tickRate),clearInterval(this._tickInterval)))}});var x=document.exitFullscreen||document.cancelFullscreen||document.cancelFullScreen||document.webkitCancelFullscreen||document.webkitCancelFullScreen||document.mozCancelFullscreen||document.mozCancelFullScreen||function(){};function k(e){e._fullscreenActive=document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||!1,!e.stickyFullscreen&&e._fullscreenActive&&(e._wantFullscreen=!1)}Object.defineProperty(b,"fullscreen",{get:function(){return this._fullscreenActive},set:function(e){!e?(this._wantFullscreen=!1,(document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||!1)&&x.call(document)):(this._wantFullscreen=!0,_(this));return this._fullscreenActive}});var O=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock||function(){};function P(e,t){e._pointerLockActive=e.element===(document.pointerLockElement||document.mozPointerLockElement||document.webkitPointerLockElement||null),!e.stickyPointerLock&&e._pointerLockActive&&(e._wantPointerLock=!1)}function S(e,t,n){e._curKeyState[t]!==n&&(n?e._pressCount[t]++:e._releaseCount[t]++,e._curKeyState[t]=n)}function C(e,t){!function(e){var t,n,r,i=d()+e.frameSkip,o=e._pressCount,s=e._releaseCount,a=e._tickRate,u=m.length;for(;!e._paused&&d()>=e._lastTick+a;){if(d()>i)return void(e._lastTick=d()+a);for(n=d(),e.emit("tick"),r=d(),e.tickTime=r-n,++e.tickCount,e._lastTick+=a,t=0;t<u;++t)o[t]=s[t]=0;e._pointerLockActive?(e.prevMouseX=e.mouseX=e.width>>1,e.prevMouseY=e.mouseY=e.height>>1):(e.prevMouseX=e.mouseX,e.prevMouseY=e.mouseY),e.scroll[0]=e.scroll[1]=e.scroll[2]=0}}(e),t&&function(e){var t;e._rafHandle=requestAnimationFrame(e._rafFunction),t=e._paused?e._frameTime:h(1,(d()-e._lastTick)/e._tickRate);++e.frameCount;var n=d();e.emit("render",t);var r=d();e.frameTime=r-n}(e)}function j(e,t){e.preventDefaults&&t.preventDefault(),e.stopPropagation&&t.stopPropagation()}function E(e,t){j(e,t);var n=g(t.keyCode||t.char||t.which||t.charCode);n>=0&&S(e,n,!1)}function A(e,t){if(function(e){return document.activeElement===document.body||document.activeElement===e.element}(e))if(j(e,t),t.metaKey)N(e,t);else{var n=g(t.keyCode||t.char||t.which||t.charCode);n>=0&&S(e,n,!0)}}Object.defineProperty(b,"pointerLock",{get:function(){return this._pointerLockActive},set:function(e){return!!e?(this._wantPointerLock=!0,_(this)):(this._wantPointerLock=!1,O.call(document)),this._pointerLockActive}}),Object.defineProperty(b,"width",{get:function(){return this.element.clientWidth}}),Object.defineProperty(b,"height",{get:function(){return this.element.clientHeight}});var M=c(32).map((function(e){return y("mouse-"+(e+1))}));function T(e,t){if(j(e,t),e._pointerLockActive){var n=t.movementX||t.mozMovementX||t.webkitMovementX||0,r=t.movementY||t.mozMovementY||t.webkitMovementY||0;e.mouseX+=n,e.mouseY+=r}else e.mouseX=t.clientX-e.element.offsetLeft,e.mouseY=t.clientY-e.element.offsetTop;return!1}function I(e,t){return j(e,t),S(e,M[t.button],!0),!1}function D(e,t){return j(e,t),S(e,M[t.button],!1),!1}function z(e,t){return j(e,t),e._pointerLockActive?(e.prevMouseX=e.mouseX=e.width>>1,e.prevMouseY=e.mouseY=e.height>>1):(e.prevMouseX=e.mouseX=t.clientX-e.element.offsetLeft,e.prevMouseY=e.mouseY=t.clientY-e.element.offsetTop),!1}function B(e,t){return j(e,t),function(e,t){for(var n=0;n<32;++n)S(e,M[n],!!(t&1<<n))}(e,0),!1}function L(e,t){j(e,t);var n=1;switch(t.deltaMode){case 0:n=1;break;case 1:n=12;break;case 2:n=e.height}return e.scroll[0]+=t.deltaX*n,e.scroll[1]+=t.deltaY*n,e.scroll[2]+=t.deltaZ*n||0,!1}function R(e,t){return j(e,t),!1}function N(e,t){var n,r=m.length,i=e._curKeyState,o=e._releaseCount;for(n=0;n<r;++n)i[n]&&++o[n],i[n]=!1;return!1}function F(e,t){var n=0|e.element.clientWidth,r=0|e.element.clientHeight;n===e._width&&r===e._height||(e._width=n,e._height=r,e.emit("resize",n,r))}function U(){var e=document.createElement("div");return e.tabindex=1,e.style.position="absolute",e.style.left="0px",e.style.right="0px",e.style.top="0px",e.style.bottom="0px",e.style.height="100%",e.style.overflow="hidden",document.body.appendChild(e),document.body.style.overflow="hidden",document.body.style.height="100%",e}e.exports=function(e){var t=!!(e=e||{}).fullscreen,n=t;void 0!==typeof e.pointerLock&&(n=!!e.pointerLock);var r=new v;return r._tickRate=e.tickRate||30,r.frameSkip=e.frameSkip||5*(r._tickRate+5),r.stickyFullscreen=!!e.stickyFullscreen||!!e.sticky,r.stickyPointerLock=!!e.stickyPointerLock||!!e.sticky,e.bindings&&(r.bindings=e.bindings),setTimeout((function(){o((function(){var i=e.element;if("string"==typeof i){var o=document.querySelector(i);o||(o=document.getElementById(i)),o||(o=document.getElementByClass(i)[0]),o||(o=U()),r.element=o}else r.element="object"==typeof i&&i?i:"function"==typeof i?i():U();r.element.style&&(r.element.style["-webkit-touch-callout"]="none",r.element.style["-webkit-user-select"]="none",r.element.style["-khtml-user-select"]="none",r.element.style["-moz-user-select"]="none",r.element.style["-ms-user-select"]="none",r.element.style["user-select"]="none"),r._width=r.element.clientWidth,r._height=r.element.clientHeight;var s=F.bind(void 0,r);"undefined"!=typeof MutationObserver?new MutationObserver(s).observe(r.element,{attributes:!0,subtree:!0}):r.element.addEventListener("DOMSubtreeModified",s,!1);window.addEventListener("resize",s,!1),window.addEventListener("keydown",A.bind(void 0,r),!1),window.addEventListener("keyup",E.bind(void 0,r),!1),r.element.oncontextmenu=R.bind(void 0,r),r.element.addEventListener("mousedown",I.bind(void 0,r),!1),r.element.addEventListener("mouseup",D.bind(void 0,r),!1),r.element.addEventListener("mousemove",T.bind(void 0,r),!1),r.element.addEventListener("mouseenter",z.bind(void 0,r),!1);var a=B.bind(void 0,r);r.element.addEventListener("mouseleave",a,!1),r.element.addEventListener("mouseout",a,!1),window.addEventListener("mouseleave",a,!1),window.addEventListener("mouseout",a,!1);var u=N.bind(void 0,r);r.element.addEventListener("blur",u,!1),r.element.addEventListener("focusout",u,!1),r.element.addEventListener("focus",u,!1),window.addEventListener("blur",u,!1),window.addEventListener("focusout",u,!1),window.addEventListener("focus",u,!1),f(r.element,L.bind(void 0,r),!1);var l=k.bind(void 0,r);document.addEventListener("fullscreenchange",l,!1),document.addEventListener("mozfullscreenchange",l,!1),document.addEventListener("webkitfullscreenchange",l,!1),r.element.addEventListener("click",_.bind(void 0,r),!1);var c=P.bind(void 0,r);document.addEventListener("pointerlockchange",c,!1),document.addEventListener("mozpointerlockchange",c,!1),document.addEventListener("webkitpointerlockchange",c,!1),document.addEventListener("pointerlocklost",c,!1),document.addEventListener("webkitpointerlocklost",c,!1),document.addEventListener("mozpointerlocklost",c,!1),r.fullscreen=t,r.pointerLock=n,r.bind("mouse-left","mouse-1"),r.bind("mouse-right","mouse-3"),r.bind("mouse-middle","mouse-2"),r._lastTick=d(),r.startTime=d(),r.paused=!1,r.emit("init")}))}),0),r}},function(e,t,n){(function(e){var r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},i=/%[sdj%]/g;t.format=function(e){if(!g(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(a(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,s=String(e).replace(i,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),u=r[n];n<o;u=r[++n])m(u)||!w(u)?s+=" "+u:s+=" "+a(u);return s},t.deprecate=function(n,r){if(void 0!==e&&!0===e.noDeprecation)return n;if(void 0===e)return function(){return t.deprecate(n,r).apply(this,arguments)};var i=!1;return function(){if(!i){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),i=!0}return n.apply(this,arguments)}};var o,s={};function a(e,n){var r={seen:[],stylize:l};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),p(n)?r.showHidden=n:n&&t._extend(r,n),v(r.showHidden)&&(r.showHidden=!1),v(r.depth)&&(r.depth=2),v(r.colors)&&(r.colors=!1),v(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=u),c(r,e,r.depth)}function u(e,t){var n=a.styles[t];return n?"["+a.colors[n][0]+"m"+e+"["+a.colors[n][1]+"m":e}function l(e,t){return e}function c(e,n,r){if(e.customInspect&&n&&k(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,e);return g(i)||(i=c(e,i,r)),i}var o=function(e,t){if(v(t))return e.stylize("undefined","undefined");if(g(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(y(t))return e.stylize(""+t,"number");if(p(t))return e.stylize(""+t,"boolean");if(m(t))return e.stylize("null","null")}(e,n);if(o)return o;var s=Object.keys(n),a=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(n)),x(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return h(n);if(0===s.length){if(k(n)){var u=n.name?": "+n.name:"";return e.stylize("[Function"+u+"]","special")}if(b(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(_(n))return e.stylize(Date.prototype.toString.call(n),"date");if(x(n))return h(n)}var l,w="",O=!1,P=["{","}"];(d(n)&&(O=!0,P=["[","]"]),k(n))&&(w=" [Function"+(n.name?": "+n.name:"")+"]");return b(n)&&(w=" "+RegExp.prototype.toString.call(n)),_(n)&&(w=" "+Date.prototype.toUTCString.call(n)),x(n)&&(w=" "+h(n)),0!==s.length||O&&0!=n.length?r<0?b(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),l=O?function(e,t,n,r,i){for(var o=[],s=0,a=t.length;s<a;++s)j(t,String(s))?o.push(f(e,t,n,r,String(s),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(f(e,t,n,r,i,!0))})),o}(e,n,r,a,s):s.map((function(t){return f(e,n,r,a,t,O)})),e.seen.pop(),function(e,t,n){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(l,w,P)):P[0]+w+P[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,n,r,i,o){var s,a,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?a=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(a=e.stylize("[Setter]","special")),j(r,i)||(s="["+i+"]"),a||(e.seen.indexOf(u.value)<0?(a=m(n)?c(e,u.value,null):c(e,u.value,n-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),v(s)){if(o&&i.match(/^\d+$/))return a;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function d(e){return Array.isArray(e)}function p(e){return"boolean"==typeof e}function m(e){return null===e}function y(e){return"number"==typeof e}function g(e){return"string"==typeof e}function v(e){return void 0===e}function b(e){return w(e)&&"[object RegExp]"===O(e)}function w(e){return"object"==typeof e&&null!==e}function _(e){return w(e)&&"[object Date]"===O(e)}function x(e){return w(e)&&("[object Error]"===O(e)||e instanceof Error)}function k(e){return"function"==typeof e}function O(e){return Object.prototype.toString.call(e)}function P(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(n){if(v(o)&&(o=e.env.NODE_DEBUG||""),n=n.toUpperCase(),!s[n])if(new RegExp("\\b"+n+"\\b","i").test(o)){var r=e.pid;s[n]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",n,r,e)}}else s[n]=function(){};return s[n]},t.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=d,t.isBoolean=p,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=y,t.isString=g,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=v,t.isRegExp=b,t.isObject=w,t.isDate=_,t.isError=x,t.isFunction=k,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(295);var S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function C(){var e=new Date,t=[P(e.getHours()),P(e.getMinutes()),P(e.getSeconds())].join(":");return[e.getDate(),S[e.getMonth()],t].join(" ")}function j(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",C(),t.format.apply(t,arguments))},t.inherits=n(296),t._extend=function(e,t){if(!t||!w(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var E="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function A(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(E&&e[E]){var t;if("function"!=typeof(t=e[E]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,E,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,r=new Promise((function(e,r){t=e,n=r})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(e,r){e?n(e):t(r)}));try{e.apply(this,i)}catch(e){n(e)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),E&&Object.defineProperty(t,E,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},t.promisify.custom=E,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var i=n.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var o=this,s=function(){return i.apply(o,arguments)};t.apply(this,n).then((function(t){e.nextTick(s,null,t)}),(function(t){e.nextTick(A,t,s)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.defineProperties(n,r(t)),n}}).call(this,n(294))},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var u,l=[],c=!1,h=-1;function f(){c&&u&&(c=!1,u.length?l=u.concat(l):h=-1,l.length&&d())}function d(){if(!c){var e=a(f);c=!0;for(var t=l.length;t;){for(u=l,l=[];++h<t;)u&&u[h].run();h=-1,t=l.length}u=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||c||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){var r,i,o,s,a;e.exports=(i=[],o=document,s=o.documentElement.doScroll,(a=(s?/^loaded|^c/:/^loaded|^i|^c/).test(o.readyState))||o.addEventListener("DOMContentLoaded",r=function(){for(o.removeEventListener("DOMContentLoaded",r),a=1;r=i.shift();)r()}),function(e){a?setTimeout(e,0):i.push(e)})},function(e,t){var n,r="undefined"!=typeof window?window.navigator.userAgent:"",i=/OS X/.test(r),o=/Opera/.test(r),s=!/like Gecko/.test(r)&&!o,a=e.exports={0:i?"<menu>":"<UNK>",1:"<mouse 1>",2:"<mouse 2>",3:"<break>",4:"<mouse 3>",5:"<mouse 4>",6:"<mouse 5>",8:"<backspace>",9:"<tab>",12:"<clear>",13:"<enter>",16:"<shift>",17:"<control>",18:"<alt>",19:"<pause>",20:"<caps-lock>",21:"<ime-hangul>",23:"<ime-junja>",24:"<ime-final>",25:"<ime-kanji>",27:"<escape>",28:"<ime-convert>",29:"<ime-nonconvert>",30:"<ime-accept>",31:"<ime-mode-change>",27:"<escape>",32:"<space>",33:"<page-up>",34:"<page-down>",35:"<end>",36:"<home>",37:"<left>",38:"<up>",39:"<right>",40:"<down>",41:"<select>",42:"<print>",43:"<execute>",44:"<snapshot>",45:"<insert>",46:"<delete>",47:"<help>",91:"<meta>",92:"<meta>",93:i?"<meta>":"<menu>",95:"<sleep>",106:"<num-*>",107:"<num-+>",108:"<num-enter>",109:"<num--\x3e",110:"<num-.>",111:"<num-/>",144:"<num-lock>",145:"<scroll-lock>",160:"<shift-left>",161:"<shift-right>",162:"<control-left>",163:"<control-right>",164:"<alt-left>",165:"<alt-right>",166:"<browser-back>",167:"<browser-forward>",168:"<browser-refresh>",169:"<browser-stop>",170:"<browser-search>",171:"<browser-favorites>",172:"<browser-home>",173:i&&s?"-":"<volume-mute>",174:"<volume-down>",175:"<volume-up>",176:"<next-track>",177:"<prev-track>",178:"<stop>",179:"<play-pause>",180:"<launch-mail>",181:"<launch-media-select>",182:"<launch-app 1>",183:"<launch-app 2>",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"<meta>",224:"<meta>",226:"<alt-gr>",229:"<ime-process>",231:o?"`":"<unicode>",246:"<attention>",247:"<crsel>",248:"<exsel>",249:"<erase-eof>",250:"<play>",251:"<zoom>",252:"<no-name>",253:"<pa-1>",254:"<clear>"};for(n=58;n<65;++n)a[n]=String.fromCharCode(n);for(n=48;n<58;++n)a[n]=n-48+"";for(n=65;n<91;++n)a[n]=String.fromCharCode(n);for(n=96;n<106;++n)a[n]="<num-"+(n-96)+">";for(n=112;n<136;++n)a[n]="F"+(n-111)},function(e,t,n){"use strict";e.exports=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}},function(e,t,n){"use strict";e.exports=function(e,t,n){return 0===e.length?e:t?(n||e.sort(t),function(e,t){for(var n=1,r=e.length,i=e[0],o=e[0],s=1;s<r;++s)if(o=i,t(i=e[s],o)){if(s===n){n++;continue}e[n++]=i}return e.length=n,e}(e,t)):(n||e.sort(),function(e){for(var t=1,n=e.length,r=e[0],i=e[0],o=1;o<n;++o,i=r)if(i=r,(r=e[o])!==i){if(o===t){t++;continue}e[t++]=r}return e.length=t,e}(e))}},function(e,t,n){"use strict";function r(e,t,n,r,i,o){var s=["function ",e,"(a,l,h,",r.join(","),"){",o?"":"var i=",n?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",i?".get(m)":"[m]"];return o?t.indexOf("c")<0?s.push(";if(x===y){return m}else if(x<=y){"):s.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):s.push(";if(",t,"){i=m;"),n?s.push("l=m+1}else{h=m-1}"):s.push("h=m-1}else{l=m+1}"),s.push("}"),o?s.push("return -1};"):s.push("return i};"),s.join("")}function i(e,t,n,i){return new Function([r("A","x"+e+"y",t,["y"],!1,i),r("B","x"+e+"y",t,["y"],!0,i),r("P","c(x,y)"+e+"0",t,["y","c"],!1,i),r("Q","c(x,y)"+e+"0",t,["y","c"],!0,i),"function dispatchBsearch",n,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",n].join(""))()}e.exports={ge:i(">=",!1,"GE"),gt:i(">",!1,"GT"),lt:i("<",!0,"LT"),le:i("<=",!0,"LE"),eq:i("-",!0,"EQ",!0)}},function(e,t){for(var n=0,r=["ms","moz","webkit","o"],i=0;i<r.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[r[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[r[i]+"CancelAnimationFrame"]||window[r[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,t){var r=(new Date).getTime(),i=Math.max(0,16-(r-n)),o=window.setTimeout((function(){e(r+i)}),i);return n=r+i,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})},function(e,t){var n,r,i="";function o(e,t,o,s){e[n](i+t,"wheel"==r?o:function(e){!e&&(e=window.event);var t={originalEvent:e,target:e.target||e.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==e.type?0:1,deltaX:0,delatZ:0,preventDefault:function(){e.preventDefault?e.preventDefault():e.returnValue=!1}};return"mousewheel"==r?(t.deltaY=-1/40*e.wheelDelta,e.wheelDeltaX&&(t.deltaX=-1/40*e.wheelDeltaX)):t.deltaY=e.detail,o(t)},s||!1)}window.addEventListener?n="addEventListener":(n="attachEvent",i="on"),r="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",e.exports=function(e,t,n){o(e,r,t,n),"DOMMouseScroll"==r&&o(e,"MozMousePixelScroll",t,n)}},function(e,t){"object"==typeof window.performance?window.performance.now?e.exports=function(){return window.performance.now()}:window.performance.webkitNow&&(e.exports=function(){return window.performance.webkitNow()}):Date.now?e.exports=Date.now:e.exports=function(){return(new Date).getTime()}},function(e,t,n){var r=n(306),i=n(135).EventEmitter,o=n(307);function s(e,t){this.element=e||document,t=t||{},this.preventDefaults=!!t.preventDefaults,this.stopPropagation=!!t.stopPropagation,this.allowContextMenu=!!t.allowContextMenu,this.disabled=!!t.disabled,this.down=new i,this.up=new i,this.state={dx:0,dy:0,scrollx:0,scrolly:0,scrollz:0},this._keybindmap={},this._keyStates={},this._bindPressCounts={},this._ignoreMousemoveOnce=!1,this.initEvents()}function a(e,t,n){g(n.keyCode,r[n.keyCode],t,e,n)}function u(e,t,n){return g(-1-n.button,"<mouse "+(n.button+1)+">",t,e,n),!1}function l(e){if(!e.allowContextMenu)return!1}function c(e,t){if(e._ignoreMousemoveOnce)e._ignoreMousemoveOnce=!1;else{var n=t.movementX||t.mozMovementX||0,r=t.movementY||t.mozMovementY||0;if(t.touches&&0==(n|r)){var i=function(e){for(var t,n=e.changedTouches,r=0;r<n.length;++r)n[r].identifier==d&&(t=n[r]);if(!t)return[0,0];var i=[t.clientX-h,t.clientY-f];return h=t.clientX,f=t.clientY,i}(t);n=i[0],r=i[1]}e.state.dx+=n,e.state.dy+=r}}e.exports=function(e,t){return new s(e,t)},s.prototype.initEvents=function(){window.addEventListener("keydown",a.bind(void 0,this,!0),!1),window.addEventListener("keyup",a.bind(void 0,this,!1),!1),this.element.addEventListener("mousedown",u.bind(void 0,this,!0),!1),this.element.addEventListener("mouseup",u.bind(void 0,this,!1),!1),this.element.oncontextmenu=l.bind(void 0,this),this.element.addEventListener("dragstart",u.bind(void 0,this,!1),!1),this.element.addEventListener("mousemove",c.bind(void 0,this),!1),this.element.addEventListener("touchmove",c.bind(void 0,this),!1),this.element.addEventListener("touchstart",p.bind(void 0,this),!1),o(this.element,m.bind(void 0,this),!1),document.addEventListener("pointerlockchange",y.bind(void 0,this),!1),document.addEventListener("mozpointerlockchange",y.bind(void 0,this),!1)},s.prototype.bind=function(e){for(var t=1;t<arguments.length;++t){var n=arguments[t],r=this._keybindmap[n]||[];-1==r.indexOf(e)&&r.push(e),this._keybindmap[n]=r}this.state[e]=!!this.state[e]},s.prototype.unbind=function(e){for(var t in this._keybindmap){var n=this._keybindmap[t],r=n.indexOf(e);r>-1&&n.splice(r,1)}},s.prototype.tick=function(){this.state.dx=this.state.dy=0,this.state.scrollx=this.state.scrolly=this.state.scrollz=0},s.prototype.getBoundKeys=function(){var e=[];for(var t in this._keybindmap)e.push(t);return e};var h=0,f=0,d=null;function p(e,t){var n=t.changedTouches[0];h=n.clientX,f=n.clientY,d=n.identifier}function m(e,t){var n=1;switch(t.deltaMode){case 0:n=1;break;case 1:n=12;break;case 2:n=e.element.clientHeight||window.innerHeight}return e.state.scrollx+=t.deltaX*n,e.state.scrolly+=t.deltaY*n,e.state.scrollz+=t.deltaZ*n||0,!1}function y(e,t){(document.pointerLockElement||document.mozPointerLockElement||null)&&(e._ignoreMousemoveOnce=!0)}function g(e,t,n,r,i){var o=r._keybindmap[t];if(o){if(r.preventDefaults&&i.preventDefault(),r.stopPropagation&&i.stopPropagation(),b(r._keyStates[e],n))for(var s=0;s<o.length;++s)v(o[s],n,r,i);r._keyStates[e]=n}}function v(e,t,n,r){var i=n._bindPressCounts[e]||0;if((i+=t?1:-1)<0&&(i=0),n._bindPressCounts[e]=i,b(n.state[e],i)){var o=t?n.down:n.up;n.disabled||o.emit(e,r)}n.state[e]=!!i}function b(e,t){return e?!t:t}},function(e,t,n){"use strict";var r,i="undefined"!=typeof window?window.navigator.userAgent:"",o=/OS X/.test(i),s=/Opera/.test(i),a=!/like Gecko/.test(i)&&!s,u=e.exports={0:o?"<menu>":"<UNK>",1:"<mouse 1>",2:"<mouse 2>",3:"<break>",4:"<mouse 3>",5:"<mouse 4>",6:"<mouse 5>",8:"<backspace>",9:"<tab>",12:"<clear>",13:"<enter>",16:"<shift>",17:"<control>",18:"<alt>",19:"<pause>",20:"<caps-lock>",21:"<ime-hangul>",23:"<ime-junja>",24:"<ime-final>",25:"<ime-kanji>",27:"<escape>",28:"<ime-convert>",29:"<ime-nonconvert>",30:"<ime-accept>",31:"<ime-mode-change>",32:"<space>",33:"<page-up>",34:"<page-down>",35:"<end>",36:"<home>",37:"<left>",38:"<up>",39:"<right>",40:"<down>",41:"<select>",42:"<print>",43:"<execute>",44:"<snapshot>",45:"<insert>",46:"<delete>",47:"<help>",91:"<meta>",92:"<meta>",93:o?"<meta>":"<menu>",95:"<sleep>",106:"<num-*>",107:"<num-+>",108:"<num-enter>",109:"<num--\x3e",110:"<num-.>",111:"<num-/>",144:"<num-lock>",145:"<scroll-lock>",160:"<shift-left>",161:"<shift-right>",162:"<control-left>",163:"<control-right>",164:"<alt-left>",165:"<alt-right>",166:"<browser-back>",167:"<browser-forward>",168:"<browser-refresh>",169:"<browser-stop>",170:"<browser-search>",171:"<browser-favorites>",172:"<browser-home>",173:o&&a?"-":"<volume-mute>",174:"<volume-down>",175:"<volume-up>",176:"<next-track>",177:"<prev-track>",178:"<stop>",179:"<play-pause>",180:"<launch-mail>",181:"<launch-media-select>",182:"<launch-app 1>",183:"<launch-app 2>",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"<meta>",224:"<meta>",226:"<alt-gr>",229:"<ime-process>",231:s?"`":"<unicode>",246:"<attention>",247:"<crsel>",248:"<exsel>",249:"<erase-eof>",250:"<play>",251:"<zoom>",252:"<no-name>",253:"<pa-1>",254:"<clear>"};for(r=58;r<65;++r)u[r]=String.fromCharCode(r);for(r=48;r<58;++r)u[r]=r-48+"";for(r=65;r<91;++r)u[r]=String.fromCharCode(r);for(r=96;r<106;++r)u[r]="<num-"+(r-96)+">";for(r=112;r<136;++r)u[r]="F"+(r-111)},function(e,t){var n,r,i="";function o(e,t,o,s){e[n](i+t,"wheel"==r?o:function(e){!e&&(e=window.event);var t={originalEvent:e,target:e.target||e.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==e.type?0:1,deltaX:0,delatZ:0,preventDefault:function(){e.preventDefault?e.preventDefault():e.returnValue=!1}};return"mousewheel"==r?(t.deltaY=-1/40*e.wheelDelta,e.wheelDeltaX&&(t.deltaX=-1/40*e.wheelDeltaX)):t.deltaY=e.detail,o(t)},s||!1)}window.addEventListener?n="addEventListener":(n="attachEvent",i="on"),r="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",e.exports=function(e,t,n){o(e,r,t,n),"DOMMouseScroll"==r&&o(e,"MozMousePixelScroll",t,n)}},function(e,t,n){"use strict";var r=n(208),i=n(76),o=n(236),s=n(309);e.exports=function(e,t,n){return new u(e,t,n)};var a={gravity:[0,-10,0],minBounceImpulse:.5,airDrag:.1,fluidDrag:.4,fluidDensity:2};function u(e,t,n){e=Object.assign({},a,e),this.gravity=e.gravity,this.airDrag=e.airDrag,this.fluidDensity=e.fluidDensity,this.fluidDrag=e.fluidDrag,this.minBounceImpulse=e.minBounceImpulse,this.bodies=[],this.testSolid=t,this.testFluid=n}u.prototype.addBody=function(e,t,n,i,o,a){e=e||new r([0,0,0],[1,1,1]),void 0===t&&(t=1),void 0===n&&(n=1),void 0===i&&(i=0),void 0===o&&(o=1);var u=new s(e,t,n,i,o,a);return this.bodies.push(u),u},u.prototype.removeBody=function(e){var t=this.bodies.indexOf(e);t<0||(this.bodies.splice(t,1),e.aabb=e.onCollide=null)};var l=i.create(),c=i.create(),h=i.create(),f=i.create(),d=i.create();u.prototype.tick=function(e){e/=1e3;var t=O(0,i.squaredLength(this.gravity));this.bodies.forEach(n=>function(e,t,n,r){if(i.copy(d,t.resting),t.mass<=0)return i.set(t.velocity,0,0,0),i.set(t._forces,0,0,0),void i.set(t._impulses,0,0,0);var s=r||0===t.gravityMultiplier;if(function(e,t,n,r){if(t._sleepFrameCount>0)return!1;if(r)return!0;var s=!1,a=.5*n*n*t.gravityMultiplier;return i.scale(k,e.gravity,a),o(e.testSolid,t.aabb,k,(function(){return s=!0,!0}),!0),s}(e,t,n,s))return;t._sleepFrameCount--,function(e,t){var n=t.aabb,r=Math.floor(n.base[0]),o=Math.floor(n.base[2]),s=Math.floor(n.base[1]),a=Math.floor(n.max[1]);if(!e.testFluid(r,s,o))return t.inFluid=!1,void(t.ratioInFluid=0);var u=1,l=s+1;for(;l<=a&&e.testFluid(r,l,o);)u++,l++;var c=(s+u-n.base[1])/n.vec[1];c>1&&(c=1);var h=n.vec[0]*n.vec[1]*n.vec[2]*c,f=p;i.scale(f,e.gravity,-e.fluidDensity*h),t.applyForce(f),t.inFluid=!0,t.ratioInFluid=c}(e,t),S(t._forces),S(t._impulses),S(t.velocity),S(t.resting),i.scale(l,t._forces,1/t.mass),i.scaleAndAdd(l,l,e.gravity,t.gravityMultiplier),i.scale(c,t._impulses,1/t.mass),i.scaleAndAdd(c,c,l,n),i.add(t.velocity,t.velocity,c),t.friction&&(m(0,t,c),m(1,t,c),m(2,t,c));var a=t.airDrag>=0?t.airDrag:e.airDrag;t.inFluid&&(a=t.fluidDrag>=0?t.fluidDrag:e.fluidDrag,a*=1-(1-t.ratioInFluid)**2);var u=Math.max(1-a*n/t.mass,0);i.scale(t.velocity,t.velocity,u),i.scale(h,t.velocity,n),i.set(t._forces,0,0,0),i.set(t._impulses,0,0,0),t.autoStep&&P(v,t.aabb);g(e,t.aabb,h,t.resting),t.autoStep&&function(e,t,n,r){if(t.resting[1]>=0&&!t.inFluid)return;var s=0!==t.resting[0],a=0!==t.resting[2];if(!s&&!a)return;var u=Math.abs(r[0]/r[2]);if(!s&&u>4)return;if(!a&&u<1/4)return;i.add(w,n.base,r);var l=e.testSolid;o(l,n,r,(function(e,t,n,r){if(1!==t)return!0;r[t]=0}));var c=t.aabb.base[1],h=Math.floor(c+1.001)-c;i.set(_,0,h,0);var f=!1;if(o(l,n,_,(function(e,t,n,r){return f=!0,!0})),f)return;if(i.subtract(x,w,n.base),x[1]=0,g(e,n,x,b),s&&!O(n.base[0],w[0]))return;if(a&&!O(n.base[2],w[2]))return;P(t.aabb,n),t.resting[0]=b[0],t.resting[2]=b[2],t.onStep&&t.onStep()}(e,t,v,h);for(var y=0;y<3;++y)f[y]=0,t.resting[y]&&(d[y]||(f[y]=-t.velocity[y]),t.velocity[y]=0);var C=i.length(f);C>.001&&(i.scale(f,f,t.mass),t.onCollide&&t.onCollide(f),t.restitution>0&&C>e.minBounceImpulse&&(i.scale(f,f,t.restitution),t.applyImpulse(f)));i.squaredLength(t.velocity)>1e-5&&t._markActive()}(this,n,e,t))};var p=i.create();function m(e,t,n){var r=t.resting[e],o=n[e];if(0!==r&&!(r*o<=0)){i.copy(y,t.velocity),y[e]=0;var s=i.length(y);if(!O(s,0)){var a=Math.abs(t.friction*o),u=s>a?(s-a)/s:0;t.velocity[(e+1)%3]*=u,t.velocity[(e+2)%3]*=u}}}var y=i.create();function g(e,t,n,r){return i.set(r,0,0,0),o(e.testSolid,t,n,(function(e,t,n,i){r[t]=n,i[t]=0}))}var v=new r([],[]),b=i.create(),w=i.create(),_=i.create(),x=i.create();var k=i.create();function O(e,t){return Math.abs(e-t)<1e-5}function P(e,t){for(var n=0;n<3;n++)e.base[n]=t.base[n],e.max[n]=t.max[n],e.vec[n]=t.vec[n]}var S=function(){}},function(e,t,n){"use strict";var r=n(208),i=n(76);function o(e,t,n,o,s,a,u){this.aabb=new r(e.base,e.vec),this.mass=t,this.friction=n,this.restitution=o,this.gravityMultiplier=s,this.onCollide=a,this.autoStep=!!u,this.airDrag=-1,this.fluidDrag=-1,this.onStep=null,this.velocity=i.create(),this.resting=[0,0,0],this.inFluid=!1,this._ratioInFluid=0,this._forces=i.create(),this._impulses=i.create(),this._sleepFrameCount=10}e.exports=o,o.prototype.setPosition=function(e){s(e),i.subtract(e,e,this.aabb.base),this.aabb.translate(e),this._markActive()},o.prototype.getPosition=function(){return i.clone(this.aabb.base)},o.prototype.applyForce=function(e){s(e),i.add(this._forces,this._forces,e),this._markActive()},o.prototype.applyImpulse=function(e){s(e),i.add(this._impulses,this._impulses,e),this._markActive()},o.prototype._markActive=function(){this._sleepFrameCount=10},o.prototype.atRestX=function(){return this.resting[0]},o.prototype.atRestY=function(){return this.resting[1]},o.prototype.atRestZ=function(){return this.resting[2]};var s=function(){}},function(e,t,n){"use strict";e.exports=
/*!
 * ent-comp: a light, *fast* Entity Component System in JS
 * @url      github.com/andyhall/ent-comp
 * @author   Andy Hall <andy@fenomas.com>
 * @license  MIT
*/
function e(){var t=this;this.components={},this.comps=this.components;var n=this.components,i=1,o={},s=[],a=[],u=[],l=[],c=[];function h(e){Object.keys(o).forEach(t=>{o[t].hash[e]&&f(e,t)})}function f(e,t){var i=n[t],s=o[t];s&&s.hash[e]&&(i.onRemove&&(i.multi?s.hash[e].forEach(t=>{i.onRemove(e,t)}):i.onRemove(e,s.hash[e])),i.multi&&(s.hash[e].length=0),r.remove(s,e))}function d(e,t,r){var i=n[t],s=o[t].hash[e];if(s){var a=s.indexOf(r);a<0||(i.onRemove&&i.onRemove(e,r),s.splice(a,1),0===s.length&&f(e,t))}}function p(){m||(m=!0,setTimeout((function(){m=!1,y()}),1))}this._storage=o,this._systems=s,this._renderSystems=a,this.createEntity=function(e){var n=i++;return e&&e.length&&e.forEach(e=>t.addComponent(n,e)),n},this.deleteEntity=function(e,n){return n?h(e):(u.push(e),p()),t},this.createComponent=function(e){if(!e)throw"Missing component definition";var t=e.name;if(!t)throw"Component definition must have a name property.";if("string"!=typeof t)throw"Component name must be a string.";if(""===t)throw"Component name must be a non-empty string.";if(o[t])throw`Component ${t} already exists.`;var i={};return i.name=t,i.order=isNaN(e.order)?99:e.order,i.state=e.state||{},i.onAdd=e.onAdd||null,i.onRemove=e.onRemove||null,i.system=e.system||null,i.renderSystem=e.renderSystem||null,i.multi=!!e.multi,n[t]=i,o[t]=r.create(),i.system&&(s.push(t),s.sort((e,t)=>n[e].order-n[t].order)),i.renderSystem&&(a.push(t),a.sort((e,t)=>n[e].order-n[t].order)),t},this.deleteComponent=function(e){var r=o[e];if(!r)throw"Unknown component: "+e;r.list.forEach(n=>{var r=n.__id||n[0].__id;t.removeComponent(r,e,!0)});var i=s.indexOf(e),u=a.indexOf(e);return i>-1&&s.splice(i,1),u>-1&&a.splice(u,1),delete n[e],delete o[e],t},this.addComponent=function(e,t,i){var s=n[t],a=o[t];if(!a)throw`Unknown component: ${t}.`;var u=!1;if(l.forEach(n=>{n.id===e&&n.compName===t&&(u=!0)}),u&&g(),a.hash[e]&&!s.multi)throw`Entity ${e} already has component: ${t}.`;var c=Object.assign({},{__id:e},s.state,i);if(c.__id=e,s.multi){var h=a.hash[e];h||(h=[],r.add(a,e,h)),h.push(c)}else r.add(a,e,c);return s.onAdd&&s.onAdd(e,c),this},this.hasComponent=function(e,t){var n=o[t];if(!n)throw`Unknown component: ${t}.`;return void 0!==n.hash[e]},this.removeComponent=function(e,r,i){var s=n[r],a=o[r];if(!a)throw`Unknown component: ${r}.`;if(!a.hash[e]){if(s.multi)return t;throw`Entity ${e} does not have component: ${r} to remove.`}return i?f(e,r):(l.push({id:e,compName:r}),p()),t},this.getState=function(e,t){var n=o[t];if(!n)throw`Unknown component: ${t}.`;return n.hash[e]},e.prototype.getStatesList=function(e){var t=o[e];if(!t)throw`Unknown component: ${e}.`;return t.list},this.getStateAccessor=function(e){if(!o[e])throw`Unknown component: ${e}.`;var t=o[e].hash;return function(e){return t[e]}},this.getComponentAccessor=function(e){if(!o[e])throw`Unknown component: ${e}.`;var t=o[e].hash;return function(e){return void 0!==t[e]}},this.tick=function(e){return y(),s.forEach(t=>{var r=o[t].list;n[t].system(e,r)}),y(),t},this.render=function(e){return y(),a.forEach(t=>{var r=o[t].list;n[t].renderSystem(e,r)}),y(),t},this.removeMultiComponent=function(e,r,i,s){var a=n[r],u=o[r];if(!u)throw`Unknown component: ${r}.`;if(!a.multi)throw"removeMultiComponent called on non-multi component";var l=u.hash[e];if(!l||!l[i])throw`Multicomponent ${r} instance not found at index ${i}`;var h=l[i];return s?d(e,r,h):c.push({id:e,compName:r,state:h}),t};var m=!1;function y(){g(),function(e){for(;c.length;){var t=c.pop();d(t.id,t.compName,t.state),t.state=null}}(),function(){for(;u.length;){h(u.pop())}}()}function g(){for(;l.length;){var e=l.pop();f(e.id,e.compName)}}};var r=n(311)},function(e,t,n){"use strict";e.exports={create:function(){return{list:[],hash:{},_map:{}}},add:function(e,t,n){e.list.push(n),e.hash[t]=n,e._map[t]=e.list.length-1},remove:function(e,t){var n=e._map[t];if(n===e.list.length-1)e.list.pop();else{var r=e.list.pop();e.list[n]=r;var i=r.__id||r[0].__id;e._map[i]=n}delete e.hash[t],delete e._map[t]}}},function(e,t,n){var r={"./collideEntities.js":313,"./collideTerrain.js":324,"./fadeOnZoom.js":325,"./followsEntity.js":326,"./mesh.js":327,"./movement.js":328,"./physics.js":216,"./position.js":215,"./receivesInputs.js":329,"./shadow.js":330,"./smoothCamera.js":331};function i(e){var t=o(e);return n(t)}function o(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}i.keys=function(){return Object.keys(r)},i.resolve=o,e.exports=i,i.id=312},function(e,t,n){"use strict";n.r(t);var r=n(314);t.default=function(e){var t=[];return{name:"collideEntities",order:70,state:{cylinder:!1,collideBits:1,collideMask:1,callback:null},onAdd:null,onRemove:null,system:function(i,o){for(var s=e.ents,a=0;a<o.length;a++){var u=o[a].__id,l=s.getPositionData(u);t[a]=l._extents}t.length=o.length,r(t,(function(r,i){var s=o[r],a=o[i];(function(e,t,r,i){if(e.cylinder)return t.cylinder?function(e,t){var n=(e[3]-e[0])/2,r=(t[3]-t[0])/2,i=e[0]+n-(t[0]+r),o=e[2]+n-(t[2]+r),s=n+r;return i*i+o*o<=s*s}(r,i):n(r,i);if(t.cylinder)return n(i,r);return!0})(s,a,t[r],t[i])&&function(e,t,n){var r=t.__id,i=n.__id;t.collideMask&n.collideBits&&t.callback&&t.callback(i);n.collideMask&t.collideBits&&n.callback&&n.callback(r);e.ents.onPairwiseEntityCollision(r,i)}(e,s,a)}))}};function n(e,t){var n=(e[3]-e[0])/2,r=e[0]+n,o=e[2]+n,s=i(r,t[0],t[3])-r,a=i(o,t[2],t[5])-o;return s*s+a*a<=n*n}function i(e,t,n){return e<t?t:e>n?n:e}}},function(e,t,n){"use strict";e.exports=function(e,t,n){switch(arguments.length){case 1:return h(e);case 2:return"function"==typeof t?l(e,e,t,!0):f(e,t);case 3:return l(e,t,n,!1);default:throw new Error("box-intersect: Invalid arguments")}};var r,i=n(209),o=n(237),s=n(321);function a(e,t){for(var n=0;n<e;++n)if(!(t[n]<=t[n+e]))return!0;return!1}function u(e,t,n,r){for(var i=0,o=0,s=0,u=e.length;s<u;++s){var l=e[s];if(!a(t,l)){for(var c=0;c<2*t;++c)n[i++]=l[c];r[o++]=s}}return o}function l(e,t,n,r){var a=e.length,l=t.length;if(!(a<=0||l<=0)){var c=e[0].length>>>1;if(!(c<=0)){var h,f=i.mallocDouble(2*c*a),d=i.mallocInt32(a);if((a=u(e,c,f,d))>0){if(1===c&&r)o.init(a),h=o.sweepComplete(c,n,0,a,f,d,0,a,f,d);else{var p=i.mallocDouble(2*c*l),m=i.mallocInt32(l);(l=u(t,c,p,m))>0&&(o.init(a+l),h=1===c?o.sweepBipartite(c,n,0,a,f,d,0,l,p,m):s(c,n,r,a,f,d,l,p,m),i.free(p),i.free(m))}i.free(f),i.free(d)}return h}}}function c(e,t){r.push([e,t])}function h(e){return r=[],l(e,e,c,!0),r}function f(e,t){return r=[],l(e,t,c,!1),r}},function(e,t,n){"use strict";e.exports=function(e,t){switch(void 0===t&&(t=0),typeof e){case"number":if(e>0)return function(e,t){var n,r;for(n=new Array(e),r=0;r<e;++r)n[r]=t;return n}(0|e,t);break;case"object":if("number"==typeof e.length)return function e(t,n,r){var i=0|t[r];if(i<=0)return[];var o,s=new Array(i);if(r===t.length-1)for(o=0;o<i;++o)s[o]=n;else for(o=0;o<i;++o)s[o]=e(t,n,r+1);return s}(e,t,0)}return[]}},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n(317),i=n(318),o=n(319);function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return l(this,e,t,n)}function l(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=f(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n),i=(e=a(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(u.isBuffer(t)){var n=0|d(t.length);return 0===(e=a(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?a(e,0):f(e,t);if("Buffer"===t.type&&o(t.data))return f(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(c(t),e=a(e,t<0?0:0|d(t)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function f(e,t){var n=t.length<0?0:0|d(t.length);e=a(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function d(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function p(e,t){if(u.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return F(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return U(e).length;default:if(r)return F(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return E(this,t,n);case"utf8":case"utf-8":return S(this,t,n);case"ascii":return C(this,t,n);case"latin1":case"binary":return j(this,t,n);case"base64":return P(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function y(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function g(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=u.from(t,r)),u.isBuffer(t))return 0===t.length?-1:v(e,t,n,r,i);if("number"==typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,r,i){var o,s=1,a=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,u/=2,n/=2}function l(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var c=-1;for(o=n;o<a;o++)if(l(e,o)===l(t,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===u)return c*s}else-1!==c&&(o-=o-c),c=-1}else for(n+u>a&&(n=a-u),o=n;o>=0;o--){for(var h=!0,f=0;f<u;f++)if(l(e,o+f)!==l(t,f)){h=!1;break}if(h)return o}return-1}function b(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function w(e,t,n,r){return V(F(t,e.length-n),e,n,r)}function _(e,t,n,r){return V(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function x(e,t,n,r){return _(e,t,n,r)}function k(e,t,n,r){return V(U(t),e,n,r)}function O(e,t,n,r){return V(function(e,t){for(var n,r,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function P(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function S(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,s,a,u,l=e[i],c=null,h=l>239?4:l>223?3:l>191?2:1;if(i+h<=n)switch(h){case 1:l<128&&(c=l);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&l)<<6|63&o)>127&&(c=u);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(u=(15&l)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(c=u);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(u=(15&l)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(c=u)}null===c?(c=65533,h=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),i+=h}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}t.Buffer=u,t.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},t.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,n){return l(null,e,t,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,n){return function(e,t,n,r){return c(t),t<=0?a(e,t):void 0!==n?"string"==typeof r?a(e,t).fill(n,r):a(e,t).fill(n):a(e,t)}(null,e,t,n)},u.allocUnsafe=function(e){return h(null,e)},u.allocUnsafeSlow=function(e){return h(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=u.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var s=e[n];if(!u.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?S(this,0,e):m.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,n,r,i){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0),a=Math.min(o,s),l=this.slice(r,i),c=e.slice(t,n),h=0;h<a;++h)if(l[h]!==c[h]){o=l[h],s=c[h];break}return o<s?-1:s<o?1:0},u.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},u.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},u.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},u.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return w(this,e,t,n);case"ascii":return _(this,e,t,n);case"latin1":case"binary":return x(this,e,t,n);case"base64":return k(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function C(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function j(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function E(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=N(e[o]);return i}function A(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function M(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function T(e,t,n,r,i,o){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function I(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function D(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function z(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(e,t,n,r,o){return o||z(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function L(e,t,n,r,o){return o||z(e,0,n,8),i.write(e,t,n,r,52,8),n+8}u.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=u.prototype;else{var i=t-e;n=new u(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+e]}return n},u.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},u.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},u.prototype.readUInt8=function(e,t){return t||M(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||M(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||M(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||M(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||M(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},u.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},u.prototype.readInt8=function(e,t){return t||M(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||M(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(e,t){t||M(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(e,t){return t||M(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||M(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||M(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||M(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||M(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||M(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||T(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},u.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||T(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},u.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||T(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||T(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):I(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||T(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):I(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||T(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):D(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||T(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);T(this,e,t,n,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<n&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},u.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);T(this,e,t,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},u.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||T(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||T(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):I(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||T(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):I(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||T(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):D(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||T(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,n){return B(this,e,t,!0,n)},u.prototype.writeFloatBE=function(e,t,n){return B(this,e,t,!1,n)},u.prototype.writeDoubleLE=function(e,t,n){return L(this,e,t,!0,n)},u.prototype.writeDoubleBE=function(e,t,n){return L(this,e,t,!1,n)},u.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},u.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var s=u.isBuffer(e)?e:F(new u(e,r).toString()),a=s.length;for(o=0;o<n-t;++o)this[o+t]=s[o%a]}return this};var R=/[^+\/0-9A-Za-z-_]/g;function N(e){return e<16?"0"+e.toString(16):e.toString(16)}function F(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function U(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(R,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function V(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(150))},function(e,t,n){"use strict";t.byteLength=function(e){var t=l(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=l(e),s=r[0],a=r[1],u=new o(function(e,t,n){return 3*(t+n)/4-n}(0,s,a)),c=0,h=a>0?s-4:s;for(n=0;n<h;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],u[c++]=t>>16&255,u[c++]=t>>8&255,u[c++]=255&t;2===a&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,u[c++]=255&t);1===a&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,u[c++]=t>>8&255,u[c++]=255&t);return u},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],s=0,a=n-i;s<a;s+=16383)o.push(c(e,s,s+16383>a?a:s+16383));1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=s.length;a<u;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,n){for(var i,o,s=[],a=t;a<n;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,l=u>>1,c=-7,h=n?i-1:0,f=n?-1:1,d=e[t+h];for(h+=f,o=d&(1<<-c)-1,d>>=-c,c+=a;c>0;o=256*o+e[t+h],h+=f,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=r;c>0;s=256*s+e[t+h],h+=f,c-=8);if(0===o)o=1-l;else{if(o===u)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,r),o-=l}return(d?-1:1)*s*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var s,a,u,l=8*o-i-1,c=(1<<l)-1,h=c>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=c):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),(t+=s+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(s++,u/=2),s+h>=c?(a=0,s=c):s+h>=1?(a=(t*u-1)*Math.pow(2,i),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[n+d]=255&a,d+=p,a/=256,i-=8);for(s=s<<i|a,l+=i;l>0;e[n+d]=255&s,d+=p,s/=256,l-=8);e[n+d-p]|=128*m}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";e.exports=function(e,t){t<=128?r(0,t-1,e):function e(t,n,c){var h=(n-t+1)/6|0,f=t+h,d=n-h,p=t+n>>1,m=p-h,y=p+h,g=f,v=m,b=p,w=y,_=d,x=t+1,k=n-1,O=0;u(g,v,c)&&(O=g,g=v,v=O);u(w,_,c)&&(O=w,w=_,_=O);u(g,b,c)&&(O=g,g=b,b=O);u(v,b,c)&&(O=v,v=b,b=O);u(g,w,c)&&(O=g,g=w,w=O);u(b,w,c)&&(O=b,b=w,w=O);u(v,_,c)&&(O=v,v=_,_=O);u(v,b,c)&&(O=v,v=b,b=O);u(w,_,c)&&(O=w,w=_,_=O);for(var P=c[2*v],S=c[2*v+1],C=c[2*w],j=c[2*w+1],E=2*g,A=2*b,M=2*_,T=2*f,I=2*p,D=2*d,z=0;z<2;++z){var B=c[E+z],L=c[A+z],R=c[M+z];c[T+z]=B,c[I+z]=L,c[D+z]=R}o(m,t,c),o(y,n,c);for(var N=x;N<=k;++N)if(l(N,P,S,c))N!==x&&i(N,x,c),++x;else if(!l(N,C,j,c))for(;;){if(l(k,C,j,c)){l(k,P,S,c)?(s(N,x,k,c),++x,--k):(i(N,k,c),--k);break}if(--k<N)break}a(t,x-1,P,S,c),a(n,k+1,C,j,c),x-2-t<=32?r(t,x-2,c):e(t,x-2,c);n-(k+2)<=32?r(k+2,n,c):e(k+2,n,c);k-x<=32?r(x,k,c):e(x,k,c)}(0,t-1,e)};function r(e,t,n){for(var r=2*(e+1),i=e+1;i<=t;++i){for(var o=n[r++],s=n[r++],a=i,u=r-2;a-- >e;){var l=n[u-2],c=n[u-1];if(l<o)break;if(l===o&&c<s)break;n[u]=l,n[u+1]=c,u-=2}n[u]=o,n[u+1]=s}}function i(e,t,n){t*=2;var r=n[e*=2],i=n[e+1];n[e]=n[t],n[e+1]=n[t+1],n[t]=r,n[t+1]=i}function o(e,t,n){t*=2,n[e*=2]=n[t],n[e+1]=n[t+1]}function s(e,t,n,r){t*=2,n*=2;var i=r[e*=2],o=r[e+1];r[e]=r[t],r[e+1]=r[t+1],r[t]=r[n],r[t+1]=r[n+1],r[n]=i,r[n+1]=o}function a(e,t,n,r,i){t*=2,i[e*=2]=i[t],i[t]=n,i[e+1]=i[t+1],i[t+1]=r}function u(e,t,n){t*=2;var r=n[e*=2],i=n[t];return!(r<i)&&(r!==i||n[e+1]>n[t+1])}function l(e,t,n,r){var i=r[e*=2];return i<t||i===t&&r[e+1]<n}},function(e,t,n){"use strict";e.exports=function(e,t,n,o,c,x,k,O,P){!function(e,t){var n=8*i.log2(t+1)*(e+1)|0,o=i.nextPow2(6*n);g.length<o&&(r.free(g),g=r.mallocInt32(o));var s=i.nextPow2(2*n);v.length<s&&(r.free(v),v=r.mallocDouble(s))}(e,o+k);var S,C=0,j=2*e;b(C++,0,0,o,0,k,n?16:0,-1/0,1/0),n||b(C++,0,0,k,0,o,1,-1/0,1/0);for(;C>0;){var E=6*(C-=1),A=g[E],M=g[E+1],T=g[E+2],I=g[E+3],D=g[E+4],z=g[E+5],B=2*C,L=v[B],R=v[B+1],N=1&z,F=!!(16&z),U=c,V=x,q=O,K=P;if(N&&(U=O,V=P,q=c,K=x),!(2&z&&(T=d(e,A,M,T,U,V,R),M>=T)||4&z&&(M=p(e,A,M,T,U,V,L))>=T)){var W=T-M,Y=D-I;if(F){if(e*W*(W+Y)<1<<22){if(void 0!==(S=u.scanComplete(e,A,t,M,T,U,V,I,D,q,K)))return S;continue}}else{if(e*Math.min(W,Y)<128){if(void 0!==(S=s(e,A,t,N,M,T,U,V,I,D,q,K)))return S;continue}if(e*W*Y<1<<22){if(void 0!==(S=u.scanBipartite(e,A,t,N,M,T,U,V,I,D,q,K)))return S;continue}}var H=h(e,A,M,T,U,V,L,R);if(M<H)if(e*(H-M)<128){if(void 0!==(S=a(e,A+1,t,M,H,U,V,I,D,q,K)))return S}else if(A===e-2){if(void 0!==(S=N?u.sweepBipartite(e,t,I,D,q,K,M,H,U,V):u.sweepBipartite(e,t,M,H,U,V,I,D,q,K)))return S}else b(C++,A+1,M,H,I,D,N,-1/0,1/0),b(C++,A+1,I,D,M,H,1^N,-1/0,1/0);if(H<T){var G=l(e,A,I,D,q,K),J=q[j*G+A],Z=f(e,A,G,D,q,K,J);if(Z<D&&b(C++,A,H,T,Z,D,(4|N)+(F?16:0),J,R),I<G&&b(C++,A,H,T,I,G,(2|N)+(F?16:0),L,J),G+1===Z){if(void 0!==(S=F?_(e,A,t,H,T,U,V,G,q,K[G]):w(e,A,t,N,H,T,U,V,G,q,K[G])))return S}else if(G<Z){var X;if(F){if(X=m(e,A,H,T,U,V,J),H<X){var $=f(e,A,H,X,U,V,J);if(A===e-2){if(H<$&&void 0!==(S=u.sweepComplete(e,t,H,$,U,V,G,Z,q,K)))return S;if($<X&&void 0!==(S=u.sweepBipartite(e,t,$,X,U,V,G,Z,q,K)))return S}else H<$&&b(C++,A+1,H,$,G,Z,16,-1/0,1/0),$<X&&(b(C++,A+1,$,X,G,Z,0,-1/0,1/0),b(C++,A+1,G,Z,$,X,1,-1/0,1/0))}}else X=N?y(e,A,H,T,U,V,J):m(e,A,H,T,U,V,J),H<X&&(A===e-2?S=N?u.sweepBipartite(e,t,G,Z,q,K,H,X,U,V):u.sweepBipartite(e,t,H,X,U,V,G,Z,q,K):(b(C++,A+1,H,X,G,Z,N,-1/0,1/0),b(C++,A+1,G,Z,H,X,1^N,-1/0,1/0)))}}}}};var r=n(209),i=n(210),o=n(322),s=o.partial,a=o.full,u=n(237),l=n(323),c=n(238),h=c("!(lo>=p0)&&!(p1>=hi)",["p0","p1"]),f=c("lo===p0",["p0"]),d=c("lo<p0",["p0"]),p=c("hi<=p0",["p0"]),m=c("lo<=p0&&p0<=hi",["p0"]),y=c("lo<p0&&p0<=hi",["p0"]),g=r.mallocInt32(1024),v=r.mallocDouble(1024);function b(e,t,n,r,i,o,s,a,u){var l=6*e;g[l]=t,g[l+1]=n,g[l+2]=r,g[l+3]=i,g[l+4]=o,g[l+5]=s;var c=2*e;v[c]=a,v[c+1]=u}function w(e,t,n,r,i,o,s,a,u,l,c){var h=2*e,f=u*h,d=l[f+t];e:for(var p=i,m=i*h;p<o;++p,m+=h){var y=s[m+t],g=s[m+t+e];if(!(d<y||g<d)&&(!r||d!==y)){for(var v,b=a[p],w=t+1;w<e;++w){y=s[m+w],g=s[m+w+e];var _=l[f+w],x=l[f+w+e];if(g<_||x<y)continue e}if(void 0!==(v=r?n(c,b):n(b,c)))return v}}}function _(e,t,n,r,i,o,s,a,u,l){var c=2*e,h=a*c,f=u[h+t];e:for(var d=r,p=r*c;d<i;++d,p+=c){var m=s[d];if(m!==l){var y=o[p+t],g=o[p+t+e];if(!(f<y||g<f)){for(var v=t+1;v<e;++v){y=o[p+v],g=o[p+v+e];var b=u[h+v],w=u[h+v+e];if(g<b||w<y)continue e}var _=n(m,l);if(void 0!==_)return _}}}}},function(e,t,n){"use strict";var r=["d","ax","vv","rs","re","rb","ri","bs","be","bb","bi"];function i(e){var t="bruteForce"+(e?"Full":"Partial"),n=[],i=r.slice();e||i.splice(3,0,"fp");var o=["function "+t+"("+i.join()+"){"];function s(t,i){var s=function(e,t,n){var i="bruteForce"+(e?"Red":"Blue")+(t?"Flip":"")+(n?"Full":""),o=["function ",i,"(",r.join(),"){","var ","es","=2*","d",";"],s="for(var i=rs,rp=es*rs;i<re;++i,rp+=es){var x0=rb[ax+rp],x1=rb[ax+rp+d],xi=ri[i];",a="for(var j=bs,bp=es*bs;j<be;++j,bp+=es){var y0=bb[ax+bp],"+(n?"y1=bb[ax+bp+d],":"")+"yi=bi[j];";return e?o.push(s,"Q",":",a):o.push(a,"Q",":",s),n?o.push("if(y1<x0||x1<y0)continue;"):t?o.push("if(y0<=x0||x1<y0)continue;"):o.push("if(y0<x0||x1<y0)continue;"),o.push("for(var k=ax+1;k<d;++k){var r0=rb[k+rp],r1=rb[k+d+rp],b0=bb[k+bp],b1=bb[k+d+bp];if(r1<b0||b1<r0)continue Q;}var rv=vv("),t?o.push("yi,xi"):o.push("xi,yi"),o.push(");if(rv!==void 0)return rv;}}}"),{name:i,code:o.join("")}}(t,i,e);n.push(s.code),o.push("return "+s.name+"("+r.join()+");")}o.push("if(re-rs>be-bs){"),e?(s(!0,!1),o.push("}else{"),s(!1,!1)):(o.push("if(fp){"),s(!0,!0),o.push("}else{"),s(!0,!1),o.push("}}else{if(fp){"),s(!1,!0),o.push("}else{"),s(!1,!1),o.push("}")),o.push("}}return "+t);var a=n.join("")+o.join("");return new Function(a)()}t.partial=i(!1),t.full=i(!0)},function(e,t,n){"use strict";e.exports=function(e,t,n,o,s,a){if(o<=n+1)return n;var u=n,l=o,c=o+n>>>1,h=2*e,f=c,d=s[h*c+t];for(;u<l;){if(l-u<8){i(e,t,u,l,s,a),d=s[h*c+t];break}var p=l-u,m=Math.random()*p+u|0,y=s[h*m+t],g=Math.random()*p+u|0,v=s[h*g+t],b=Math.random()*p+u|0,w=s[h*b+t];y<=v?w>=v?(f=g,d=v):y>=w?(f=m,d=y):(f=b,d=w):v>=w?(f=g,d=v):w>=y?(f=m,d=y):(f=b,d=w);for(var _=h*(l-1),x=h*f,k=0;k<h;++k,++_,++x){var O=s[_];s[_]=s[x],s[x]=O}var P=a[l-1];a[l-1]=a[f],a[f]=P,f=r(e,t,u,l-1,s,a,d);for(_=h*(l-1),x=h*f,k=0;k<h;++k,++_,++x){O=s[_];s[_]=s[x],s[x]=O}P=a[l-1];if(a[l-1]=a[f],a[f]=P,c<f){for(l=f-1;u<l&&s[h*(l-1)+t]===d;)l-=1;l+=1}else{if(!(f<c))break;for(u=f+1;u<l&&s[h*u+t]===d;)u+=1}}return r(e,t,n,c,s,a,s[h*c+t])};var r=n(238)("lo<p0",["p0"]);function i(e,t,n,r,i,o){for(var s=2*e,a=s*(n+1)+t,u=n+1;u<r;++u,a+=s)for(var l=i[a],c=u,h=s*(u-1);c>n&&i[h+t]>l;--c,h-=s){for(var f=h,d=h+s,p=0;p<s;++p,++f,++d){var m=i[f];i[f]=i[d],i[d]=m}var y=o[c];o[c]=o[c-1],o[c-1]=y}}},function(e,t,n){"use strict";n.r(t),t.default=function(e){return{name:"collideTerrain",order:0,state:{callback:null},onAdd:function(t,n){var r=e.entities;r.hasPhysics(t)&&(r.getPhysicsBody(t).onCollide=function(n){var r=e.ents.getCollideTerrain(t).callback;r&&r(n,t)})},onRemove:function(t,n){var r=e.entities;r.hasPhysics(t)&&(r.getPhysicsBody(t).onCollide=null)}}}},function(e,t,n){"use strict";n.r(t),t.default=function(e){return{name:"fadeOnZoom",order:99,state:{cutoff:1.5,_showing:!0},onAdd:null,onRemove:null,system:function(t,n){var r=e.camera.currentZoom,i=e.entities;n.forEach(e=>{!function(e,t,n,r){if(!r.hasMesh(t))return;if(e._showing&&n<e.cutoff||!e._showing&&n>e.cutoff){r.getMeshData(t).mesh.visibility=e._showing=n>e.cutoff}}(e,e.__id,r,i)})}}}},function(e,t,n){"use strict";n.r(t);var r=n(76);t.default=function(e){return{name:"followsEntity",order:50,state:{entity:0,offset:null,onTargetMissing:null},onAdd:function(e,i){var o=r.create();i.offset=i.offset?r.copy(o,i.offset):o,t(i),n(i)},onRemove:null,system:function(e,n){n.forEach(e=>t(e))},renderSystem:function(e,t){t.forEach(e=>n(e))}};function t(t){var n=t.__id,i=e.ents.getPositionData(n),o=e.ents.getPositionData(t.entity);o?r.add(i._localPosition,o._localPosition,t.offset):(t.onTargetMissing&&t.onTargetMissing(n),e.ents.removeComponent(n,e.ents.names.followsEntity))}function n(t){var n=t.__id,i=e.ents.getPositionData(n),o=e.ents.getPositionData(t.entity);o&&r.add(i._renderPosition,o._renderPosition,t.offset)}}},function(e,t,n){"use strict";n.r(t);var r=n(76);t.default=function(e){return{name:"mesh",order:100,state:{mesh:null,offset:null},onAdd:function(t,n){var i=e.ents.getPositionData(t);if(!n.mesh)throw new Error("Mesh component added without a mesh - probably a bug!");e.rendering.addMeshToScene(n.mesh,!1,i.position),n.offset||(n.offset=new r.create);var o=i._renderPosition;n.mesh.position.copyFromFloats(o[0]+n.offset[0],o[1]+n.offset[1],o[2]+n.offset[2])},onRemove:function(e,t){t.mesh.dispose()},renderSystem:function(t,n){n.forEach(t=>{var n=t.__id,r=e.ents.getPositionData(n)._renderPosition;t.mesh.position.copyFromFloats(r[0]+t.offset[0],r[1]+t.offset[1],r[2]+t.offset[2])})}}}},function(e,t,n){"use strict";n.r(t);var r=n(76);t.default=function(e){return{name:"movement",order:30,state:{heading:0,running:!1,jumping:!1,sprint:!1,crouch:!1,xMult:1,yMult:1,maxSpeed:10,moveForce:30,responsiveness:15,runningFriction:0,standingFriction:2,sprintMoveMult:1.2,crouchMoveMult:.8,airMoveMult:.5,jumpImpulse:10,jumpForce:12,jumpTime:500,airJumps:1,_jumpCount:0,_isJumping:0,_currjumptime:0},onAdd:null,onRemove:null,system:function(t,n){var a=e.entities;n.forEach(e=>{var n=a.getPhysicsBody(e.__id);!function(e,t,n){var a=n.atRestY()<0,u=a||t._jumpCount<t.airJumps;a&&(t._isJumping=!1,t._jumpCount=0);if(t.jumping)if(t._isJumping){if(t._currjumptime>0){var l=t.jumpForce;t._currjumptime<e&&(l*=t._currjumptime/e),n.applyForce([0,l,0]),t._currjumptime-=e}}else u&&(t._isJumping=!0,a||t._jumpCount++,t._currjumptime=t.jumpTime,n.applyImpulse([0,t.jumpImpulse,0]),!a&&n.velocity[1]<0&&(n.velocity[1]=0));else t._isJumping=!1;var c=i,h=o;if(t.running){var f=t.maxSpeed;t.sprint&&(f*=t.sprintMoveMult),t.crouch&&(f*=t.crouchMoveMult),r.set(c,0,0,f),r.rotateY(c,c,s,t.heading),r.subtract(h,c,n.velocity),h[1]=0;var d=r.length(h);if(r.normalize(h,h),d>0){var p=t.moveForce;a||(p*=t.airMoveMult);var m=t.responsiveness*d;p>m&&(p=m),r.scale(h,h,p),n.applyForce(h)}n.friction=t.runningFriction}else n.friction=t.standingFriction}(t,e,n)})}}};var i=r.create(),o=r.create(),s=r.create()},function(e,t,n){"use strict";n.r(t),t.default=function(e){return{name:"receivesInputs",order:20,state:{ignore:!1,x:1,y:1},onAdd:null,onRemove:null,system:function(t,n){var r=e.entities,i=e.inputs.state,o=e.camera.heading;n.forEach(e=>{!function(e,t,n,r,i,o){e.jumping=!r&&!!t.jump;e.xMulp=i,e.yMulp=o;var s=t.forward?t.backward?0:1:t.backward?-1:0,a=t.right?t.left?0:1:t.left?-1:0;0==(s|a)||r?e.running=!1:(e.running=!0,s?(-1==s&&(n+=Math.PI),a&&(n+=Math.PI/4*s*a)):n+=a*Math.PI/2,e.heading=n)}(r.getMovement(e.__id),i,o,e.ignore,e.x,e.y)})}}}},function(e,t,n){"use strict";n.r(t);var r=n(6),i=n(25),o=n(76);t.default=function(e,t){var n=t,u=e.rendering.getScene(),l=r.a.CreateDisc("shadow",.75,30,u);return l.rotation.x=Math.PI/2,l.material=e.rendering.makeStandardMaterial("shadowMat"),l.material.diffuseColor=i.e.Black(),l.material.ambientColor=i.e.Black(),l.material.alpha=.5,l.setEnabled(!1),u.removeMesh(l),{name:"shadow",order:80,state:{size:.5,_mesh:null},onAdd:function(t,n){var r=l.createInstance("shadow_instance");e.rendering.addMeshToScene(r),r.setEnabled(!1),n._mesh=r},onRemove:function(e,t){t._mesh.dispose()},system:function(t,r){var i=e.camera._localGetPosition(),u=n;r.forEach(t=>{var n=e.ents.getPositionData(t.__id),r=e.ents.getPhysics(t.__id);!function(e,t,n,r,i,u,l){var c;if(n&&n.body.resting[1]<0)c=t._localPosition[1];else{var h=e._localPick(t._localPosition,a,u);if(!h)return void r.setEnabled(!1);c=h.position[1]-e.worldOriginOffset[1]}c=Math.round(c),o.copy(s,t._localPosition),s[1]=c;var f=.01+o.squaredDistance(l,s)/1600*.1;f>.1&&(f=.1);r.position.y=c+f;var d=t._localPosition[1]-c,p=.7*i*(1-d/u);r.scaling.copyFromFloats(p,p,p),r.setEnabled(!0)}(e,n,r,t._mesh,t.size,u,i)})},renderSystem:function(t,n){n.forEach(t=>{var n=e.ents.getPositionData(t.__id)._renderPosition,r=t._mesh.position;r.x=n[0],r.z=n[2]})}}};var s=o.fromValues(0,0,0),a=o.fromValues(0,-1,0)},function(e,t,n){"use strict";n.r(t),t.default=function(e){return{name:"smooth-camera",order:99,state:{time:100.1},onAdd:null,onRemove:null,system:function(t,n){n.forEach(n=>{n.time-=t,n.time<0&&e.ents.removeComponent(n.__id,"smooth-camera")})}}}},function(e){e.exports=JSON.parse('{"_from":"github:VoxelSrv/noa-engine","_id":"noa-engine@0.29.0","_inBundle":false,"_integrity":"","_location":"/noa-engine","_phantomChildren":{},"_requested":{"type":"git","raw":"github:VoxelSrv/noa-engine","rawSpec":"github:VoxelSrv/noa-engine","saveSpec":"github:VoxelSrv/noa-engine","fetchSpec":null,"gitCommittish":null},"_requiredBy":["#USER","/"],"_resolved":"github:VoxelSrv/noa-engine#702ad8c814140f9ce67effcb748d313330b4fcea","_spec":"github:VoxelSrv/noa-engine","_where":"/home/patbox/Pulpit/voxelsrv/client","author":{"name":"Andy Hall"},"bugs":{"url":"https://github.com/andyhall/noa/issues"},"bundleDependencies":false,"dependencies":{"@babylonjs/core":"^4.2.0-alpha.35","aabb-3d":"github:andyhall/aabb-3d","box-intersect":"^1.0.2","ent-comp":"^0.9.1","fast-voxel-raycast":"^0.1.1","game-inputs":"^0.4.0","game-shell":"github:andyhall/game-shell","gl-vec3":"^1.1.3","ndarray":"^1.0.19","voxel-aabb-sweep":"^0.5.0","voxel-physics-engine":"^0.10.0"},"deprecated":false,"description":"Experimental voxel game engine","devDependencies":{"jsdoc-to-markdown":"^5.0.3","typescript":"^3.9.7"},"files":["/src","/types"],"homepage":"https://github.com/andyhall/noa#readme","keywords":["voxel","game","engine"],"license":"MIT","main":"src/index.js","name":"noa-engine","repository":{"type":"git","url":"git+https://github.com/andyhall/noa.git"},"scripts":{"doc":"jsdoc2md -f src/* src/**/* -g table -p list --partial doc-templates/* > doc/API.md"},"typings":"types/index.d.ts","version":"0.29.0"}')},function(e,t,n){"use strict";n.r(t);var r=function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function i(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}var o=Object.keys,s=Array.isArray,a="undefined"!=typeof self?self:"undefined"!=typeof window?window:global;function u(e,t){return"object"!=typeof t||o(t).forEach((function(n){e[n]=t[n]})),e}"undefined"==typeof Promise||a.Promise||(a.Promise=Promise);var l=Object.getPrototypeOf,c={}.hasOwnProperty;function h(e,t){return c.call(e,t)}function f(e,t){"function"==typeof t&&(t=t(l(e))),o(t).forEach((function(n){p(e,n,t[n])}))}var d=Object.defineProperty;function p(e,t,n,r){d(e,t,u(n&&h(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function m(e){return{from:function(t){return e.prototype=Object.create(t.prototype),p(e.prototype,"constructor",e),{extend:f.bind(null,e.prototype)}}}}var y=Object.getOwnPropertyDescriptor;var g=[].slice;function v(e,t,n){return g.call(e,t,n)}function b(e,t){return t(e)}function w(e){if(!e)throw new Error("Assertion Failed")}function _(e){a.setImmediate?setImmediate(e):setTimeout(e,0)}function x(e,t){return e.reduce((function(e,n,r){var i=t(n,r);return i&&(e[i[0]]=i[1]),e}),{})}function k(e,t){if(h(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],r=0,i=t.length;r<i;++r){var o=k(e,t[r]);n.push(o)}return n}var s=t.indexOf(".");if(-1!==s){var a=e[t.substr(0,s)];return void 0===a?void 0:k(a,t.substr(s+1))}}function O(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){w("string"!=typeof n&&"length"in n);for(var r=0,i=t.length;r<i;++r)O(e,t[r],n[r])}else{var o=t.indexOf(".");if(-1!==o){var a=t.substr(0,o),u=t.substr(o+1);if(""===u)void 0===n?s(e)&&!isNaN(parseInt(a))?e.splice(a,1):delete e[a]:e[a]=n;else{var l=e[a];l||(l=e[a]={}),O(l,u,n)}}else void 0===n?s(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function P(e){var t={};for(var n in e)h(e,n)&&(t[n]=e[n]);return t}var S=[].concat;function C(e){return S.apply([],e)}var j="Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set".split(",").concat(C([8,16,32,64].map((function(e){return["Int","Uint","Float"].map((function(t){return t+e+"Array"}))})))).filter((function(e){return a[e]})),E=j.map((function(e){return a[e]})),A=x(j,(function(e){return[e,!0]}));function M(e){if(!e||"object"!=typeof e)return e;var t;if(s(e)){t=[];for(var n=0,r=e.length;n<r;++n)t.push(M(e[n]))}else if(E.indexOf(e.constructor)>=0)t=e;else for(var i in t=e.constructor?Object.create(e.constructor.prototype):{},e)h(e,i)&&(t[i]=M(e[i]));return t}var T={}.toString;function I(e){return T.call(e).slice(8,-1)}var D=function(e,t){return"Array"===t?""+e.map((function(e){return D(e,I(e))})):"ArrayBuffer"===t?""+new Uint8Array(e):"Date"===t?e.getTime():ArrayBuffer.isView(e)?""+new Uint8Array(e.buffer):e};function z(e,t,n,r){return n=n||{},r=r||"",o(e).forEach((function(i){if(h(t,i)){var o=e[i],s=t[i];if("object"==typeof o&&"object"==typeof s&&o&&s){var a=I(o),u=I(s);a===u?A[a]?D(o,a)!==D(s,u)&&(n[r+i]=t[i]):z(o,s,n,r+i+"."):n[r+i]=t[i]}else o!==s&&(n[r+i]=t[i])}else n[r+i]=void 0})),o(t).forEach((function(i){h(e,i)||(n[r+i]=t[i])})),n}var B="undefined"!=typeof Symbol&&Symbol.iterator,L=B?function(e){var t;return null!=e&&(t=e[B])&&t.apply(e)}:function(){return null},R={};function N(e){var t,n,r,i;if(1===arguments.length){if(s(e))return e.slice();if(this===R&&"string"==typeof e)return[e];if(i=L(e)){for(n=[];!(r=i.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"==typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var F="undefined"!=typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},U="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function V(e,t){U=e,q=t}var q=function(){return!0},K=!new Error("").stack;function W(){if(K)try{throw new Error}catch(e){return e}return new Error}function Y(e,t){var n=e.stack;return n?(t=t||0,0===n.indexOf(e.name)&&(t+=(e.name+e.message).split("\n").length),n.split("\n").slice(t).filter(q).map((function(e){return"\n"+e})).join("")):""}var H=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],G=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(H),J={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function Z(e,t){this._e=W(),this.name=e,this.message=t}function X(e,t){return e+". Errors: "+Object.keys(t).map((function(e){return t[e].toString()})).filter((function(e,t,n){return n.indexOf(e)===t})).join("\n")}function $(e,t,n,r){this._e=W(),this.failures=t,this.failedKeys=r,this.successCount=n,this.message=X(e,t)}function Q(e,t){this._e=W(),this.name="BulkError",this.failures=t,this.message=X(e,t)}m(Z).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Y(this._e,2))}},toString:function(){return this.name+": "+this.message}}),m($).from(Z),m(Q).from(Z);var ee=G.reduce((function(e,t){return e[t]=t+"Error",e}),{}),te=Z,ne=G.reduce((function(e,t){var n=t+"Error";function r(e,r){this._e=W(),this.name=n,e?"string"==typeof e?(this.message=e+(r?"\n "+r:""),this.inner=r||null):"object"==typeof e&&(this.message=e.name+" "+e.message,this.inner=e):(this.message=J[t]||n,this.inner=null)}return m(r).from(te),e[t]=r,e}),{});ne.Syntax=SyntaxError,ne.Type=TypeError,ne.Range=RangeError;var re=H.reduce((function(e,t){return e[t+"Error"]=ne[t],e}),{});var ie=G.reduce((function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=ne[t]),e}),{});function oe(){}function se(e){return e}function ae(e,t){return null==e||e===se?t:function(n){return t(e(n))}}function ue(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function le(e,t){return e===oe?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?ue(r,this.onsuccess):r),i&&(this.onerror=this.onerror?ue(i,this.onerror):i),void 0!==o?o:n}}function ce(e,t){return e===oe?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?ue(n,this.onsuccess):n),r&&(this.onerror=this.onerror?ue(r,this.onerror):r)}}function he(e,t){return e===oe?t:function(n){var r=e.apply(this,arguments);u(n,r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var s=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?ue(i,this.onsuccess):i),o&&(this.onerror=this.onerror?ue(o,this.onerror):o),void 0===r?void 0===s?void 0:s:u(r,s)}}function fe(e,t){return e===oe?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function de(e,t){return e===oe?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return n.then((function(){return t.apply(r,o)}))}return t.apply(this,arguments)}}ie.ModifyError=$,ie.DexieError=Z,ie.BulkError=Q;var pe={},me="undefined"==typeof Promise?[]:function(){var e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,e.__proto__,e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,t.__proto__,e]}(),ye=me[0],ge=me[1],ve=me[2],be=ge&&ge.then,we=ye&&ye.constructor,_e=!!ve,xe=!1,ke=ve?function(){ve.then(We)}:a.setImmediate?setImmediate.bind(null,We):a.MutationObserver?function(){var e=document.createElement("div");new MutationObserver((function(){We(),e=null})).observe(e,{attributes:!0}),e.setAttribute("i","1")}:function(){setTimeout(We,0)},Oe=function(e,t){Ie.push([e,t]),Se&&(ke(),Se=!1)},Pe=!0,Se=!0,Ce=[],je=[],Ee=null,Ae=se,Me={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:pt,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((function(e){try{pt(e[0],e[1])}catch(e){}}))}},Te=Me,Ie=[],De=0,ze=[];function Be(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=oe,this._lib=!1;var t=this._PSD=Te;if(U&&(this._stackHolder=W(),this._prev=null,this._numPrev=0),"function"!=typeof e){if(e!==pe)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Fe(this,this._value))}this._state=null,this._value=null,++t.ref,Ne(this,e)}var Le={get:function(){var e=Te,t=tt;function n(n,r){var i=this,o=!e.global&&(e!==Te||t!==tt);o&&ot();var s=new Be((function(t,s){Ve(i,new Re(ft(n,e,o),ft(r,e,o),t,s,e))}));return U&&Ke(s,this),s}return n.prototype=pe,n},set:function(e){p(this,"then",e&&e.prototype===pe?Le:{get:function(){return e},set:Le.set})}};function Re(e,t,n,r,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r,this.psd=i}function Ne(e,t){try{t((function(t){if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&Ye();t&&"function"==typeof t.then?Ne(e,(function(e,n){t instanceof Be?t._then(e,n):t.then(e,n)})):(e._state=!0,e._value=t,Ue(e)),n&&He()}}),Fe.bind(null,e))}catch(t){Fe(e,t)}}function Fe(e,t){if(je.push(t),null===e._state){var n=e._lib&&Ye();t=Ae(t),e._state=!1,e._value=t,U&&null!==t&&"object"==typeof t&&!t._promise&&function(e,t,n){try{e.apply(null,n)}catch(e){t&&t(e)}}((function(){var n=function e(t,n){var r;return y(t,n)||(r=l(t))&&e(r,n)}(t,"stack");t._promise=e,p(t,"stack",{get:function(){return xe?n&&(n.get?n.get.apply(t):n.value):e.stack}})})),function(e){Ce.some((function(t){return t._value===e._value}))||Ce.push(e)}(e),Ue(e),n&&He()}}function Ue(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Ve(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),0===De&&(++De,Oe((function(){0==--De&&Ge()}),[]))}function Ve(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++De,Oe(qe,[n,e,t])}else e._listeners.push(t)}function qe(e,t,n){try{Ee=t;var r,i=t._value;t._state?r=e(i):(je.length&&(je=[]),r=e(i),-1===je.indexOf(i)&&function(e){var t=Ce.length;for(;t;)if(Ce[--t]._value===e._value)return void Ce.splice(t,1)}(t)),n.resolve(r)}catch(e){n.reject(e)}finally{Ee=null,0==--De&&Ge(),--n.psd.ref||n.psd.finalize()}}function Ke(e,t){var n=t?t._numPrev+1:0;n<100&&(e._prev=t,e._numPrev=n)}function We(){Ye()&&He()}function Ye(){var e=Pe;return Pe=!1,Se=!1,e}function He(){var e,t,n;do{for(;Ie.length>0;)for(e=Ie,Ie=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(Ie.length>0);Pe=!0,Se=!0}function Ge(){var e=Ce;Ce=[],e.forEach((function(e){e._PSD.onunhandled.call(null,e._value,e)}));for(var t=ze.slice(0),n=t.length;n;)t[--n]()}function Je(e){return new Be(pe,!1,e)}function Ze(e,t){var n=Te;return function(){var r=Ye(),i=Te;try{return lt(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{lt(i,!1),r&&He()}}}f(Be.prototype,{then:Le,_then:function(e,t){Ve(this,new Re(null,null,e,t,Te))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"==typeof t?this.then(null,(function(e){return e instanceof t?n(e):Je(e)})):this.then(null,(function(e){return e&&e.name===t?n(e):Je(e)}))},finally:function(e){return this.then((function(t){return e(),t}),(function(t){return e(),Je(t)}))},stack:{get:function(){if(this._stack)return this._stack;try{xe=!0;var e=function e(t,n,r){if(n.length===r)return n;var i="";if(!1===t._state){var o,s,a=t._value;null!=a?(o=a.name||"Error",s=a.message||a,i=Y(a,0)):(o=a,s=""),n.push(o+(s?": "+s:"")+i)}U&&((i=Y(t._stackHolder,2))&&-1===n.indexOf(i)&&n.push(i),t._prev&&e(t._prev,n,r));return n}(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=e),e}finally{xe=!1}}},timeout:function(e,t){var n=this;return e<1/0?new Be((function(r,i){var o=setTimeout((function(){return i(new ne.Timeout(t))}),e);n.then(r,i).finally(clearTimeout.bind(null,o))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&p(Be.prototype,Symbol.toStringTag,"Dexie.Promise"),Me.env=ct(),f(Be,{all:function(){var e=N.apply(null,arguments).map(st);return new Be((function(t,n){0===e.length&&t([]);var r=e.length;e.forEach((function(i,o){return Be.resolve(i).then((function(n){e[o]=n,--r||t(e)}),n)}))}))},resolve:function(e){if(e instanceof Be)return e;if(e&&"function"==typeof e.then)return new Be((function(t,n){e.then(t,n)}));var t=new Be(pe,!0,e);return Ke(t,Ee),t},reject:Je,race:function(){var e=N.apply(null,arguments).map(st);return new Be((function(t,n){e.map((function(e){return Be.resolve(e).then(t,n)}))}))},PSD:{get:function(){return Te},set:function(e){return Te=e}},newPSD:rt,usePSD:ht,scheduler:{get:function(){return Oe},set:function(e){Oe=e}},rejectionMapper:{get:function(){return Ae},set:function(e){Ae=e}},follow:function(e,t){return new Be((function(n,r){return rt((function(t,n){var r=Te;r.unhandleds=[],r.onunhandled=n,r.finalize=ue((function(){var e=this;!function(e){ze.push((function t(){e(),ze.splice(ze.indexOf(t),1)})),++De,Oe((function(){0==--De&&Ge()}),[])}((function(){0===e.unhandleds.length?t():n(e.unhandleds[0])}))}),r.finalize),e()}),t,n,r)}))}}),we&&(we.allSettled&&p(Be,"allSettled",(function(){var e=N.apply(null,arguments).map(st);return new Be((function(t){0===e.length&&t([]);var n=e.length,r=new Array(n);e.forEach((function(e,i){return Be.resolve(e).then((function(e){return r[i]={status:"fulfilled",value:e}}),(function(e){return r[i]={status:"rejected",reason:e}})).then((function(){return--n||t(r)}))}))}))})),we.any&&"undefined"!=typeof AggregateError&&p(Be,"any",(function(){var e=N.apply(null,arguments).map(st);return new Be((function(t,n){0===e.length&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach((function(e,o){return Be.resolve(e).then((function(e){return t(e)}),(function(e){i[o]=e,--r||n(new AggregateError(i))}))}))}))})));var Xe={awaits:0,echoes:0,id:0},$e=0,Qe=[],et=0,tt=0,nt=0;function rt(e,t,n,r){var i=Te,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++nt;var s=Me.env;o.env=_e?{Promise:Be,PromiseProp:{value:Be,configurable:!0,writable:!0},all:Be.all,race:Be.race,allSettled:Be.allSettled,any:Be.any,resolve:Be.resolve,reject:Be.reject,nthen:dt(s.nthen,o),gthen:dt(s.gthen,o)}:{},t&&u(o,t),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=ht(o,e,n,r);return 0===o.ref&&o.finalize(),a}function it(){return Xe.id||(Xe.id=++$e),++Xe.awaits,Xe.echoes+=100,Xe.id}function ot(e){!Xe.awaits||e&&e!==Xe.id||(0==--Xe.awaits&&(Xe.id=0),Xe.echoes=100*Xe.awaits)}function st(e){return Xe.echoes&&e&&e.constructor===we?(it(),e.then((function(e){return ot(),e}),(function(e){return ot(),mt(e)}))):e}function at(e){++tt,Xe.echoes&&0!=--Xe.echoes||(Xe.echoes=Xe.id=0),Qe.push(Te),lt(e,!0)}function ut(){var e=Qe[Qe.length-1];Qe.pop(),lt(e,!1)}function lt(e,t){var n,r=Te;if((t?!Xe.echoes||et++&&e===Te:!et||--et&&e===Te)||(n=t?at.bind(null,e):ut,be.call(ye,n)),e!==Te&&(Te=e,r===Me&&(Me.env=ct()),_e)){var i=Me.env.Promise,o=e.env;ge.then=o.nthen,i.prototype.then=o.gthen,(r.global||e.global)&&(Object.defineProperty(a,"Promise",o.PromiseProp),i.all=o.all,i.race=o.race,i.resolve=o.resolve,i.reject=o.reject,o.allSettled&&(i.allSettled=o.allSettled),o.any&&(i.any=o.any))}}function ct(){var e=a.Promise;return _e?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(a,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:ge.then,gthen:e.prototype.then}:{}}function ht(e,t,n,r,i){var o=Te;try{return lt(e,!0),t(n,r,i)}finally{lt(o,!1)}}function ft(e,t,n){return"function"!=typeof e?e:function(){var r=Te;n&&it(),lt(t,!0);try{return e.apply(this,arguments)}finally{lt(r,!1)}}}function dt(e,t){return function(n,r){return e.call(this,ft(n,t,!1),ft(r,t,!1))}}-1===(""+be).indexOf("[native code]")&&(it=ot=oe);function pt(e,t){var n;try{n=t.onuncatched(e)}catch(e){}if(!1!==n)try{var r,i={promise:t,reason:e};if(a.document&&document.createEvent?((r=document.createEvent("Event")).initEvent("unhandledrejection",!0,!0),u(r,i)):a.CustomEvent&&u(r=new CustomEvent("unhandledrejection",{detail:i}),i),r&&a.dispatchEvent&&(dispatchEvent(r),!a.PromiseRejectionEvent&&a.onunhandledrejection))try{a.onunhandledrejection(r)}catch(e){}U&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(e.stack||e))}catch(e){}}var mt=Be.reject;var yt=String.fromCharCode(65535),gt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",vt=[],bt="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),wt=bt,_t=bt,xt=function(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)};function kt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Ot={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1},Pt=function(){function e(){}return e.prototype._trans=function(e,t,n){var r=this._tx||Te.trans,i=this.name;function o(e,n,r){if(!r.schema[i])throw new ne.NotFound("Table "+i+" not part of transaction");return t(r.idbtrans,r)}var s=Ye();try{return r&&r.db===this.db?r===Te.trans?r._promise(e,o,n):rt((function(){return r._promise(e,o,n)}),{trans:r,transless:Te.transless||Te}):function e(t,n,r,i){if(t._state.openComplete||Te.letThrough){var o=t._createTransaction(n,r,t._dbSchema);try{o.create()}catch(e){return mt(e)}return o._promise(n,(function(e,t){return rt((function(){return Te.trans=o,i(e,t,o)}))})).then((function(e){return o._completion.then((function(){return e}))}))}if(!t._state.isBeingOpened){if(!t._options.autoOpen)return mt(new ne.DatabaseClosed);t.open().catch(oe)}return t._state.dbReadyPromise.then((function(){return e(t,n,r,i)}))}(this.db,e,[this.name],o)}finally{s&&He()}},e.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):this._trans("readonly",(function(t){return n.core.get({trans:t,key:e}).then((function(e){return n.hook.reading.fire(e)}))})).then(t)},e.prototype.where=function(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(s(e))return new this.db.WhereClause(this,"["+e.join("+")+"]");var t=o(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter((function(e){return e.compound&&t.every((function(t){return e.keyPath.indexOf(t)>=0}))&&e.keyPath.every((function(e){return t.indexOf(e)>=0}))}))[0];if(n&&this.db._maxKey!==yt)return this.where(n.name).equals(n.keyPath.map((function(t){return e[t]})));!n&&U&&console.warn("The query "+JSON.stringify(e)+" on "+this.name+" would benefit of a compound index ["+t.join("+")+"]");var r=this.schema.idxByName,i=this.db._deps.indexedDB;function a(e,t){try{return 0===i.cmp(e,t)}catch(e){return!1}}var u=t.reduce((function(t,n){var i=t[0],o=t[1],u=r[n],l=e[n];return[i||u,i||!u?kt(o,u&&u.multi?function(e){var t=k(e,n);return s(t)&&t.some((function(e){return a(l,e)}))}:function(e){return a(l,k(e,n))}):o]}),[null,null]),l=u[0],c=u[1];return l?this.where(l.name).equals(e[l.keyPath]).filter(c):n?this.filter(c):this.where(t).equals("")},e.prototype.filter=function(e){return this.toCollection().and(e)},e.prototype.count=function(e){return this.toCollection().count(e)},e.prototype.offset=function(e){return this.toCollection().offset(e)},e.prototype.limit=function(e){return this.toCollection().limit(e)},e.prototype.each=function(e){return this.toCollection().each(e)},e.prototype.toArray=function(e){return this.toCollection().toArray(e)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,s(e)?"["+e.join("+")+"]":e))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(e){this.schema.mappedClass=e;var t=function(t){if(!t)return t;var n=Object.create(e.prototype);for(var r in t)if(h(t,r))try{n[r]=t[r]}catch(e){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=t,this.hook("reading",t),e},e.prototype.defineClass=function(){return this.mapToClass((function(e){u(this,e)}))},e.prototype.add=function(e,t){var n=this;return this._trans("readwrite",(function(r){return n.core.mutate({trans:r,type:"add",keys:null!=t?[t]:null,values:[e]})})).then((function(e){return e.numFailures?Be.reject(e.failures[0]):e.lastResult})).then((function(t){if(!n.core.schema.primaryKey.outbound)try{O(e,n.core.schema.primaryKey.keyPath,t)}catch(e){}return t}))},e.prototype.update=function(e,t){if("object"!=typeof t||s(t))throw new ne.InvalidArgument("Modifications must be an object.");if("object"!=typeof e||s(e))return this.where(":id").equals(e).modify(t);o(t).forEach((function(n){O(e,n,t[n])}));var n=k(e,this.schema.primKey.keyPath);return void 0===n?mt(new ne.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(t)},e.prototype.put=function(e,t){var n=this;return this._trans("readwrite",(function(r){return n.core.mutate({trans:r,type:"put",values:[e],keys:null!=t?[t]:null})})).then((function(e){return e.numFailures?Be.reject(e.failures[0]):e.lastResult})).then((function(t){if(!n.core.schema.primaryKey.outbound)try{O(e,n.core.schema.primaryKey.keyPath,t)}catch(e){}return t}))},e.prototype.delete=function(e){var t=this;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]})})).then((function(e){return e.numFailures?Be.reject(e.failures[0]):void 0}))},e.prototype.clear=function(){var e=this;return this._trans("readwrite",(function(t){return e.core.mutate({trans:t,type:"deleteRange",range:Ot})})).then((function(e){return e.numFailures?Be.reject(e.failures[0]):void 0}))},e.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",(function(n){return t.core.getMany({keys:e,trans:n}).then((function(e){return e.map((function(e){return t.hook.reading.fire(e)}))}))}))},e.prototype.bulkAdd=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,o=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){if(!r.core.schema.primaryKey.outbound&&i)throw new ne.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new ne.InvalidArgument("Arguments objects and keys must have the same length");var n=e.length;return r.core.mutate({trans:t,type:"add",keys:i,values:e,wantResults:o}).then((function(e){var t=e.numFailures,i=e.results,s=e.lastResult,a=e.failures;if(0===t)return o?i:s;throw new Q(r.name+".bulkAdd(): "+t+" of "+n+" operations failed",Object.keys(a).map((function(e){return a[e]})))}))}))},e.prototype.bulkPut=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,o=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){if(!r.core.schema.primaryKey.outbound&&i)throw new ne.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new ne.InvalidArgument("Arguments objects and keys must have the same length");var n=e.length;return r.core.mutate({trans:t,type:"put",keys:i,values:e,wantResults:o}).then((function(e){var t=e.numFailures,i=e.results,s=e.lastResult,a=e.failures;if(0===t)return o?i:s;throw new Q(r.name+".bulkPut(): "+t+" of "+n+" operations failed",Object.keys(a).map((function(e){return a[e]})))}))}))},e.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:e})})).then((function(e){var r=e.numFailures,i=e.lastResult,o=e.failures;if(0===r)return i;throw new Q(t.name+".bulkDelete(): "+r+" of "+n+" operations failed",o)}))},e}();function St(e){var t={},n=function(n,r){if(r){for(var i=arguments.length,o=new Array(i-1);--i;)o[i-1]=arguments[i];return t[n].subscribe.apply(null,o),e}if("string"==typeof n)return t[n]};n.addEventType=a;for(var r=1,i=arguments.length;r<i;++r)a(arguments[r]);return n;function a(e,r,i){if("object"==typeof e)return u(e);r||(r=fe),i||(i=oe);var o={subscribers:[],fire:i,subscribe:function(e){-1===o.subscribers.indexOf(e)&&(o.subscribers.push(e),o.fire=r(o.fire,e))},unsubscribe:function(e){o.subscribers=o.subscribers.filter((function(t){return t!==e})),o.fire=o.subscribers.reduce(r,i)}};return t[e]=n[e]=o,o}function u(e){o(e).forEach((function(t){var n=e[t];if(s(n))a(t,e[t][0],e[t][1]);else{if("asap"!==n)throw new ne.InvalidArgument("Invalid event config");var r=a(t,se,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];r.subscribers.forEach((function(e){_((function(){e.apply(null,t)}))}))}))}}))}}function Ct(e,t){return m(t).from({prototype:e}),t}function jt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Et(e,t){e.filter=kt(e.filter,t)}function At(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return kt(r(),t())}:t,e.justLimit=n&&!r}function Mt(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new ne.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Tt(e,t,n){var r=Mt(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function It(e,t,n,r){var i=e.replayFilter?kt(e.filter,e.replayFilter()):e.filter;if(e.or){var o={},s=function(e,n,r){if(!i||i(n,r,(function(e){return n.stop(e)}),(function(e){return n.fail(e)}))){var s=n.primaryKey,a=""+s;"[object ArrayBuffer]"===a&&(a=""+new Uint8Array(s)),h(o,a)||(o[a]=!0,t(e,n,r))}};return Promise.all([e.or._iterate(s,n),Dt(Tt(e,r,n),e.algorithm,s,!e.keysOnly&&e.valueMapper)])}return Dt(Tt(e,r,n),kt(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function Dt(e,t,n,r){var i=Ze(r?function(e,t,i){return n(r(e),t,i)}:n);return e.then((function(e){if(e)return e.start((function(){var n=function(){return e.continue()};t&&!t(e,(function(e){return n=e}),(function(t){e.stop(t),n=oe}),(function(t){e.fail(t),n=oe}))||i(e.value,e,(function(e){return n=e})),n()}))}))}var zt=function(){function e(){}return e.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,mt.bind(null,n.error)):n.table._trans("readonly",e).then(t)},e.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,mt.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},e.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=kt(t.algorithm,e)},e.prototype._iterate=function(e,t){return It(this._ctx,e,t,this._ctx.table.core)},e.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&u(n,e),t._ctx=n,t},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(e){var t=this._ctx;return this._read((function(n){return It(t,e,n,t.table.core)}))},e.prototype.count=function(e){var t=this;return this._read((function(e){var n=t._ctx,r=n.table.core;if(jt(n,!0))return r.count({trans:e,query:{index:Mt(n,r.schema),range:n.range}}).then((function(e){return Math.min(e,n.limit)}));var i=0;return It(n,(function(){return++i,!1}),e,r).then((function(){return i}))})).then(e)},e.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],i=n.length-1;function o(e,t){return t?o(e[n[t]],t-1):e[r]}var s="next"===this._ctx.dir?1:-1;function a(e,t){var n=o(e,i),r=o(t,i);return n<r?-s:n>r?s:0}return this.toArray((function(e){return e.sort(a)})).then(t)},e.prototype.toArray=function(e){var t=this;return this._read((function(e){var n=t._ctx;if("next"===n.dir&&jt(n,!0)&&n.limit>0){var r=n.valueMapper,i=Mt(n,n.table.core.schema);return n.table.core.query({trans:e,limit:n.limit,values:!0,query:{index:i,range:n.range}}).then((function(e){var t=e.result;return r?t.map(r):t}))}var o=[];return It(n,(function(e){return o.push(e)}),e,n.table.core).then((function(){return o}))}),e)},e.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,jt(t)?At(t,(function(){var t=e;return function(e,n){return 0===t||(1===t?(--t,!1):(n((function(){e.advance(t),t=0})),!1))}})):At(t,(function(){var t=e;return function(){return--t<0}}))),this},e.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),At(this._ctx,(function(){var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}}),!0),this},e.prototype.until=function(e,t){return Et(this._ctx,(function(n,r,i){return!e(n.value)||(r(i),t)})),this},e.prototype.first=function(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)},e.prototype.last=function(e){return this.reverse().first(e)},e.prototype.filter=function(e){var t,n;return Et(this._ctx,(function(t){return e(t.value)})),t=this._ctx,n=e,t.isMatch=kt(t.isMatch,n),this},e.prototype.and=function(e){return this.filter(e)},e.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},e.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.key,n)}))},e.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},e.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.primaryKey,n)}))},e.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.key)})).then((function(){return n})).then(e)},e.prototype.primaryKeys=function(e){var t=this._ctx;if("next"===t.dir&&jt(t,!0)&&t.limit>0)return this._read((function(e){var n=Mt(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})})).then((function(e){return e.result})).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.primaryKey)})).then((function(){return n})).then(e)},e.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},e.prototype.firstKey=function(e){return this.limit(1).keys((function(e){return e[0]})).then(e)},e.prototype.lastKey=function(e){return this.reverse().firstKey(e)},e.prototype.distinct=function(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var n={};return Et(this._ctx,(function(e){var t=e.primaryKey.toString(),r=h(n,t);return n[t]=!0,!r})),this},e.prototype.modify=function(e){var t=this,n=this._ctx;return this._write((function(r){var i;if("function"==typeof e)i=e;else{var s=o(e),a=s.length;i=function(t){for(var n=!1,r=0;r<a;++r){var i=s[r],o=e[i];k(t,i)!==o&&(O(t,i,o),n=!0)}return n}}var u=n.table.core,l=u.schema.primaryKey,c=l.outbound,h=l.extractKey,f="testmode"in Sn?1:2e3,d=t.db.core.cmp,p=[],m=0,y=[],g=function(e,t){var n=t.failures,r=t.numFailures;m+=e-r;for(var i=0,s=o(n);i<s.length;i++){var a=s[i];p.push(n[a])}};return t.clone().primaryKeys().then((function(e){var t=function(n){var o=Math.min(f,e.length-n);return u.getMany({trans:r,keys:e.slice(n,n+o)}).then((function(s){for(var a=[],l=[],p=c?[]:null,m=[],y=0;y<o;++y){var v=s[y],b={value:M(v),primKey:e[n+y]};!1!==i.call(b,b.value,b)&&(null==b.value?m.push(e[n+y]):c||0===d(h(v),h(b.value))?(l.push(b.value),c&&p.push(e[n+y])):(m.push(e[n+y]),a.push(b.value)))}return Promise.resolve(a.length>0&&u.mutate({trans:r,type:"add",values:a}).then((function(e){for(var t in e.failures)m.splice(parseInt(t),1);g(a.length,e)}))).then((function(e){return l.length>0&&u.mutate({trans:r,type:"put",keys:p,values:l}).then((function(e){return g(l.length,e)}))})).then((function(){return m.length>0&&u.mutate({trans:r,type:"delete",keys:m}).then((function(e){return g(m.length,e)}))})).then((function(){return e.length>n+o&&t(n+f)}))}))};return t(0).then((function(){if(p.length>0)throw new $("Error modifying one or more objects",p,m,y);return e.length}))}))}))},e.prototype.delete=function(){var e=this._ctx,t=e.range;return jt(e)&&(e.isPrimKey&&!_t||3===t.type)?this._write((function(n){var r=e.table.core.schema.primaryKey,i=t;return e.table.core.count({trans:n,query:{index:r,range:i}}).then((function(t){return e.table.core.mutate({trans:n,type:"deleteRange",range:i}).then((function(e){var n=e.failures,r=(e.lastResult,e.results,e.numFailures);if(r)throw new $("Could not delete some values",Object.keys(n).map((function(e){return n[e]})),t-r);return t-r}))}))})):this.modify((function(e,t){return t.value=null}))},e}();function Bt(e,t){return e<t?-1:e===t?0:1}function Lt(e,t){return e>t?-1:e===t?0:1}function Rt(e,t,n){var r=e instanceof Kt?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function Nt(e){return new e.Collection(e,(function(){return qt("")})).limit(0)}function Ft(e,t,n,r,i,o){for(var s=Math.min(e.length,r.length),a=-1,u=0;u<s;++u){var l=t[u];if(l!==r[u])return i(e[u],n[u])<0?e.substr(0,u)+n[u]+n.substr(u+1):i(e[u],r[u])<0?e.substr(0,u)+r[u]+n.substr(u+1):a>=0?e.substr(0,a)+t[a]+n.substr(a+1):null;i(e[u],l)<0&&(a=u)}return s<r.length&&"next"===o?e+n.substr(e.length):s<e.length&&"prev"===o?e.substr(0,n.length):a<0?null:e.substr(0,a)+r[a]+n.substr(a+1)}function Ut(e,t,n,r){var i,o,s,a,u,l,c,h=n.length;if(!n.every((function(e){return"string"==typeof e})))return Rt(e,"String expected.");function f(e){i=function(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}(e),o=function(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}(e),s="next"===e?Bt:Lt;var t=n.map((function(e){return{lower:o(e),upper:i(e)}})).sort((function(e,t){return s(e.lower,t.lower)}));a=t.map((function(e){return e.upper})),u=t.map((function(e){return e.lower})),l=e,c="next"===e?"":r}f("next");var d=new e.Collection(e,(function(){return Vt(a[0],u[h-1]+r)}));d._ondirectionchange=function(e){f(e)};var p=0;return d._addAlgorithm((function(e,n,r){var i=e.key;if("string"!=typeof i)return!1;var f=o(i);if(t(f,u,p))return!0;for(var d=null,m=p;m<h;++m){var y=Ft(i,f,a[m],u[m],s,l);null===y&&null===d?p=m+1:(null===d||s(d,y)>0)&&(d=y)}return n(null!==d?function(){e.continue(d+c)}:r),!1})),d}function Vt(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function qt(e){return{type:1,lower:e,upper:e}}var Kt=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!0,configurable:!0}),e.prototype.between=function(e,t,n,r){n=!1!==n,r=!0===r;try{return this._cmp(e,t)>0||0===this._cmp(e,t)&&(n||r)&&(!n||!r)?Nt(this):new this.Collection(this,(function(){return Vt(e,t,!n,!r)}))}catch(e){return Rt(this,gt)}},e.prototype.equals=function(e){return new this.Collection(this,(function(){return qt(e)}))},e.prototype.above=function(e){return null==e?Rt(this,gt):new this.Collection(this,(function(){return Vt(e,void 0,!0)}))},e.prototype.aboveOrEqual=function(e){return null==e?Rt(this,gt):new this.Collection(this,(function(){return Vt(e,void 0,!1)}))},e.prototype.below=function(e){return null==e?Rt(this,gt):new this.Collection(this,(function(){return Vt(void 0,e,!1,!0)}))},e.prototype.belowOrEqual=function(e){return null==e?Rt(this,gt):new this.Collection(this,(function(){return Vt(void 0,e)}))},e.prototype.startsWith=function(e){return"string"!=typeof e?Rt(this,"String expected."):this.between(e,e+yt,!0,!0)},e.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):Ut(this,(function(e,t){return 0===e.indexOf(t[0])}),[e],yt)},e.prototype.equalsIgnoreCase=function(e){return Ut(this,(function(e,t){return e===t[0]}),[e],"")},e.prototype.anyOfIgnoreCase=function(){var e=N.apply(R,arguments);return 0===e.length?Nt(this):Ut(this,(function(e,t){return-1!==t.indexOf(e)}),e,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var e=N.apply(R,arguments);return 0===e.length?Nt(this):Ut(this,(function(e,t){return t.some((function(t){return 0===e.indexOf(t)}))}),e,yt)},e.prototype.anyOf=function(){var e=this,t=N.apply(R,arguments),n=this._cmp;try{t.sort(n)}catch(e){return Rt(this,gt)}if(0===t.length)return Nt(this);var r=new this.Collection(this,(function(){return Vt(t[0],t[t.length-1])}));r._ondirectionchange=function(r){n="next"===r?e._ascending:e._descending,t.sort(n)};var i=0;return r._addAlgorithm((function(e,r,o){for(var s=e.key;n(s,t[i])>0;)if(++i===t.length)return r(o),!1;return 0===n(s,t[i])||(r((function(){e.continue(t[i])})),!1)})),r},e.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var e=N.apply(R,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return Rt(this,gt)}var t=e.reduce((function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[-1/0,t]]}),null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(e,t){var n=this,r=this._cmp,i=this._ascending,o=this._descending,s=this._min,a=this._max;if(0===e.length)return Nt(this);if(!e.every((function(e){return void 0!==e[0]&&void 0!==e[1]&&i(e[0],e[1])<=0})))return Rt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ne.InvalidArgument);var u=!t||!1!==t.includeLowers,l=t&&!0===t.includeUppers;var c,h=i;function f(e,t){return h(e[0],t[0])}try{(c=e.reduce((function(e,t){for(var n=0,i=e.length;n<i;++n){var o=e[n];if(r(t[0],o[1])<0&&r(t[1],o[0])>0){o[0]=s(o[0],t[0]),o[1]=a(o[1],t[1]);break}}return n===i&&e.push(t),e}),[])).sort(f)}catch(e){return Rt(this,gt)}var d=0,p=l?function(e){return i(e,c[d][1])>0}:function(e){return i(e,c[d][1])>=0},m=u?function(e){return o(e,c[d][0])>0}:function(e){return o(e,c[d][0])>=0};var y=p,g=new this.Collection(this,(function(){return Vt(c[0][0],c[c.length-1][1],!u,!l)}));return g._ondirectionchange=function(e){"next"===e?(y=p,h=i):(y=m,h=o),c.sort(f)},g._addAlgorithm((function(e,t,r){for(var o=e.key;y(o);)if(++d===c.length)return t(r),!1;return!!function(e){return!p(e)&&!m(e)}(o)||(0===n._cmp(o,c[d][1])||0===n._cmp(o,c[d][0])||t((function(){h===i?e.continue(c[d][0]):e.continue(c[d][1])})),!1)})),g},e.prototype.startsWithAnyOf=function(){var e=N.apply(R,arguments);return e.every((function(e){return"string"==typeof e}))?0===e.length?Nt(this):this.inAnyRange(e.map((function(e){return[e,e+yt]}))):Rt(this,"startsWithAnyOf() only works with strings")},e}();function Wt(e){return 1===e.length?e[0]:e}function Yt(e){try{return e.only([[]]),[[]]}catch(e){return yt}}function Ht(e){return Ze((function(t){return Gt(t),e(t.target.error),!1}))}function Gt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Jt=function(){function e(){}return e.prototype._lock=function(){return w(!Te.global),++this._reculock,1!==this._reculock||Te.global||(Te.lockOwnerFor=this),this},e.prototype._unlock=function(){if(w(!Te.global),0==--this._reculock)for(Te.global||(Te.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{ht(e[1],e[0])}catch(e){}}return this},e.prototype._locked=function(){return this._reculock&&Te.lockOwnerFor!==this},e.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(w(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new ne.DatabaseClosed(r);case"MissingAPIError":throw new ne.MissingAPI(r.message,r);default:throw new ne.OpenFailed(r)}if(!this.active)throw new ne.TransactionInactive;return w(null===this._completion._state),(e=this.idbtrans=e||n.transaction(Wt(this.storeNames),this.mode)).onerror=Ze((function(n){Gt(n),t._reject(e.error)})),e.onabort=Ze((function(n){Gt(n),t.active&&t._reject(new ne.Abort(e.error)),t.active=!1,t.on("abort").fire(n)})),e.oncomplete=Ze((function(){t.active=!1,t._resolve()})),this},e.prototype._promise=function(e,t,n){var r=this;if("readwrite"===e&&"readwrite"!==this.mode)return mt(new ne.ReadOnly("Transaction is readonly"));if(!this.active)return mt(new ne.TransactionInactive);if(this._locked())return new Be((function(i,o){r._blockedFuncs.push([function(){r._promise(e,t,n).then(i,o)},Te])}));if(n)return rt((function(){var e=new Be((function(e,n){r._lock();var i=t(e,n,r);i&&i.then&&i.then(e,n)}));return e.finally((function(){return r._unlock()})),e._lib=!0,e}));var i=new Be((function(e,n){var i=t(e,n,r);i&&i.then&&i.then(e,n)}));return i._lib=!0,i},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(e){var t=this._root(),n=Be.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then((function(){return n}));else{t._waitingFor=n,t._waitingQueue=[];var r=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(r.get(-1/0).onsuccess=e)}()}var i=t._waitingFor;return new Be((function(e,r){n.then((function(n){return t._waitingQueue.push(Ze(e.bind(null,n)))}),(function(e){return t._waitingQueue.push(Ze(r.bind(null,e)))})).finally((function(){t._waitingFor===i&&(t._waitingFor=null)}))}))},e.prototype.abort=function(){this.active&&this._reject(new ne.Abort),this.active=!1},e.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(h(t,e))return t[e];var n=this.schema[e];if(!n)throw new ne.NotFound("Table "+e+" not part of transaction");var r=new this.db.Table(e,n,this);return r.core=this.db.core.table(e),t[e]=r,r},e}();function Zt(e,t,n,r,i,o,s){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:o,src:(n&&!s?"&":"")+(r?"*":"")+(i?"++":"")+Xt(t)}}function Xt(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function $t(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:x(n,(function(e){return[e.name,e]}))}}function Qt(e){return null==e?function(){}:"string"==typeof e?function(e){return 1===e.split(".").length?function(t){return t[e]}:function(t){return k(t,e)}}(e):function(t){return k(t,e)}}function en(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}function tn(e){return[].slice.call(e)}var nn=0;function rn(e){return null==e?":id":"string"==typeof e?e:"["+e.join("+")+"]"}function on(e,t,n,r){var o=t.cmp.bind(t);function a(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var t=e.lower,r=e.upper,i=e.lowerOpen,o=e.upperOpen;return void 0===t?void 0===r?null:n.upperBound(r,!!o):void 0===r?n.lowerBound(t,!!i):n.bound(t,r,!!i,!!o)}var u=function(e,t){var n=tn(e.objectStoreNames);return{schema:{name:e.name,tables:n.map((function(e){return t.objectStore(e)})).map((function(e){var t=e.keyPath,n=e.autoIncrement,r=s(t),i=null==t,o={},a={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:i,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:Qt(t)},indexes:tn(e.indexNames).map((function(t){return e.index(t)})).map((function(e){var t=e.name,n=e.unique,r=e.multiEntry,i=e.keyPath,a={name:t,compound:s(i),keyPath:i,unique:n,multiEntry:r,extractKey:Qt(i)};return o[rn(i)]=a,a})),getIndexByKeyPath:function(e){return o[rn(e)]}};return o[":id"]=a.primaryKey,null!=t&&(o[rn(t)]=a.primaryKey),a}))},hasGetAll:n.length>0&&"getAll"in t.objectStore(n[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,r),l=u.schema,c=u.hasGetAll,h=l.tables.map((function(e){return function(e){var t=e.name;return{name:t,schema:e,mutate:function(n){var r=n.trans,o=n.type,s=n.keys,u=n.values,l=n.range,c=n.wantResults;return new Promise((function(n,h){n=Ze(n);var f=r.objectStore(t),d=null==f.keyPath,p="put"===o||"add"===o;if(!p&&"delete"!==o&&"deleteRange"!==o)throw new Error("Invalid operation type: "+o);var m=(s||u||{length:1}).length;if(s&&u&&s.length!==u.length)throw new Error("Given keys array must have same length as given values array.");if(0===m)return n({numFailures:0,failures:{},results:[],lastResult:void 0});var y,g=c&&i(s||en(e.primaryKey,{type:o,keys:s,values:u})),v=[],b=0,w=function(e){++b,Gt(e),g&&(g[e.target._reqno]=void 0),v[e.target._reqno]=e.target.error},_=function(e){var t=e.target;g[t._reqno]=t.result};if("deleteRange"===o){if(4===l.type)return n({numFailures:b,failures:v,results:g,lastResult:void 0});y=3===l.type?f.clear():f.delete(a(l))}else{var x=p?d?[u,s]:[u,null]:[s,null],k=x[0],O=x[1];if(p)for(var P=0;P<m;++P)(y=O&&void 0!==O[P]?f[o](k[P],O[P]):f[o](k[P]))._reqno=P,g&&void 0===g[P]&&(y.onsuccess=_),y.onerror=w;else for(P=0;P<m;++P)(y=f[o](k[P]))._reqno=P,y.onerror=w}var S=function(e){var t=e.target.result;g&&(g[m-1]=t),n({numFailures:b,failures:v,results:g,lastResult:t})};y.onerror=function(e){w(e),S(e)},y.onsuccess=S}))},getMany:function(e){var n=e.trans,r=e.keys;return new Promise((function(e,i){e=Ze(e);for(var o,s=n.objectStore(t),a=r.length,u=new Array(a),l=0,c=0,h=function(t){var n=t.target;null!=(u[n._pos]=n.result)&&0,++c===l&&e(u)},f=Ht(i),d=0;d<a;++d){null!=r[d]&&((o=s.get(r[d]))._pos=d,o.onsuccess=h,o.onerror=f,++l)}0===l&&e(u)}))},get:function(e){var n=e.trans,r=e.key;return new Promise((function(e,i){e=Ze(e);var o=n.objectStore(t).get(r);o.onsuccess=function(t){return e(t.target.result)},o.onerror=Ht(i)}))},query:function(e){return function(n){return new Promise((function(r,i){r=Ze(r);var o=n.trans,s=n.values,u=n.limit,l=n.query,c=u===1/0?void 0:u,h=l.index,f=l.range,d=o.objectStore(t),p=h.isPrimaryKey?d:d.index(h.name),m=a(f);if(0===u)return r({result:[]});if(e){var y=s?p.getAll(m,c):p.getAllKeys(m,c);y.onsuccess=function(e){return r({result:e.target.result})},y.onerror=Ht(i)}else{var g=0,v=s||!("openKeyCursor"in p)?p.openCursor(m):p.openKeyCursor(m),b=[];v.onsuccess=function(e){var t=v.result;return t?(b.push(s?t.value:t.primaryKey),++g===u?r({result:b}):void t.continue()):r({result:b})},v.onerror=Ht(i)}}))}}(c),openCursor:function(e){var n=e.trans,r=e.values,i=e.query,o=e.reverse,s=e.unique;return new Promise((function(e,u){e=Ze(e);var l=i.index,c=i.range,h=n.objectStore(t),f=l.isPrimaryKey?h:h.index(l.name),d=o?s?"prevunique":"prev":s?"nextunique":"next",p=r||!("openKeyCursor"in f)?f.openCursor(a(c),d):f.openKeyCursor(a(c),d);p.onerror=Ht(u),p.onsuccess=Ze((function(t){var r=p.result;if(r){r.___id=++nn,r.done=!1;var i=r.continue.bind(r),o=r.continuePrimaryKey;o&&(o=o.bind(r));var s=r.advance.bind(r),a=function(){throw new Error("Cursor not stopped")};r.trans=n,r.stop=r.continue=r.continuePrimaryKey=r.advance=function(){throw new Error("Cursor not started")},r.fail=Ze(u),r.next=function(){var e=this,t=1;return this.start((function(){return t--?e.continue():e.stop()})).then((function(){return e}))},r.start=function(e){var t=new Promise((function(e,t){e=Ze(e),p.onerror=Ht(t),r.fail=t,r.stop=function(t){r.stop=r.continue=r.continuePrimaryKey=r.advance=a,e(t)}})),n=function(){if(p.result)try{e()}catch(e){r.fail(e)}else r.done=!0,r.start=function(){throw new Error("Cursor behind last entry")},r.stop()};return p.onsuccess=Ze((function(e){p.onsuccess=n,n()})),r.continue=i,r.continuePrimaryKey=o,r.advance=s,n(),t},e(r)}else e(null)}),u)}))},count:function(e){var n=e.query,r=e.trans,i=n.index,o=n.range;return new Promise((function(e,n){var s=r.objectStore(t),u=i.isPrimaryKey?s:s.index(i.name),l=a(o),c=l?u.count(l):u.count();c.onsuccess=Ze((function(t){return e(t.target.result)})),c.onerror=Ht(n)}))}}}(e)})),f={};return h.forEach((function(e){return f[e.name]=e})),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!f[e])throw new Error("Table '"+e+"' not found");return f[e]},cmp:o,MIN_KEY:-1/0,MAX_KEY:Yt(n),schema:l}}function sn(e,t,n,i){var o=n.IDBKeyRange;return{dbcore:function(e,t){return t.reduce((function(e,t){var n=t.create;return r(r({},e),n(e))}),e)}(on(t,n.indexedDB,o,i),e.dbcore)}}function an(e,t){var n=t.db,r=sn(e._middlewares,n,e._deps,t);e.core=r.dbcore,e.tables.forEach((function(t){var n=t.name;e.core.schema.tables.some((function(e){return e.name===n}))&&(t.core=e.core.table(n),e[n]instanceof e.Table&&(e[n].core=t.core))}))}function un(e,t,n,r){n.forEach((function(n){var i=r[n];t.forEach((function(t){n in t||(t===e.Transaction.prototype||t instanceof e.Transaction?p(t,n,{get:function(){return this.table(n)},set:function(e){d(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new e.Table(n,i))}))}))}function ln(e,t){t.forEach((function(t){for(var n in t)t[n]instanceof e.Table&&delete t[n]}))}function cn(e,t){return e._cfg.version-t._cfg.version}function hn(e,t,n,r){var i=e._dbSchema,s=e._createTransaction("readwrite",e._storeNames,i);s.create(n),s._completion.catch(r);var a=s._reject.bind(s),u=Te.transless||Te;rt((function(){Te.trans=s,Te.transless=u,0===t?(o(i).forEach((function(e){fn(n,e,i[e].primKey,i[e].indexes)})),an(e,n),Be.follow((function(){return e.on.populate.fire(s)})).catch(a)):function(e,t,n,r){var i=[],s=e._versions,a=e._dbSchema=pn(e,e.idbdb,r),u=!1;function l(){return i.length?Be.resolve(i.shift()(n.idbtrans)).then(l):Be.resolve()}return s.filter((function(e){return e._cfg.version>=t})).forEach((function(s){i.push((function(){var i=a,l=s._cfg.dbschema;mn(e,i,r),mn(e,l,r),a=e._dbSchema=l;var c=function(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var i=e[n],o=t[n];if(i){var s={name:n,def:o,recreate:!1,del:[],add:[],change:[]};if(i.primKey.src===o.primKey.src||bt){var a=i.idxByName,u=o.idxByName,l=void 0;for(l in a)u[l]||s.del.push(l);for(l in u){var c=a[l],h=u[l];c?c.src!==h.src&&s.change.push(h):s.add.push(h)}(s.del.length>0||s.add.length>0||s.change.length>0)&&r.change.push(s)}else s.recreate=!0,r.change.push(s)}else r.add.push([n,o])}return r}(i,l);c.add.forEach((function(e){fn(r,e[0],e[1].primKey,e[1].indexes)})),c.change.forEach((function(e){if(e.recreate)throw new ne.Upgrade("Not yet support for changing primary key");var t=r.objectStore(e.name);e.add.forEach((function(e){return dn(t,e)})),e.change.forEach((function(e){t.deleteIndex(e.name),dn(t,e)})),e.del.forEach((function(e){return t.deleteIndex(e)}))}));var h=s._cfg.contentUpgrade;if(h&&s._cfg.version>t){an(e,r),u=!0;var f=P(l);c.del.forEach((function(e){f[e]=i[e]})),ln(e,[e.Transaction.prototype]),un(e,[e.Transaction.prototype],o(f),f),n.schema=f;var d,p=F(h);p&&it();var m=Be.follow((function(){if((d=h(n))&&p){var e=ot.bind(null,null);d.then(e,e)}}));return d&&"function"==typeof d.then?Be.resolve(d):m.then((function(){return d}))}})),i.push((function(t){u&&wt||function(e,t){for(var n=0;n<t.db.objectStoreNames.length;++n){var r=t.db.objectStoreNames[n];null==e[r]&&t.db.deleteObjectStore(r)}}(s._cfg.dbschema,t);ln(e,[e.Transaction.prototype]),un(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema}))})),l().then((function(){var e,t;t=r,o(e=a).forEach((function(n){t.db.objectStoreNames.contains(n)||fn(t,n,e[n].primKey,e[n].indexes)}))}))}(e,t,s,n).catch(a)}))}function fn(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach((function(e){return dn(i,e)})),i}function dn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function pn(e,t,n){var r={};return v(t.objectStoreNames,0).forEach((function(e){for(var t=n.objectStore(e),i=t.keyPath,o=Zt(Xt(i),i||"",!1,!1,!!t.autoIncrement,i&&"string"!=typeof i,!0),s=[],a=0;a<t.indexNames.length;++a){var u=t.index(t.indexNames[a]);i=u.keyPath;var l=Zt(u.name,i,!!u.unique,!!u.multiEntry,!1,i&&"string"!=typeof i,!1);s.push(l)}r[e]=$t(e,o,s)})),r}function mn(e,t,n){for(var r=n.db.objectStoreNames,i=0;i<r.length;++i){var o=r[i],s=n.objectStore(o);e._hasGetAll="getAll"in s;for(var u=0;u<s.indexNames.length;++u){var l=s.indexNames[u],c=s.index(l).keyPath,h="string"==typeof c?c:"["+v(c).join("+")+"]";if(t[o]){var f=t[o].idxByName[h];f&&(f.name=l,delete t[o].idxByName[h],t[o].idxByName[l]=f)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&a.WorkerGlobalScope&&a instanceof a.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}var yn,gn=function(){function e(){}return e.prototype._parseStoresSpec=function(e,t){o(e).forEach((function(n){if(null!==e[n]){var r=e[n].split(",").map((function(e,t){var n=(e=e.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return Zt(n,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),s(r),0===t)})),i=r.shift();if(i.multi)throw new ne.Schema("Primary key cannot be multi-valued");r.forEach((function(e){if(e.auto)throw new ne.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new ne.Schema("Index must have a name and cannot be an empty string")})),t[n]=$t(n,i,r)}}))},e.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?u(this._cfg.storesSource,e):e;var n=t._versions,r={},i={};return n.forEach((function(e){u(r,e._cfg.storesSource),i=e._cfg.dbschema={},e._parseStoresSpec(r,i)})),t._dbSchema=i,ln(t,[t._allTables,t,t.Transaction.prototype]),un(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],o(i),i),t._storeNames=o(i),this},e.prototype.upgrade=function(e){return this._cfg.contentUpgrade=e,this},e}();function vn(e){return rt((function(){return Te.letThrough=!0,e()}))}function bn(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then((function(){return t.dbOpenError?mt(t.dbOpenError):e}));U&&(t.openCanceller._stackHolder=W()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.dbReadyResolve,i=null;return Be.race([t.openCanceller,new Be((function(r,s){if(!n)throw new ne.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var a=e.name,u=t.autoSchema?n.open(a):n.open(a,Math.round(10*e.verno));if(!u)throw new ne.MissingAPI("IndexedDB API not available");u.onerror=Ht(s),u.onblocked=Ze(e._fireOnBlocked),u.onupgradeneeded=Ze((function(r){if(i=u.transaction,t.autoSchema&&!e._options.allowEmptyDB){u.onerror=Gt,i.abort(),u.result.close();var o=n.deleteDatabase(a);o.onsuccess=o.onerror=Ze((function(){s(new ne.NoSuchDatabase("Database "+a+" doesnt exist"))}))}else{i.onerror=Ht(s);var l=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;e.idbdb=u.result,hn(e,l/10,i,s)}}),s),u.onsuccess=Ze((function(){i=null;var n=e.idbdb=u.result,s=v(n.objectStoreNames);if(s.length>0)try{var l=n.transaction(Wt(s),"readonly");t.autoSchema?function(e,t,n){e.verno=t.version/10;var r=e._dbSchema=pn(0,t,n);e._storeNames=v(t.objectStoreNames,0),un(e,[e._allTables],o(r),r)}(e,n,l):mn(e,e._dbSchema,l),an(e,l)}catch(e){}vt.push(e),n.onversionchange=Ze((function(n){t.vcFired=!0,e.on("versionchange").fire(n)})),yn.add(a),r()}),s)}))]).then((function(){return t.onReadyBeingFired=[],Be.resolve(vn(e.on.ready.fire)).then((function e(){if(t.onReadyBeingFired.length>0){var n=t.onReadyBeingFired.reduce(de,oe);return t.onReadyBeingFired=[],Be.resolve(vn(n)).then(e)}}))})).finally((function(){t.onReadyBeingFired=null})).then((function(){return t.isBeingOpened=!1,e})).catch((function(n){try{i&&i.abort()}catch(e){}return t.isBeingOpened=!1,e.close(),t.dbOpenError=n,mt(t.dbOpenError)})).finally((function(){t.openComplete=!0,r()}))}function wn(e){var t=function(t){return e.next(t)},n=i(t),r=i((function(t){return e.throw(t)}));function i(e){return function(t){var i=e(t),o=i.value;return i.done?o:o&&"function"==typeof o.then?o.then(n,r):s(o)?Promise.all(o).then(n,r):n(o)}}return i(t)()}function _n(e,t,n){var r=arguments.length;if(r<2)throw new ne.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var o=C(i);return[e,o,n]}function xn(e,t,n,r,i){return Be.resolve().then((function(){var o=Te.transless||Te,s=e._createTransaction(t,n,e._dbSchema,r),a={trans:s,transless:o};r?s.idbtrans=r.idbtrans:s.create();var u,l=F(i);l&&it();var c=Be.follow((function(){if(u=i.call(s,s))if(l){var e=ot.bind(null,null);u.then(e,e)}else"function"==typeof u.next&&"function"==typeof u.throw&&(u=wn(u))}),a);return(u&&"function"==typeof u.then?Be.resolve(u).then((function(e){return s.active?e:mt(new ne.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):c.then((function(){return u}))).then((function(e){return r&&s._resolve(),s._completion.then((function(){return e}))})).catch((function(e){return s._reject(e),mt(e)}))}))}function kn(e,t,n){for(var r=s(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}var On={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return r(r({},e),{table:function(t){var n=e.table(t),i=n.schema,o={},s=[];function a(e,t,n){var i=rn(e),u=o[i]=o[i]||[],l=null==e?0:"string"==typeof e?1:e.length,c=t>0,h=r(r({},n),{isVirtual:c,isPrimaryKey:!c&&n.isPrimaryKey,keyTail:t,keyLength:l,extractKey:Qt(e),unique:!c&&n.unique});(u.push(h),h.isPrimaryKey||s.push(h),l>1)&&a(2===l?e[0]:e.slice(0,l-1),t+1,n);return u.sort((function(e,t){return e.keyTail-t.keyTail})),h}var u=a(i.primaryKey.keyPath,0,i.primaryKey);o[":id"]=[u];for(var l=0,c=i.indexes;l<c.length;l++){var h=c[l];a(h.keyPath,0,h)}function f(t){var n,i,o=t.query.index;return o.isVirtual?r(r({},t),{query:{index:o,range:(n=t.query.range,i=o.keyTail,{type:1===n.type?2:n.type,lower:kn(n.lower,n.lowerOpen?e.MAX_KEY:e.MIN_KEY,i),lowerOpen:!0,upper:kn(n.upper,n.upperOpen?e.MIN_KEY:e.MAX_KEY,i),upperOpen:!0})}}):t}return r(r({},n),{schema:r(r({},i),{primaryKey:u,indexes:s,getIndexByKeyPath:function(e){var t=o[rn(e)];return t&&t[0]}}),count:function(e){return n.count(f(e))},query:function(e){return n.query(f(e))},openCursor:function(t){var r=t.query.index,i=r.keyTail,o=r.isVirtual,s=r.keyLength;if(!o)return n.openCursor(t);return n.openCursor(f(t)).then((function(n){return n&&function(n){return Object.create(n,{continue:{value:function(r){null!=r?n.continue(kn(r,t.reverse?e.MAX_KEY:e.MIN_KEY,i)):t.unique?n.continue(kn(n.key,t.reverse?e.MIN_KEY:e.MAX_KEY,i)):n.continue()}},continuePrimaryKey:{value:function(t,r){n.continuePrimaryKey(kn(t,e.MAX_KEY,i),r)}},key:{get:function(){var e=n.key;return 1===s?e[0]:e.slice(0,s)}},value:{get:function(){return n.value}}})}(n)}))}})}})}},Pn={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return r(r({},e),{table:function(t){var n=e.table(t),o=n.schema.primaryKey;return r(r({},n),{mutate:function(e){var s=Te.trans,a=s.table(t).hook,u=a.deleting,l=a.creating,c=a.updating;switch(e.type){case"add":if(l.fire===oe)break;return s._promise("readwrite",(function(){return h(e)}),!0);case"put":if(l.fire===oe&&c.fire===oe)break;return s._promise("readwrite",(function(){return h(e)}),!0);case"delete":if(u.fire===oe)break;return s._promise("readwrite",(function(){return h(e)}),!0);case"deleteRange":if(u.fire===oe)break;return s._promise("readwrite",(function(){return function(e){return function e(t,i,s){return n.query({trans:t,values:!1,query:{index:o,range:i},limit:s}).then((function(n){var o=n.result;return h({type:"delete",keys:o,trans:t}).then((function(n){return n.numFailures>0?Promise.reject(n.failures[0]):o.length<s?{failures:[],numFailures:0,lastResult:void 0}:e(t,r(r({},i),{lower:o[o.length-1],lowerOpen:!0}),s)}))}))}(e.trans,e.range,1e4)}(e)}),!0)}return n.mutate(e);function h(e){var t=Te.trans,s=e.keys||en(o,e);if(!s)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?r(r({},e),{keys:s,wantResults:!0}):r({},e)).type&&(e.values=i(e.values)),e.keys&&(e.keys=i(e.keys)),function(e,t,n){return"add"===t.type?Promise.resolve(new Array(t.values.length)):e.getMany({trans:t.trans,keys:n})}(n,e,s).then((function(r){var i=s.map((function(n,i){var s=r[i],a={onerror:null,onsuccess:null};if("delete"===e.type)u.fire.call(a,n,s,t);else if("add"===e.type||void 0===s){var h=l.fire.call(a,n,e.values[i],t);null==n&&null!=h&&(n=h,e.keys[i]=n,o.outbound||O(e.values[i],o.keyPath,n))}else{var f=z(s,e.values[i]),d=c.fire.call(a,f,n,s,t);if(d){var p=e.values[i];Object.keys(d).forEach((function(e){O(p,e,d[e])}))}}return a}));return n.mutate(e).then((function(t){for(var n=t.failures,o=t.results,a=t.numFailures,u=t.lastResult,l=0;l<s.length;++l){var c=o?o[l]:s[l],h=i[l];null==c?h.onerror&&h.onerror(n[l]):h.onsuccess&&h.onsuccess("put"===e.type&&r[l]?e.values[l]:c)}return{failures:n,results:o,numFailures:a,lastResult:u}})).catch((function(e){return i.forEach((function(t){return t.onerror&&t.onerror(e)})),Promise.reject(e)}))}))}}})}})}},Sn=function(){function e(t,n){var i=this;this._middlewares={},this.verno=0;var o=e.dependencies;this._options=n=r({addons:e.addons,autoOpen:!0,indexedDB:o.indexedDB,IDBKeyRange:o.IDBKeyRange},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var s=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null;var a,u={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:oe,dbReadyPromise:null,cancelOpen:oe,openCanceller:null,autoSchema:!0};u.dbReadyPromise=new Be((function(e){u.dbReadyResolve=e})),u.openCanceller=new Be((function(e,t){u.cancelOpen=t})),this._state=u,this.name=t,this.on=St(this,"populate","blocked","versionchange",{ready:[de,oe]}),this.on.ready.subscribe=b(this.on.ready.subscribe,(function(t){return function(n,r){e.vip((function(){var e=i._state;if(e.openComplete)e.dbOpenError||Be.resolve().then(n),r&&t(n);else if(e.onReadyBeingFired)e.onReadyBeingFired.push(n),r&&t(n);else{t(n);var o=i;r||t((function e(){o.on.ready.unsubscribe(n),o.on.ready.unsubscribe(e)}))}}))}})),this.Collection=(a=this,Ct(zt.prototype,(function(e,t){this.db=a;var n=Ot,r=null;if(t)try{n=t()}catch(e){r=e}var i=e._ctx,o=i.table,s=o.hook.reading.fire;this._ctx={table:o,index:i.index,isPrimKey:!i.index||o.schema.primKey.keyPath&&i.index===o.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:i.or,valueMapper:s!==se?s:null}}))),this.Table=function(e){return Ct(Pt.prototype,(function(t,n,r){this.db=e,this._tx=r,this.name=t,this.schema=n,this.hook=e._allTables[t]?e._allTables[t].hook:St(null,{creating:[le,oe],reading:[ae,se],updating:[he,oe],deleting:[ce,oe]})}))}(this),this.Transaction=function(e){return Ct(Jt.prototype,(function(t,n,r,i){var o=this;this.db=e,this.mode=t,this.storeNames=n,this.schema=r,this.idbtrans=null,this.on=St(this,"complete","error","abort"),this.parent=i||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Be((function(e,t){o._resolve=e,o._reject=t})),this._completion.then((function(){o.active=!1,o.on.complete.fire()}),(function(e){var t=o.active;return o.active=!1,o.on.error.fire(e),o.parent?o.parent._reject(e):t&&o.idbtrans&&o.idbtrans.abort(),mt(e)}))}))}(this),this.Version=function(e){return Ct(gn.prototype,(function(t){this.db=e,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}(this),this.WhereClause=function(e){return Ct(Kt.prototype,(function(t,n,r){this.db=e,this._ctx={table:t,index:":id"===n?null:n,or:r};var i=e._deps.indexedDB;if(!i)throw new ne.MissingAPI("indexedDB API missing");this._cmp=this._ascending=i.cmp.bind(i),this._descending=function(e,t){return i.cmp(t,e)},this._max=function(e,t){return i.cmp(e,t)>0?e:t},this._min=function(e,t){return i.cmp(e,t)<0?e:t},this._IDBKeyRange=e._deps.IDBKeyRange}))}(this),this.on("versionchange",(function(e){e.newVersion>0?console.warn("Another connection wants to upgrade database '"+i.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+i.name+"'. Closing db now to resume the delete request."),i.close()})),this.on("blocked",(function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('"+i.name+"') was blocked"):console.warn("Upgrade '"+i.name+"' blocked by other connection holding version "+e.oldVersion/10)})),this._maxKey=Yt(n.IDBKeyRange),this._createTransaction=function(e,t,n,r){return new i.Transaction(e,t,n,r)},this._fireOnBlocked=function(e){i.on("blocked").fire(e),vt.filter((function(e){return e.name===i.name&&e!==i&&!e._state.vcFired})).map((function(t){return t.on("versionchange").fire(e)}))},this.use(On),this.use(Pn),s.forEach((function(e){return e(i)}))}return e.prototype.version=function(e){if(isNaN(e)||e<.1)throw new ne.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new ne.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter((function(t){return t._cfg.version===e}))[0];return n||(n=new this.Version(e),t.push(n),t.sort(cn),n.stores({}),this._state.autoSchema=!1,n)},e.prototype._whenReady=function(e){var t=this;return this._state.openComplete||Te.letThrough?e():new Be((function(e,n){if(!t._state.isBeingOpened){if(!t._options.autoOpen)return void n(new ne.DatabaseClosed);t.open().catch(oe)}t._state.dbReadyPromise.then(e,n)})).then(e)},e.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,i=e.name;i&&this.unuse({stack:t,name:i});var o=this._middlewares[t]||(this._middlewares[t]=[]);return o.push({stack:t,create:n,level:null==r?10:r,name:i}),o.sort((function(e,t){return e.level-t.level})),this},e.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter((function(e){return r?e.create!==r:!!n&&e.name!==n}))),this},e.prototype.open=function(){return bn(this)},e.prototype.close=function(){var e=vt.indexOf(this),t=this._state;if(e>=0&&vt.splice(e,1),this.idbdb){try{this.idbdb.close()}catch(e){}this.idbdb=null}this._options.autoOpen=!1,t.dbOpenError=new ne.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError),t.dbReadyPromise=new Be((function(e){t.dbReadyResolve=e})),t.openCanceller=new Be((function(e,n){t.cancelOpen=n}))},e.prototype.delete=function(){var e=this,t=arguments.length>0,n=this._state;return new Be((function(r,i){var o=function(){e.close();var t=e._deps.indexedDB.deleteDatabase(e.name);t.onsuccess=Ze((function(){yn.remove(e.name),r()})),t.onerror=Ht(i),t.onblocked=e._fireOnBlocked};if(t)throw new ne.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(o):o()}))},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return null!==this.idbdb},e.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},e.prototype.hasFailed=function(){return null!==this._state.dbOpenError},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var e=this;return o(this._allTables).map((function(t){return e._allTables[t]}))},enumerable:!0,configurable:!0}),e.prototype.transaction=function(){var e=_n.apply(this,arguments);return this._transaction.apply(this,e)},e.prototype._transaction=function(e,t,n){var r=this,i=Te.trans;i&&i.db===this&&-1===e.indexOf("!")||(i=null);var o,s,a=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(s=t.map((function(e){var t=e instanceof r.Table?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t})),"r"==e||"readonly"===e)o="readonly";else{if("rw"!=e&&"readwrite"!=e)throw new ne.InvalidArgument("Invalid transaction mode: "+e);o="readwrite"}if(i){if("readonly"===i.mode&&"readwrite"===o){if(!a)throw new ne.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&s.forEach((function(e){if(i&&-1===i.storeNames.indexOf(e)){if(!a)throw new ne.SubTransaction("Table "+e+" not included in parent transaction.");i=null}})),a&&i&&!i.active&&(i=null)}}catch(e){return i?i._promise(null,(function(t,n){n(e)})):mt(e)}var u=xn.bind(null,this,o,s,i,n);return i?i._promise(o,u,"lock"):Te.trans?ht(Te.transless,(function(){return r._whenReady(u)})):this._whenReady(u)},e.prototype.table=function(e){if(!h(this._allTables,e))throw new ne.InvalidTable("Table "+e+" does not exist");return this._allTables[e]},e}(),Cn=Sn;f(Cn,r(r({},ie),{delete:function(e){return new Cn(e).delete()},exists:function(e){return new Cn(e,{addons:[]}).open().then((function(e){return e.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(e){return yn?yn.getDatabaseNames().then(e):Be.resolve([])},defineClass:function(){return function(e){u(this,e)}},ignoreTransaction:function(e){return Te.trans?ht(Te.transless,e):e()},vip:vn,async:function(e){return function(){try{var t=wn(e.apply(this,arguments));return t&&"function"==typeof t.then?t:Be.resolve(t)}catch(e){return mt(e)}}},spawn:function(e,t,n){try{var r=wn(e.apply(n,t||[]));return r&&"function"==typeof r.then?r:Be.resolve(r)}catch(e){return mt(e)}},currentTransaction:{get:function(){return Te.trans||null}},waitFor:function(e,t){var n=Be.resolve("function"==typeof e?Cn.ignoreTransaction(e):e).timeout(t||6e4);return Te.trans?Te.trans.waitFor(n):n},Promise:Be,debug:{get:function(){return U},set:function(e){V(e,"dexie"===e?function(){return!0}:xt)}},derive:m,extend:u,props:f,override:b,Events:St,getByKeyPath:k,setByKeyPath:O,delByKeyPath:function(e,t){"string"==typeof t?O(e,t,void 0):"length"in t&&[].map.call(t,(function(t){O(e,t,void 0)}))},shallowClone:P,deepClone:M,getObjectDiff:z,asap:_,minKey:-1/0,addons:[],connections:vt,errnames:ee,dependencies:function(){try{return{indexedDB:a.indexedDB||a.mozIndexedDB||a.webkitIndexedDB||a.msIndexedDB,IDBKeyRange:a.IDBKeyRange||a.webkitIDBKeyRange}}catch(e){return{indexedDB:null,IDBKeyRange:null}}}(),semVer:"3.0.2",version:"3.0.2".split(".").map((function(e){return parseInt(e)})).reduce((function(e,t,n){return e+t/Math.pow(10,2*n)})),default:Cn,Dexie:Cn})),Cn.maxKey=Yt(Cn.dependencies.IDBKeyRange),function(e){try{yn=function(e){var t,n=e&&"function"==typeof e.databases;if(!n){var r=new Sn("__dbnames",{addons:[]});r.version(1).stores({dbnames:"name"}),t=r.table("dbnames")}return{getDatabaseNames:function(){return n?Be.resolve(e.databases()).then((function(e){return e.map((function(e){return e.name})).filter((function(e){return"__dbnames"!==e}))})):t.toCollection().primaryKeys()},add:function(e){return!n&&"__dbnames"!==e&&t.put({name:e}).catch(oe)},remove:function(e){return!n&&"__dbnames"!==e&&t.delete(e).catch(oe)}}}(e)}catch(e){}}(Sn.dependencies.indexedDB),Be.rejectionMapper=function(e,t){if(!e||e instanceof Z||e instanceof TypeError||e instanceof SyntaxError||!e.name||!re[e.name])return e;var n=new re[e.name](t||e.message,e);return"stack"in e&&p(n,"stack",{get:function(){return this.inner.stack}}),n},V(U,xt),t.default=Sn},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const s=n(81),a=o(n(97)),u=n(169),l=n(243),c=n(170),h=n(144),f=n(171);function d(){const e=new a.Rectangle;e.height=13*s.scale+"px",e.thickness=0;const t=()=>{e.height=13*s.scale+"px"};s.event.on("scale-change",t),e.onDisposeObservable.add(()=>{s.event.off("scale-change",t)});const n=new a.Rectangle;n.width="20%",n.horizontalAlignment=0,n.thickness=0,e.addControl(n);const r=new a.Rectangle;r.width="50%",r.horizontalAlignment=0,r.left="20%",r.thickness=0,e.addControl(r);const i=new a.Rectangle;i.width="10%",i.horizontalAlignment=0,i.left="70%",i.thickness=0,e.addControl(i);const o=new a.Rectangle;return o.width="20%",o.horizontalAlignment=0,o.left="80%",o.thickness=0,e.addControl(o),{main:e,name:n,motd:r,players:i,software:o}}t.default=function(e,t){const n=new a.Rectangle;n.thickness=0,n.horizontalAlignment=2,n.zIndex=10,window.innerHeight>230*s.scale?n.height=230*s.scale+"px":n.height="100%",n.width=310*s.scale+"px",n.background="#11111166";const r=new a.TextBlock;r.fontFamily="Lato",r.fontSize=11*s.scale,r.textVerticalAlignment=0,r.color="white",r.text="Multiplayer",r.top=s.scale,n.addControl(r);const i=new a.InputText;i.height=17*s.scale+"px",i.width=266*s.scale+"px",i.top=18*s.scale+"px",i.left=5*s.scale+"px",i.fontSize=6*s.scale,i.verticalAlignment=0,i.horizontalAlignment=0,i.thickness=0,i.background="#ffffffaa",i.focusedBackground="#ffffffff",i.color="#666666",i.placeholderText="Server address",n.addControl(i);const o=new a.Rectangle;o.height=17*s.scale+"px",o.width=34*s.scale+"px",o.top=18*s.scale+"px",o.left=-5*s.scale+"px",o.verticalAlignment=0,o.horizontalAlignment=1,o.thickness=0,o.background="#4d4d4daa",o.color="#666666",o.onPointerClickObservable.add(()=>{let t=i.text;t.startsWith("wss://")||t.startsWith("ws://")||(t="ws://"+t);const n=new l.Socket(t);c.connect(e,n)});const p=new u.FormTextBlock;p.text=[{text:"Connect",color:"white",font:"Lato"}],p.textHorizontalAlignment=2,p.fontSize=6*s.scale,p.onPointerEnterObservable.add(e=>{p.text.forEach(e=>e.underline=!0),p._markAsDirty()}),p.onPointerOutObservable.add(e=>{p.text.forEach(e=>e.underline=!1),p._markAsDirty()}),o.addControl(p),n.addControl(o);const m=new a.Rectangle;m.width=290*s.scale+"px",m.height="70%",m.verticalAlignment=0,m.top=40*s.scale+"px",m.background="#ffffffbb",m.thickness=0;const y=d();y.main.verticalAlignment=0,y.main.fontFamily="Lato",y.main.background="#88888855",y.main.fontSize=7*s.scale;const g=new a.TextBlock;g.text="Name",g.color="#222222",y.name.addControl(g);const v=new a.TextBlock;v.text="Motd",v.color="#222222",y.motd.addControl(v);const b=new a.TextBlock;b.text="Players",b.color="#222222",y.players.addControl(b);const w=new a.TextBlock;w.text="Software",w.color="#222222",y.software.addControl(w),m.addControl(y.main),n.addControl(m);const _=new a.ScrollViewer;_.height=150*s.scale+"px",_.top=13*s.scale+"px",_.thickness=0,_.verticalAlignment=0,_.barSize=0,m.addControl(_);const x=new a.StackPanel;x.fontFamily="Lato",x.width="100%",x.fontSize=6*s.scale,x.verticalAlignment=0,_.addControl(x),fetch("http://pb4.eu:9001").then(e=>e.json()).then(e=>{Object.values(e).forEach(e=>{const t=d(),n=new a.TextBlock;n.text=e.name,n.color="#222222",t.name.addControl(n);const r=new a.TextBlock;r.text=e.motd,r.color="#222222",t.motd.addControl(r);const s=new a.TextBlock;s.text=`${e.numberplayers}/${e.maxplayers}`,s.color="#222222",t.players.addControl(s);const u=new a.TextBlock;u.text=e.software,u.color="#222222",t.software.addControl(u),t.main.onPointerEnterObservable.add(e=>{t.main.background="#ffffff67"}),t.main.onPointerOutObservable.add(e=>{t.main.background="#ffffff00"});let l=0;t.main.onPointerClickObservable.add(t=>{i.text=e.ip,l+=1,l>1&&o.onPointerClickObservable.notifyObservers(new a.Vector2WithInfo(new h.Vector2(0,0),0)),setTimeout(()=>{l=0},1e3)}),x.addControl(t.main)})});const k=f.createItem();k.item.verticalAlignment=1,k.text.text=[{text:"Go back to menu",color:"white",font:"Lato"}],k.item.onPointerClickObservable.add(()=>{n.dispose(),t("main")}),n.addControl(k.item);const O=e=>{window.innerHeight>230*s.scale?n.height=230*s.scale+"px":n.height="100%",n.width=310*s.scale+"px",r.fontSize=11*s.scale,i.height=17*s.scale+"px",i.width=266*s.scale+"px",i.top=18*s.scale+"px",i.left=5*s.scale+"px",i.fontSize=6*s.scale,o.height=17*s.scale+"px",o.width=34*s.scale+"px",o.top=18*s.scale+"px",o.left=-5*s.scale+"px",p.fontSize=6*s.scale,m.width=290*s.scale+"px",m.top=40*s.scale+"px",_.top=13*s.scale+"px",y.main.fontSize=7*s.scale,x.fontSize=6*s.scale,_.height=150*s.scale+"px",k.item.width=100*s.scale+"px",k.item.height=18*s.scale+"px",k.text.fontSize=10*s.scale};return s.event.on("scale-change",O),n.onDisposeObservable.add(()=>{s.event.off("scale-change",O)}),n}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.parseToMessage=t.parseToObject=void 0;const a=o(n(336)),u=o(n(351)),l=s(n(352)),c=s(n(353));let h={},f={};l.default.forEach((e,t)=>f[e]=t),c.default.forEach((e,t)=>h[e]=t),t.parseToObject=function(e,t){let n,r="";if("server"==e){if(r=c.default[t[0]],null==r)return null;n=u[r]}else{if(r=l.default[t[0]],null==r)return null;n=a[r],e="client"}const i=t.slice(1),o=n.decode(i);let s=null;return s=null!=n?n.verify(o):"Invalid packet",s?(console.error("Invalid "+e+" packet! Type: "+r,s),null):{data:n.toObject(o),type:r}},t.parseToMessage=function(e,t,n){let r,i=0;if("server"==e){if(i=h[t],null==i)return null;r=u[t]}else{if(i=f[t],null==i)return null;r=a[t],e="client"}let o=null;if(o=null!=r?r.verify(n):"Invalid packet",o)return console.error("Invalid "+e+" packet! Type: "+t,n,o),null;const s=r.create(n),l=r.encode(s).finish(),c=new Uint8Array(1+l.length);return c.set([i]),c.set(l,1),c.buffer}},function(e,t,n){var r,i,o;i=[n(244)],void 0===(o="function"==typeof(r=function(e){"use strict";var t=e.Reader,n=e.Writer,r=e.util,i=e.roots.default||(e.roots.default={});return i.LoginResponse=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.username="",o.prototype.protocol=0,o.prototype.mobile=!1,o.prototype.client="",o.prototype.uuid="",o.prototype.secret="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.username&&Object.hasOwnProperty.call(e,"username")&&t.uint32(10).string(e.username),null!=e.protocol&&Object.hasOwnProperty.call(e,"protocol")&&t.uint32(16).uint32(e.protocol),null!=e.mobile&&Object.hasOwnProperty.call(e,"mobile")&&t.uint32(24).bool(e.mobile),null!=e.client&&Object.hasOwnProperty.call(e,"client")&&t.uint32(34).string(e.client),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(42).string(e.uuid),null!=e.secret&&Object.hasOwnProperty.call(e,"secret")&&t.uint32(50).string(e.secret),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.LoginResponse;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.username=e.string();break;case 2:o.protocol=e.uint32();break;case 3:o.mobile=e.bool();break;case 4:o.client=e.string();break;case 5:o.uuid=e.string();break;case 6:o.secret=e.string();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.username&&e.hasOwnProperty("username")&&!r.isString(e.username)?"username: string expected":null!=e.protocol&&e.hasOwnProperty("protocol")&&!r.isInteger(e.protocol)?"protocol: integer expected":null!=e.mobile&&e.hasOwnProperty("mobile")&&"boolean"!=typeof e.mobile?"mobile: boolean expected":null!=e.client&&e.hasOwnProperty("client")&&!r.isString(e.client)?"client: string expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!r.isString(e.uuid)?"uuid: string expected":null!=e.secret&&e.hasOwnProperty("secret")&&!r.isString(e.secret)?"secret: string expected":null},o.fromObject=function(e){if(e instanceof i.LoginResponse)return e;var t=new i.LoginResponse;return null!=e.username&&(t.username=String(e.username)),null!=e.protocol&&(t.protocol=e.protocol>>>0),null!=e.mobile&&(t.mobile=Boolean(e.mobile)),null!=e.client&&(t.client=String(e.client)),null!=e.uuid&&(t.uuid=String(e.uuid)),null!=e.secret&&(t.secret=String(e.secret)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.username="",n.protocol=0,n.mobile=!1,n.client="",n.uuid="",n.secret=""),null!=e.username&&e.hasOwnProperty("username")&&(n.username=e.username),null!=e.protocol&&e.hasOwnProperty("protocol")&&(n.protocol=e.protocol),null!=e.mobile&&e.hasOwnProperty("mobile")&&(n.mobile=e.mobile),null!=e.client&&e.hasOwnProperty("client")&&(n.client=e.client),null!=e.uuid&&e.hasOwnProperty("uuid")&&(n.uuid=e.uuid),null!=e.secret&&e.hasOwnProperty("secret")&&(n.secret=e.secret),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.ActionMove=function(){function r(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return r.prototype.x=0,r.prototype.y=0,r.prototype.z=0,r.prototype.rotation=0,r.prototype.pitch=0,r.create=function(e){return new r(e)},r.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(9).double(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(17).double(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(25).double(e.z),null!=e.rotation&&Object.hasOwnProperty.call(e,"rotation")&&t.uint32(37).float(e.rotation),null!=e.pitch&&Object.hasOwnProperty.call(e,"pitch")&&t.uint32(45).float(e.pitch),t},r.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},r.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.ActionMove;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.x=e.double();break;case 2:o.y=e.double();break;case 3:o.z=e.double();break;case 4:o.rotation=e.float();break;case 5:o.pitch=e.float();break;default:e.skipType(7&s)}}return o},r.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},r.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&"number"!=typeof e.x?"x: number expected":null!=e.y&&e.hasOwnProperty("y")&&"number"!=typeof e.y?"y: number expected":null!=e.z&&e.hasOwnProperty("z")&&"number"!=typeof e.z?"z: number expected":null!=e.rotation&&e.hasOwnProperty("rotation")&&"number"!=typeof e.rotation?"rotation: number expected":null!=e.pitch&&e.hasOwnProperty("pitch")&&"number"!=typeof e.pitch?"pitch: number expected":null},r.fromObject=function(e){if(e instanceof i.ActionMove)return e;var t=new i.ActionMove;return null!=e.x&&(t.x=Number(e.x)),null!=e.y&&(t.y=Number(e.y)),null!=e.z&&(t.z=Number(e.z)),null!=e.rotation&&(t.rotation=Number(e.rotation)),null!=e.pitch&&(t.pitch=Number(e.pitch)),t},r.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0,n.rotation=0,n.pitch=0),null!=e.x&&e.hasOwnProperty("x")&&(n.x=t.json&&!isFinite(e.x)?String(e.x):e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=t.json&&!isFinite(e.y)?String(e.y):e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=t.json&&!isFinite(e.z)?String(e.z):e.z),null!=e.rotation&&e.hasOwnProperty("rotation")&&(n.rotation=t.json&&!isFinite(e.rotation)?String(e.rotation):e.rotation),null!=e.pitch&&e.hasOwnProperty("pitch")&&(n.pitch=t.json&&!isFinite(e.pitch)?String(e.pitch):e.pitch),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},r}(),i.ActionMessage=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.message="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(10).string(e.message),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.ActionMessage;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.message=e.string();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.message&&e.hasOwnProperty("message")&&!r.isString(e.message)?"message: string expected":null},o.fromObject=function(e){if(e instanceof i.ActionMessage)return e;var t=new i.ActionMessage;return null!=e.message&&(t.message=String(e.message)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.message=""),null!=e.message&&e.hasOwnProperty("message")&&(n.message=e.message),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.ActionBlockPlace=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.x=0,o.prototype.y=0,o.prototype.z=0,o.prototype.x2=0,o.prototype.y2=0,o.prototype.z2=0,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(8).int32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(16).int32(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(24).int32(e.z),null!=e.x2&&Object.hasOwnProperty.call(e,"x2")&&t.uint32(32).int32(e.x2),null!=e.y2&&Object.hasOwnProperty.call(e,"y2")&&t.uint32(40).int32(e.y2),null!=e.z2&&Object.hasOwnProperty.call(e,"z2")&&t.uint32(48).int32(e.z2),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.ActionBlockPlace;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.x=e.int32();break;case 2:o.y=e.int32();break;case 3:o.z=e.int32();break;case 4:o.x2=e.int32();break;case 5:o.y2=e.int32();break;case 6:o.z2=e.int32();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&!r.isInteger(e.x)?"x: integer expected":null!=e.y&&e.hasOwnProperty("y")&&!r.isInteger(e.y)?"y: integer expected":null!=e.z&&e.hasOwnProperty("z")&&!r.isInteger(e.z)?"z: integer expected":null!=e.x2&&e.hasOwnProperty("x2")&&!r.isInteger(e.x2)?"x2: integer expected":null!=e.y2&&e.hasOwnProperty("y2")&&!r.isInteger(e.y2)?"y2: integer expected":null!=e.z2&&e.hasOwnProperty("z2")&&!r.isInteger(e.z2)?"z2: integer expected":null},o.fromObject=function(e){if(e instanceof i.ActionBlockPlace)return e;var t=new i.ActionBlockPlace;return null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.z&&(t.z=0|e.z),null!=e.x2&&(t.x2=0|e.x2),null!=e.y2&&(t.y2=0|e.y2),null!=e.z2&&(t.z2=0|e.z2),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0,n.x2=0,n.y2=0,n.z2=0),null!=e.x&&e.hasOwnProperty("x")&&(n.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=e.z),null!=e.x2&&e.hasOwnProperty("x2")&&(n.x2=e.x2),null!=e.y2&&e.hasOwnProperty("y2")&&(n.y2=e.y2),null!=e.z2&&e.hasOwnProperty("z2")&&(n.z2=e.z2),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.ActionBlockBreak=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.x=0,o.prototype.y=0,o.prototype.z=0,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(8).int32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(16).int32(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(24).int32(e.z),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.ActionBlockBreak;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.x=e.int32();break;case 2:o.y=e.int32();break;case 3:o.z=e.int32();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&!r.isInteger(e.x)?"x: integer expected":null!=e.y&&e.hasOwnProperty("y")&&!r.isInteger(e.y)?"y: integer expected":null!=e.z&&e.hasOwnProperty("z")&&!r.isInteger(e.z)?"z: integer expected":null},o.fromObject=function(e){if(e instanceof i.ActionBlockBreak)return e;var t=new i.ActionBlockBreak;return null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.z&&(t.z=0|e.z),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0),null!=e.x&&e.hasOwnProperty("x")&&(n.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=e.z),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.ActionInventoryClick=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.slot=0,o.prototype.type="",o.prototype.inventory="",o.prototype.slot2=0,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.slot&&Object.hasOwnProperty.call(e,"slot")&&t.uint32(8).int32(e.slot),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(18).string(e.type),null!=e.inventory&&Object.hasOwnProperty.call(e,"inventory")&&t.uint32(26).string(e.inventory),null!=e.slot2&&Object.hasOwnProperty.call(e,"slot2")&&t.uint32(32).int32(e.slot2),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.ActionInventoryClick;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.slot=e.int32();break;case 2:o.type=e.string();break;case 3:o.inventory=e.string();break;case 4:o.slot2=e.int32();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.slot&&e.hasOwnProperty("slot")&&!r.isInteger(e.slot)?"slot: integer expected":null!=e.type&&e.hasOwnProperty("type")&&!r.isString(e.type)?"type: string expected":null!=e.inventory&&e.hasOwnProperty("inventory")&&!r.isString(e.inventory)?"inventory: string expected":null!=e.slot2&&e.hasOwnProperty("slot2")&&!r.isInteger(e.slot2)?"slot2: integer expected":null},o.fromObject=function(e){if(e instanceof i.ActionInventoryClick)return e;var t=new i.ActionInventoryClick;return null!=e.slot&&(t.slot=0|e.slot),null!=e.type&&(t.type=String(e.type)),null!=e.inventory&&(t.inventory=String(e.inventory)),null!=e.slot2&&(t.slot2=0|e.slot2),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.slot=0,n.type="",n.inventory="",n.slot2=0),null!=e.slot&&e.hasOwnProperty("slot")&&(n.slot=e.slot),null!=e.type&&e.hasOwnProperty("type")&&(n.type=e.type),null!=e.inventory&&e.hasOwnProperty("inventory")&&(n.inventory=e.inventory),null!=e.slot2&&e.hasOwnProperty("slot2")&&(n.slot2=e.slot2),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.ActionInventoryOpen=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.inventory="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.inventory&&Object.hasOwnProperty.call(e,"inventory")&&t.uint32(10).string(e.inventory),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.ActionInventoryOpen;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.inventory=e.string();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.inventory&&e.hasOwnProperty("inventory")&&!r.isString(e.inventory)?"inventory: string expected":null},o.fromObject=function(e){if(e instanceof i.ActionInventoryOpen)return e;var t=new i.ActionInventoryOpen;return null!=e.inventory&&(t.inventory=String(e.inventory)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.inventory=""),null!=e.inventory&&e.hasOwnProperty("inventory")&&(n.inventory=e.inventory),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.ActionInventoryClose=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.inventory="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.inventory&&Object.hasOwnProperty.call(e,"inventory")&&t.uint32(10).string(e.inventory),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.ActionInventoryClose;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.inventory=e.string();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.inventory&&e.hasOwnProperty("inventory")&&!r.isString(e.inventory)?"inventory: string expected":null},o.fromObject=function(e){if(e instanceof i.ActionInventoryClose)return e;var t=new i.ActionInventoryClose;return null!=e.inventory&&(t.inventory=String(e.inventory)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.inventory=""),null!=e.inventory&&e.hasOwnProperty("inventory")&&(n.inventory=e.inventory),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.ActionClick=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.x=0,o.prototype.y=0,o.prototype.z=0,o.prototype.type="",o.prototype.onBlock=!1,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(8).int32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(16).int32(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(24).int32(e.z),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(34).string(e.type),null!=e.onBlock&&Object.hasOwnProperty.call(e,"onBlock")&&t.uint32(40).bool(e.onBlock),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.ActionClick;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.x=e.int32();break;case 2:o.y=e.int32();break;case 3:o.z=e.int32();break;case 4:o.type=e.string();break;case 5:o.onBlock=e.bool();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&!r.isInteger(e.x)?"x: integer expected":null!=e.y&&e.hasOwnProperty("y")&&!r.isInteger(e.y)?"y: integer expected":null!=e.z&&e.hasOwnProperty("z")&&!r.isInteger(e.z)?"z: integer expected":null!=e.type&&e.hasOwnProperty("type")&&!r.isString(e.type)?"type: string expected":null!=e.onBlock&&e.hasOwnProperty("onBlock")&&"boolean"!=typeof e.onBlock?"onBlock: boolean expected":null},o.fromObject=function(e){if(e instanceof i.ActionClick)return e;var t=new i.ActionClick;return null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.z&&(t.z=0|e.z),null!=e.type&&(t.type=String(e.type)),null!=e.onBlock&&(t.onBlock=Boolean(e.onBlock)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0,n.type="",n.onBlock=!1),null!=e.x&&e.hasOwnProperty("x")&&(n.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=e.z),null!=e.type&&e.hasOwnProperty("type")&&(n.type=e.type),null!=e.onBlock&&e.hasOwnProperty("onBlock")&&(n.onBlock=e.onBlock),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.ActionClickEntity=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.uuid="",o.prototype.type="",o.prototype.distance=0,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(10).string(e.uuid),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(18).string(e.type),null!=e.distance&&Object.hasOwnProperty.call(e,"distance")&&t.uint32(29).float(e.distance),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.ActionClickEntity;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.uuid=e.string();break;case 2:o.type=e.string();break;case 3:o.distance=e.float();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!r.isString(e.uuid)?"uuid: string expected":null!=e.type&&e.hasOwnProperty("type")&&!r.isString(e.type)?"type: string expected":null!=e.distance&&e.hasOwnProperty("distance")&&"number"!=typeof e.distance?"distance: number expected":null},o.fromObject=function(e){if(e instanceof i.ActionClickEntity)return e;var t=new i.ActionClickEntity;return null!=e.uuid&&(t.uuid=String(e.uuid)),null!=e.type&&(t.type=String(e.type)),null!=e.distance&&(t.distance=Number(e.distance)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.uuid="",n.type="",n.distance=0),null!=e.uuid&&e.hasOwnProperty("uuid")&&(n.uuid=e.uuid),null!=e.type&&e.hasOwnProperty("type")&&(n.type=e.type),null!=e.distance&&e.hasOwnProperty("distance")&&(n.distance=t.json&&!isFinite(e.distance)?String(e.distance):e.distance),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i})?r.apply(t,i):r)||(e.exports=o)},function(e,t,n){"use strict";var r=t;function i(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=n(245),r.BufferWriter=n(346),r.Reader=n(246),r.BufferReader=n(347),r.util=n(127),r.rpc=n(348),r.roots=n(350),r.configure=i,i()},function(e,t,n){"use strict";e.exports=function(e,t){var n=new Array(arguments.length-1),r=0,i=2,o=!0;for(;i<arguments.length;)n[r++]=arguments[i++];return new Promise((function(i,s){n[r]=function(e){if(o)if(o=!1,e)s(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];i.apply(null,t)}};try{e.apply(t||null,n)}catch(e){o&&(o=!1,s(e))}}))}},function(e,t,n){"use strict";var r=t;r.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var i=new Array(64),o=new Array(123),s=0;s<64;)o[i[s]=s<26?s+65:s<52?s+71:s<62?s-4:s-59|43]=s++;r.encode=function(e,t,n){for(var r,o=null,s=[],a=0,u=0;t<n;){var l=e[t++];switch(u){case 0:s[a++]=i[l>>2],r=(3&l)<<4,u=1;break;case 1:s[a++]=i[r|l>>4],r=(15&l)<<2,u=2;break;case 2:s[a++]=i[r|l>>6],s[a++]=i[63&l],u=0}a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0)}return u&&(s[a++]=i[r],s[a++]=61,1===u&&(s[a++]=61)),o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};r.decode=function(e,t,n){for(var r,i=n,s=0,a=0;a<e.length;){var u=e.charCodeAt(a++);if(61===u&&s>1)break;if(void 0===(u=o[u]))throw Error("invalid encoding");switch(s){case 0:r=u,s=1;break;case 1:t[n++]=r<<2|(48&u)>>4,r=u,s=2;break;case 2:t[n++]=(15&r)<<4|(60&u)>>2,r=u,s=3;break;case 3:t[n++]=(3&r)<<6|u,s=0}}if(1===s)throw Error("invalid encoding");return n-i},r.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},function(e,t,n){"use strict";function r(){this._listeners={}}e.exports=r,r.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},r.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},r.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this}},function(e,t,n){"use strict";function r(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3]}function o(e,r,i){t[0]=e,r[i]=n[3],r[i+1]=n[2],r[i+2]=n[1],r[i+3]=n[0]}function s(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function a(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?i:o,e.writeFloatBE=r?o:i,e.readFloatLE=r?s:a,e.readFloatBE=r?a:s}():function(){function t(e,t,n,r){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,n,r);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var o=Math.floor(Math.log(t)/Math.LN2);e((i<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,n,r)}}function n(e,t,n){var r=e(t,n),i=2*(r>>31)+1,o=r>>>23&255,s=8388607&r;return 255===o?s?NaN:i*(1/0):0===o?1401298464324817e-60*i*s:i*Math.pow(2,o-150)*(s+8388608)}e.writeFloatLE=t.bind(null,i),e.writeFloatBE=t.bind(null,o),e.readFloatLE=n.bind(null,s),e.readFloatBE=n.bind(null,a)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3],r[i+4]=n[4],r[i+5]=n[5],r[i+6]=n[6],r[i+7]=n[7]}function o(e,r,i){t[0]=e,r[i]=n[7],r[i+1]=n[6],r[i+2]=n[5],r[i+3]=n[4],r[i+4]=n[3],r[i+5]=n[2],r[i+6]=n[1],r[i+7]=n[0]}function s(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function a(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?i:o,e.writeDoubleBE=r?o:i,e.readDoubleLE=r?s:a,e.readDoubleBE=r?a:s}():function(){function t(e,t,n,r,i,o){var s=r<0?1:0;if(s&&(r=-r),0===r)e(0,i,o+t),e(1/r>0?0:2147483648,i,o+n);else if(isNaN(r))e(0,i,o+t),e(2146959360,i,o+n);else if(r>17976931348623157e292)e(0,i,o+t),e((s<<31|2146435072)>>>0,i,o+n);else{var a;if(r<22250738585072014e-324)e((a=r/5e-324)>>>0,i,o+t),e((s<<31|a/4294967296)>>>0,i,o+n);else{var u=Math.floor(Math.log(r)/Math.LN2);1024===u&&(u=1023),e(4503599627370496*(a=r*Math.pow(2,-u))>>>0,i,o+t),e((s<<31|u+1023<<20|1048576*a&1048575)>>>0,i,o+n)}}}function n(e,t,n,r,i){var o=e(r,i+t),s=e(r,i+n),a=2*(s>>31)+1,u=s>>>20&2047,l=4294967296*(1048575&s)+o;return 2047===u?l?NaN:a*(1/0):0===u?5e-324*a*l:a*Math.pow(2,u-1075)*(l+4503599627370496)}e.writeDoubleLE=t.bind(null,i,0,4),e.writeDoubleBE=t.bind(null,o,4,0),e.readDoubleLE=n.bind(null,s,0,4),e.readDoubleBE=n.bind(null,a,4,0)}(),e}function i(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function o(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function s(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function a(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=r(r)},function(module,exports,__webpack_require__){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},function(e,t,n){"use strict";var r=t;r.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)(n=e.charCodeAt(r))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},r.read=function(e,t,n){if(n-t<1)return"";for(var r,i=null,o=[],s=0;t<n;)(r=e[t++])<128?o[s++]=r:r>191&&r<224?o[s++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[s++]=55296+(r>>10),o[s++]=56320+(1023&r)):o[s++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0);return i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))},r.write=function(e,t,n){for(var r,i,o=n,s=0;s<e.length;++s)(r=e.charCodeAt(s))<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&56320==(64512&(i=e.charCodeAt(s+1)))?(r=65536+((1023&r)<<10)+(1023&i),++s,t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128);return n-o}},function(e,t,n){"use strict";e.exports=function(e,t,n){var r=n||8192,i=r>>>1,o=null,s=r;return function(n){if(n<1||n>i)return e(n);s+n>r&&(o=e(r),s=0);var a=t.call(o,s,s+=n);return 7&s&&(s=1+(7|s)),a}}},function(e,t,n){"use strict";e.exports=i;var r=n(127);function i(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=i.zero=new i(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var s=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new i(n,r)},i.from=function(e){if("number"==typeof e)return i.fromNumber(e);if(r.isString(e)){if(!r.Long)return i.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new i(e.low>>>0,e.high>>>0):o},i.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;i.fromHash=function(e){return e===s?o:new i((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},i.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},i.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},function(e,t,n){"use strict";e.exports=o;var r=n(245);(o.prototype=Object.create(r.prototype)).constructor=o;var i=n(127);function o(){r.call(this)}function s(e,t,n){e.length<40?i.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}o._configure=function(){o.alloc=i._Buffer_allocUnsafe,o.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&"set"===i.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}},o.prototype.bytes=function(e){i.isString(e)&&(e=i._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(o.writeBytesBuffer,t,e),this},o.prototype.string=function(e){var t=i.Buffer.byteLength(e);return this.uint32(t),t&&this._push(s,t,e),this},o._configure()},function(e,t,n){"use strict";e.exports=o;var r=n(246);(o.prototype=Object.create(r.prototype)).constructor=o;var i=n(127);function o(e){r.call(this,e)}o._configure=function(){i.Buffer&&(o.prototype._slice=i.Buffer.prototype.slice)},o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},o._configure()},function(e,t,n){"use strict";t.Service=n(349)},function(e,t,n){"use strict";e.exports=i;var r=n(127);function i(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(i.prototype=Object.create(r.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function e(t,n,i,o,s){if(!o)throw TypeError("request must be specified");var a=this;if(!s)return r.asPromise(e,a,t,n,i,o);if(a.rpcImpl)try{return a.rpcImpl(t,n[a.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,n){if(e)return a.emit("error",e,t),s(e);if(null!==n){if(!(n instanceof i))try{n=i[a.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return a.emit("error",e,t),s(e)}return a.emit("data",n,t),s(null,n)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){s(e)}),0)}else setTimeout((function(){s(Error("already ended"))}),0)},i.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},function(e,t,n){"use strict";e.exports={}},function(e,t,n){var r,i,o;i=[n(244)],void 0===(o="function"==typeof(r=function(e){"use strict";var t=e.Reader,n=e.Writer,r=e.util,i=e.roots.default||(e.roots.default={});return i.LoginRequest=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.name="",o.prototype.protocol=0,o.prototype.maxplayers=0,o.prototype.numberplayers=0,o.prototype.motd="",o.prototype.software="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.protocol&&Object.hasOwnProperty.call(e,"protocol")&&t.uint32(16).int32(e.protocol),null!=e.maxplayers&&Object.hasOwnProperty.call(e,"maxplayers")&&t.uint32(24).int32(e.maxplayers),null!=e.numberplayers&&Object.hasOwnProperty.call(e,"numberplayers")&&t.uint32(32).int32(e.numberplayers),null!=e.motd&&Object.hasOwnProperty.call(e,"motd")&&t.uint32(42).string(e.motd),null!=e.software&&Object.hasOwnProperty.call(e,"software")&&t.uint32(50).string(e.software),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.LoginRequest;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.name=e.string();break;case 2:o.protocol=e.int32();break;case 3:o.maxplayers=e.int32();break;case 4:o.numberplayers=e.int32();break;case 5:o.motd=e.string();break;case 6:o.software=e.string();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.name&&e.hasOwnProperty("name")&&!r.isString(e.name)?"name: string expected":null!=e.protocol&&e.hasOwnProperty("protocol")&&!r.isInteger(e.protocol)?"protocol: integer expected":null!=e.maxplayers&&e.hasOwnProperty("maxplayers")&&!r.isInteger(e.maxplayers)?"maxplayers: integer expected":null!=e.numberplayers&&e.hasOwnProperty("numberplayers")&&!r.isInteger(e.numberplayers)?"numberplayers: integer expected":null!=e.motd&&e.hasOwnProperty("motd")&&!r.isString(e.motd)?"motd: string expected":null!=e.software&&e.hasOwnProperty("software")&&!r.isString(e.software)?"software: string expected":null},o.fromObject=function(e){if(e instanceof i.LoginRequest)return e;var t=new i.LoginRequest;return null!=e.name&&(t.name=String(e.name)),null!=e.protocol&&(t.protocol=0|e.protocol),null!=e.maxplayers&&(t.maxplayers=0|e.maxplayers),null!=e.numberplayers&&(t.numberplayers=0|e.numberplayers),null!=e.motd&&(t.motd=String(e.motd)),null!=e.software&&(t.software=String(e.software)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.name="",n.protocol=0,n.maxplayers=0,n.numberplayers=0,n.motd="",n.software=""),null!=e.name&&e.hasOwnProperty("name")&&(n.name=e.name),null!=e.protocol&&e.hasOwnProperty("protocol")&&(n.protocol=e.protocol),null!=e.maxplayers&&e.hasOwnProperty("maxplayers")&&(n.maxplayers=e.maxplayers),null!=e.numberplayers&&e.hasOwnProperty("numberplayers")&&(n.numberplayers=e.numberplayers),null!=e.motd&&e.hasOwnProperty("motd")&&(n.motd=e.motd),null!=e.software&&e.hasOwnProperty("software")&&(n.software=e.software),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.LoginSuccess=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.xPos=0,o.prototype.yPos=0,o.prototype.zPos=0,o.prototype.itemsDef="",o.prototype.blocksDef="",o.prototype.inventory="",o.prototype.armor="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.xPos&&Object.hasOwnProperty.call(e,"xPos")&&t.uint32(9).double(e.xPos),null!=e.yPos&&Object.hasOwnProperty.call(e,"yPos")&&t.uint32(17).double(e.yPos),null!=e.zPos&&Object.hasOwnProperty.call(e,"zPos")&&t.uint32(25).double(e.zPos),null!=e.itemsDef&&Object.hasOwnProperty.call(e,"itemsDef")&&t.uint32(34).string(e.itemsDef),null!=e.blocksDef&&Object.hasOwnProperty.call(e,"blocksDef")&&t.uint32(42).string(e.blocksDef),null!=e.inventory&&Object.hasOwnProperty.call(e,"inventory")&&t.uint32(50).string(e.inventory),null!=e.armor&&Object.hasOwnProperty.call(e,"armor")&&t.uint32(58).string(e.armor),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.LoginSuccess;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.xPos=e.double();break;case 2:o.yPos=e.double();break;case 3:o.zPos=e.double();break;case 4:o.itemsDef=e.string();break;case 5:o.blocksDef=e.string();break;case 6:o.inventory=e.string();break;case 7:o.armor=e.string();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.xPos&&e.hasOwnProperty("xPos")&&"number"!=typeof e.xPos?"xPos: number expected":null!=e.yPos&&e.hasOwnProperty("yPos")&&"number"!=typeof e.yPos?"yPos: number expected":null!=e.zPos&&e.hasOwnProperty("zPos")&&"number"!=typeof e.zPos?"zPos: number expected":null!=e.itemsDef&&e.hasOwnProperty("itemsDef")&&!r.isString(e.itemsDef)?"itemsDef: string expected":null!=e.blocksDef&&e.hasOwnProperty("blocksDef")&&!r.isString(e.blocksDef)?"blocksDef: string expected":null!=e.inventory&&e.hasOwnProperty("inventory")&&!r.isString(e.inventory)?"inventory: string expected":null!=e.armor&&e.hasOwnProperty("armor")&&!r.isString(e.armor)?"armor: string expected":null},o.fromObject=function(e){if(e instanceof i.LoginSuccess)return e;var t=new i.LoginSuccess;return null!=e.xPos&&(t.xPos=Number(e.xPos)),null!=e.yPos&&(t.yPos=Number(e.yPos)),null!=e.zPos&&(t.zPos=Number(e.zPos)),null!=e.itemsDef&&(t.itemsDef=String(e.itemsDef)),null!=e.blocksDef&&(t.blocksDef=String(e.blocksDef)),null!=e.inventory&&(t.inventory=String(e.inventory)),null!=e.armor&&(t.armor=String(e.armor)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.xPos=0,n.yPos=0,n.zPos=0,n.itemsDef="",n.blocksDef="",n.inventory="",n.armor=""),null!=e.xPos&&e.hasOwnProperty("xPos")&&(n.xPos=t.json&&!isFinite(e.xPos)?String(e.xPos):e.xPos),null!=e.yPos&&e.hasOwnProperty("yPos")&&(n.yPos=t.json&&!isFinite(e.yPos)?String(e.yPos):e.yPos),null!=e.zPos&&e.hasOwnProperty("zPos")&&(n.zPos=t.json&&!isFinite(e.zPos)?String(e.zPos):e.zPos),null!=e.itemsDef&&e.hasOwnProperty("itemsDef")&&(n.itemsDef=e.itemsDef),null!=e.blocksDef&&e.hasOwnProperty("blocksDef")&&(n.blocksDef=e.blocksDef),null!=e.inventory&&e.hasOwnProperty("inventory")&&(n.inventory=e.inventory),null!=e.armor&&e.hasOwnProperty("armor")&&(n.armor=e.armor),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.PlayerKick=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.reason="",o.prototype.time=r.Long?r.Long.fromBits(0,0,!0):0,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.reason&&Object.hasOwnProperty.call(e,"reason")&&t.uint32(10).string(e.reason),null!=e.time&&Object.hasOwnProperty.call(e,"time")&&t.uint32(16).uint64(e.time),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.PlayerKick;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.reason=e.string();break;case 2:o.time=e.uint64();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.reason&&e.hasOwnProperty("reason")&&!r.isString(e.reason)?"reason: string expected":null!=e.time&&e.hasOwnProperty("time")&&!(r.isInteger(e.time)||e.time&&r.isInteger(e.time.low)&&r.isInteger(e.time.high))?"time: integer|Long expected":null},o.fromObject=function(e){if(e instanceof i.PlayerKick)return e;var t=new i.PlayerKick;return null!=e.reason&&(t.reason=String(e.reason)),null!=e.time&&(r.Long?(t.time=r.Long.fromValue(e.time)).unsigned=!0:"string"==typeof e.time?t.time=parseInt(e.time,10):"number"==typeof e.time?t.time=e.time:"object"==typeof e.time&&(t.time=new r.LongBits(e.time.low>>>0,e.time.high>>>0).toNumber(!0))),t},o.toObject=function(e,t){t||(t={});var n={};if(t.defaults)if(n.reason="",r.Long){var i=new r.Long(0,0,!0);n.time=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.time=t.longs===String?"0":0;return null!=e.reason&&e.hasOwnProperty("reason")&&(n.reason=e.reason),null!=e.time&&e.hasOwnProperty("time")&&("number"==typeof e.time?n.time=t.longs===String?String(e.time):e.time:n.time=t.longs===String?r.Long.prototype.toString.call(e.time):t.longs===Number?new r.LongBits(e.time.low>>>0,e.time.high>>>0).toNumber(!0):e.time),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.PlayerEntity=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.uuid="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(10).string(e.uuid),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.PlayerEntity;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.uuid=e.string();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!r.isString(e.uuid)?"uuid: string expected":null},o.fromObject=function(e){if(e instanceof i.PlayerEntity)return e;var t=new i.PlayerEntity;return null!=e.uuid&&(t.uuid=String(e.uuid)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.uuid=""),null!=e.uuid&&e.hasOwnProperty("uuid")&&(n.uuid=e.uuid),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.PlayerTeleport=function(){function r(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return r.prototype.x=0,r.prototype.y=0,r.prototype.z=0,r.create=function(e){return new r(e)},r.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(9).double(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(17).double(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(25).double(e.z),t},r.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},r.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.PlayerTeleport;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.x=e.double();break;case 2:o.y=e.double();break;case 3:o.z=e.double();break;default:e.skipType(7&s)}}return o},r.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},r.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&"number"!=typeof e.x?"x: number expected":null!=e.y&&e.hasOwnProperty("y")&&"number"!=typeof e.y?"y: number expected":null!=e.z&&e.hasOwnProperty("z")&&"number"!=typeof e.z?"z: number expected":null},r.fromObject=function(e){if(e instanceof i.PlayerTeleport)return e;var t=new i.PlayerTeleport;return null!=e.x&&(t.x=Number(e.x)),null!=e.y&&(t.y=Number(e.y)),null!=e.z&&(t.z=Number(e.z)),t},r.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0),null!=e.x&&e.hasOwnProperty("x")&&(n.x=t.json&&!isFinite(e.x)?String(e.x):e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=t.json&&!isFinite(e.y)?String(e.y):e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=t.json&&!isFinite(e.z)?String(e.z):e.z),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},r}(),i.PlayerInventory=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.inventory="",o.prototype.type="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.inventory&&Object.hasOwnProperty.call(e,"inventory")&&t.uint32(10).string(e.inventory),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(18).string(e.type),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.PlayerInventory;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.inventory=e.string();break;case 2:o.type=e.string();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.inventory&&e.hasOwnProperty("inventory")&&!r.isString(e.inventory)?"inventory: string expected":null!=e.type&&e.hasOwnProperty("type")&&!r.isString(e.type)?"type: string expected":null},o.fromObject=function(e){if(e instanceof i.PlayerInventory)return e;var t=new i.PlayerInventory;return null!=e.inventory&&(t.inventory=String(e.inventory)),null!=e.type&&(t.type=String(e.type)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.inventory="",n.type=""),null!=e.inventory&&e.hasOwnProperty("inventory")&&(n.inventory=e.inventory),null!=e.type&&e.hasOwnProperty("type")&&(n.type=e.type),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.PlayerSlotUpdate=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.slot=0,o.prototype.type="",o.prototype.data="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.slot&&Object.hasOwnProperty.call(e,"slot")&&t.uint32(8).int32(e.slot),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(18).string(e.type),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(26).string(e.data),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.PlayerSlotUpdate;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.slot=e.int32();break;case 2:o.type=e.string();break;case 3:o.data=e.string();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.slot&&e.hasOwnProperty("slot")&&!r.isInteger(e.slot)?"slot: integer expected":null!=e.type&&e.hasOwnProperty("type")&&!r.isString(e.type)?"type: string expected":null!=e.data&&e.hasOwnProperty("data")&&!r.isString(e.data)?"data: string expected":null},o.fromObject=function(e){if(e instanceof i.PlayerSlotUpdate)return e;var t=new i.PlayerSlotUpdate;return null!=e.slot&&(t.slot=0|e.slot),null!=e.type&&(t.type=String(e.type)),null!=e.data&&(t.data=String(e.data)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.slot=0,n.type="",n.data=""),null!=e.slot&&e.hasOwnProperty("slot")&&(n.slot=e.slot),null!=e.type&&e.hasOwnProperty("type")&&(n.type=e.type),null!=e.data&&e.hasOwnProperty("data")&&(n.data=e.data),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.PlayerApplyImpulse=function(){function r(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return r.prototype.x=0,r.prototype.y=0,r.prototype.z=0,r.create=function(e){return new r(e)},r.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(13).float(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(21).float(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(29).float(e.z),t},r.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},r.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.PlayerApplyImpulse;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.x=e.float();break;case 2:o.y=e.float();break;case 3:o.z=e.float();break;default:e.skipType(7&s)}}return o},r.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},r.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&"number"!=typeof e.x?"x: number expected":null!=e.y&&e.hasOwnProperty("y")&&"number"!=typeof e.y?"y: number expected":null!=e.z&&e.hasOwnProperty("z")&&"number"!=typeof e.z?"z: number expected":null},r.fromObject=function(e){if(e instanceof i.PlayerApplyImpulse)return e;var t=new i.PlayerApplyImpulse;return null!=e.x&&(t.x=Number(e.x)),null!=e.y&&(t.y=Number(e.y)),null!=e.z&&(t.z=Number(e.z)),t},r.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0),null!=e.x&&e.hasOwnProperty("x")&&(n.x=t.json&&!isFinite(e.x)?String(e.x):e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=t.json&&!isFinite(e.y)?String(e.y):e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=t.json&&!isFinite(e.z)?String(e.z):e.z),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},r}(),i.PlayerUpdateMovement=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.key="",o.prototype.value=0,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(17).double(e.value),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.PlayerUpdateMovement;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.key=e.string();break;case 2:o.value=e.double();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!r.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&"number"!=typeof e.value?"value: number expected":null},o.fromObject=function(e){if(e instanceof i.PlayerUpdateMovement)return e;var t=new i.PlayerUpdateMovement;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=Number(e.value)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.key="",n.value=0),null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(n.value=t.json&&!isFinite(e.value)?String(e.value):e.value),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.PlayerUpdatePhysics=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.key="",o.prototype.value=0,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(17).double(e.value),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.PlayerUpdatePhysics;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.key=e.string();break;case 2:o.value=e.double();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!r.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&"number"!=typeof e.value?"value: number expected":null},o.fromObject=function(e){if(e instanceof i.PlayerUpdatePhysics)return e;var t=new i.PlayerUpdatePhysics;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=Number(e.value)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.key="",n.value=0),null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(n.value=t.json&&!isFinite(e.value)?String(e.value):e.value),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.SoundPlay=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.sound="",o.prototype.volume=0,o.prototype.x=0,o.prototype.y=0,o.prototype.z=0,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.sound&&Object.hasOwnProperty.call(e,"sound")&&t.uint32(10).string(e.sound),null!=e.volume&&Object.hasOwnProperty.call(e,"volume")&&t.uint32(16).int32(e.volume),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(25).double(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(33).double(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(41).double(e.z),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.SoundPlay;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.sound=e.string();break;case 2:o.volume=e.int32();break;case 3:o.x=e.double();break;case 4:o.y=e.double();break;case 5:o.z=e.double();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.sound&&e.hasOwnProperty("sound")&&!r.isString(e.sound)?"sound: string expected":null!=e.volume&&e.hasOwnProperty("volume")&&!r.isInteger(e.volume)?"volume: integer expected":null!=e.x&&e.hasOwnProperty("x")&&"number"!=typeof e.x?"x: number expected":null!=e.y&&e.hasOwnProperty("y")&&"number"!=typeof e.y?"y: number expected":null!=e.z&&e.hasOwnProperty("z")&&"number"!=typeof e.z?"z: number expected":null},o.fromObject=function(e){if(e instanceof i.SoundPlay)return e;var t=new i.SoundPlay;return null!=e.sound&&(t.sound=String(e.sound)),null!=e.volume&&(t.volume=0|e.volume),null!=e.x&&(t.x=Number(e.x)),null!=e.y&&(t.y=Number(e.y)),null!=e.z&&(t.z=Number(e.z)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.sound="",n.volume=0,n.x=0,n.y=0,n.z=0),null!=e.sound&&e.hasOwnProperty("sound")&&(n.sound=e.sound),null!=e.volume&&e.hasOwnProperty("volume")&&(n.volume=e.volume),null!=e.x&&e.hasOwnProperty("x")&&(n.x=t.json&&!isFinite(e.x)?String(e.x):e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=t.json&&!isFinite(e.y)?String(e.y):e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=t.json&&!isFinite(e.z)?String(e.z):e.z),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.ChatMessage=function(){function o(e){if(this.message={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.message=r.emptyObject,o.prototype.time=r.Long?r.Long.fromBits(0,0,!0):0,o.create=function(e){return new o(e)},o.encode=function(e,t){if(t||(t=n.create()),null!=e.message&&Object.hasOwnProperty.call(e,"message"))for(var r=Object.keys(e.message),o=0;o<r.length;++o)t.uint32(10).fork().uint32(8).uint32(r[o]),i.ChatMessage.ChatComponent.encode(e.message[r[o]],t.uint32(18).fork()).ldelim().ldelim();return null!=e.time&&Object.hasOwnProperty.call(e,"time")&&t.uint32(16).uint64(e.time),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var o,s,a=void 0===n?e.len:e.pos+n,u=new i.ChatMessage;e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:u.message===r.emptyObject&&(u.message={});var c=e.uint32()+e.pos;for(o=0,s=null;e.pos<c;){var h=e.uint32();switch(h>>>3){case 1:o=e.uint32();break;case 2:s=i.ChatMessage.ChatComponent.decode(e,e.uint32());break;default:e.skipType(7&h)}}u.message[o]=s;break;case 2:u.time=e.uint64();break;default:e.skipType(7&l)}}return u},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.message&&e.hasOwnProperty("message")){if(!r.isObject(e.message))return"message: object expected";for(var t=Object.keys(e.message),n=0;n<t.length;++n){if(!r.key32Re.test(t[n]))return"message: integer key{k:uint32} expected";var o=i.ChatMessage.ChatComponent.verify(e.message[t[n]]);if(o)return"message."+o}}return null!=e.time&&e.hasOwnProperty("time")&&!(r.isInteger(e.time)||e.time&&r.isInteger(e.time.low)&&r.isInteger(e.time.high))?"time: integer|Long expected":null},o.fromObject=function(e){if(e instanceof i.ChatMessage)return e;var t=new i.ChatMessage;if(e.message){if("object"!=typeof e.message)throw TypeError(".ChatMessage.message: object expected");t.message={};for(var n=Object.keys(e.message),o=0;o<n.length;++o){if("object"!=typeof e.message[n[o]])throw TypeError(".ChatMessage.message: object expected");t.message[n[o]]=i.ChatMessage.ChatComponent.fromObject(e.message[n[o]])}}return null!=e.time&&(r.Long?(t.time=r.Long.fromValue(e.time)).unsigned=!0:"string"==typeof e.time?t.time=parseInt(e.time,10):"number"==typeof e.time?t.time=e.time:"object"==typeof e.time&&(t.time=new r.LongBits(e.time.low>>>0,e.time.high>>>0).toNumber(!0))),t},o.toObject=function(e,t){t||(t={});var n,o={};if((t.objects||t.defaults)&&(o.message={}),t.defaults)if(r.Long){var s=new r.Long(0,0,!0);o.time=t.longs===String?s.toString():t.longs===Number?s.toNumber():s}else o.time=t.longs===String?"0":0;if(e.message&&(n=Object.keys(e.message)).length){o.message={};for(var a=0;a<n.length;++a)o.message[n[a]]=i.ChatMessage.ChatComponent.toObject(e.message[n[a]],t)}return null!=e.time&&e.hasOwnProperty("time")&&("number"==typeof e.time?o.time=t.longs===String?String(e.time):e.time:o.time=t.longs===String?r.Long.prototype.toString.call(e.time):t.longs===Number?new r.LongBits(e.time.low>>>0,e.time.high>>>0).toNumber(!0):e.time),o},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o.ChatComponent=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.text="",o.prototype.font="",o.prototype.color="",o.prototype.linethrough=!1,o.prototype.underline=!1,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.text&&Object.hasOwnProperty.call(e,"text")&&t.uint32(10).string(e.text),null!=e.font&&Object.hasOwnProperty.call(e,"font")&&t.uint32(18).string(e.font),null!=e.color&&Object.hasOwnProperty.call(e,"color")&&t.uint32(26).string(e.color),null!=e.linethrough&&Object.hasOwnProperty.call(e,"linethrough")&&t.uint32(32).bool(e.linethrough),null!=e.underline&&Object.hasOwnProperty.call(e,"underline")&&t.uint32(40).bool(e.underline),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.ChatMessage.ChatComponent;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.text=e.string();break;case 2:o.font=e.string();break;case 3:o.color=e.string();break;case 4:o.linethrough=e.bool();break;case 5:o.underline=e.bool();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.text&&e.hasOwnProperty("text")&&!r.isString(e.text)?"text: string expected":null!=e.font&&e.hasOwnProperty("font")&&!r.isString(e.font)?"font: string expected":null!=e.color&&e.hasOwnProperty("color")&&!r.isString(e.color)?"color: string expected":null!=e.linethrough&&e.hasOwnProperty("linethrough")&&"boolean"!=typeof e.linethrough?"linethrough: boolean expected":null!=e.underline&&e.hasOwnProperty("underline")&&"boolean"!=typeof e.underline?"underline: boolean expected":null},o.fromObject=function(e){if(e instanceof i.ChatMessage.ChatComponent)return e;var t=new i.ChatMessage.ChatComponent;return null!=e.text&&(t.text=String(e.text)),null!=e.font&&(t.font=String(e.font)),null!=e.color&&(t.color=String(e.color)),null!=e.linethrough&&(t.linethrough=Boolean(e.linethrough)),null!=e.underline&&(t.underline=Boolean(e.underline)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.text="",n.font="",n.color="",n.linethrough=!1,n.underline=!1),null!=e.text&&e.hasOwnProperty("text")&&(n.text=e.text),null!=e.font&&e.hasOwnProperty("font")&&(n.font=e.font),null!=e.color&&e.hasOwnProperty("color")&&(n.color=e.color),null!=e.linethrough&&e.hasOwnProperty("linethrough")&&(n.linethrough=e.linethrough),null!=e.underline&&e.hasOwnProperty("underline")&&(n.underline=e.underline),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),o}(),i.TabUpdate=function(){function o(e){if(this.message={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.message=r.emptyObject,o.prototype.time=r.Long?r.Long.fromBits(0,0,!0):0,o.create=function(e){return new o(e)},o.encode=function(e,t){if(t||(t=n.create()),null!=e.message&&Object.hasOwnProperty.call(e,"message"))for(var r=Object.keys(e.message),o=0;o<r.length;++o)t.uint32(10).fork().uint32(8).uint32(r[o]),i.TabUpdate.ChatComponent.encode(e.message[r[o]],t.uint32(18).fork()).ldelim().ldelim();return null!=e.time&&Object.hasOwnProperty.call(e,"time")&&t.uint32(16).uint64(e.time),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var o,s,a=void 0===n?e.len:e.pos+n,u=new i.TabUpdate;e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:u.message===r.emptyObject&&(u.message={});var c=e.uint32()+e.pos;for(o=0,s=null;e.pos<c;){var h=e.uint32();switch(h>>>3){case 1:o=e.uint32();break;case 2:s=i.TabUpdate.ChatComponent.decode(e,e.uint32());break;default:e.skipType(7&h)}}u.message[o]=s;break;case 2:u.time=e.uint64();break;default:e.skipType(7&l)}}return u},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.message&&e.hasOwnProperty("message")){if(!r.isObject(e.message))return"message: object expected";for(var t=Object.keys(e.message),n=0;n<t.length;++n){if(!r.key32Re.test(t[n]))return"message: integer key{k:uint32} expected";var o=i.TabUpdate.ChatComponent.verify(e.message[t[n]]);if(o)return"message."+o}}return null!=e.time&&e.hasOwnProperty("time")&&!(r.isInteger(e.time)||e.time&&r.isInteger(e.time.low)&&r.isInteger(e.time.high))?"time: integer|Long expected":null},o.fromObject=function(e){if(e instanceof i.TabUpdate)return e;var t=new i.TabUpdate;if(e.message){if("object"!=typeof e.message)throw TypeError(".TabUpdate.message: object expected");t.message={};for(var n=Object.keys(e.message),o=0;o<n.length;++o){if("object"!=typeof e.message[n[o]])throw TypeError(".TabUpdate.message: object expected");t.message[n[o]]=i.TabUpdate.ChatComponent.fromObject(e.message[n[o]])}}return null!=e.time&&(r.Long?(t.time=r.Long.fromValue(e.time)).unsigned=!0:"string"==typeof e.time?t.time=parseInt(e.time,10):"number"==typeof e.time?t.time=e.time:"object"==typeof e.time&&(t.time=new r.LongBits(e.time.low>>>0,e.time.high>>>0).toNumber(!0))),t},o.toObject=function(e,t){t||(t={});var n,o={};if((t.objects||t.defaults)&&(o.message={}),t.defaults)if(r.Long){var s=new r.Long(0,0,!0);o.time=t.longs===String?s.toString():t.longs===Number?s.toNumber():s}else o.time=t.longs===String?"0":0;if(e.message&&(n=Object.keys(e.message)).length){o.message={};for(var a=0;a<n.length;++a)o.message[n[a]]=i.TabUpdate.ChatComponent.toObject(e.message[n[a]],t)}return null!=e.time&&e.hasOwnProperty("time")&&("number"==typeof e.time?o.time=t.longs===String?String(e.time):e.time:o.time=t.longs===String?r.Long.prototype.toString.call(e.time):t.longs===Number?new r.LongBits(e.time.low>>>0,e.time.high>>>0).toNumber(!0):e.time),o},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o.ChatComponent=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.text="",o.prototype.font="",o.prototype.color="",o.prototype.linethrough=!1,o.prototype.underline=!1,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.text&&Object.hasOwnProperty.call(e,"text")&&t.uint32(10).string(e.text),null!=e.font&&Object.hasOwnProperty.call(e,"font")&&t.uint32(18).string(e.font),null!=e.color&&Object.hasOwnProperty.call(e,"color")&&t.uint32(26).string(e.color),null!=e.linethrough&&Object.hasOwnProperty.call(e,"linethrough")&&t.uint32(32).bool(e.linethrough),null!=e.underline&&Object.hasOwnProperty.call(e,"underline")&&t.uint32(40).bool(e.underline),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.TabUpdate.ChatComponent;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.text=e.string();break;case 2:o.font=e.string();break;case 3:o.color=e.string();break;case 4:o.linethrough=e.bool();break;case 5:o.underline=e.bool();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.text&&e.hasOwnProperty("text")&&!r.isString(e.text)?"text: string expected":null!=e.font&&e.hasOwnProperty("font")&&!r.isString(e.font)?"font: string expected":null!=e.color&&e.hasOwnProperty("color")&&!r.isString(e.color)?"color: string expected":null!=e.linethrough&&e.hasOwnProperty("linethrough")&&"boolean"!=typeof e.linethrough?"linethrough: boolean expected":null!=e.underline&&e.hasOwnProperty("underline")&&"boolean"!=typeof e.underline?"underline: boolean expected":null},o.fromObject=function(e){if(e instanceof i.TabUpdate.ChatComponent)return e;var t=new i.TabUpdate.ChatComponent;return null!=e.text&&(t.text=String(e.text)),null!=e.font&&(t.font=String(e.font)),null!=e.color&&(t.color=String(e.color)),null!=e.linethrough&&(t.linethrough=Boolean(e.linethrough)),null!=e.underline&&(t.underline=Boolean(e.underline)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.text="",n.font="",n.color="",n.linethrough=!1,n.underline=!1),null!=e.text&&e.hasOwnProperty("text")&&(n.text=e.text),null!=e.font&&e.hasOwnProperty("font")&&(n.font=e.font),null!=e.color&&e.hasOwnProperty("color")&&(n.color=e.color),null!=e.linethrough&&e.hasOwnProperty("linethrough")&&(n.linethrough=e.linethrough),null!=e.underline&&e.hasOwnProperty("underline")&&(n.underline=e.underline),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),o}(),i.EntityCreate=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.uuid="",o.prototype.data="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(10).string(e.uuid),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).string(e.data),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.EntityCreate;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.uuid=e.string();break;case 2:o.data=e.string();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!r.isString(e.uuid)?"uuid: string expected":null!=e.data&&e.hasOwnProperty("data")&&!r.isString(e.data)?"data: string expected":null},o.fromObject=function(e){if(e instanceof i.EntityCreate)return e;var t=new i.EntityCreate;return null!=e.uuid&&(t.uuid=String(e.uuid)),null!=e.data&&(t.data=String(e.data)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.uuid="",n.data=""),null!=e.uuid&&e.hasOwnProperty("uuid")&&(n.uuid=e.uuid),null!=e.data&&e.hasOwnProperty("data")&&(n.data=e.data),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.EntityRemove=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.uuid="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(10).string(e.uuid),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.EntityRemove;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.uuid=e.string();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!r.isString(e.uuid)?"uuid: string expected":null},o.fromObject=function(e){if(e instanceof i.EntityRemove)return e;var t=new i.EntityRemove;return null!=e.uuid&&(t.uuid=String(e.uuid)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.uuid=""),null!=e.uuid&&e.hasOwnProperty("uuid")&&(n.uuid=e.uuid),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.EntityMove=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.uuid="",o.prototype.x=0,o.prototype.y=0,o.prototype.z=0,o.prototype.rotation=0,o.prototype.pitch=0,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(10).string(e.uuid),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(17).double(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(25).double(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(33).double(e.z),null!=e.rotation&&Object.hasOwnProperty.call(e,"rotation")&&t.uint32(45).float(e.rotation),null!=e.pitch&&Object.hasOwnProperty.call(e,"pitch")&&t.uint32(53).float(e.pitch),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.EntityMove;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.uuid=e.string();break;case 2:o.x=e.double();break;case 3:o.y=e.double();break;case 4:o.z=e.double();break;case 5:o.rotation=e.float();break;case 6:o.pitch=e.float();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!r.isString(e.uuid)?"uuid: string expected":null!=e.x&&e.hasOwnProperty("x")&&"number"!=typeof e.x?"x: number expected":null!=e.y&&e.hasOwnProperty("y")&&"number"!=typeof e.y?"y: number expected":null!=e.z&&e.hasOwnProperty("z")&&"number"!=typeof e.z?"z: number expected":null!=e.rotation&&e.hasOwnProperty("rotation")&&"number"!=typeof e.rotation?"rotation: number expected":null!=e.pitch&&e.hasOwnProperty("pitch")&&"number"!=typeof e.pitch?"pitch: number expected":null},o.fromObject=function(e){if(e instanceof i.EntityMove)return e;var t=new i.EntityMove;return null!=e.uuid&&(t.uuid=String(e.uuid)),null!=e.x&&(t.x=Number(e.x)),null!=e.y&&(t.y=Number(e.y)),null!=e.z&&(t.z=Number(e.z)),null!=e.rotation&&(t.rotation=Number(e.rotation)),null!=e.pitch&&(t.pitch=Number(e.pitch)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.uuid="",n.x=0,n.y=0,n.z=0,n.rotation=0,n.pitch=0),null!=e.uuid&&e.hasOwnProperty("uuid")&&(n.uuid=e.uuid),null!=e.x&&e.hasOwnProperty("x")&&(n.x=t.json&&!isFinite(e.x)?String(e.x):e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=t.json&&!isFinite(e.y)?String(e.y):e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=t.json&&!isFinite(e.z)?String(e.z):e.z),null!=e.rotation&&e.hasOwnProperty("rotation")&&(n.rotation=t.json&&!isFinite(e.rotation)?String(e.rotation):e.rotation),null!=e.pitch&&e.hasOwnProperty("pitch")&&(n.pitch=t.json&&!isFinite(e.pitch)?String(e.pitch):e.pitch),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.EntityUpdate=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.uuid="",o.prototype.key="",o.prototype.value="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(10).string(e.uuid),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(18).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(26).string(e.value),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.EntityUpdate;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.uuid=e.string();break;case 2:o.key=e.string();break;case 3:o.value=e.string();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!r.isString(e.uuid)?"uuid: string expected":null!=e.key&&e.hasOwnProperty("key")&&!r.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&!r.isString(e.value)?"value: string expected":null},o.fromObject=function(e){if(e instanceof i.EntityUpdate)return e;var t=new i.EntityUpdate;return null!=e.uuid&&(t.uuid=String(e.uuid)),null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=String(e.value)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.uuid="",n.key="",n.value=""),null!=e.uuid&&e.hasOwnProperty("uuid")&&(n.uuid=e.uuid),null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(n.value=e.value),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.EntityAnimate=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.uuid="",o.prototype.animation="",o.prototype.time=0,o.prototype.replace=!1,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(10).string(e.uuid),null!=e.animation&&Object.hasOwnProperty.call(e,"animation")&&t.uint32(18).string(e.animation),null!=e.time&&Object.hasOwnProperty.call(e,"time")&&t.uint32(24).uint32(e.time),null!=e.replace&&Object.hasOwnProperty.call(e,"replace")&&t.uint32(32).bool(e.replace),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.EntityAnimate;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.uuid=e.string();break;case 2:o.animation=e.string();break;case 3:o.time=e.uint32();break;case 4:o.replace=e.bool();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!r.isString(e.uuid)?"uuid: string expected":null!=e.animation&&e.hasOwnProperty("animation")&&!r.isString(e.animation)?"animation: string expected":null!=e.time&&e.hasOwnProperty("time")&&!r.isInteger(e.time)?"time: integer expected":null!=e.replace&&e.hasOwnProperty("replace")&&"boolean"!=typeof e.replace?"replace: boolean expected":null},o.fromObject=function(e){if(e instanceof i.EntityAnimate)return e;var t=new i.EntityAnimate;return null!=e.uuid&&(t.uuid=String(e.uuid)),null!=e.animation&&(t.animation=String(e.animation)),null!=e.time&&(t.time=e.time>>>0),null!=e.replace&&(t.replace=Boolean(e.replace)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.uuid="",n.animation="",n.time=0,n.replace=!1),null!=e.uuid&&e.hasOwnProperty("uuid")&&(n.uuid=e.uuid),null!=e.animation&&e.hasOwnProperty("animation")&&(n.animation=e.animation),null!=e.time&&e.hasOwnProperty("time")&&(n.time=e.time),null!=e.replace&&e.hasOwnProperty("replace")&&(n.replace=e.replace),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.WorldBlockUpdate=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.x=0,o.prototype.y=0,o.prototype.z=0,o.prototype.id=0,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(8).int32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(16).int32(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(24).int32(e.z),null!=e.id&&Object.hasOwnProperty.call(e,"id")&&t.uint32(32).uint32(e.id),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.WorldBlockUpdate;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.x=e.int32();break;case 2:o.y=e.int32();break;case 3:o.z=e.int32();break;case 4:o.id=e.uint32();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&!r.isInteger(e.x)?"x: integer expected":null!=e.y&&e.hasOwnProperty("y")&&!r.isInteger(e.y)?"y: integer expected":null!=e.z&&e.hasOwnProperty("z")&&!r.isInteger(e.z)?"z: integer expected":null!=e.id&&e.hasOwnProperty("id")&&!r.isInteger(e.id)?"id: integer expected":null},o.fromObject=function(e){if(e instanceof i.WorldBlockUpdate)return e;var t=new i.WorldBlockUpdate;return null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.z&&(t.z=0|e.z),null!=e.id&&(t.id=e.id>>>0),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0,n.id=0),null!=e.x&&e.hasOwnProperty("x")&&(n.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=e.z),null!=e.id&&e.hasOwnProperty("id")&&(n.id=e.id),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.WorldChunkLoad=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.x=0,o.prototype.y=0,o.prototype.z=0,o.prototype.data=r.newBuffer([]),o.prototype.type=!1,o.prototype.compressed=!1,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(8).int32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(16).int32(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(24).int32(e.z),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(34).bytes(e.data),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(40).bool(e.type),null!=e.compressed&&Object.hasOwnProperty.call(e,"compressed")&&t.uint32(48).bool(e.compressed),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.WorldChunkLoad;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.x=e.int32();break;case 2:o.y=e.int32();break;case 3:o.z=e.int32();break;case 4:o.data=e.bytes();break;case 5:o.type=e.bool();break;case 6:o.compressed=e.bool();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&!r.isInteger(e.x)?"x: integer expected":null!=e.y&&e.hasOwnProperty("y")&&!r.isInteger(e.y)?"y: integer expected":null!=e.z&&e.hasOwnProperty("z")&&!r.isInteger(e.z)?"z: integer expected":null!=e.data&&e.hasOwnProperty("data")&&!(e.data&&"number"==typeof e.data.length||r.isString(e.data))?"data: buffer expected":null!=e.type&&e.hasOwnProperty("type")&&"boolean"!=typeof e.type?"type: boolean expected":null!=e.compressed&&e.hasOwnProperty("compressed")&&"boolean"!=typeof e.compressed?"compressed: boolean expected":null},o.fromObject=function(e){if(e instanceof i.WorldChunkLoad)return e;var t=new i.WorldChunkLoad;return null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.z&&(t.z=0|e.z),null!=e.data&&("string"==typeof e.data?r.base64.decode(e.data,t.data=r.newBuffer(r.base64.length(e.data)),0):e.data.length&&(t.data=e.data)),null!=e.type&&(t.type=Boolean(e.type)),null!=e.compressed&&(t.compressed=Boolean(e.compressed)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0,t.bytes===String?n.data="":(n.data=[],t.bytes!==Array&&(n.data=r.newBuffer(n.data))),n.type=!1,n.compressed=!1),null!=e.x&&e.hasOwnProperty("x")&&(n.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=e.z),null!=e.data&&e.hasOwnProperty("data")&&(n.data=t.bytes===String?r.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data),null!=e.type&&e.hasOwnProperty("type")&&(n.type=e.type),null!=e.compressed&&e.hasOwnProperty("compressed")&&(n.compressed=e.compressed),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.WorldChunkUnload=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.x=0,o.prototype.y=0,o.prototype.z=0,o.prototype.type=!1,o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(8).int32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(16).int32(e.y),null!=e.z&&Object.hasOwnProperty.call(e,"z")&&t.uint32(24).int32(e.z),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(32).bool(e.type),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.WorldChunkUnload;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.x=e.int32();break;case 2:o.y=e.int32();break;case 3:o.z=e.int32();break;case 4:o.type=e.bool();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&!r.isInteger(e.x)?"x: integer expected":null!=e.y&&e.hasOwnProperty("y")&&!r.isInteger(e.y)?"y: integer expected":null!=e.z&&e.hasOwnProperty("z")&&!r.isInteger(e.z)?"z: integer expected":null!=e.type&&e.hasOwnProperty("type")&&"boolean"!=typeof e.type?"type: boolean expected":null},o.fromObject=function(e){if(e instanceof i.WorldChunkUnload)return e;var t=new i.WorldChunkUnload;return null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.z&&(t.z=0|e.z),null!=e.type&&(t.type=Boolean(e.type)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.x=0,n.y=0,n.z=0,n.type=!1),null!=e.x&&e.hasOwnProperty("x")&&(n.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=e.y),null!=e.z&&e.hasOwnProperty("z")&&(n.z=e.z),null!=e.type&&e.hasOwnProperty("type")&&(n.type=e.type),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i.RegistryUpdate=function(){function o(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return o.prototype.itemsDef="",o.prototype.blocksDef="",o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=n.create()),null!=e.itemsDef&&Object.hasOwnProperty.call(e,"itemsDef")&&t.uint32(10).string(e.itemsDef),null!=e.blocksDef&&Object.hasOwnProperty.call(e,"blocksDef")&&t.uint32(18).string(e.blocksDef),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,n){e instanceof t||(e=t.create(e));for(var r=void 0===n?e.len:e.pos+n,o=new i.RegistryUpdate;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:o.itemsDef=e.string();break;case 2:o.blocksDef=e.string();break;default:e.skipType(7&s)}}return o},o.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.itemsDef&&e.hasOwnProperty("itemsDef")&&!r.isString(e.itemsDef)?"itemsDef: string expected":null!=e.blocksDef&&e.hasOwnProperty("blocksDef")&&!r.isString(e.blocksDef)?"blocksDef: string expected":null},o.fromObject=function(e){if(e instanceof i.RegistryUpdate)return e;var t=new i.RegistryUpdate;return null!=e.itemsDef&&(t.itemsDef=String(e.itemsDef)),null!=e.blocksDef&&(t.blocksDef=String(e.blocksDef)),t},o.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.itemsDef="",n.blocksDef=""),null!=e.itemsDef&&e.hasOwnProperty("itemsDef")&&(n.itemsDef=e.itemsDef),null!=e.blocksDef&&e.hasOwnProperty("blocksDef")&&(n.blocksDef=e.blocksDef),n},o.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},o}(),i})?r.apply(t,i):r)||(e.exports=o)},function(e){e.exports=JSON.parse('["LoginResponse","ActionMove","ActionMessage","ActionBlockPlace","ActionBlockBreak","ActionInventoryClick","ActionInventoryOpen","ActionInventoryClose","ActionClick","ActionClickEntity"]')},function(e){e.exports=JSON.parse('["LoginRequest","LoginSuccess","PlayerKick","PlayerEntity","PlayerTeleport","PlayerInventory","PlayerSlotUpdate","PlayerApplyImpulse","PlayerUpdateMovement","PlayerUpdatePhysics","SoundPlay","ChatMessage","TabUpdate","EntityCreate","EntityRemove","EntityMove","EntityUpdate","EntityAnimate","WorldBlockUpdate","WorldChunkLoad","WorldChunkUnload","RegistryUpdate"]')},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.destroyGuis=t.setupGuis=void 0;const i=n(355),o=n(242),s=n(212),a=r(n(248));t.setupGuis=function(e,t,n,r){o.buildHotbar(e,t),i.setupDot(),i.setupDebug(e,t.server),o.buildInventory(e,t),s.setupChat(),a.default(e)},t.destroyGuis=function(){null!=o.inventory&&o.inventory.dispose(),null!=o.hotbar&&o.hotbar.dispose(),null!=s.chatContainer&&s.chatContainer.dispose(),null!=i.debug&&i.debug.dispose(),null!=i.dot&&i.dot.dispose()}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.setupDot=t.dot=t.setupDebug=t.debug=void 0;const s=n(81),a=o(n(97)),u=n(96);t.setupDebug=function(e,n){const r=s.getUI(0),i=e.playerEntity,o=e.entities.getPositionData(i);let l;t.debug=new a.TextBlock,r.addControl(t.debug),t.debug.text="",t.debug.color="#f0f0f0",t.debug.fontSize=8*s.scale+"px",t.debug.left="5px",t.debug.top="5px",t.debug.shadowColor="#111111",t.debug.shadowOffsetX=1,t.debug.shadowOffsetY=1,t.debug.textHorizontalAlignment=a.Control.HORIZONTAL_ALIGNMENT_LEFT,t.debug.textVerticalAlignment=a.Control.VERTICAL_ALIGNMENT_TOP,l=null!=n?`Server: ${n}\n`:"Singleplayer world\n";let c=s.scale;const h=async()=>{const n=`${o.position[0].toFixed(1)}, ${o.position[1].toFixed(1)}, ${o.position[2].toFixed(1)}`,r=`VoxelSrv ${u.gameVersion}\nNoa: ${e.version}\nXYZ: ${n}\n${l}`;t.debug.text=r,c!=s.scale&&(c=s.scale,t.debug.fontSize=8*s.scale+"px")};e.on("tick",h),t.debug.onDisposeObservable.add(()=>{e.off("tick",h)})},t.setupDot=function(){s.getLayer(0);const e=s.getUI(0);t.dot=new a.Ellipse,t.dot.background="#eeeeee88",t.dot.height=2*s.scale+"px",t.dot.width=2*s.scale+"px",t.dot.thickness=0;const n=()=>{t.dot.height=2*s.scale+"px",t.dot.width=2*s.scale+"px"};s.event.on("scale-change",n),t.dot.onDisposeObservable.add(()=>{s.event.off("scale-change",n)}),e.addControl(t.dot)}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const s=n(81),a=o(n(97)),u=n(169),l=n(213);t.default=function(e,t,n){const r=new a.Rectangle;r.thickness=0,r.horizontalAlignment=2,r.zIndex=10,r.height=100*s.scale+"px",r.width=180*s.scale+"px",r.background="#11111166",s.getScreen(1).addControl(r);const i=new a.TextBlock;i.fontFamily="Lato",i.fontSize=11*s.scale,i.textVerticalAlignment=0,i.color="white",i.text="Disconnected!",i.top=s.scale,r.addControl(i);const o=new a.TextBlock;o.fontFamily="Lato",o.fontSize=9*s.scale,o.textVerticalAlignment=2,o.color="white",o.text=e,o.textWrapping=a.TextWrapping.WordWrap,r.addControl(o);const c=function(){const e=new a.Rectangle;e.width=100*s.scale+"px",e.height=18*s.scale+"px",e.isPointerBlocker=!0,e.horizontalAlignment=2,e.thickness=0,e.paddingBottom="10px",e.zIndex=10;const t=new u.FormTextBlock;return t.text=[{text:"MenuItemText",color:"white",font:"Lato"}],t.fontSize=10*s.scale,t.textHorizontalAlignment=2,e.addControl(t),e.onPointerEnterObservable.add(e=>{t.text.forEach(e=>e.underline=!0),t._markAsDirty()}),e.onPointerOutObservable.add(e=>{t.text.forEach(e=>e.underline=!1),t._markAsDirty()}),{item:e,text:t}}();c.item.verticalAlignment=1,c.text.text=[{text:"Go back to menu",color:"white",font:"Lato"}],c.item.onPointerClickObservable.add(()=>{r.dispose(),l.buildMainMenu(t,n)}),r.addControl(c.item);const h=e=>{r.height=100*s.scale+"px",r.width=180*s.scale+"px",i.fontSize=11*s.scale,c.item.width=100*s.scale+"px",c.item.height=18*s.scale+"px",c.text.fontSize=10*s.scale};return s.event.on("scale-change",h),r.onDisposeObservable.add(()=>{s.event.off("scale-change",h)}),r}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.setChunk=t.setupAutoload=void 0;const s=n(128),a=o(n(358)),u={};t.setupAutoload=function(e,t){},t.setChunk=function(e,t){if(e.compressed){let t=0;t=e.type?262144:35,e.data=a.inflate(e.data,new Uint16Array(t))}if(e.type){const r=new s(e.data,[32,256,32]);for(var n=0;n<8;n++){const i=new s(new Uint16Array(32768),[32,32,32]),o=e.x+"|"+n+"|"+e.z+"|"+t.worldName;for(let e=0;e<32;e++)for(let t=0;t<32;t++)for(let o=0;o<32;o++){const s=r.get(e,o+32*n,t);i.set(e,o,t,s)}u[o]=i,t.world.setChunkData(o,i)}const i=t.ents.getPosition(t.playerEntity);e.x==Math.round(i[0]/32)&&e.z==Math.round(i[2]/32)&&(t.world.playerChunkLoaded=!0)}else{const n=e.x+"|"+e.y+"|"+e.z+"|"+t.worldName,r=new s(e.data,[32,32,32]);u[n]=r,t.world.setChunkData(n,r)}}},function(e,t,n){"use strict";var r={};(0,n(118).assign)(r,n(359),n(362),n(254)),e.exports=r},function(e,t,n){"use strict";var r=n(360),i=n(118),o=n(252),s=n(214),a=n(253),u=Object.prototype.toString;function l(e){if(!(this instanceof l))return new l(e);this.options=i.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==n)throw new Error(s[n]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){var c;if(c="string"==typeof t.dictionary?o.string2buf(t.dictionary):"[object ArrayBuffer]"===u.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(n=r.deflateSetDictionary(this.strm,c)))throw new Error(s[n]);this._dict_set=!0}}function c(e,t){var n=new l(t);if(n.push(e,!0),n.err)throw n.msg||s[n.err];return n.result}l.prototype.push=function(e,t){var n,s,a=this.strm,l=this.options.chunkSize;if(this.ended)return!1;s=t===~~t?t:!0===t?4:0,"string"==typeof e?a.input=o.string2buf(e):"[object ArrayBuffer]"===u.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;do{if(0===a.avail_out&&(a.output=new i.Buf8(l),a.next_out=0,a.avail_out=l),1!==(n=r.deflate(a,s))&&0!==n)return this.onEnd(n),this.ended=!0,!1;0!==a.avail_out&&(0!==a.avail_in||4!==s&&2!==s)||("string"===this.options.to?this.onData(o.buf2binstring(i.shrinkBuf(a.output,a.next_out))):this.onData(i.shrinkBuf(a.output,a.next_out)))}while((a.avail_in>0||0===a.avail_out)&&1!==n);return 4===s?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==s||(this.onEnd(0),a.avail_out=0,!0)},l.prototype.onData=function(e){this.chunks.push(e)},l.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Deflate=l,t.deflate=c,t.deflateRaw=function(e,t){return(t=t||{}).raw=!0,c(e,t)},t.gzip=function(e,t){return(t=t||{}).gzip=!0,c(e,t)}},function(e,t,n){"use strict";var r,i=n(118),o=n(361),s=n(250),a=n(251),u=n(214);function l(e,t){return e.msg=u[t],t}function c(e){return(e<<1)-(e>4?9:0)}function h(e){for(var t=e.length;--t>=0;)e[t]=0}function f(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(i.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function d(e,t){o._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,f(e.strm)}function p(e,t){e.pending_buf[e.pending++]=t}function m(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function y(e,t){var n,r,i=e.max_chain_length,o=e.strstart,s=e.prev_length,a=e.nice_match,u=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,l=e.window,c=e.w_mask,h=e.prev,f=e.strstart+258,d=l[o+s-1],p=l[o+s];e.prev_length>=e.good_match&&(i>>=2),a>e.lookahead&&(a=e.lookahead);do{if(l[(n=t)+s]===p&&l[n+s-1]===d&&l[n]===l[o]&&l[++n]===l[o+1]){o+=2,n++;do{}while(l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&o<f);if(r=258-(f-o),o=f-258,r>s){if(e.match_start=t,s=r,r>=a)break;d=l[o+s-1],p=l[o+s]}}}while((t=h[t&c])>u&&0!=--i);return s<=e.lookahead?s:e.lookahead}function g(e){var t,n,r,o,u,l,c,h,f,d,p=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=p+(p-262)){i.arraySet(e.window,e.window,p,p,0),e.match_start-=p,e.strstart-=p,e.block_start-=p,t=n=e.hash_size;do{r=e.head[--t],e.head[t]=r>=p?r-p:0}while(--n);t=n=p;do{r=e.prev[--t],e.prev[t]=r>=p?r-p:0}while(--n);o+=p}if(0===e.strm.avail_in)break;if(l=e.strm,c=e.window,h=e.strstart+e.lookahead,f=o,d=void 0,(d=l.avail_in)>f&&(d=f),n=0===d?0:(l.avail_in-=d,i.arraySet(c,l.input,l.next_in,d,h),1===l.state.wrap?l.adler=s(l.adler,c,d,h):2===l.state.wrap&&(l.adler=a(l.adler,c,d,h)),l.next_in+=d,l.total_in+=d,d),e.lookahead+=n,e.lookahead+e.insert>=3)for(u=e.strstart-e.insert,e.ins_h=e.window[u],e.ins_h=(e.ins_h<<e.hash_shift^e.window[u+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[u+3-1])&e.hash_mask,e.prev[u&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=u,u++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)}function v(e,t){for(var n,r;;){if(e.lookahead<262){if(g(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-262&&(e.match_length=y(e,n)),e.match_length>=3)if(r=o._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(d(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(d(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(d(e,!1),0===e.strm.avail_out)?1:2}function b(e,t){for(var n,r,i;;){if(e.lookahead<262){if(g(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-262&&(e.match_length=y(e,n),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,r=o._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(d(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((r=o._tr_tally(e,0,e.window[e.strstart-1]))&&d(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=o._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(d(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(d(e,!1),0===e.strm.avail_out)?1:2}function w(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}function _(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(1146),this.dyn_dtree=new i.Buf16(122),this.bl_tree=new i.Buf16(78),h(this.dyn_ltree),h(this.dyn_dtree),h(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(16),this.heap=new i.Buf16(573),h(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(573),h(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function x(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=0,o._tr_init(t),0):l(e,-2)}function k(e){var t,n=x(e);return 0===n&&((t=e.state).window_size=2*t.w_size,h(t.head),t.max_lazy_match=r[t.level].max_lazy,t.good_match=r[t.level].good_length,t.nice_match=r[t.level].nice_length,t.max_chain_length=r[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),n}function O(e,t,n,r,o,s){if(!e)return-2;var a=1;if(-1===t&&(t=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),o<1||o>9||8!==n||r<8||r>15||t<0||t>9||s<0||s>4)return l(e,-2);8===r&&(r=9);var u=new _;return e.state=u,u.strm=e,u.wrap=a,u.gzhead=null,u.w_bits=r,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=o+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+3-1)/3),u.window=new i.Buf8(2*u.w_size),u.head=new i.Buf16(u.hash_size),u.prev=new i.Buf16(u.w_size),u.lit_bufsize=1<<o+6,u.pending_buf_size=4*u.lit_bufsize,u.pending_buf=new i.Buf8(u.pending_buf_size),u.d_buf=1*u.lit_bufsize,u.l_buf=3*u.lit_bufsize,u.level=t,u.strategy=s,u.method=n,k(e)}r=[new w(0,0,0,0,(function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(g(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,d(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-262&&(d(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(d(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(d(e,!1),e.strm.avail_out),1)})),new w(4,4,8,4,v),new w(4,5,16,8,v),new w(4,6,32,32,v),new w(4,4,16,16,b),new w(8,16,32,32,b),new w(8,16,128,128,b),new w(8,32,128,256,b),new w(32,128,258,1024,b),new w(32,258,258,4096,b)],t.deflateInit=function(e,t){return O(e,t,8,15,8,0)},t.deflateInit2=O,t.deflateReset=k,t.deflateResetKeep=x,t.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?-2:(e.state.gzhead=t,0):-2},t.deflate=function(e,t){var n,i,s,u;if(!e||!e.state||t>5||t<0)return e?l(e,-2):-2;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||666===i.status&&4!==t)return l(e,0===e.avail_out?-5:-2);if(i.strm=e,n=i.last_flush,i.last_flush=t,42===i.status)if(2===i.wrap)e.adler=0,p(i,31),p(i,139),p(i,8),i.gzhead?(p(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),p(i,255&i.gzhead.time),p(i,i.gzhead.time>>8&255),p(i,i.gzhead.time>>16&255),p(i,i.gzhead.time>>24&255),p(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),p(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(p(i,255&i.gzhead.extra.length),p(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=a(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(p(i,0),p(i,0),p(i,0),p(i,0),p(i,0),p(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),p(i,3),i.status=113);else{var y=8+(i.w_bits-8<<4)<<8;y|=(i.strategy>=2||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(y|=32),y+=31-y%31,i.status=113,m(i,y),0!==i.strstart&&(m(i,e.adler>>>16),m(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(s=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>s&&(e.adler=a(e.adler,i.pending_buf,i.pending-s,s)),f(e),s=i.pending,i.pending!==i.pending_buf_size));)p(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>s&&(e.adler=a(e.adler,i.pending_buf,i.pending-s,s)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){s=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(e.adler=a(e.adler,i.pending_buf,i.pending-s,s)),f(e),s=i.pending,i.pending===i.pending_buf_size)){u=1;break}u=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,p(i,u)}while(0!==u);i.gzhead.hcrc&&i.pending>s&&(e.adler=a(e.adler,i.pending_buf,i.pending-s,s)),0===u&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){s=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(e.adler=a(e.adler,i.pending_buf,i.pending-s,s)),f(e),s=i.pending,i.pending===i.pending_buf_size)){u=1;break}u=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,p(i,u)}while(0!==u);i.gzhead.hcrc&&i.pending>s&&(e.adler=a(e.adler,i.pending_buf,i.pending-s,s)),0===u&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&f(e),i.pending+2<=i.pending_buf_size&&(p(i,255&e.adler),p(i,e.adler>>8&255),e.adler=0,i.status=113)):i.status=113),0!==i.pending){if(f(e),0===e.avail_out)return i.last_flush=-1,0}else if(0===e.avail_in&&c(t)<=c(n)&&4!==t)return l(e,-5);if(666===i.status&&0!==e.avail_in)return l(e,-5);if(0!==e.avail_in||0!==i.lookahead||0!==t&&666!==i.status){var v=2===i.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(g(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(d(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(d(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(d(e,!1),0===e.strm.avail_out)?1:2}(i,t):3===i.strategy?function(e,t){for(var n,r,i,s,a=e.window;;){if(e.lookahead<=258){if(g(e),e.lookahead<=258&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(r=a[i=e.strstart-1])===a[++i]&&r===a[++i]&&r===a[++i]){s=e.strstart+258;do{}while(r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&i<s);e.match_length=258-(s-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=o._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(d(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(d(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(d(e,!1),0===e.strm.avail_out)?1:2}(i,t):r[i.level].func(i,t);if(3!==v&&4!==v||(i.status=666),1===v||3===v)return 0===e.avail_out&&(i.last_flush=-1),0;if(2===v&&(1===t?o._tr_align(i):5!==t&&(o._tr_stored_block(i,0,0,!1),3===t&&(h(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),f(e),0===e.avail_out))return i.last_flush=-1,0}return 4!==t?0:i.wrap<=0?1:(2===i.wrap?(p(i,255&e.adler),p(i,e.adler>>8&255),p(i,e.adler>>16&255),p(i,e.adler>>24&255),p(i,255&e.total_in),p(i,e.total_in>>8&255),p(i,e.total_in>>16&255),p(i,e.total_in>>24&255)):(m(i,e.adler>>>16),m(i,65535&e.adler)),f(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?0:1)},t.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t?l(e,-2):(e.state=null,113===t?l(e,-3):0):-2},t.deflateSetDictionary=function(e,t){var n,r,o,a,u,l,c,f,d=t.length;if(!e||!e.state)return-2;if(2===(a=(n=e.state).wrap)||1===a&&42!==n.status||n.lookahead)return-2;for(1===a&&(e.adler=s(e.adler,t,d,0)),n.wrap=0,d>=n.w_size&&(0===a&&(h(n.head),n.strstart=0,n.block_start=0,n.insert=0),f=new i.Buf8(n.w_size),i.arraySet(f,t,d-n.w_size,n.w_size,0),t=f,d=n.w_size),u=e.avail_in,l=e.next_in,c=e.input,e.avail_in=d,e.next_in=0,e.input=t,g(n);n.lookahead>=3;){r=n.strstart,o=n.lookahead-2;do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+3-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++}while(--o);n.strstart=r,n.lookahead=2,g(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=l,e.input=c,e.avail_in=u,n.wrap=a,0},t.deflateInfo="pako deflate (from Nodeca project)"},function(e,t,n){"use strict";var r=n(118);function i(e){for(var t=e.length;--t>=0;)e[t]=0}var o=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],s=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],u=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],l=new Array(576);i(l);var c=new Array(60);i(c);var h=new Array(512);i(h);var f=new Array(256);i(f);var d=new Array(29);i(d);var p,m,y,g=new Array(30);function v(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}function b(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function w(e){return e<256?h[e]:h[256+(e>>>7)]}function _(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function x(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,_(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function k(e,t,n){x(e,n[2*t],n[2*t+1])}function O(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function P(e,t,n){var r,i,o=new Array(16),s=0;for(r=1;r<=15;r++)o[r]=s=s+n[r-1]<<1;for(i=0;i<=t;i++){var a=e[2*i+1];0!==a&&(e[2*i]=O(o[a]++,a))}}function S(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function C(e){e.bi_valid>8?_(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function j(e,t,n,r){var i=2*t,o=2*n;return e[i]<e[o]||e[i]===e[o]&&r[t]<=r[n]}function E(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&j(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!j(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r}function A(e,t,n){var r,i,a,u,l=0;if(0!==e.last_lit)do{r=e.pending_buf[e.d_buf+2*l]<<8|e.pending_buf[e.d_buf+2*l+1],i=e.pending_buf[e.l_buf+l],l++,0===r?k(e,i,t):(k(e,(a=f[i])+256+1,t),0!==(u=o[a])&&x(e,i-=d[a],u),k(e,a=w(--r),n),0!==(u=s[a])&&x(e,r-=g[a],u))}while(l<e.last_lit);k(e,256,t)}function M(e,t){var n,r,i,o=t.dyn_tree,s=t.stat_desc.static_tree,a=t.stat_desc.has_stree,u=t.stat_desc.elems,l=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<u;n++)0!==o[2*n]?(e.heap[++e.heap_len]=l=n,e.depth[n]=0):o[2*n+1]=0;for(;e.heap_len<2;)o[2*(i=e.heap[++e.heap_len]=l<2?++l:0)]=1,e.depth[i]=0,e.opt_len--,a&&(e.static_len-=s[2*i+1]);for(t.max_code=l,n=e.heap_len>>1;n>=1;n--)E(e,o,n);i=u;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],E(e,o,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,o[2*i]=o[2*n]+o[2*r],e.depth[i]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,o[2*n+1]=o[2*r+1]=i,e.heap[1]=i++,E(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,r,i,o,s,a,u=t.dyn_tree,l=t.max_code,c=t.stat_desc.static_tree,h=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,d=t.stat_desc.extra_base,p=t.stat_desc.max_length,m=0;for(o=0;o<=15;o++)e.bl_count[o]=0;for(u[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)(o=u[2*u[2*(r=e.heap[n])+1]+1]+1)>p&&(o=p,m++),u[2*r+1]=o,r>l||(e.bl_count[o]++,s=0,r>=d&&(s=f[r-d]),a=u[2*r],e.opt_len+=a*(o+s),h&&(e.static_len+=a*(c[2*r+1]+s)));if(0!==m){do{for(o=p-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[p]--,m-=2}while(m>0);for(o=p;0!==o;o--)for(r=e.bl_count[o];0!==r;)(i=e.heap[--n])>l||(u[2*i+1]!==o&&(e.opt_len+=(o-u[2*i+1])*u[2*i],u[2*i+1]=o),r--)}}(e,t),P(o,l,e.bl_count)}function T(e,t,n){var r,i,o=-1,s=t[1],a=0,u=7,l=4;for(0===s&&(u=138,l=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=s,s=t[2*(r+1)+1],++a<u&&i===s||(a<l?e.bl_tree[2*i]+=a:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,o=i,0===s?(u=138,l=3):i===s?(u=6,l=3):(u=7,l=4))}function I(e,t,n){var r,i,o=-1,s=t[1],a=0,u=7,l=4;for(0===s&&(u=138,l=3),r=0;r<=n;r++)if(i=s,s=t[2*(r+1)+1],!(++a<u&&i===s)){if(a<l)do{k(e,i,e.bl_tree)}while(0!=--a);else 0!==i?(i!==o&&(k(e,i,e.bl_tree),a--),k(e,16,e.bl_tree),x(e,a-3,2)):a<=10?(k(e,17,e.bl_tree),x(e,a-3,3)):(k(e,18,e.bl_tree),x(e,a-11,7));a=0,o=i,0===s?(u=138,l=3):i===s?(u=6,l=3):(u=7,l=4)}}i(g);var D=!1;function z(e,t,n,i){x(e,0+(i?1:0),3),function(e,t,n,i){C(e),i&&(_(e,n),_(e,~n)),r.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n,!0)}t._tr_init=function(e){D||(!function(){var e,t,n,r,i,u=new Array(16);for(n=0,r=0;r<28;r++)for(d[r]=n,e=0;e<1<<o[r];e++)f[n++]=r;for(f[n-1]=r,i=0,r=0;r<16;r++)for(g[r]=i,e=0;e<1<<s[r];e++)h[i++]=r;for(i>>=7;r<30;r++)for(g[r]=i<<7,e=0;e<1<<s[r]-7;e++)h[256+i++]=r;for(t=0;t<=15;t++)u[t]=0;for(e=0;e<=143;)l[2*e+1]=8,e++,u[8]++;for(;e<=255;)l[2*e+1]=9,e++,u[9]++;for(;e<=279;)l[2*e+1]=7,e++,u[7]++;for(;e<=287;)l[2*e+1]=8,e++,u[8]++;for(P(l,287,u),e=0;e<30;e++)c[2*e+1]=5,c[2*e]=O(e,5);p=new v(l,o,257,286,15),m=new v(c,s,0,30,15),y=new v(new Array(0),a,0,19,7)}(),D=!0),e.l_desc=new b(e.dyn_ltree,p),e.d_desc=new b(e.dyn_dtree,m),e.bl_desc=new b(e.bl_tree,y),e.bi_buf=0,e.bi_valid=0,S(e)},t._tr_stored_block=z,t._tr_flush_block=function(e,t,n,r){var i,o,s=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),M(e,e.l_desc),M(e,e.d_desc),s=function(e){var t;for(T(e,e.dyn_ltree,e.l_desc.max_code),T(e,e.dyn_dtree,e.d_desc.max_code),M(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*u[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=i&&(i=o)):i=o=n+5,n+4<=i&&-1!==t?z(e,t,n,r):4===e.strategy||o===i?(x(e,2+(r?1:0),3),A(e,l,c)):(x(e,4+(r?1:0),3),function(e,t,n,r){var i;for(x(e,t-257,5),x(e,n-1,5),x(e,r-4,4),i=0;i<r;i++)x(e,e.bl_tree[2*u[i]+1],3);I(e,e.dyn_ltree,t-1),I(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),A(e,e.dyn_ltree,e.dyn_dtree)),S(e),r&&C(e)},t._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(f[n]+256+1)]++,e.dyn_dtree[2*w(t)]++),e.last_lit===e.lit_bufsize-1},t._tr_align=function(e){x(e,2,3),k(e,256,l),function(e){16===e.bi_valid?(_(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},function(e,t,n){"use strict";var r=n(363),i=n(118),o=n(252),s=n(254),a=n(214),u=n(253),l=n(366),c=Object.prototype.toString;function h(e){if(!(this instanceof h))return new h(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,t.windowBits);if(n!==s.Z_OK)throw new Error(a[n]);if(this.header=new l,r.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=o.string2buf(t.dictionary):"[object ArrayBuffer]"===c.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=r.inflateSetDictionary(this.strm,t.dictionary))!==s.Z_OK))throw new Error(a[n])}function f(e,t){var n=new h(t);if(n.push(e,!0),n.err)throw n.msg||a[n.err];return n.result}h.prototype.push=function(e,t){var n,a,u,l,h,f=this.strm,d=this.options.chunkSize,p=this.options.dictionary,m=!1;if(this.ended)return!1;a=t===~~t?t:!0===t?s.Z_FINISH:s.Z_NO_FLUSH,"string"==typeof e?f.input=o.binstring2buf(e):"[object ArrayBuffer]"===c.call(e)?f.input=new Uint8Array(e):f.input=e,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new i.Buf8(d),f.next_out=0,f.avail_out=d),(n=r.inflate(f,s.Z_NO_FLUSH))===s.Z_NEED_DICT&&p&&(n=r.inflateSetDictionary(this.strm,p)),n===s.Z_BUF_ERROR&&!0===m&&(n=s.Z_OK,m=!1),n!==s.Z_STREAM_END&&n!==s.Z_OK)return this.onEnd(n),this.ended=!0,!1;f.next_out&&(0!==f.avail_out&&n!==s.Z_STREAM_END&&(0!==f.avail_in||a!==s.Z_FINISH&&a!==s.Z_SYNC_FLUSH)||("string"===this.options.to?(u=o.utf8border(f.output,f.next_out),l=f.next_out-u,h=o.buf2string(f.output,u),f.next_out=l,f.avail_out=d-l,l&&i.arraySet(f.output,f.output,u,l,0),this.onData(h)):this.onData(i.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(m=!0)}while((f.avail_in>0||0===f.avail_out)&&n!==s.Z_STREAM_END);return n===s.Z_STREAM_END&&(a=s.Z_FINISH),a===s.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===s.Z_OK):a!==s.Z_SYNC_FLUSH||(this.onEnd(s.Z_OK),f.avail_out=0,!0)},h.prototype.onData=function(e){this.chunks.push(e)},h.prototype.onEnd=function(e){e===s.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Inflate=h,t.inflate=f,t.inflateRaw=function(e,t){return(t=t||{}).raw=!0,f(e,t)},t.ungzip=f},function(e,t,n){"use strict";var r=n(118),i=n(250),o=n(251),s=n(364),a=n(365);function u(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function l(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function c(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(852),t.distcode=t.distdyn=new r.Buf32(592),t.sane=1,t.back=-1,0):-2}function h(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,c(e)):-2}function f(e,t){var n,r;return e&&e.state?(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?-2:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,h(e))):-2}function d(e,t){var n,r;return e?(r=new l,e.state=r,r.window=null,0!==(n=f(e,t))&&(e.state=null),n):-2}var p,m,y=!0;function g(e){if(y){var t;for(p=new r.Buf32(512),m=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(a(1,e.lens,0,288,p,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;a(2,e.lens,0,32,m,0,e.work,{bits:5}),y=!1}e.lencode=p,e.lenbits=9,e.distcode=m,e.distbits=5}function v(e,t,n,i){var o,s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new r.Buf8(s.wsize)),i>=s.wsize?(r.arraySet(s.window,t,n-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):((o=s.wsize-s.wnext)>i&&(o=i),r.arraySet(s.window,t,n-i,o,s.wnext),(i-=o)?(r.arraySet(s.window,t,n-i,i,0),s.wnext=i,s.whave=s.wsize):(s.wnext+=o,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=o))),0}t.inflateReset=h,t.inflateReset2=f,t.inflateResetKeep=c,t.inflateInit=function(e){return d(e,15)},t.inflateInit2=d,t.inflate=function(e,t){var n,l,c,h,f,d,p,m,y,b,w,_,x,k,O,P,S,C,j,E,A,M,T,I,D=0,z=new r.Buf8(4),B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return-2;12===(n=e.state).mode&&(n.mode=13),f=e.next_out,c=e.output,p=e.avail_out,h=e.next_in,l=e.input,d=e.avail_in,m=n.hold,y=n.bits,b=d,w=p,M=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;y<16;){if(0===d)break e;d--,m+=l[h++]<<y,y+=8}if(2&n.wrap&&35615===m){n.check=0,z[0]=255&m,z[1]=m>>>8&255,n.check=o(n.check,z,2,0),m=0,y=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&m)<<8)+(m>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&m)){e.msg="unknown compression method",n.mode=30;break}if(y-=4,A=8+(15&(m>>>=4)),0===n.wbits)n.wbits=A;else if(A>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<A,e.adler=n.check=1,n.mode=512&m?10:12,m=0,y=0;break;case 2:for(;y<16;){if(0===d)break e;d--,m+=l[h++]<<y,y+=8}if(n.flags=m,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=m>>8&1),512&n.flags&&(z[0]=255&m,z[1]=m>>>8&255,n.check=o(n.check,z,2,0)),m=0,y=0,n.mode=3;case 3:for(;y<32;){if(0===d)break e;d--,m+=l[h++]<<y,y+=8}n.head&&(n.head.time=m),512&n.flags&&(z[0]=255&m,z[1]=m>>>8&255,z[2]=m>>>16&255,z[3]=m>>>24&255,n.check=o(n.check,z,4,0)),m=0,y=0,n.mode=4;case 4:for(;y<16;){if(0===d)break e;d--,m+=l[h++]<<y,y+=8}n.head&&(n.head.xflags=255&m,n.head.os=m>>8),512&n.flags&&(z[0]=255&m,z[1]=m>>>8&255,n.check=o(n.check,z,2,0)),m=0,y=0,n.mode=5;case 5:if(1024&n.flags){for(;y<16;){if(0===d)break e;d--,m+=l[h++]<<y,y+=8}n.length=m,n.head&&(n.head.extra_len=m),512&n.flags&&(z[0]=255&m,z[1]=m>>>8&255,n.check=o(n.check,z,2,0)),m=0,y=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((_=n.length)>d&&(_=d),_&&(n.head&&(A=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,l,h,_,A)),512&n.flags&&(n.check=o(n.check,l,_,h)),d-=_,h+=_,n.length-=_),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===d)break e;_=0;do{A=l[h+_++],n.head&&A&&n.length<65536&&(n.head.name+=String.fromCharCode(A))}while(A&&_<d);if(512&n.flags&&(n.check=o(n.check,l,_,h)),d-=_,h+=_,A)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===d)break e;_=0;do{A=l[h+_++],n.head&&A&&n.length<65536&&(n.head.comment+=String.fromCharCode(A))}while(A&&_<d);if(512&n.flags&&(n.check=o(n.check,l,_,h)),d-=_,h+=_,A)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;y<16;){if(0===d)break e;d--,m+=l[h++]<<y,y+=8}if(m!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}m=0,y=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;y<32;){if(0===d)break e;d--,m+=l[h++]<<y,y+=8}e.adler=n.check=u(m),m=0,y=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=f,e.avail_out=p,e.next_in=h,e.avail_in=d,n.hold=m,n.bits=y,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){m>>>=7&y,y-=7&y,n.mode=27;break}for(;y<3;){if(0===d)break e;d--,m+=l[h++]<<y,y+=8}switch(n.last=1&m,y-=1,3&(m>>>=1)){case 0:n.mode=14;break;case 1:if(g(n),n.mode=20,6===t){m>>>=2,y-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}m>>>=2,y-=2;break;case 14:for(m>>>=7&y,y-=7&y;y<32;){if(0===d)break e;d--,m+=l[h++]<<y,y+=8}if((65535&m)!=(m>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&m,m=0,y=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(_=n.length){if(_>d&&(_=d),_>p&&(_=p),0===_)break e;r.arraySet(c,l,h,_,f),d-=_,h+=_,p-=_,f+=_,n.length-=_;break}n.mode=12;break;case 17:for(;y<14;){if(0===d)break e;d--,m+=l[h++]<<y,y+=8}if(n.nlen=257+(31&m),m>>>=5,y-=5,n.ndist=1+(31&m),m>>>=5,y-=5,n.ncode=4+(15&m),m>>>=4,y-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;y<3;){if(0===d)break e;d--,m+=l[h++]<<y,y+=8}n.lens[B[n.have++]]=7&m,m>>>=3,y-=3}for(;n.have<19;)n.lens[B[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,T={bits:n.lenbits},M=a(0,n.lens,0,19,n.lencode,0,n.work,T),n.lenbits=T.bits,M){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;P=(D=n.lencode[m&(1<<n.lenbits)-1])>>>16&255,S=65535&D,!((O=D>>>24)<=y);){if(0===d)break e;d--,m+=l[h++]<<y,y+=8}if(S<16)m>>>=O,y-=O,n.lens[n.have++]=S;else{if(16===S){for(I=O+2;y<I;){if(0===d)break e;d--,m+=l[h++]<<y,y+=8}if(m>>>=O,y-=O,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}A=n.lens[n.have-1],_=3+(3&m),m>>>=2,y-=2}else if(17===S){for(I=O+3;y<I;){if(0===d)break e;d--,m+=l[h++]<<y,y+=8}y-=O,A=0,_=3+(7&(m>>>=O)),m>>>=3,y-=3}else{for(I=O+7;y<I;){if(0===d)break e;d--,m+=l[h++]<<y,y+=8}y-=O,A=0,_=11+(127&(m>>>=O)),m>>>=7,y-=7}if(n.have+_>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;_--;)n.lens[n.have++]=A}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,T={bits:n.lenbits},M=a(1,n.lens,0,n.nlen,n.lencode,0,n.work,T),n.lenbits=T.bits,M){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,T={bits:n.distbits},M=a(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,T),n.distbits=T.bits,M){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(d>=6&&p>=258){e.next_out=f,e.avail_out=p,e.next_in=h,e.avail_in=d,n.hold=m,n.bits=y,s(e,w),f=e.next_out,c=e.output,p=e.avail_out,h=e.next_in,l=e.input,d=e.avail_in,m=n.hold,y=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;P=(D=n.lencode[m&(1<<n.lenbits)-1])>>>16&255,S=65535&D,!((O=D>>>24)<=y);){if(0===d)break e;d--,m+=l[h++]<<y,y+=8}if(P&&0==(240&P)){for(C=O,j=P,E=S;P=(D=n.lencode[E+((m&(1<<C+j)-1)>>C)])>>>16&255,S=65535&D,!(C+(O=D>>>24)<=y);){if(0===d)break e;d--,m+=l[h++]<<y,y+=8}m>>>=C,y-=C,n.back+=C}if(m>>>=O,y-=O,n.back+=O,n.length=S,0===P){n.mode=26;break}if(32&P){n.back=-1,n.mode=12;break}if(64&P){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&P,n.mode=22;case 22:if(n.extra){for(I=n.extra;y<I;){if(0===d)break e;d--,m+=l[h++]<<y,y+=8}n.length+=m&(1<<n.extra)-1,m>>>=n.extra,y-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;P=(D=n.distcode[m&(1<<n.distbits)-1])>>>16&255,S=65535&D,!((O=D>>>24)<=y);){if(0===d)break e;d--,m+=l[h++]<<y,y+=8}if(0==(240&P)){for(C=O,j=P,E=S;P=(D=n.distcode[E+((m&(1<<C+j)-1)>>C)])>>>16&255,S=65535&D,!(C+(O=D>>>24)<=y);){if(0===d)break e;d--,m+=l[h++]<<y,y+=8}m>>>=C,y-=C,n.back+=C}if(m>>>=O,y-=O,n.back+=O,64&P){e.msg="invalid distance code",n.mode=30;break}n.offset=S,n.extra=15&P,n.mode=24;case 24:if(n.extra){for(I=n.extra;y<I;){if(0===d)break e;d--,m+=l[h++]<<y,y+=8}n.offset+=m&(1<<n.extra)-1,m>>>=n.extra,y-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===p)break e;if(_=w-p,n.offset>_){if((_=n.offset-_)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}_>n.wnext?(_-=n.wnext,x=n.wsize-_):x=n.wnext-_,_>n.length&&(_=n.length),k=n.window}else k=c,x=f-n.offset,_=n.length;_>p&&(_=p),p-=_,n.length-=_;do{c[f++]=k[x++]}while(--_);0===n.length&&(n.mode=21);break;case 26:if(0===p)break e;c[f++]=n.length,p--,n.mode=21;break;case 27:if(n.wrap){for(;y<32;){if(0===d)break e;d--,m|=l[h++]<<y,y+=8}if(w-=p,e.total_out+=w,n.total+=w,w&&(e.adler=n.check=n.flags?o(n.check,c,w,f-w):i(n.check,c,w,f-w)),w=p,(n.flags?m:u(m))!==n.check){e.msg="incorrect data check",n.mode=30;break}m=0,y=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;y<32;){if(0===d)break e;d--,m+=l[h++]<<y,y+=8}if(m!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}m=0,y=0}n.mode=29;case 29:M=1;break e;case 30:M=-3;break e;case 31:return-4;case 32:default:return-2}return e.next_out=f,e.avail_out=p,e.next_in=h,e.avail_in=d,n.hold=m,n.bits=y,(n.wsize||w!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&v(e,e.output,e.next_out,w-e.avail_out)?(n.mode=31,-4):(b-=e.avail_in,w-=e.avail_out,e.total_in+=b,e.total_out+=w,n.total+=w,n.wrap&&w&&(e.adler=n.check=n.flags?o(n.check,c,w,e.next_out-w):i(n.check,c,w,e.next_out-w)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0===b&&0===w||4===t)&&0===M&&(M=-5),M)},t.inflateEnd=function(e){if(!e||!e.state)return-2;var t=e.state;return t.window&&(t.window=null),e.state=null,0},t.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?-2:(n.head=t,t.done=!1,0):-2},t.inflateSetDictionary=function(e,t){var n,r=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?-2:11===n.mode&&i(1,t,r,0)!==n.check?-3:v(e,t,r,r)?(n.mode=31,-4):(n.havedict=1,0):-2},t.inflateInfo="pako inflate (from Nodeca project)"},function(e,t,n){"use strict";e.exports=function(e,t){var n,r,i,o,s,a,u,l,c,h,f,d,p,m,y,g,v,b,w,_,x,k,O,P,S;n=e.state,r=e.next_in,P=e.input,i=r+(e.avail_in-5),o=e.next_out,S=e.output,s=o-(t-e.avail_out),a=o+(e.avail_out-257),u=n.dmax,l=n.wsize,c=n.whave,h=n.wnext,f=n.window,d=n.hold,p=n.bits,m=n.lencode,y=n.distcode,g=(1<<n.lenbits)-1,v=(1<<n.distbits)-1;e:do{p<15&&(d+=P[r++]<<p,p+=8,d+=P[r++]<<p,p+=8),b=m[d&g];t:for(;;){if(d>>>=w=b>>>24,p-=w,0===(w=b>>>16&255))S[o++]=65535&b;else{if(!(16&w)){if(0==(64&w)){b=m[(65535&b)+(d&(1<<w)-1)];continue t}if(32&w){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}_=65535&b,(w&=15)&&(p<w&&(d+=P[r++]<<p,p+=8),_+=d&(1<<w)-1,d>>>=w,p-=w),p<15&&(d+=P[r++]<<p,p+=8,d+=P[r++]<<p,p+=8),b=y[d&v];n:for(;;){if(d>>>=w=b>>>24,p-=w,!(16&(w=b>>>16&255))){if(0==(64&w)){b=y[(65535&b)+(d&(1<<w)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(x=65535&b,p<(w&=15)&&(d+=P[r++]<<p,(p+=8)<w&&(d+=P[r++]<<p,p+=8)),(x+=d&(1<<w)-1)>u){e.msg="invalid distance too far back",n.mode=30;break e}if(d>>>=w,p-=w,x>(w=o-s)){if((w=x-w)>c&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(k=0,O=f,0===h){if(k+=l-w,w<_){_-=w;do{S[o++]=f[k++]}while(--w);k=o-x,O=S}}else if(h<w){if(k+=l+h-w,(w-=h)<_){_-=w;do{S[o++]=f[k++]}while(--w);if(k=0,h<_){_-=w=h;do{S[o++]=f[k++]}while(--w);k=o-x,O=S}}}else if(k+=h-w,w<_){_-=w;do{S[o++]=f[k++]}while(--w);k=o-x,O=S}for(;_>2;)S[o++]=O[k++],S[o++]=O[k++],S[o++]=O[k++],_-=3;_&&(S[o++]=O[k++],_>1&&(S[o++]=O[k++]))}else{k=o-x;do{S[o++]=S[k++],S[o++]=S[k++],S[o++]=S[k++],_-=3}while(_>2);_&&(S[o++]=S[k++],_>1&&(S[o++]=S[k++]))}break}}break}}while(r<i&&o<a);r-=_=p>>3,d&=(1<<(p-=_<<3))-1,e.next_in=r,e.next_out=o,e.avail_in=r<i?i-r+5:5-(r-i),e.avail_out=o<a?a-o+257:257-(o-a),n.hold=d,n.bits=p}},function(e,t,n){"use strict";var r=n(118),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,n,u,l,c,h,f){var d,p,m,y,g,v,b,w,_,x=f.bits,k=0,O=0,P=0,S=0,C=0,j=0,E=0,A=0,M=0,T=0,I=null,D=0,z=new r.Buf16(16),B=new r.Buf16(16),L=null,R=0;for(k=0;k<=15;k++)z[k]=0;for(O=0;O<u;O++)z[t[n+O]]++;for(C=x,S=15;S>=1&&0===z[S];S--);if(C>S&&(C=S),0===S)return l[c++]=20971520,l[c++]=20971520,f.bits=1,0;for(P=1;P<S&&0===z[P];P++);for(C<P&&(C=P),A=1,k=1;k<=15;k++)if(A<<=1,(A-=z[k])<0)return-1;if(A>0&&(0===e||1!==S))return-1;for(B[1]=0,k=1;k<15;k++)B[k+1]=B[k]+z[k];for(O=0;O<u;O++)0!==t[n+O]&&(h[B[t[n+O]]++]=O);if(0===e?(I=L=h,v=19):1===e?(I=i,D-=257,L=o,R-=257,v=256):(I=s,L=a,v=-1),T=0,O=0,k=P,g=c,j=C,E=0,m=-1,y=(M=1<<C)-1,1===e&&M>852||2===e&&M>592)return 1;for(;;){b=k-E,h[O]<v?(w=0,_=h[O]):h[O]>v?(w=L[R+h[O]],_=I[D+h[O]]):(w=96,_=0),d=1<<k-E,P=p=1<<j;do{l[g+(T>>E)+(p-=d)]=b<<24|w<<16|_|0}while(0!==p);for(d=1<<k-1;T&d;)d>>=1;if(0!==d?(T&=d-1,T+=d):T=0,O++,0==--z[k]){if(k===S)break;k=t[n+h[O]]}if(k>C&&(T&y)!==m){for(0===E&&(E=C),g+=P,A=1<<(j=k-E);j+E<S&&!((A-=z[j+E])<=0);)j++,A<<=1;if(M+=1<<j,1===e&&M>852||2===e&&M>592)return 1;l[m=T&y]=C<<24|j<<16|g-c|0}}return 0!==T&&(l[g+T]=k-E<<24|64<<16|0),f.bits=C,0}},function(e,t,n){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.playSound=t.sounds=void 0;const s=o(n(139)),a=n(96);t.sounds={},t.playSound=function(e,n,r,i){const o=Object.keys(t.sounds)[Object.keys(t.sounds).length-1]+1;let u,l=n/10;function c(){t.sounds[o].play()}0>n?l=0:1<n&&(l=.1),console.log("Playing: "+e,"Volume: "+n,"Position: "+r),u=e.startsWith("http://")||e.startsWith("https://")&&1==a.gameSettings.allowcustom?e:"audio/"+e,null!=r?(t.sounds[o]=new s.Sound("Sound",u,i.rendering.getScene(),c,{volume:l,spatialSound:!0,maxDistance:100}),t.sounds[o].setPosition(new s.Vector3(r[0],r[1],r[2]))):t.sounds[o]=new s.Sound("Sound",u,i.rendering.getScene(),c,{volume:l}),t.sounds[o].onended=function(){delete t.sounds[o]}}},function(e,t,n){const r=n(369);let i=null;function o(e){const t=r(e);return["jpg","jpeg"].includes(t)?"image/jpeg":"image/png"}e.exports=function(e,t={}){const n=new Date,{filename:r=`Screen Shot ${n.toISOString().slice(0,10)} at ${n.toTimeString().slice(0,8).replace(/:/g,".")}.png`,quality:s=1,useBlob:a,download:u=!0}={...t};if(u&&(i=i||document.createElement("a"),i.download=r),a)return new Promise(t=>{e.toBlob(e=>{if(u){const t=URL.createObjectURL(e);i.href=t;const n=new MouseEvent("click");i.dispatchEvent(n),setTimeout(()=>{URL.revokeObjectURL(t)},1)}t(e)},o(r),s)});const l=e.toDataURL(o(r)+";base64",s);if(u){i.href=l;const e=new MouseEvent("click");i.dispatchEvent(e)}return l}},function(e,t,n){"use strict";
/*! file-extension v4.0.5 | (c) silverwind | BSD license */e.exports=function(e,t){if(t||(t={}),!e)return"";var n=(/[^./\\]*$/.exec(e)||[""])[0];return t.preserveCase?n:n.toLowerCase()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setupMobile=void 0;const r=n(81);t.setupMobile=function(e){console.log("Using mobile controls"),r.getScreen(1),r.getUI(1);let t=0,n=0,i=!1,o=null,s=null,a=[0,0];e.container.canvas.ontouchstart=function(r){a=[r.clientX,r.clientY],r.target==e.container.canvas&&(r.preventDefault(),null!=o&&(clearInterval(o),clearInterval(s)),i=!0,n=(new Date).getTime()/1e3,o=setInterval((function(){t=(new Date).getTime()/1e3-n}),2),s=setInterval((function(){t>.7&&e.inputs.down.emit("fire")}),400))},e.container.canvas.ontouchmove=function(e){e.preventDefault();let t=Math.abs(a[0]-e.targetTouches[0].clientX),r=Math.abs(a[1]-e.targetTouches[0].clientY);(t>3||r>3)&&(n=(new Date).getTime()/1e3+.5),a=[e.targetTouches[0].clientX,e.targetTouches[0].clientY]},e.container.canvas.ontouchend=function(n){n.target==e.container.canvas&&(n.preventDefault(),0<=t&&t<.7&&e.inputs.down.emit("alt-fire"),null!=o&&(clearInterval(o),clearInterval(s)),i=!1,t=0)},e.container.canvas.ontouchcancel=function(n){n.target==e.container.canvas&&(n.preventDefault(),null!=o&&(clearInterval(o),clearInterval(s)),i=!1,t=0)};const u=document.createElement("div");u.id="game_mobile_controls",document.body.appendChild(u);let l=null,c={x:0,y:0};var h=document.createElement("div");function f(t,n){t=Math.round(t/100),0==(n=Math.round(n/100))?(e.inputs.state.forward=!1,e.inputs.state.backward=!1):n>0?(e.inputs.state.forward=!1,e.inputs.state.backward=!0):n<0&&(e.inputs.state.forward=!0,e.inputs.state.backward=!1),0==t?(e.inputs.state.left=!1,e.inputs.state.right=!1):t>0?(e.inputs.state.left=!1,e.inputs.state.right=!0):t<0&&(e.inputs.state.left=!0,e.inputs.state.right=!1)}h.id="game_mobile_joystick",h.ontouchstart=function(e){e.target==h&&(e.preventDefault(),h.style.transition="0s",l=(e.changedTouches,{x:e.targetTouches[0].clientX,y:e.targetTouches[0].clientY}))},h.ontouchmove=function(e){if(e.target!=h)return;if(null===l)return;e.preventDefault();const t=e.targetTouches[0].clientX-l.x,n=e.targetTouches[0].clientY-l.y,r=Math.atan2(n,t),i=Math.min(100,Math.hypot(t,n)),o=i*Math.cos(r),s=i*Math.sin(r);h.style.transform="translate("+(o+16)+"px, "+(s+16)+"px)",c={x:o,y:s},f(o,s)},h.ontouchend=function(e){e.target==h&&(e.preventDefault(),null!==l&&(h.style.transition=".1s",h.style.transform="translate(16px, 16px)",l=null,c={x:0,y:0},f(0,0)))},u.appendChild(h);var d=document.createElement("div");d.id="game_mobile_jump",d.ontouchstart=function(){e.inputs.state.jump=!0},d.ontouchend=function(){e.inputs.state.jump=!1},d.ontouchcancel=function(){e.inputs.state.jump=!1},document.body.appendChild(d);var p=document.createElement("div");p.id="game_mobile_topbuttons",document.body.appendChild(p);var m=document.createElement("div");m.id="game_mobile_chat",m.innerHTML="",m.ontouchstart=function(t){t.preventDefault(),e.inputs.down.emit("chat")},p.appendChild(m);var y=document.createElement("div");y.id="game_mobile_menu",y.ontouchstart=function(t){t.preventDefault(),e.inputs.down.emit("menu")},p.appendChild(y)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setupGamepad=void 0;const r=n(96);t.setupGamepad=function(e){let t=null,n=!1,i=!1,o=!1;e.on("beforeRender",(function(){t=r.gameSettings.gamepad&&null!=navigator.getGamepads()[0]?navigator.getGamepads()[0]:null,null!=t&&(!function(t,n,r,i){t=Math.round(t),0==(n=Math.round(n))?(e.inputs.state.forward=!1,e.inputs.state.backward=!1):n>0?(e.inputs.state.forward=!1,e.inputs.state.backward=!0):n<0&&(e.inputs.state.forward=!0,e.inputs.state.backward=!1);0==t?(e.inputs.state.left=!1,e.inputs.state.right=!1):t>0?(e.inputs.state.left=!1,e.inputs.state.right=!0):t<0&&(e.inputs.state.left=!0,e.inputs.state.right=!1);e.camera.heading=e.camera.heading+Math.trunc(10*r)/500,e.camera.pitch=e.camera.pitch+Math.trunc(10*i)/500}(t.axes[0],t.axes[1],t.axes[2],t.axes[3]),e.inputs.state.jump=t.buttons[0].pressed,t.buttons[13].pressed&&e.inputs.down.emit("mid-fire"),t.buttons[2].pressed&&!n&&(e.inputs.down.emit("inventory"),n=!0,setTimeout((function(){n=!1}),200)),t.buttons[6].pressed&&!i&&(e.inputs.down.emit("alt-fire"),i=!0,setTimeout((function(){i=!1}),200)),t.buttons[7].pressed&&!o&&(e.inputs.down.emit("fire"),o=!0,setTimeout((function(){o=!1}),200)))})),setInterval((function(){null!=t&&(t.buttons[4].pressed?e.inputs.state.scrolly=-1:t.buttons[5].pressed?e.inputs.state.scrolly=1:e.inputs.state.scrolly=0)}),140)}},function(e,t,n){"use strict";n.r(t);var r=n(292),i=n(135).EventEmitter;function o(e,t){t=t||{},this._noa=e,this._tickRate=t.tickRate,this.element=t.domElement||function(){var e=document.createElement("div");return e.tabindex=1,e.style.position="fixed",e.style.left="0px",e.style.right="0px",e.style.top="0px",e.style.bottom="0px",e.style.height="100%",e.style.overflow="hidden",document.body.appendChild(e),document.body.style.overflow="hidden",document.body.style.height="100%",e.id="noa-container",e}(),this.canvas=function(e){var t=e.querySelector("canvas");t||((t=document.createElement("canvas")).style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.height="100%",t.style.width="100%",t.id="noa-canvas",e.insertBefore(t,e.firstChild));return t}(this.element),this._shell=function(e,t){(t=Object.assign({pointerLock:!1,preventDefaults:!1},t)).element=e;var n=r(t);return n.preventDefaults=t.preventDefaults,n}(this.canvas,t),this.hasPointerLock=!1,this.supportsPointerLock=!1,this.pointerInGame=!1,this.isFocused=document.hasFocus();var n=this,i=function(e){!function(e,t){var n=document.pointerLockElement||document.mozPointerLockElement||document.webkitPointerLockElement;n?(e.hasPointerLock=!0,e.emit("gainedPointerLock")):(e.hasPointerLock=!1,e.emit("lostPointerLock"));n&&(e.pointerInGame=!0)}(n)};document.addEventListener("pointerlockchange",i,!1),document.addEventListener("mozpointerlockchange",i,!1),document.addEventListener("webkitpointerlockchange",i,!1),function(e){if("pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document){e.supportsPointerLock=!0;var t=function(n){e.supportsPointerLock=!1,document.removeEventListener(n.type,t)};document.addEventListener("touchmove",t)}}(n),n.element.addEventListener("mouseenter",(function(){n.pointerInGame=!0})),n.element.addEventListener("mouseleave",(function(){n.pointerInGame=!1})),window.addEventListener("focus",(function(){n.isFocused=!0})),window.addEventListener("blur",(function(){n.isFocused=!1})),this._shell.on("init",s.bind(null,this))}function s(e){var t=e._noa;e._shell.on("resize",t.rendering.resize.bind(t.rendering)),function(e){var t=e._noa,n=e._tickRate,r=performance.now(),i=0,o=function(){var e=performance.now();if(!t._paused){i+=e-r;for(var s=2;i>n&&s-- >0;)t.tick(n),i-=n;i>n&&(i=0);var a=performance.now(),u=i+(a-e),l=Math.min(1,u/n);t.render(l)}r=e,requestAnimationFrame(o)};requestAnimationFrame(o)}(e),e.emit("DOMready")}function a(e,t){var n=e.indexOf(t);n<0||(n===e.length-1?e.pop():e[n]=e.pop())}function u(e,t,n){for(var r=(n||performance.now())+e,i=0;i<1e3;i++){if(t()||performance.now()>r)return}}o.prototype=Object.create(i.prototype),o.prototype.appendTo=function(e){this.element.appendChild(e)},o.prototype.setPointerLock=function(e){this._shell.pointerLock=!!e};var l=0,c=0;function h(e,t,n,r,i){e?function(e,t,n,r,i,o,s,a,u,l,c){for(var h=0;h<o;h++)for(var f=0;f<s;f++)for(var d=e.index(n+h,r+f,i),p=t.index(u+h,l+f,c),m=0;m<a;m++)t.data[p]=e.data[d],d+=e.stride[2],p+=t.stride[2]}(e,t,n[0],n[1],n[2],r[0],r[1],r[2],i[0],i[1],i[2]):function(e,t,n,r,i,o,s){for(var a=0;a<i;a++)for(var u=0;u<o;u++)for(var l=e.index(t+a,n+u,r),c=0;c<s;c++)e.data[l]=0,l+=e.stride[2]}(t,i[0],i[1],i[2],r[0],r[1],r[2])}function f(){this.arr=[],this.hash={}}f.prototype.includes=function(e){return this.hash[e]},f.prototype.add=function(e){this.hash[e]||(this.arr.push(e),this.hash[e]=!0)},f.prototype.remove=function(e){this.hash[e]&&(this.arr.splice(this.arr.indexOf(e),1),delete this.hash[e])},f.prototype.count=function(){return this.arr.length},f.prototype.forEach=function(e,t){return this.arr.forEach(e,t)},f.prototype.slice=function(e,t){return this.arr.slice(e,t)},f.prototype.isEmpty=function(){return 0===this.arr.length},f.prototype.empty=function(){this.arr.length=0,this.hash={}},f.prototype.pop=function(){var e=this.arr.pop();return delete this.hash[e],e},f.prototype.sort=function(e){var t={};this.arr.forEach(n=>{t[n]=e(n)}),this.arr.sort((e,n)=>t[n]-t[e])},f.prototype.copyFrom=function(e){this.arr=e.arr.slice(),this.hash=Object.assign({},e.hash)};var d=n(18),p=n(57),m=n(112),y=n(141),g=n(11),v=n(78),b=n(32),w=n(25),_=n(6),x=n(200),k=(n(168),n(76)),O={showFPS:!1,antiAlias:!0,clearColor:[.8,.9,1],ambientColor:[1,1,1],lightDiffuse:[1,1,1],lightSpecular:[1,1,1],groundLightColor:[.5,.5,.5],useAO:!0,AOmultipliers:[.93,.8,.5],reverseAOmultiplier:1,preserveDrawingBuffer:!0};function P(e,t,n){this.noa=e,t=Object.assign({},O,t),this.useAO=!!t.useAO,this.aoVals=t.AOmultipliers,this.revAoVal=t.reverseAOmultiplier,this.meshingCutoffTime=6,this._resizeDebounce=250,function(e,t,n){e._engine=new g.a(t,n.antiAlias,{preserveDrawingBuffer:n.preserveDrawingBuffer},n.adaptToDeviceRatio),e._multiscenes=new Array,e._scene=new d.a(e._engine);var r=e._scene;e._multiscenes.push(r),r.detachControl(),r._addComponent(new x.c(r)),e._octree=new m.a(e=>{}),e._octree.blocks=[],r._selectionOctree=e._octree,e._cameraHolder=new _.a("camHolder",r),e._camera=new p.a("camera",new w.y(0,0,0),r),e._camera.parent=e._cameraHolder,e._camera.minZ=.01,e._cameraHolder.visibility=!1,e._camScreen=_.a.CreatePlane("camScreen",10,r),e.addMeshToScene(e._camScreen),e._camScreen.position.z=.1,e._camScreen.parent=e._camera,e._camScreenMat=e.makeStandardMaterial("camscreenmat"),e._camScreen.material=e._camScreenMat,e._camScreen.setEnabled(!1),e._camLocBlock=0;var i=new w.y(.1,1,.3);function o(e){return new w.e(e[0],e[1],e[2])}e._light=new v.a("light",i,r),r.clearColor=o(n.clearColor),r.ambientColor=o(n.ambientColor),e._light.diffuse=o(n.lightDiffuse),e._light.specular=o(n.lightSpecular),e._light.groundColor=o(n.groundLightColor),e.flatMaterial=e.makeStandardMaterial("flatmat")}(this,n,t),t.showFPS&&function(){var e=document.createElement("div");e.id="noa_fps";"color:white; background-color:rgba(0,0,0,0.5);","font:14px monospace; text-align:center;","min-width:2em; margin:4px;",e.style="position:absolute; top:0; right:0; z-index:0;color:white; background-color:rgba(0,0,0,0.5);font:14px monospace; text-align:center;min-width:2em; margin:4px;",document.body.appendChild(e);var t=0,n=0,r=performance.now(),i=r;E=function(){t++;var o=performance.now();if(o-i>n&&(n=o-i),i=o,!(o-r<1e3)){var s=Math.round(t/(o-r)*1e3),a=Math.round(1/n*1e3);e.innerHTML=s+"<br>"+a,t=0,n=0,r=o}}}()}P.prototype.getScene=function(){return this._scene},P.prototype.getEngine=function(){return this._engine},P.prototype.addScene=function(e){this._multiscenes.push(e)},P.prototype.getSceneArray=function(e){return this._multiscenes},P.prototype.tick=function(e){},P.prototype.render=function(e){j("start"),function(e){var t=e.noa.camera,n=t._localGetTargetPosition();e._cameraHolder.position.copyFromFloats(n[0],n[1],n[2]),e._cameraHolder.rotation.x=t.pitch,e._cameraHolder.rotation.y=t.heading,e._camera.position.z=-t.currentZoom;var r=t._localGetPosition(),i=e.noa.worldOriginOffset,o=Math.floor(r[0]+i[0]),s=Math.floor(r[1]+i[1]),a=Math.floor(r[2]+i[2]),u=e.noa.getBlock(o,s,a);!function(e,t){if(t===e._camLocBlock)return;if(0===t)e._camScreen.setEnabled(!1);else{var n=e.noa.registry.getBlockFaceMaterial(t,0);if(n){var r=e.noa.registry.getMaterialData(n),i=r.color,o=r.alpha;i&&o&&o<1&&(e._camScreenMat.diffuseColor.set(0,0,0),e._camScreenMat.ambientColor.set(i[0],i[1],i[2]),e._camScreenMat.alpha=o,e._camScreen.setEnabled(!0))}}e._camLocBlock=t}(e,u)}(this),j("updateCamera"),this._engine.beginFrame(),j("beginFrame"),this._multiscenes.forEach(e=>{e.render()}),j("render"),E(),this._engine.endFrame(),j("endFrame"),j("end")},P.prototype.resize=function(e){S||(S=!0,setTimeout(()=>{this._engine.resize(),S=!1},this._resizeDebounce))};var S=!1;P.prototype.highlightBlockFace=function(e,t,n){var r=function(e){var t=e._highlightMesh;if(!t){t=_.a.CreatePlane("highlight",1,e._scene);var n=e.makeStandardMaterial("highlightMat");n.backFaceCulling=!1,n.emissiveColor=new w.e(1,1,1),n.alpha=.2,t.material=n;var r=.5,i=_.a.CreateLines("hightlightLines",[new w.y(r,r,0),new w.y(r,-r,0),new w.y(-r,-r,0),new w.y(-r,r,0),new w.y(r,r,0)],e._scene);i.color=new w.e(1,1,1),i.parent=t,e.addMeshToScene(t),e.addMeshToScene(i),e._highlightMesh=t}return t}(this);if(e){this.noa.globalToLocal(t,null,C);for(var i=.001+.001*k.dist(this.noa.camera._localGetPosition(),C),o=0;o<3;o++)0===n[o]?C[o]+=.5:C[o]+=n[o]>0?1+i:-i;r.position.copyFromFloats(C[0],C[1],C[2]),r.rotation.x=n[1]?Math.PI/2:0,r.rotation.y=n[0]?Math.PI/2:0}r.setEnabled(e)};var C=[];P.prototype.addMeshToScene=function(e,t,n,r){if(!e._noaContainingChunk&&!this._octree.dynamicContent.includes(e)){if(!e.parent){n||(n=[e.position.x,e.position.y,e.position.z]);var i=[];this.noa.globalToLocal(n,null,i),e.position.copyFromFloats(i[0],i[1],i[2])}var o=!1;if(t){var s=r||this.noa.world._getChunkByCoords(n[0],n[1],n[2]);o=!(!s||!s.octreeBlock)}o?(s.octreeBlock.entries.push(e),e._noaContainingChunk=s):this._octree.dynamicContent.push(e),t&&(e.freezeWorldMatrix(),e.freezeNormals());var a=this.removeMeshFromScene.bind(this,e);e.onDisposeObservable.add(a)}},P.prototype.removeMeshFromScene=function(e){e._noaContainingChunk&&e._noaContainingChunk.octreeBlock&&a(e._noaContainingChunk.octreeBlock.entries,e),e._noaContainingChunk=null,a(this._octree.dynamicContent,e)},P.prototype.makeStandardMaterial=function(e){var t=new b.a(e,this._scene);return t.specularColor.copyFromFloats(0,0,0),t.ambientColor.copyFromFloats(1,1,1),t.diffuseColor.copyFromFloats(1,1,1),t},P.prototype.prepareChunkForRendering=function(e){var t=e.size,n=[];this.noa.globalToLocal([e.x,e.y,e.z],null,n);var r=new w.y(n[0],n[1],n[2]),i=new w.y(n[0]+t,n[1]+t,n[2]+t);e.octreeBlock=new y.a(r,i,void 0,void 0,void 0,e=>{}),this._octree.blocks.push(e.octreeBlock)},P.prototype.disposeChunkForRendering=function(e){e.octreeBlock&&(a(this._octree.blocks,e.octreeBlock),e.octreeBlock.entries.length=0,e.octreeBlock=null)},P.prototype._rebaseOrigin=function(e){var t=new w.y(e[0],e[1],e[2]);this._scene.meshes.forEach(e=>{e.parent||(e.position.subtractInPlace(t),e._isWorldMatrixFrozen&&e.markAsDirty())}),this._octree.blocks.forEach(e=>{e.minPoint.subtractInPlace(t),e.maxPoint.subtractInPlace(t),e._boundingVectors.forEach(e=>{e.subtractInPlace(t)})})},P.prototype.debug_SceneCheck=function(){var e=this._scene.meshes,t=this._octree.dynamicContent,n=[],r=0,i=0,o=this._scene.materials,s=[];o.forEach(e=>{e.subMaterials?e.subMaterials.forEach(e=>s.push(e)):s.push(e)}),this._octree.blocks.forEach((function(e){r++,e.entries.forEach(e=>n.push(e))})),e.forEach((function(e){if(e._isDisposed&&l(e,"disposed mesh in scene"),0!==e.getIndices().length)if(c(e,t,n)&&l(e,"non-empty mesh missing from octree"),e.material){i+=e.subMeshes?e.subMeshes.length:1;var r=e.material.subMaterials||[e.material];r.forEach((function(e){c(e,r)&&l(e,"mesh material not in scene")}))}else l(e,"non-empty scene mesh with no material")}));var a=[];s.forEach(t=>{var n=!1;e.forEach(e=>{e.material===t&&(n=!0),e.material&&e.material.subMaterials&&e.material.subMaterials.includes(t)&&(n=!0)}),n||a.push(t.name)}),a.length&&console.warn("Materials unused by any mesh: ",a.join(", ")),t.forEach((function(t){c(t,e)&&l(t,"octree/dynamic mesh not in scene")})),n.forEach((function(t){c(t,e)&&l(t,"octree block mesh not in scene")}));var u=Math.round(10*n.length/r)/10;function l(e,t){console.warn(e.name+" --- "+t)}function c(e,t,n){return!!e&&(!t.includes(e)&&(!n||!n.includes(e)))}return console.log("meshes - octree:",n.length,"  dynamic:",t.length,"   subMeshes:",i,"   avg meshes/octreeBlock:",u),"done."},P.prototype.debug_MeshCount=function(){var e={};for(var t in this._scene.meshes.forEach(t=>{var n=t.name||"";n=(n=(n=(n=n.replace(/-\d+.*/,"#")).replace(/\d+.*/,"#")).replace(/(rotHolder|camHolder|camScreen)/,"rendering use")).replace(/atlas sprite .*/,"atlas sprites"),e[n]=e[n]||0,e[n]++}),e)console.log("   "+(e[t]+"       ").substr(0,7)+t)};var j=()=>{},E=function(){};var A=n(128),M=n.n(A),T=n(65),I=n(15),D=n(71),z=n(10),B=function(e){var t=new V(e),n=new U(e);this.meshChunk=function(r,i,o,s,a,u,l){q("start");var c=i||e.registry.getBlockFaceMaterial,f=o||e.registry._getMaterialVertexColor,d=void 0===a?e.rendering.useAO:a,p=u||e.rendering.aoVals,m=isNaN(l)?e.rendering.revAoVal:l,y=function(e){var t=e.voxels.shape[0],n=R;if(t+2!==n.shape[0]){var r=t+2;n=new M.a(new Uint16Array(r*r*r),[r,r,r]),R=n}var i=N[0],o=N[1],s=N[2],a=N[3],u=N[4],l=N[5],c=N[6];t!==L&&(L=t,function(e,t,n,r){for(var i=0;i<3;i++)t[i]=[e-1,0,0][i],n[i]=[1,e,1][i],r[i]=[0,1,e+1][i]}(t,u,l,c));for(var f=0;f<3;f++){i[0]=f;for(var d=0;d<3;d++){i[1]=d;for(var p=0;p<3;p++){i[2]=p;for(var m=0;m<3;m++){var y=i[m];o[m]=u[y],s[m]=l[y],a[m]=c[y]}var g=e._neighbors.get(f-1,d-1,p-1);h(g?g.voxels:null,n,o,s,a)}}}return n}(r);q("copy");var g,v=r.isFull||r.isEmpty,b=t.mesh(y,c,f,d,p,m,v);return b.length&&(g=n.build(r,b,s),q("terrain")),q("end"),g||null}};var L,R=new M.a(new Uint16Array(27),[3,3,3]),N=Array.from(Array(10)).map(e=>[0,0,0]);function F(e){this.id=0|e,this.positions=[],this.indices=[],this.normals=[],this.colors=[],this.uvs=[],this.mergeable=!1}function U(e){function t(e,t){for(var r=[],i=[],o=[],s=null,a=0;a<e.length;++a){var u=e[a];if(t||u.mergeable)if(r.push(u.positions.length),i.push(u.indices.length),o.push(u.id),s){var l=s.positions.length/3;n(s.positions,u.positions),n(s.normals,u.normals),n(s.colors,u.colors),n(s.uvs,u.uvs);for(var c=0,h=u.indices.length;c<h;++c)s.indices.push(u.indices[c]+l);e.splice(a,1),u.dispose(),a--}else s=u}return{vertices:r,indices:i,matIDs:o}}function n(e,t){for(var n=0;n<t.length;n++)e.push(t[n])}this.build=function(n,i,o){for(var s=0,a=0;a<i.length;a++){var u=i[a];if(o)u.mergeable=!0;else{var l=e.registry.getMaterialTexture(u.id),c=e.registry.getMaterialData(u.id);u.mergeable=!l&&1===c.alpha&&!c.renderMat}u.mergeable&&s++}s>1&&t(i,!1);var h=t(i,!0);return function(t,n,r,i,o){var s=e.rendering.getScene(),a=new _.a(n,s),u=new I.a;if(u.positions=t.positions,u.indices=t.indices,u.normals=t.normals,u.colors=t.colors,u.uvs=t.uvs,u.applyToMesh(a),t.dispose(),1===r.length)a.material=r[0];else{var l=new D.a("multimat "+n,s);a.subMeshes=[];for(var c=0,h=0,f=0;f<r.length;f++){l.subMaterials[f]=r[f];var d=new T.a(f,c,i[f],h,o[f],a);a.subMeshes[f]=d,c+=i[f],h+=o[f]}a.material=l}return a}(i[0],"chunk_"+n.id,h.matIDs.map(t=>function(t,n){if(n)return e.rendering.flatMaterial;var i="terrain mat "+t;r[i]||(r[i]=function(t){var n=e.registry.getMaterialData(t);if(n.renderMat)return n.renderMat;var r=e.registry.getMaterialTexture(t),i=n.alpha;if(!r&&1===i)return e.rendering.flatMaterial;var o=e.rendering.flatMaterial.clone("terrain"+t);if(r){var s=e.rendering.getScene(),a=new z.a(r,s,!0,!1,z.a.NEAREST_SAMPLINGMODE);n.textureAlpha&&(a.hasAlpha=!0),o.diffuseTexture=a}n.alpha<1&&(o.alpha=n.alpha);return o}(t));return r[i]}(t,o)),h.vertices,h.indices)};var r={}}function V(e){var t=new Int16Array(16),n=new Uint16Array(16),r=null,i=e.registry._solidityLookup,o=e.registry._opacityLookup;function s(e,i,o,s){for(var u=o.shape[1],l=t,c=n,h=0,f=2*i,d=o.data,p=o.index(e-1,0,0),m=o.stride[0],y=o.stride[1],g=o.stride[2],v=0;v<u;++v){var b=p;p+=g;for(var w=0;w<u;w++,h++,b+=y){var _=d[b],x=d[b+m];if(_!==x){var k=a(_,x,s,f);k&&(l[h]=k>0?s(_,f):-s(x,f+1),r&&(c[h]=k>0?r(o,e,e-1,w,v):r(o,e-1,e,w,v)))}}}}function a(e,t,n,r){var i=o[e],s=o[t];if(i&&s)return 0;if(i)return 1;if(s)return-1;var a=n(e,r),u=n(t,r+1);return a===u?0:0===a?-1:0===u?1:0}function u(e,r,i,o,s,a,u,d,p,m,y){var g=0,v=t,b=n,w=[0,0,0],_=[0,0,0],x=[0,0,0];w[r]=e;for(var k=[0,0,0],O=u?l:c,P=u?f:h,S=0;S<a;++S)for(var C=1,j=1,E=0;E<s;E+=C,g+=C){var A=0|v[g];if(A){var M=0|b[g];for(C=1;C<s-E&&O(g+C,v,A,b,M);++C);e:for(j=1;j<a-S;++j)for(var T=0;T<C;++T){if(!O(g+T+j*s,v,A,b,M))break e}var I=Math.abs(A);d[I]||(d[I]=new F(I));var D=d[I],z=P(D.colors,p(I),M,m,y);w[i]=E,w[o]=S,_[i]=C,x[o]=j;var B=D.positions;B.push(w[0],w[1],w[2],w[0]+_[0],w[1]+_[1],w[2]+_[2],w[0]+_[0]+x[0],w[1]+_[1]+x[1],w[2]+_[2]+x[2],w[0]+x[0],w[1]+x[1],w[2]+x[2]);var L=A>0?1:-1;2===r?D.uvs.push(0,j,-L*C,j,-L*C,0,0,0):D.uvs.push(0,C,0,0,L*j,0,L*j,C);var R=B.length/3-4;A<0?z?D.indices.push(R,R+1,R+2,R,R+2,R+3):D.indices.push(R+1,R+2,R+3,R,R+1,R+3):z?D.indices.push(R,R+2,R+1,R,R+3,R+2):D.indices.push(R+3,R+1,R,R+3,R+2,R+1),k[r]=L,D.normals.push(k[0],k[1],k[2],k[0],k[1],k[2],k[0],k[1],k[2],k[0],k[1],k[2]);for(var N=0;N<j;++N)for(var U=0;U<C;++U)v[g+U+N*s]=0}else C=1}}function l(e,t,n,r,i){return n===t[e]&&i===r[e]}function c(e,t,n,r,i){return n===t[e]}function h(e,t,n,r,i){return e.push(t[0],t[1],t[2],1),e.push(t[0],t[1],t[2],1),e.push(t[0],t[1],t[2],1),e.push(t[0],t[1],t[2],1),!0}function f(e,t,n,r,i){var o=m(n,0,0),s=m(n,1,0),a=m(n,1,1),u=m(n,0,1);y(e,t,o,r,i),y(e,t,s,r,i),y(e,t,a,r,i),y(e,t,u,r,i);return o===a?u!==s||2===u:u!==s&&o+a>u+s}function d(e,t,n,r,o){var s=1,a=1,u=1,l=1;return i[e.get(t,r+1,o)]&&(++u,++l),i[e.get(t,r-1,o)]&&(++s,++a),i[e.get(t,r,o+1)]&&(++a,++l),i[e.get(t,r,o-1)]&&(++s,++u),i[e.get(t,r,o)]?(l=3===l||i[e.get(t,r+1,o+1)]?3:2,a=3===a||i[e.get(t,r-1,o+1)]?3:2,u=3===u||i[e.get(t,r+1,o-1)]?3:2,s=3===s||i[e.get(t,r-1,o-1)]?3:2):(1===l&&i[e.get(t,r+1,o+1)]&&(l=2),1===a&&i[e.get(t,r-1,o+1)]&&(a=2),1===u&&i[e.get(t,r+1,o-1)]&&(u=2),1===s&&i[e.get(t,r-1,o-1)]&&(s=2)),l<<6|u<<4|a<<2|s}function p(e,t,n,r,o){var s=1,a=1,u=1,l=1;return i[e.get(t,r+1,o)]&&(++u,++l),i[e.get(t,r-1,o)]&&(++s,++a),i[e.get(t,r,o+1)]&&(++a,++l),i[e.get(t,r,o-1)]&&(++s,++u),i[e.get(t,r,o)]?(l=3===l||i[e.get(t,r+1,o+1)]?3:2,a=3===a||i[e.get(t,r-1,o+1)]?3:2,u=3===u||i[e.get(t,r+1,o-1)]?3:2,s=3===s||i[e.get(t,r-1,o-1)]?3:2):(1===l&&(i[e.get(t,r+1,o+1)]?l=2:i[e.get(n,r,o+1)]&&i[e.get(n,r+1,o)]&&i[e.get(n,r+1,o+1)]||(l=0)),1===u&&(i[e.get(t,r+1,o-1)]?u=2:i[e.get(n,r,o-1)]&&i[e.get(n,r+1,o)]&&i[e.get(n,r+1,o-1)]||(u=0)),1===a&&(i[e.get(t,r-1,o+1)]?a=2:i[e.get(n,r,o+1)]&&i[e.get(n,r-1,o)]&&i[e.get(n,r-1,o+1)]||(a=0)),1===s&&(i[e.get(t,r-1,o-1)]?s=2:i[e.get(n,r,o-1)]&&i[e.get(n,r-1,o)]&&i[e.get(n,r-1,o-1)]||(s=0))),l<<6|u<<4|a<<2|s}function m(e,t,n){return e>>(t?n?6:4:n?2:0)&3}function y(e,t,n,r,i){var o=0===n?i:r[n-1];e.push(t[0]*o,t[1]*o,t[2]*o,1)}this.mesh=function(a,l,c,h,f,m,y){i=e.registry._solidityLookup,o=e.registry._opacityLookup;var g={},v=m===f[0];r=h?v?d:p:null;for(var b=0;b<3;++b){var w=(b+1)%3,_=(b+2)%3,x=a.shape,k=a.transpose(b,w,_).lo(1,1,1).hi(x[b]-2,x[w]-2,x[_]-2),O=k.shape[0]-1,P=k.shape[1],S=k.shape[2];t.length<P*S&&(t=new Int16Array(P*S),n=new Uint16Array(P*S));for(var C=0;C<=O;++C)s(C,b,k,l),q("masks"),u(C,b,w,_,P,S,h,g,c,f,m),y&&(C+=O-1),q("submeshes")}return Object.keys(g).map(e=>g[e])}}F.prototype.dispose=function(){this.positions=null,this.indices=null,this.normals=null,this.colors=null,this.uvs=null};var q=()=>{},K=n(195),W=new function(){function e(e,t,n,r,i,o){var s=e._objectBlocks,a=new K.a("object_sps_"+e.id,t,{updatable:!1}),u=e.noa.registry._blockHandlerLookup,l=e.noa.registry._blockMeshLookup;for(var c in n){var h,f=l[c],d=n[c],p=d.length,m=u[c];m&&(h=m.onCustomMeshCreate);a.addShape(f,p,{positionFunction:function(e,t,n){var a=d[n],u=s[a];e.position.set(u.x+.5,u.y,u.z+.5),h&&h(e,r+u.x,i+u.y,o+u.z)}}),d.length=0}return a}this.initChunk=function(e){e._objectBlocks={},e._objectSystems=[]},this.disposeChunk=function(e){this.removeObjectMeshes(e),e._objectBlocks=null},this.addObjectBlock=function(e,t,n,r,i){var o=n+"|"+r+"|"+i;e._objectBlocks[o]=new Y(t,n,r,i,null)},this.removeObjectBlock=function(e,t,n,r){var i=t+"|"+n+"|"+r;e._objectBlocks[i]&&delete e._objectBlocks[i]},this.removeObjectMeshes=function(e){for(var t=e._objectSystems||[];t.length;){var n=t.pop();n.mesh&&n.mesh.dispose(),n.dispose()}},this.buildObjectMeshes=function(t){$("start");var n=t.noa.rendering.getScene(),r=t.noa.registry._blockMeshLookup,i={};for(var o in t._objectBlocks){var s=t._objectBlocks[o].id,a=r[s].material,u=a?n.materials.indexOf(a):-1;i[u]||(i[u]={}),i[u][s]||(i[u][s]=[]),i[u][s].push(o)}$("preprocess");var l=t.i*t.size,c=t.j*t.size,h=t.k*t.size,f=[];for(var d in i){var p=e(t,n,i[d],l,c,h);$("made SPS");var m=p.buildMesh();$("built mesh"),m.material=d>-1?n.materials[d]:null,f.push(m),t._objectSystems.push(p)}return $("end"),f}};function Y(e,t,n,r){this.id=0|e,this.x=0|t,this.y=0|n,this.z=0|r}var H,G,J,Z,X,$=()=>{},Q=n(128),ee=te;function te(e,t,n,r,i,o,s){this.id=t,this.requestID="",this.noa=e,this.isDisposed=!1,this.octreeBlock=null,this.voxels=s,this.i=n,this.j=r,this.k=i,this.size=o,this.x=n*o,this.y=r*o,this.z=i*o,this._terrainDirty=!1,this._objectsDirty=!1,H=e.registry._solidityLookup,G=e.registry._opacityLookup,J=e.registry._objectLookup,Z=e.registry._blockHandlerLookup,this._terrainMesh=null,this._objectBlocks=null,this._objectSystems=null,W.initChunk(this),this.isFull=!1,this.isEmpty=!1;var a=Array.from(Array(27)).map(()=>null);this._neighbors=new Q(a,[3,3,3]).lo(1,1,1),this._neighbors.set(0,0,0,this),this._neighborCount=0,this._maxMeshedNeighbors=0,this._timesMeshed=0,ie(this)}function ne(e,t,n,r,i,o){var s=Z[t];if(s){var a=s[n];a&&a(e.x+r,e.y+i,e.z+o)}}function re(e){return 0!==e&&(!!H[e]||!J[e])}function ie(e){for(var t=!0,n=!0,r=!1,i=e.voxels,o=i.shape[0],s=0;s<o;++s)for(var a=0;a<o;++a)for(var u=i.index(s,a,0),l=0;l<o;++l,++u){var c=i.data[u];0!==c?(t=t&&G[c],n=!1,J[c]&&(oe(e,c,s,a,l),r=!0),ne(e,c,"onLoad",s,a,l)):t=!1}e.isFull=t,e.isEmpty=n,e._terrainDirty=!e.isEmpty,e._objectsDirty=r}function oe(e,t,n,r,i){W.addObjectBlock(e,t,n,r,i),e._objectsDirty=!0}function se(e,t){for(var n=e.voxels,r=n.shape[0],i=0;i<r;++i)for(var o=0;o<r;++o)for(var s=0;s<r;++s){var a=n.get(i,o,s);a>0&&ne(e,a,t,i,o,s)}}te._createVoxelArray=function(e){var t=new Uint16Array(e*e*e);return new Q(t,[e,e,e])},te.prototype._updateVoxelArray=function(e){se(this,"onUnload"),W.disposeChunk(this),this.voxels=e,this._terrainDirty=!1,this._objectsDirty=!1,W.initChunk(this),ie(this)},te.prototype.get=function(e,t,n){return this.voxels.get(e,t,n)},te.prototype.getSolidityAt=function(e,t,n){return H[this.voxels.get(e,t,n)]},te.prototype.set=function(e,t,n,r){var i=this.voxels.get(e,t,n),o=i;if(r!==o){this.voxels.set(e,t,n,r),J[i]&&function(e,t,n,r){W.removeObjectBlock(e,t,n,r),e._objectsDirty=!0}(this,e,t,n),J[r]&&oe(this,r,e,t,n),ne(this,o,"onUnset",e,t,n),ne(this,r,"onSet",e,t,n),G[r]||(this.isFull=!1),0!==r&&(this.isEmpty=!1),(re(r)||re(i))&&(this._terrainDirty=!0),(this._terrainDirty||this._objectsDirty)&&this.noa.world._queueChunkForRemesh(this);var s=!1;if(H[i]!==H[r]&&(s=!0),G[i]!==G[r]&&(s=!0),s){var a=this.size-1,u=0===e?-1:e<a?0:1,l=0===t?-1:t<a?0:1,c=0===n?-1:n<a?0:1;if(u|l|c){var h=l?[0,l]:[0],f=c?[0,c]:[0];(u?[0,u]:[0]).forEach(e=>{h.forEach(t=>{f.forEach(n=>{if(0!=(e|t|n)){var r=this._neighbors.get(e,t,n);r&&(r._terrainDirty=!0,this.noa.world._queueChunkForRemesh(r))}})})})}}}},te.prototype.mesh=function(e,t,n,r,i){return X||(X=new B(this.noa)),X.meshChunk(this,e,t,n,r,i)},te.prototype.updateMeshes=function(){var e=this.noa.rendering;if(this._terrainDirty){this._terrainMesh&&this._terrainMesh.dispose();var t=this.mesh();if(t&&t.getIndices().length>0){var n=[this.x,this.y,this.z];e.addMeshToScene(t,!0,n,this)}this._terrainMesh=t||null,this._terrainDirty=!1,this._timesMeshed++,this._maxMeshedNeighbors=Math.max(this._maxMeshedNeighbors,this._neighborCount)}if(this._objectsDirty){W.removeObjectMeshes(this);var r=W.buildObjectMeshes(this),i=[this.x,this.y,this.z];r.forEach(t=>e.addMeshToScene(t,!0,i,this)),this._objectsDirty=!1}},te.prototype.dispose=function(){se(this,"onUnload"),W.disposeChunk(this),this._terrainMesh&&this._terrainMesh.dispose(),this.voxels.data=null,this.voxels=null,this._neighbors.data=null,this._neighbors=null,this.isDisposed=!0};var ae=n(135).EventEmitter,ue={chunkSize:24,chunkAddDistance:3,chunkRemoveDistance:4,worldGenWhilePaused:!1,manuallyControlChunkLoading:!1};function le(e,t){var n;this.noa=e,t=Object.assign({},ue,t),this.playerChunkLoaded=!1,this.Chunk=ee,this.chunkSize=t.chunkSize,this.chunkAddDistance=t.chunkAddDistance,this.chunkRemoveDistance=t.chunkRemoveDistance,this.chunkRemoveDistance<this.chunkAddDistance&&(this.chunkRemoveDistance=this.chunkAddDistance),this.manuallyControlChunkLoading=!!t.manuallyControlChunkLoading,this.minNeighborsToMesh=6,this.maxChunksPendingCreation=10,this.maxChunksPendingMeshing=10,this.maxProcessingPerTick=9,this.maxProcessingPerRender=5,this.worldGenWhilePaused=t.worldGenWhilePaused,this._cachedWorldName="",this._lastPlayerChunkID="",this._chunkStorage={},(n=this)._chunkIDsKnown=new f,n._chunkIDsToRequest=new f,n._chunkIDsPending=new f,n._chunkIDsToMesh=new f,n._chunkIDsToMeshFirst=new f,n._chunkIDsToRemove=new f,n._queueChunkForRemesh=e=>{ge(n,e)},function(e){e._getChunk=(t,n,r)=>{var i=he(t,n,r);return e._chunkStorage[i]||null},e._setChunk=(t,n,r,i)=>{var o=he(t,n,r);i?e._chunkStorage[o]=i:delete e._chunkStorage[o]},e._getChunkByCoords=function(t,n,r){var i=e._worldCoordToChunkCoord(t),o=e._worldCoordToChunkCoord(n),s=e._worldCoordToChunkCoord(r);return e._getChunk(i,o,s)}}(this),this.removeChunk=function(e){ye(this,e)};var r=this.chunkSize;if(0==(r&r-1)){var i=0|Math.log2(r),o=r-1|0;this._worldCoordToChunkCoord=e=>e>>i|0,this._worldCoordToChunkIndex=e=>e&o|0}else this._worldCoordToChunkCoord=e=>0|Math.floor(e/r),this._worldCoordToChunkIndex=e=>(e%r+r)%r|0}le.prototype=Object.create(ae.prototype),le.prototype.getBlockID=function(e,t,n){var r=this._getChunkByCoords(e,t,n);return r?r.get(this._worldCoordToChunkIndex(e),this._worldCoordToChunkIndex(t),this._worldCoordToChunkIndex(n)):0},le.prototype.getBlockSolidity=function(e,t,n){var r=this._getChunkByCoords(e,t,n);return!!r&&!!r.getSolidityAt(this._worldCoordToChunkIndex(e),this._worldCoordToChunkIndex(t),this._worldCoordToChunkIndex(n))},le.prototype.getBlockOpacity=function(e,t,n){var r=this.getBlockID(e,t,n);return this.noa.registry.getBlockOpacity(r)},le.prototype.getBlockFluidity=function(e,t,n){var r=this.getBlockID(e,t,n);return this.noa.registry.getBlockFluidity(r)},le.prototype.getBlockProperties=function(e,t,n){var r=this.getBlockID(e,t,n);return this.noa.registry.getBlockProps(r)},le.prototype.getBlockObjectMesh=function(e,t,n){var r=this._getChunkByCoords(e,t,n);return r?r.getObjectMeshAt(this._worldCoordToChunkIndex(e),this._worldCoordToChunkIndex(t),this._worldCoordToChunkIndex(n)):0},le.prototype.setBlockID=function(e,t,n,r){var i=this._worldCoordToChunkCoord(t),o=this._worldCoordToChunkCoord(n),s=this._worldCoordToChunkCoord(r),a=this._worldCoordToChunkIndex(t),u=this._worldCoordToChunkIndex(n),l=this._worldCoordToChunkIndex(r),c=this._getChunk(i,o,s);c&&c.set(a,u,l,e)},le.prototype.isBoxUnobstructed=function(e){for(var t=e.base,n=e.max,r=Math.floor(t[0]);r<n[0]+1;r++)for(var i=Math.floor(t[1]);i<n[1]+1;i++)for(var o=Math.floor(t[2]);o<n[2]+1;o++)if(this.getBlockSolidity(r,i,o))return!1;return!0},le.prototype.setChunkData=function(e,t,n){!function(e,t,n,r){var i=t.split("|"),o=parseInt(i.shift()),s=parseInt(i.shift()),a=parseInt(i.shift()),u=i.join("|"),l=he(o,s,a);if(e._chunkIDsPending.remove(l),u!==e.noa.worldName)return;if(!e._chunkIDsKnown.includes(l))return;if(e._chunkIDsToRemove.includes(l))return;var c=e._chunkStorage[l];if(c){c._updateVoxelArray(n),c._neighbors.data.forEach(t=>{t&&t!==c&&t._neighborCount>20&&ge(e,t)})}else{var h=e.chunkSize;c=new ee(e.noa,l,o,s,a,h,n),e._setChunk(o,s,a,c),c.requestID=t,c.userData=r,be(e,o,s,a,c),e.noa.rendering.prepareChunkForRendering(c),e.emit("chunkAdded",c)}ge(e,c),xe("receive")}(this,e,t,n)},le.prototype.invalidateVoxelsInAABB=function(e){!function(e,t){var n=t.base.map(t=>Math.floor(e._worldCoordToChunkCoord(t))),r=t.max.map(t=>Math.floor(e._worldCoordToChunkCoord(t)));e._chunkIDsKnown.forEach(t=>{for(var i=fe(t),o=0;o<3;o++)if(i[o]<n[o]||i[o]>r[o])return;e._chunkIDsToRemove.includes(t)||e._chunkIDsToRequest.add(t)})}(this,e)},le.prototype.manuallyLoadChunk=function(e,t,n){if(!this.manuallyControlChunkLoading)throw ce;var r=he(this._worldCoordToChunkCoord(e),this._worldCoordToChunkCoord(t),this._worldCoordToChunkCoord(n));this._chunkIDsKnown.add(r),this._chunkIDsToRequest.add(r)},le.prototype.manuallyUnloadChunk=function(e,t,n){if(!this.manuallyControlChunkLoading)throw ce;var r=he(this._worldCoordToChunkCoord(e),this._worldCoordToChunkCoord(t),this._worldCoordToChunkCoord(n));this._chunkIDsToRemove.add(r),this._chunkIDsToRequest.remove(r),this._chunkIDsToMesh.remove(r),this._chunkIDsToMeshFirst.remove(r)};var ce="Set `noa.world.manuallyControlChunkLoading` if you need this API";function he(e,t,n){return e+"|"+t+"|"+n}function fe(e){return e.split("|").map(e=>parseInt(e))}function de(e){var t=e.noa.entities.getPosition(e.noa.playerEntity);return[e._worldCoordToChunkCoord(t[0]),e._worldCoordToChunkCoord(t[1]),e._worldCoordToChunkCoord(t[2])]}le.prototype.tick=function(){var e=performance.now();this._cachedWorldName!==this.noa.worldName&&(!function(e){e._chunkIDsToRemove.copyFrom(e._chunkIDsKnown),e._chunkIDsToRequest.empty(),e._chunkIDsToMesh.empty(),e._chunkIDsToMeshFirst.empty();var t=de(e);ve(e._chunkIDsToRemove,t[0],t[1],t[2])}(this),this._cachedWorldName=this.noa.worldName);var t,n,r,i,o,s,a=de(this),h=he(a[0],a[1],a[2]),f=h!=this._lastPlayerChunkID;if(f&&(this.emit("playerEnteredChunk",a[0],a[1],a[2]),this._lastPlayerChunkID=h),_e("start"),xe("start"),!this.manuallyControlChunkLoading){f&&(t=this,n=a[0],r=a[1],i=a[2],o=t.chunkRemoveDistance*t.chunkRemoveDistance,s=t._chunkIDsToRemove,t._chunkIDsKnown.forEach(e=>{if(!s.includes(e)){var a=fe(e),u=a[0]-n,l=a[1]-r,c=a[2]-i;u*u+l*l+c*c<o||(t._chunkIDsToRemove.add(e),t._chunkIDsToRequest.remove(e),t._chunkIDsToMesh.remove(e),t._chunkIDsToMeshFirst.remove(e))}}),ve(s,n,r,i),_e("remQueue"));var d=function(e){if(e===l)return c;for(var t=Math.ceil(e),n=0,r=e*e,i=-t;i<=t;++i)for(var o=-t;o<=t;++o)for(var s=-t;s<=t;++s){i*i+o*o+s*s<r&&n++}return l=e,c=n,n}(this.chunkAddDistance);(f||this._chunkIDsKnown.count()<d)&&(!function(e,t,n,r){for(var i=Math.ceil(e.chunkAddDistance),o=e.chunkAddDistance*e.chunkAddDistance,s=e._chunkIDsKnown,a=e._chunkIDsToRequest,u=t-i;u<=t+i;++u)for(var l=n-i;l<=n+i;++l)for(var c=r-i;c<=r+i;++c){var h=he(u,l,c);if(!s.includes(h)){var f=u-t,d=l-n,p=c-r;f*f+d*d+p*p>o||(s.add(h),a.add(h))}}ve(a,t,n,r)}(this,a[0],a[1],a[2]),_e("addQueue"))}u(this.maxProcessingPerTick,()=>{var e=function(e){var t=e._chunkIDsToRequest;if(t.isEmpty())return!0;var n=e._chunkIDsPending.count(),r=e._chunkIDsToMesh.count();if(n>=e.maxChunksPendingCreation)return!0;if(r>=e.maxChunksPendingMeshing)return!0;var i=t.pop();return function(e,t){var n=fe(t),r=n[0],i=n[1],o=n[2],s=e.chunkSize,a=ee._createVoxelArray(e.chunkSize),u=e.noa.worldName,l=[r,i,o,u].join("|"),c=r*s,h=i*s,f=o*s;e._chunkIDsPending.add(t),e.emit("worldDataNeeded",l,a,c,h,f,u),xe("request")}(e,i),t.isEmpty()}(this);return _e("requests"),e=e&&function(e){var t=e._chunkIDsToRemove;return!!t.isEmpty()||(ye(e,t.pop()),t.isEmpty())}(this),_e("removes"),e=e&&me(this,!1),_e("meshes"),e},e),performance.now()-e+2<this.maxProcessingPerTick&&(!function(e){for(var t=e._chunkIDsKnown.arr,n=Math.min(50,t.length),r=e._chunkIDsToMesh.count()+e._chunkIDsToMeshFirst.count(),i=0;i<n;i++){pe=(pe+1)%t.length;var o=t[pe],s=e._chunkStorage[o];if(s){var a=s._neighborCount;if(!(a<e.minNeighborsToMesh)&&!(a<=s._maxMeshedNeighbors)&&(ge(e,s),++r>10))return}}}(this),_e("looking"),u(this.maxProcessingPerTick,()=>{var e=me(this,!1);return _e("meshes"),e},e));var p=this._getChunk(a[0],a[1],a[2]);this.playerChunkLoaded=!!p,xe("end",this),_e("end")},le.prototype.render=function(){u(this.maxProcessingPerRender,()=>me(this,!0))};var pe=-1;function me(e,t){var n=e._chunkIDsToMeshFirst;if(n.isEmpty()&&!t&&(n=e._chunkIDsToMesh),n.isEmpty())return!0;var r=n.pop();if(!e._chunkIDsToRemove.includes(r)){var i=e._chunkStorage[r];i&&function(e,t){e._chunkIDsToMesh.remove(t.id),e._chunkIDsToMeshFirst.remove(t.id),t.updateMeshes(),xe("mesh")}(e,i)}}function ye(e,t){var n=fe(t),r=e._getChunk(n[0],n[1],n[2]);r&&(e.emit("chunkBeingRemoved",r.requestID,r.voxels,r.userData),e.noa.rendering.disposeChunkForRendering(r),r.dispose(),xe("dispose"),be(e,n[0],n[1],n[2],null)),e._setChunk(n[0],n[1],n[2],null),e._chunkIDsKnown.remove(t),e._chunkIDsToMesh.remove(t),e._chunkIDsToMeshFirst.remove(t)}function ge(e,t){var n=t._neighborCount;n<Math.min(e.minNeighborsToMesh,26)||(t._terrainDirty=!0,(26===n?e._chunkIDsToMeshFirst:e._chunkIDsToMesh).add(t.id))}function ve(e,t,n,r){e.sort(e=>{var i=fe(e),o=i[0]-t,s=i[1]-n,a=i[2]-r;return o*o+a*a+Math.abs(s)})}function be(e,t,n,r,i){for(var o=-1;o<=1;o++)for(var s=-1;s<=1;s++)for(var a=-1;a<=1;a++)if(0!=(o|s|a)){var u=he(t+o,n+s,r+a),l=e._chunkStorage[u];l&&(i?(i._neighborCount++,i._neighbors.set(o,s,a,l),l._neighborCount++,l._neighbors.set(-o,-s,-a,i),26===l._neighborCount&&ge(e,l)):(l._neighborCount--,l._neighbors.set(-o,-s,-a,null)))}}function we(e,t,n,r){var i=0,o=0,s=0,a=0,u=[];n.forEach(t=>{var n=e._chunkStorage[t];n&&(s++,u.push(n._timesMeshed),n.isFull&&i++,n.isEmpty&&o++,26===n._neighborCount&&a++)});var l=n.length.toString().padEnd(8);if(l+=("exist: "+s).padEnd(12),l+=("full: "+i).padEnd(12),l+=("empty: "+o).padEnd(12),l+=("surr: "+a).padEnd(12),r){var c=u.reduce((e,t)=>e+t,0),h=u.reduce((e,t)=>Math.max(e,t),0),f=u.reduce((e,t)=>Math.min(e,t),0);l+="times meshed: avg "+(c/s).toFixed(2),l+="  max "+h,l+="  min "+f}console.log(t,l)}le.prototype.report=function(){console.log("World report - playerChunkLoaded: ",this.playerChunkLoaded),we(this,"  known:     ",this._chunkIDsKnown.arr,!0),we(this,"  to request:",this._chunkIDsToRequest.arr),we(this,"  to remove: ",this._chunkIDsToRemove.arr),we(this,"  creating:  ",this._chunkIDsPending.arr),we(this,"  to mesh:   ",this._chunkIDsToMesh.arr.concat(this._chunkIDsToMeshFirst.arr))};var _e=()=>{},xe=()=>{};var ke=n(305),Oe=function(e,t,n){return function(e,t,n){t=Object.assign({},Pe,t);var r=ke(n,t),i=t.bindings;for(var o in i){var s=Array.isArray(i[o])?i[o]:[i[o]];s.unshift(o),r.bind.apply(r,s)}return r}(0,t,n)},Pe={bindings:{forward:["W","<up>"],left:["A","<left>"],backward:["S","<down>"],right:["D","<right>"],fire:"<mouse 1>","mid-fire":["<mouse 2>","Q"],"alt-fire":["<mouse 3>","E"],jump:"<space>",sprint:"<shift>",crouch:"<control>"}};var Se=n(308),Ce=function(e,t){return function(e,t){t=Object.assign({},je,t);var n=e.world,r=e.registry._solidityLookup,i=e.registry._fluidityLookup,o=e.worldOriginOffset;return Se(t,(e,t,i)=>{var s=n.getBlockID(e+o[0],t+o[1],i+o[2]);return r[s]},(e,t,r)=>{var s=n.getBlockID(e+o[0],t+o[1],r+o[2]);return i[s]})}(e,t)},je={gravity:[0,-10,0],airDrag:.1};var Ee=n(76),Ae=n(208),Me=n(236),Te={inverseX:!1,inverseY:!1,sensitivityX:10,sensitivityY:10,initialZoom:0,zoomSpeed:.2};function Ie(e,t){this.noa=e,t=Object.assign({},Te,t),this.sensitivityX=t.sensitivityX,this.sensitivityY=t.sensitivityY,this.inverseX=t.inverseX,this.inverseY=t.inverseY,this.heading=0,this.pitch=0,this.cameraTarget=this.noa.ents.createEntity(["position"]);var n=.9*e.ents.getPositionData(e.playerEntity).height;e.ents.addComponent(this.cameraTarget,"followsEntity",{entity:e.playerEntity,offset:[0,n,0]}),this.zoomDistance=t.initialZoom,this.zoomSpeed=t.zoomSpeed,this.currentZoom=t.initialZoom,this._dirVector=Ee.fromValues(0,1,0)}Ie.prototype._localGetTargetPosition=function(){var e=this.noa.ents.getPositionData(this.cameraTarget);return Ee.copy(De,e._renderPosition)},Ie.prototype._localGetPosition=function(){var e=this._localGetTargetPosition();return 0===this.currentZoom?e:Ee.scaleAndAdd(e,e,this._dirVector,-this.currentZoom)};var De=Ee.create();Ie.prototype.getTargetPosition=function(){var e=this._localGetTargetPosition();return this.noa.localToGlobal(e,ze)};var ze=[];Ie.prototype.getPosition=function(){var e=this._localGetPosition();return this.noa.localToGlobal(e,ze)},Ie.prototype.getDirection=function(){return this._dirVector},Ie.prototype.applyInputsToCamera=function(){var e=this.noa.inputs.state;!function(e){var t=e.dx,n=e.dy,r=document.body.clientWidth/6,i=document.body.clientHeight/6,o=Math.abs(t)>r&&t/Ve<-1,s=Math.abs(n)>i&&n/qe<-1;o||s?(e.dx=Ve,e.dy=qe,Ve=t>0?1:-1,qe=n>0?1:-1):(t&&(Ve=t),n&&(qe=n))}(e);var t=.0066*Math.PI/180,n=e.dy*this.sensitivityY*t,r=e.dx*this.sensitivityX*t;this.inverseY&&(n=-n),this.inverseX&&(r=-r);var i=2*Math.PI;this.heading+=r<0?r+i:r,this.heading>i&&(this.heading-=i);var o=Math.PI/2-.001;this.pitch=Math.max(-o,Math.min(o,this.pitch+n)),Ee.set(this._dirVector,0,0,1),Ee.rotateX(this._dirVector,this._dirVector,Be,this.pitch),Ee.rotateY(this._dirVector,this._dirVector,Be,this.heading)};var Be=Ee.create();Ie.prototype.updateBeforeEntityRenderSystems=function(){this.currentZoom+=(this.zoomDistance-this.currentZoom)*this.zoomSpeed},Ie.prototype.updateAfterEntityRenderSystems=function(){var e=function(e){if(!Le){var t=e.noa.worldOriginOffset;Le=new Ae([0,0,0],Ee.clone(Ne)),Re=(n,r,i)=>e.noa.world.getBlockSolidity(n+t[0],r+t[1],i+t[2]),Ee.scale(Ne,Ne,-.5)}Le.setPosition(e._localGetTargetPosition()),Le.translate(Ne);var n=Math.max(e.zoomDistance,e.currentZoom)+.1;return Ee.scale(Fe,e.getDirection(),-n),Me(Re,Le,Fe,Ue,!0)}(this);this.currentZoom>e&&(this.currentZoom=e)};var Le,Re,Ne=Ee.fromValues(.2,.2,.2),Fe=Ee.create(),Ue=()=>!0;var Ve=0,qe=0,Ke={texturePath:""},We={solid:!0,opaque:!0,fluidDensity:1,viscosity:.5};function Ye(e,t){this.noa=e,t=Object.assign({},Ke,t);var n=[!1],r=[!1],i=[!1],o=[!1],s=[0,0,0,0,0,0],a=[null],u=[null],l=[null],c={},h=[null],f=t.texturePath;this.registerBlock=function(e,t){t=t||{},We.solid=!t.fluid,We.opaque=!t.fluid;var h=Object.assign({},We,t);if(e<1||e>65535)throw"Block id out of range: "+e;for(;e>n.length;)this.registerBlock(n.length,{});n[e]=!!h.solid,r[e]=!!h.opaque,i[e]=!!h.fluid,o[e]=!!h.blockMesh,u[e]=h.blockMesh||null;var f,d=h.material||null;if(d)if("string"==typeof d)f=[d,d,d,d,d,d];else if(d.length&&2==d.length)f=[d[1],d[1],d[0],d[0],d[1],d[1]];else if(d.length&&3==d.length)f=[d[2],d[2],d[0],d[1],d[2],d[2]];else{if(!d.length||6!=d.length)throw"Invalid material parameter: "+d;f=d}else f=[null,null,null,null,null,null];for(var p=0;p<6;++p)s[6*e+p]=He(this,c,f[p],!0);a[e]={},i[e]&&(a[e].fluidDensity=h.fluidDensity,a[e].viscosity=h.viscosity);var m=h.onLoad||h.onUnload||h.onSet||h.onUnset||h.onCustomMeshCreate;return l[e]=m?new Ge(h):null,e},this.registerMaterial=function(e,t,n,r,i){var o=c[e]||h.length;c[e]=o;var s=1;return t&&4==t.length&&(s=t.pop()),h[o]={color:t||[1,1,1],alpha:s,texture:n?f+n:"",textureAlpha:!!r,renderMat:i||null},o},this.getBlockSolidity=function(e){return n[e]},this.getBlockOpacity=function(e){return r[e]},this.getBlockFluidity=function(e){return i[e]},this.getBlockProps=function(e){return a[e]},this.getBlockFaceMaterial=function(e,t){return s[6*e+t]},this.getMaterialColor=function(e){return h[e].color},this.getMaterialTexture=function(e){return h[e].texture},this.getMaterialData=function(e){return h[e]},this._solidityLookup=n,this._opacityLookup=r,this._fluidityLookup=i,this._objectLookup=o,this._blockMeshLookup=u,this._blockHandlerLookup=l,this._getMaterialVertexColor=function(e){return h[e].texture?d:h[e].color};var d=[1,1,1];this.registerMaterial("dirt",[.4,.3,0],null),this.registerBlock(1,{material:"dirt"})}function He(e,t,n,r){if(!n)return 0;var i=t[n];return void 0===i&&r&&(i=e.registerMaterial(n)),i}function Ge(e){this.onLoad=e.onLoad||null,this.onUnload=e.onUnload||null,this.onSet=e.onSet||null,this.onUnset=e.onUnset||null,this.onCustomMeshCreate=e.onCustomMeshCreate||null}var Je=n(215),Ze=n(216),Xe=n(76),$e=n(310),Qe={shadowDistance:10};function et(e,t){$e.call(this),this.noa=e,t=Object.assign({},Qe,t),this.names={};var r={shadow:t.shadowDistance},i=n(312);i.keys().forEach(t=>{var n=/\.\/(.*)\.js/.exec(t)[1],o=r[n]||void 0,s=i(t);s.default&&(s=s.default);var a=s(e,o),u=this.createComponent(a);this.names[n]=u}),this.isPlayer=function(t){return t===e.playerEntity},this.hasPhysics=this.getComponentAccessor(this.names.physics),this.cameraSmoothed=this.getComponentAccessor(this.names.smoothCamera),this.hasMesh=this.getComponentAccessor(this.names.mesh),this.hasPosition=this.getComponentAccessor(this.names.position);var o=this.getStateAccessor(this.names.position);function s(t,n){Xe.copy(n._renderPosition,n._localPosition),Xe.add(n.position,n._localPosition,e.worldOriginOffset),Object(Je.updatePositionExtents)(n);var r=a(t);r&&Object(Ze.setPhysicsFromPosition)(r,n)}this.getPositionData=o,this._localGetPosition=function(e){return o(e)._localPosition},this.getPosition=function(e){return o(e).position},this._localSetPosition=function(e,t){var n=o(e);Xe.copy(n._localPosition,t),s(e,n)},this.setPosition=(t,n,r,i)=>{"number"==typeof n&&(n=[n,r,i]);var o=e.globalToLocal(n,null,[]);this._localSetPosition(t,o)},this.setEntitySize=function(e,t,n,r){var i=o(e);i.width=(t+r)/2,i.height=n,s(e,i)},this._rebaseOrigin=function(e){this.getStatesList(this.names.position).forEach(t=>{Xe.subtract(t._localPosition,t._localPosition,e),s(t.__id,t)})};var a=this.getStateAccessor(this.names.physics);this.getPhysics=a,this.getPhysicsBody=function(e){return a(e).body},this.getMeshData=this.getStateAccessor(this.names.mesh),this.getMovement=this.getStateAccessor(this.names.movement),this.getCollideTerrain=this.getStateAccessor(this.names.collideTerrain),this.getCollideEntities=this.getStateAccessor(this.names.collideEntities),this.onPairwiseEntityCollision=function(e,t){}}function tt(e,t){return!(e[0]>t[3])&&(!(e[1]>t[4])&&(!(e[2]>t[5])&&(!(e[3]<t[0])&&(!(e[4]<t[1])&&!(e[5]<t[2])))))}et.prototype=Object.create($e.prototype),et.prototype.constructor=et,et.prototype.addComponentAgain=function(e,t,n){this.hasComponent(e,t)&&this.removeComponent(e,t,!0),this.addComponent(e,t,n)},et.prototype.isTerrainBlocked=function(e,t,n){for(var r=this.noa.worldOriginOffset,i=Math.floor(e-r[0]),o=Math.floor(t-r[1]),s=Math.floor(n-r[2]),a=[i+.001,o+.001,s+.001,i+.999,o+.999,s+.999],u=this.getStatesList(this.names.collideTerrain),l=0;l<u.length;l++){var c=u[l].__id;if(tt(a,this.getPositionData(c)._extents))return!0}return!1},et.prototype.getEntitiesInAABB=function(e,t){var n=this.noa.worldOriginOffset,r=[e.base[0]+n[0],e.base[1]+n[1],e.base[2]+n[2],e.max[0]+n[0],e.max[1]+n[1],e.max[2]+n[2]],i=t?this.getStatesList(t).map(e=>this.getPositionData(e.__id)):this.getStatesList(this.names.position),o=[];return i.forEach(e=>{tt(r,e._extents)&&o.push(e.__id)}),o},et.prototype.add=function(e,t,n,r,i,o,s){var a=this,u=this.createEntity();if(this.addComponent(u,this.names.position,{position:e||[0,0,0],width:t,height:n}),o){this.addComponent(u,this.names.physics);var l=this.getPhysicsBody(u),c=this.names.smoothCamera;l.onStep=function(){a.addComponentAgain(u,c)}}return r&&(i||(i=Xe.create()),this.addComponent(u,this.names.mesh,{mesh:r,offset:i})),s&&this.addComponent(u,this.names.shadow,{size:t}),u}
/*!
 * noa: an experimental voxel game engine.
 * @url      github.com/andyhall/noa
 * @author   Andy Hall <andy@fenomas.com>
 * @license  MIT
 */;var nt=n(76),rt=n(128),it=n(291),ot=n(135).EventEmitter,st=(t.default=at,{debug:!1,silent:!1,playerHeight:1.8,playerWidth:.6,playerStart:[0,10,0],playerAutoStep:!1,tickRate:33,blockTestDistance:10,stickyPointerLock:!0,dragCameraOutsidePointerLock:!0,skipDefaultHighlighting:!1,originRebaseDistance:25});function at(e){if(!(this instanceof at))return new at(e);this.version=n(332).version,e=Object.assign({},st,e),this._tickRate=e.tickRate,this._lastRenderTime=0,this._paused=!1,this._dragOutsideLock=e.dragCameraOutsidePointerLock;var t=this;if(!e.silent){var r=e.debug?" (debug)":"";console.log(`noa-engine v${this.version}${r}`)}this.worldOriginOffset=[0,0,0],this._originRebaseDistance=e.originRebaseDistance,this.vec3=nt,this.positionInCurrentTick=0,this.worldName="default",this.container=function(e,t){return new o(e,t)}(this,e),this.inputs=Oe(0,e,this.container.element),this.registry=function(e,t){return new Ye(e,t)}(this,e),this.world=function(e,t){return new le(e,t)}(this,e),this.rendering=function(e,t,n){return new P(e,t,n)}(this,e,this.container.canvas),this.physics=Ce(this,e),this.entities=function(e,t){return new et(e,t)}(this,e),this.ents=this.entities;var i=this.ents;this.playerEntity=i.add(e.playerStart,e.playerWidth,e.playerHeight,null,null,!0,!0),i.addComponent(this.playerEntity,i.names.collideTerrain),i.addComponent(this.playerEntity,i.names.collideEntities);var s=i.getPhysicsBody(this.playerEntity);s.gravityMultiplier=2,s.autoStep=e.playerAutoStep,i.addComponent(this.playerEntity,i.names.receivesInputs),i.addComponent(this.playerEntity,i.names.fadeOnZoom);var a,u,l;i.addComponent(this.playerEntity,i.names.movement,{airJumps:1}),this.camera=function(e,t){return new Ie(e,t)}(this,e),this.blockTestDistance=e.blockTestDistance,this.blockTargetIdCheck=this.registry.getBlockSolidity,this.targetedBlock=null,e.skipDefaultHighlighting||(this.defaultBlockHighlightFunction=function(e){e?t.rendering.highlightBlockFace(!0,e.position,e.normal):t.rendering.highlightBlockFace(!1)},this.on("targetBlockChanged",this.defaultBlockHighlightFunction)),e.debug&&(window.noa=this,window.scene=this.rendering._scene,window.ndarray=rt,window.vec3=nt,i.getMovement(1).airJumps=999,this.setViewDistance=function(e){var t=this.world.chunkSize;this.world.chunkAddDistance=e/t,this.world.chunkRemoveDistance=e/t+1,this.world._lastPlayerChunkID=""}),u="0.27",(l=(e,t,n)=>{var r=()=>{throw`This property changed in ${u} - ${n}`};Object.defineProperty(e,t,{get:r,set:r})})(a=this,"getPlayerEyePosition","to get the camera/player offset see API docs for `noa.camera.cameraTarget`"),l(a,"setPlayerEyePosition","to set the camera/player offset see API docs for `noa.camera.cameraTarget`"),l(a,"getPlayerPosition","use `noa.ents.getPosition(noa.playerEntity)` or similar"),l(a,"getCameraVector","use `noa.camera.getDirection`"),l(a,"getPlayerMesh","use `noa.ents.getMeshData(noa.playerEntity).mesh` or similar"),l(a,"playerBody","use `noa.ents.getPhysicsBody(noa.playerEntity)`"),l(a.rendering,"zoomDistance","use `noa.camera.zoomDistance`"),l(a.rendering,"_currentZoom","use `noa.camera.currentZoom`"),l(a.rendering,"_cameraZoomSpeed","use `noa.camera.zoomSpeed`"),l(a.rendering,"getCameraVector","use `noa.camera.getDirection`"),l(a.rendering,"getCameraPosition","use `noa.camera.getLocalPosition`"),l(a.rendering,"getCameraRotation","use `noa.camera.heading` and `noa.camera.pitch`"),l(a.rendering,"setCameraRotation","to customize camera behavior see API docs for `noa.camera`"),u="0.28",l(a.rendering,"makeMeshInstance","removed, use Babylon's `mesh.createInstance`"),l(a.world,"_maxChunksPendingCreation",'use `maxChunksPendingCreation` (no "_")'),l(a.world,"_maxChunksPendingMeshing",'use `maxChunksPendingMeshing` (no "_")'),l(a.world,"_maxProcessingPerTick",'use `maxProcessingPerTick` (no "_")'),l(a.world,"_maxProcessingPerRender",'use `maxProcessingPerRender` (no "_")'),u="0.29",l(a,"_constants","removed, voxel IDs are no longer packed with bit flags")}at.prototype=Object.create(ot.prototype),at.prototype.tick=function(){if(this._paused)this.world.worldGenWhilePaused&&this.world.tick(e);else{ft("start"),function(e){var t=e.ents.getPositionData(e.playerEntity)._localPosition,n=e._originRebaseDistance;if(nt.sqrLen(t)<n*n)return;for(var r=[],i=0;i<3;i++){var o=Math.floor(t[i]);r[i]=o,e.worldOriginOffset[i]+=o}e.rendering._rebaseOrigin(r),e.entities._rebaseOrigin(r)}(this);var e=this._tickRate;this.world.tick(e),ft("world"),this.physics.tick(e),ft("physics"),this.rendering.tick(e),ft("rendering"),function(e){var t="",n=e.blockTargetIdCheck||e.registry.getBlockSolidity,r=e._localPick(null,null,null,n);if(r){var i=ct;nt.floor(i.adjacent,r.position),nt.copy(i.normal,r.normal),nt.sub(i.position,i.adjacent,i.normal),i.blockID=e.world.getBlockID(i.position[0],i.position[1],i.position[2]),e.targetedBlock=i,t=i.position.join("|")+i.normal.join("|")+"|"+i.blockID}else e.targetedBlock=null;t!=ht&&(e.emit("targetBlockChanged",e.targetedBlock),ht=t)}(this),ft("targets"),this.entities.tick(e),ft("entities"),this.emit("tick",e),ft("tick event"),ft("end");var t=this.inputs.state;t.scrollx=t.scrolly=t.scrollz=0}},at.prototype.render=function(e){this.positionInCurrentTick=e;var t=performance.now(),n=t-(this._lastRenderTime||t-16);this._lastRenderTime=t,this._paused?this.world.worldGenWhilePaused&&this.world.render():(dt("start"),(this.container.hasPointerLock||!this.container.supportsPointerLock||this._dragOutsideLock&&this.inputs.state.fire)&&this.camera.applyInputsToCamera(),dt("init"),this.world.render(n),dt("meshing"),this.camera.updateBeforeEntityRenderSystems(),this.entities.render(n),this.camera.updateAfterEntityRenderSystems(),dt("entities"),this.emit("beforeRender",n),dt("before render"),this.rendering.render(n),dt("render"),this.emit("afterRender",n),dt("after render"),dt("end"),this.inputs.state.dx=this.inputs.state.dy=0)},at.prototype.globalToLocal=function(e,t,n){var r=this.worldOriginOffset;if(t){for(var i=0;i<3;i++){var o=e[i]-r[i];o+=t[i],n[i]=o}return n}return nt.sub(n,e,r)},at.prototype.localToGlobal=function(e,t,n){var r=this.worldOriginOffset;if(n){for(var i=0;i<3;i++){var o=Math.floor(e[i]);t[i]=o+r[i],n[i]=e[i]-o}return t}return nt.add(t,e,r)},at.prototype.setPaused=function(e){this._paused=!!e,e||(this.inputs.state.dx=this.inputs.state.dy=0)},at.prototype.getBlock=function(e,t,n){return e.length?this.world.getBlockID(e[0],e[1],e[2]):this.world.getBlockID(e,t,n)},at.prototype.setBlock=function(e,t,n,r){return t.length?this.world.setBlockID(e,t[0],t[1],t[2]):this.world.setBlockID(e,t,n,r)},at.prototype.addBlock=function(e,t,n,r){if(t.length){if(this.entities.isTerrainBlocked(t[0],t[1],t[2]))return;return this.world.setBlockID(e,t[0],t[1],t[2]),e}if(!this.entities.isTerrainBlocked(t,n,r))return this.world.setBlockID(e,t,n,r),e},at.prototype.pick=function(e,t,n,r){return 0===n?null:(e&&(this.globalToLocal(e,null,ut),e=ut),this._localPick(e,t,n,r))};var ut=nt.create();at.prototype._localPick=function(e,t,n,r){if(0===n)return null;var i=r||this.registry.getBlockSolidity,o=this.world,s=this.worldOriginOffset;e||(e=this.camera._localGetTargetPosition()),t=t||this.camera.getDirection(),n=n||this.blockTestDistance;var a=lt._localPosition,u=lt.normal;return it((function(e,t,n){var r=o.getBlockID(e+s[0],t+s[1],n+s[2]);return i(r)}),e,t,n,a,u)?(nt.scaleAndAdd(a,a,u,.01),this.localToGlobal(a,lt.position),lt):null};var lt={_localPosition:nt.create(),position:[0,0,0],normal:[0,0,0]};var ct={blockID:0,position:[],normal:[],adjacent:[]},ht="";var ft=()=>{},dt=()=>{}}]);